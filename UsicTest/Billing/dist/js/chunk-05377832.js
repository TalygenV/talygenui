(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-05377832"],{"5eb3":function(e,t,a){var o=a("73a2");o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var n=a("499e").default;n("88549dce",o,!0,{sourceMap:!1,shadowMode:!1})},6520:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("section",{staticClass:"page-action action-margin"},[a("div",[a("tg-list",{attrs:{IsShowAction:!1,ModuleName:"Company",SubModuleCode:"",LegendArray:[],RenderRowActionMethod:e.renderActions,widgets:[],HeaderText:e.$t("MeterReading"),IdentityColumn:"MeterReadingId",listType:["List"],ListData:e.ListingData,HeaderData:e.Headers,HeaderButtons:e.listheaderbuttons,TotalRecords:e.TotalRecords,SearchFields:e.leftSearchFields,IsSearchFieldsOnTop:"false",ListDataCallBackFunction:e.FetchData,showCheckBox:!0,SortExp:e.SortExp,SortBy:e.SortBy,NorecordfoundText:e.$t("NoRecordfound")},on:{ActionButtonClick:e.actionButtonClick,LeftsearchButtonClick:e.leftCommonSearch,PagerButtonClick:e.pagerMethod,HeaderButtonClick:e.commonHeaderButtonClick,SortdataButtonClick:e.sortdata},scopedSlots:e._u([{key:"slotdata",fn:function(t){var o=t.data;return["file_names"==o.column.COLUMN_NAME?[null!=o.row.file_names?a("div",{staticClass:"form-control p-0 border-0",attrs:{alt:"",title:""}},[a("a",{attrs:{href:"javascript:;"},on:{click:function(t){return e.openLightbox(o.row.file_names)}}},[a("img",{staticClass:"border p-2",attrs:{src:o.row.file_names,height:"50",width:"100",title:""}})])]):e._e(),null==o.row.file_names?a("div",{staticClass:"form-control p-0 border-0"},[a("img",{attrs:{src:"/Content/images/imagenotavailable.jpg",alt:"No Image Available",height:"50",width:"100",title:""}})]):e._e()]:e._e(),"ReadingDate"==o.column.COLUMN_NAME?[a("span",{staticClass:"text-center single-action tourguide_a",attrs:{title:e.$options.filters.formatDate(o.row.ReadingDate)}},[e._v(" "+e._s(e.$d(o.row.ReadingDate))+" ")])]:e._e(),"location"==o.column.COLUMN_NAME?[a("span",{staticClass:"text-center single-action",staticStyle:{cursor:"pointer"},attrs:{title:"Location"}},[null!=o.row.longitude&&null!=o.row.latitude?a("a",{attrs:{href:"javascript:;"},on:{click:function(t){return e.openMap(o.row)}}},[a("i",{staticClass:"text-info fa fa-map-marker fa-2x"})]):a("a",{attrs:{href:"javascript:;"}},[a("i",{staticClass:"text-info disabled fa fa-map-marker fa-2x"})])])]:e._e(),"status_code"==o.column.COLUMN_NAME?["PROCESSED"==o.row.status_code?a("span",{staticClass:"px-2 bg-primary text-center text-white d-block"},[e._v(" "+e._s(e.$t("Processed"))+" ")]):"UNPROCESSED"==o.row.status_code?a("span",{staticClass:"px-2 bg-success text-center text-white d-block"},[e._v(" "+e._s(e.$t("Unprocessed"))+" ")]):"FLAGGED"==o.row.status_code?a("span",{staticClass:"px-2 bg-warning text-center text-white d-block"},[e._v(" "+e._s(e.$t("Flagged"))+" ")]):"DONOTBILL"==o.row.status_code?a("span",{staticClass:"px-2 bg-info text-center text-white d-block"},[e._v(" "+e._s(e.$t("DoNotBill"))+" ")]):e._e()]:e._e()]}}])}),e.isViewMap?a("ViewMap",{attrs:{latLngValues:e.latLngValues,meterReadingDetail:e.meterReadingDetail}}):e._e()],1),a("vue-image-lightbox-carousel",{ref:"lightbox",attrs:{show:e.showLightbox,images:e.images,"show-footer-count":!1},on:{close:e.closeshowLightbox}})],1)])},n=[],i=(a("14d9"),a("9769"));let r=[{title:"Delete",id:"DeleteMultiple",iconClass:"fa fa-trash",callbackfunction:"Delete",additionalClass:"",isdisabled:!0,isvisible:!0,checkPrivilege:!0,isEnabledOnSelectedRow:!0}],s=[{fieldName:"Customer",fieldType:"ddl-radio",fieldIcon:"fa-user",paramName:"ClientId",fieldSearchConditionName:["MM.client_id"],isSearch:!1,value:"",listOptions:[]},{fieldName:"DateRange",fieldType:"date-range",fieldIcon:"fa fa-calendar",paramName:"MeterReadingDate ",fieldSearchConditionName:[""],isSearch:!1,datePickerConfig:{useCurrent:!0,showClear:!0,showClose:!0,allowInputToggle:!1,minDate:!0,maxDate:!0,widgetPositioning:{horizontal:"right",vertical:"bottom"}},secondDatePickerConfig:{useCurrent:!1,showClear:!0,showClose:!0,allowInputToggle:!1,minDate:!0,maxDate:!0,widgetPositioning:{horizontal:"right",vertical:"bottom"}}},{fieldName:"Status",fieldType:"ddl-radio",fieldIcon:"fa fa fa-file-text-o",paramName:"statusCode",fieldSearchConditionName:["MR.status_code"],isSearch:!1,value:"",listOptions:[{name:"Unprocessed",value:"UNPROCESSED"},{name:"Processed",value:"PROCESSED"},{name:"Flagged",value:"FLAGGED"},{name:"DoNotBill",value:"DONOTBILL"}]}];function l(e,t,a){var o=e;let n=[];if("Customer"===a){o.isLoading=!0;var r="id=&moduleName=&type=CLIENTS&search=";i["a"].GetDDLData(r).then(e=>{if(e.data&&e.data.DATA){var t=e.data.DATA;t.forEach(e=>{if(e.name&&"string"===typeof e.name){let t=e.name.split(" (")[0].trim(),a={name:t,value:e.value};n.push(a)}}),o.leftSearchFields[0].listOptions=n}o.isLoading=!1}).catch(e=>{console.error("Failed to load customer dropdown data:",e),o.isLoading=!1})}}var p={buttons:r,leftsearchSchema:s,bindleftCommonSearchdropdown:l},d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("div",{staticClass:"my-popups"},[a("div",{staticClass:"modal d-block"},[a("div",{staticClass:"modal-dialog modal-dialog-centered"},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[e._v(" "+e._s(e.$t("ViewLocation"))+" :- "+e._s(e.meterReadingDetail.meter_number)+" ")]),a("button",{staticClass:"close",attrs:{type:"button",title:"Close"},on:{click:function(t){return e.closePopup()}}},[a("em",{staticClass:"fa fa-times"})])]),a("div",{staticClass:"modal-body"},[a("MapComponent",{ref:"mapComponnet",staticClass:"row",attrs:{mapType:"MapBox",mapContainer:"addAddress",config:e.config,mapHeight:"500px",meterReadingDetail:e.meterReadingDetail,latLng:e.latLngValues}})],1)])])])])])},c=[],m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("loader",{attrs:{"is-visible":e.isLoading}}),a("div",{staticClass:"container-fluid mt-2"},[a("div",[a("div",{staticClass:"row mt-0.5",attrs:{id:"checkForZone"}},["Google"==e.mapType&&1==e.config.isShowSearchBox?a("div",{staticClass:"col-lg-5 col-sm-12"},[a("div",{staticClass:"form-group d-flex"},[a("div",{staticClass:"input-group customsearchbox divcityshown"},[1==e.config.isShowSearchBox?a("input",{staticClass:"form-control",attrs:{type:"text",id:"pac-input",maxlength:"50",placeholder:"Enter Your Location or Zip Code"}}):e._e()])])]):e._e(),a("div",{staticClass:"col-lg-3 col-sm-12"},[void 0!=e.config&&1==e.config.isShowCurrentLocation?a("div",{staticClass:"form-group"},[a("a",{staticClass:"btn btn-secondary",attrs:{href:"javascript:;"},on:{click:e.CurrentLocation}},[e._v("Use my location")]),e._v("    OR "),a("a",{staticClass:"btn btn-warning float-right",attrs:{href:"javascript:;"},on:{click:e.ImportFilePopup}},[a("i",{staticClass:"fa fa-upload mr-2"}),e._v("Click To import Geo JSON File.")])]):e._e()])]),a("div",{staticClass:"search"},[a("div",{staticClass:"map-result"},[a("div",{staticClass:"map-actions"},[void 0!=e.config&&1==e.config.isShowGetDirection?a("span",{staticClass:"save legends_low"},[1==e.config.isShowGetDirection?a("a",{class:{"mp-active":0==e.showSetting,"mg-success":1==e.showSetting},attrs:{href:"javascript:;",title:"GetDirection"},on:{click:e.GetDirection}},[a("em",{staticClass:"fa fa-map-marker"})]):e._e()]):e._e(),e._v("  "),void 0!=e.config&&1==e.config.isShowLocator?a("span",{staticClass:"save legends_low"},[1==e.config.isShowLocator?a("a",{class:{"mp-active":0==e.showSetting,"mg-success":1==e.showSetting},attrs:{href:"javascript:;",title:"View Locator on map"},on:{click:e.ViewLocatorOnMap}},[a("em",{staticClass:"fa fa-map-marker"})]):e._e()]):e._e(),e._v("  "),void 0!=e.config&&1==e.config.isShowEtaMap?a("span",{staticClass:"edit legends_profile"},[1==e.config.isShowEtaMap?a("a",{attrs:{href:"javascript:;",title:"ETA Map"},on:{click:function(t){return e.LoadLocatorDataonMap("locator")}}},[a("em",{staticClass:"fa fa-map"})]):e._e()]):e._e(),void 0!=e.config&&1==e.config.isShowEtaPipeLines?a("span",{staticClass:"edit legends_high esri_prof"},[e._m(0),a("div",{staticClass:"dropdown"},[e._m(1),a("div",{staticClass:"dropdown-menu esri_prof_data",staticStyle:{display:"block"}},[e._m(2),a("div",{staticClass:"w-100 mb-2"},e._l(e.UtilityMapData,(function(t,o){return a("a",{key:o,staticClass:"dropdown-item p-0",attrs:{href:"javascript:;"}},[a("div",{staticClass:"custom-control custom-checkbox custom-control-inline w-100"},[a("input",{staticClass:"custom-control-input dynamic customcheckboxUtilityMap",attrs:{type:"checkbox"}}),a("label",{staticClass:"custom-control-label pt-1",attrs:{type:"checkbox"}},[a("label",{staticClass:"font-weight-bold"},[e._v(e._s(t.LAYER_NAME))])])])])})),0),a("div",[a("a",{staticClass:"btn btn-primary d-block text-white py-2",attrs:{href:"javascript:;",title:"Go"},on:{click:e.ShowUtilityMap}},[e._v("Go"),a("i",{staticClass:"fa fa-angle-double-right pl-2"})])])])])]):e._e()]),e.showSaveZone?a("div",{staticClass:"gmnoprint",staticStyle:{position:"absolute",right:"0px","z-index":"9999999",top:"0px"},attrs:{id:"customSaveButton"},on:{click:e.OpenSaveZone}},[e._m(3)]):e._e(),e.showDeleteFeature?a("div",{staticClass:"gmnoprint",staticStyle:{position:"absolute",right:"1670px","z-index":"999999",top:"0px"},attrs:{id:"customSaveButton"},on:{click:e.DeleteFeature}},[e._m(4)]):e._e(),a("div",{staticClass:"map"},[a("div",{staticClass:"map_canvas map_ipadcontrol",style:{"min-height":void 0==e.mapHeight?"500px":e.mapHeight,"min-width":void 0==e.mapWidth?"100%":e.mapWidth},attrs:{id:e.mapContainer}}),a("div",{staticClass:"w-100 float-left",staticStyle:{position:"absolute",top:"0px"}},[0==e.showSetting?a("a",{staticClass:"showduration anchideduration",attrs:{title:"Hide"},on:{click:e.ShowTravelMode}},[e._v("Hide")]):e._e(),1==e.showSetting?a("a",{staticClass:"showduration ancshowduration",attrs:{title:"Show Setting"},on:{click:e.ShowTravelMode}},[e._v("Show Setting")]):e._e(),a("div",{staticClass:"position-absolute float-left my24 mx24 bg-gray-faint round settingPopup d-none",staticStyle:{"z-index":"999999"}},[a("div",{attrs:{id:"params"}},[e._m(5),a("h4",{staticClass:"txt-m font-weight-bold"},[e._v("Choose Travel Mode:")]),e._m(6),a("h4",{staticClass:"txt-m font-weight-bold"},[e._v("Choose Maximum Duration:")]),a("div",{staticClass:"w-100 float-left",staticStyle:{"margin-bottom":"15px"}},[a("div",{staticClass:"w-30 float-left"},[a("label",{staticClass:"switch"},[a("input",{staticClass:"dynamic",attrs:{type:"checkbox",name:"duration",checked:"checked"},domProps:{value:e.time},on:{onChange:function(t){return e.TravelMode(e.time)}}}),a("span",{staticClass:"sliderchk round"})]),a("div",{staticClass:"fs_textname "},[e._v("Minutes10")])]),a("div",{staticClass:"w-30 float-left"},[a("label",{staticClass:"switch"},[a("input",{staticClass:"dynamic",attrs:{type:"checkbox",name:"duration",checked:"checked"},domProps:{value:2*e.time},on:{onChange:function(t){return e.TravelMode(2*e.time)}}}),a("span",{staticClass:"sliderchk round"})]),a("div",{staticClass:"fs_textname"},[e._v("Minutes20")])]),a("div",{staticClass:"w-30 float-left"},[a("label",{staticClass:"switch"},[a("input",{staticClass:"dynamic",attrs:{type:"checkbox",name:"duration",checked:"checked"},domProps:{value:3*e.time},on:{onChange:function(t){return e.TravelMode(3*e.time)}}}),a("span",{staticClass:"sliderchk round"})]),a("div",{staticClass:"fs_textname"},[e._v("Minutes30")])])])])])])])])])])])],1)},g=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a",{attrs:{href:"javascript:;",title:"UtilityMap"}},[a("i",{staticClass:"fa fa-map-pin",attrs:{"aria-hidden":"true"}})])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a",{attrs:{href:"javascript:;",title:"UtilityMap"}},[a("i",{staticClass:"fa fa-map-pin",attrs:{"aria-hidden":"true"}})])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"w-100 bg-grey"},[a("div",{staticClass:"custom-control custom-checkbox custom-control-inline w-100"},[a("input",{staticClass:"custom-control-input dynamic customcheckboxselectall",attrs:{id:"customcheckboxselectallUtilityMap",type:"checkbox",value:""}}),a("label",{staticClass:"custom-control-label pt-1",attrs:{for:"customcheckboxselectallUtilityMap",type:"checkbox",value:""}},[e._v("SelectAll")])])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"background-color":"rgb(40, 167, 69)",color:"rgb(255, 255, 255)","border-style":"solid","border-width":"1px","border-color":"rgb(204, 204, 204)","margin-top":"4px","margin-left":"-6px",cursor:"pointer","text-align":"center"},attrs:{title:"Save Zone"}},[a("div",{staticStyle:{"font-family":"Arial, sans-serif","font-size":"14px",padding:"0.6rem 0.8rem"}},[a("i",{staticClass:"fa fa-save pr-2"}),e._v("Save Zone")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{left:"-121px","background-color":"rgb(240, 4, 4)",color:"rgb(255, 255, 255)","border-style":"solid","border-width":"1px","border-color":"rgb(204, 204, 204)","margin-top":"4px","margin-right":"122px","margin-left":"-6px",cursor:"pointer","text-align":"center"},attrs:{title:"Delete Save Zone"}},[a("div",{staticStyle:{"font-family":"Arial, sans-serif","font-size":"14px",padding:"0.6rem 0.8rem"}},[a("i",{staticClass:"fa fa-trash pr-2"}),e._v("Delete Selected Shape")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"row float-left"},[a("div",{staticClass:"col float-left text-dark px-2"},[a("span",{staticClass:"timelegend min10"}),e._v(" Minutes10 ")]),a("div",{staticClass:"col float-left text-dark px-2"},[a("span",{staticClass:"timelegend min20"}),e._v(" Minutes20 ")]),a("div",{staticClass:"col float-left text-dark px-2"},[a("span",{staticClass:"timelegend min30"}),e._v(" Minutes30 ")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mr12 toggle-group text-center"},[a("label",{staticClass:"toggle-container"},[a("input",{staticClass:"dynamic",attrs:{name:"profile",type:"radio",value:"foot-walking"}}),a("div",{staticClass:"toggle toggle--active-null toggle--null"},[e._v("Walking")])]),a("label",{staticClass:"toggle-container"},[a("input",{staticClass:"dynamic",attrs:{name:"profile",type:"radio",value:"cycling-regular"}}),a("div",{staticClass:"toggle toggle--active-null toggle--null"},[e._v("Cycling")])]),a("label",{staticClass:"toggle-container"},[a("input",{staticClass:"dynamic",attrs:{name:"profile",type:"radio",value:"driving-car",checked:"checked"}}),a("div",{staticClass:"toggle toggle--active-null toggle--null"},[e._v("Driving")])])])}],u=a("e192"),h=a.n(u),f=(a("ac6d"),a("e11e")),v=a.n(f),y=(a("6cc5"),a("cae8")),L=a.n(y),w=(a("bdd0"),a("885b")),b=a.n(w),C=(a("c307"),a("2573"),a("20d6"),a("5fbf"),a("ac00")),_=(a("1615"),a("5bfd"),a("125d"),a("afaa")),x={components:{},props:{mapType:{required:!0},Data:{required:!1},isShowDrawButton:{required:!1,type:String},config:{required:!1},mapWidth:{required:!1},mapHeight:{required:!1},latLng:{required:!1},mapContainer:{required:!0},selectedUser:{required:!1},UtilityMapData:{required:!1},editZone:{required:!1},zoneId:{required:!1},meterReadingDetail:{type:Object}},data:function(){return{isLoading:!1,zoneEditData:[],showDeleteFeature:!1,showSaveZonePopUp:!1,showSaveZone:!1,showAddZone:!1,time:600,colors:"",showSetting:null,address:[],UserName:null,UserEmailId:null,imageMarker:[],mapLayer:[],map:null,locations:[],locationPriority:[],locationname:[],ticketNumberList:[],LocationwithPriority:null,markers:[],mapZoom:!1,mapMarker:[],markerCluster:null,startingPoint:null,showSettingPopup:!1,lngLatData:[],fullAddress:[],leafLetReferenceNumber:[],polygonData:[],polygonNewShapeId:null,zoneData:[],drawingManager:null,currentSelectedShape:null,myPolygon:null,editableLayers:null,showHideEtaMap:!1,showImportFilePopup:!1,emailString:"",ZoneType:""}},watch:{Data:{handler:function(){setTimeout(()=>{this.ShowLocationOnGoogleMap(),"LeafLet"==this.mapType&&this.initLeafletMap(this.Data)},500)},deep:!0},config:{handler:function(){this.ShowDrawingManager()},deep:!0},selectedUser:{handler:function(){this.ViewLocatorOnMap(this.selectedUser)},deep:!0},latLng:{handler:function(){this.ViewOnMap()}}},mounted:function(){"Google"==this.mapType?setTimeout(()=>{},2e3):"MapBox"==this.mapType?(this.initMapBox(this.Data,"pk.eyJ1IjoiaGFycmlzbHVtZW4iLCJhIjoiY2s2dWtrMzJ3MDk2NTNncXMxMjlxa29mcCJ9.riRtpclzr9XfExHhclre8A"),void 0!=this.latLng&&this.ViewOnMap()):"Esri"==this.mapType?setTimeout(()=>{this.initLeafletMap(this.Data)},2e3):"LeafLet"!=this.mapType&&"Esri"!=this.mapType||setTimeout(()=>{this.initLeafletMap(this.Data)},2e3)},created:function(){this.UserName=this.GetUserInfo.Name,this.UserEmailId=this.GetUserInfo.Email,void 0!=this.myPolygon&&null!=this.myPolygon&&this.myPolygon.setMap(null);let e=document.createElement("script");e.setAttribute("src","https://maps.googleapis.com/maps/api/js?key=AIzaSyAJdx4gmhGKWjPTBBVk5riFgpbE0lGS-xM&callback=initAutocompletes&libraries=geometry,drawing,places&v=weekly"),document.head.appendChild(e);let t=document.createElement("script");t.setAttribute("src","https://unpkg.com/@google/markerclustererplus@4.0.1/dist/markerclustererplus.min.js"),document.head.appendChild(t);let a=document.createElement("script");a.setAttribute("src","~/Scripts/FsmMaps/fontawesome-markers.min.js"),document.head.appendChild(a),this.ShowLocationOnGoogleMap(),this.MapExtendLocation()},methods:{MapExtendLocation:function(){var e=this;if("Google"==e.mapType){let i=[];e.Data[0].mapExtendLatLong.forEach((function(e){i.push(new google.maps.LatLng(e[1],e[0]))}));for(var t=new google.maps.LatLngBounds,a=i,o=0,n=a.length;o<n;o++)t.extend(a[o]);e.map.fitBounds(t)}},ImportFilePopup:function(){var e=this;e.showImportFilePopup=!0},initAutocompletes:function(){var e=this;const t=document.getElementById("pac-input"),a=new google.maps.places.SearchBox(t);e.map.addListener("bounds_changed",()=>{a.setBounds(e.map.getBounds())}),google.maps.event.addListener(a,"places_changed",(function(){var t,o,n=a.getPlaces(),i=new google.maps.LatLngBounds;for(t=0;o=n[t];t++)(function(e){i.extend(e.geometry.location)})(o);e.map.fitBounds(i),a.set("map",e.map),e.map.setZoom(Math.min(e.map.getZoom(),12))}))},CurrentLocation:function(){var e=this;navigator.geolocation?navigator.geolocation.getCurrentPosition(e.GetCurrentLocation,e.geoError):alert("Geolocation is not supported by this browser.")},GetCurrentLocation:function(e){var t=this;if(e){var a=e.coords.latitude,o=e.coords.longitude,n=new google.maps.LatLng(a,o);t.map.setCenter(n),t.map.setZoom(18)}},SaveMapExtent:function(){var e=this;e.$emit("SaveMapExtent",e.fullAddress,e.mapType)},ShowUtilityMap:function(){var e=this,t=JSON.parse(localStorage.getItem("coordinates"));null==t&&(t={x:"43.133971",x1:"43.132812",y:"-76.088009",y1:"-76.087183"}),Object(_["loadModules"])(["esri/Map","esri/views/MapView","esri/layers/FeatureLayer","esri/Graphic","esri/layers/GraphicsLayer"]).then(([a,o,n,i,r])=>{var s=new a({basemap:"hybrid"});new o({container:"utilitymap",map:e.map,extent:{xmin:-13856051.7748509,ymin:2821931.08215458,xmax:-7488766.97004404,ymax:6364777.09974285,spatialReference:102100}});""!=layerUrl&&null!=layerUrl&&(Colors={},Colors.names={aqua:"#00ffff",azure:"#f0ffff",beige:"#f5f5dc",black:"#000000",blue:"#0000ff",brown:"#a52a2a",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkviolet:"#9400d3",fuchsia:"#ff00ff",gold:"#ffd700",green:"#008000",indigo:"#4b0082",khaki:"#f0e68c",lightblue:"#add8e6",lightcyan:"#e0ffff",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightyellow:"#ffffe0",lime:"#00ff00",magenta:"#ff00ff",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",pink:"#ffc0cb",purple:"#800080",violet:"#800080",red:"#ff0000",silver:"#c0c0c0",white:"#ffffff",yellow:"#ffff00"},Colors.random=function(){var e,t=0;for(var a in this.names)Math.random()<1/++t&&(e=a);return{name:e,rgb:this.names[e]}},String(layerUrl).split(",").forEach((function(e){var t=String(e).split("^")[1];""!=t&&null!=t&&"null"!=t&&"undefined"!=typeof t||(t=String(Colors.random().rgb).toUpperCase());const a={type:"simple",symbol:{color:t,type:"simple-line",style:"solid"},visualVariables:[{type:"size",field:"ELEV_GAIN",minDataValue:0,maxDataValue:2300,minSize:"3px",maxSize:"7px"}]};var o=String(e).split("^")[0];s.add(new n({url:o,renderer:a}))})));new o({container:"utilitymap",map:s,basemap:"hybrid",center:[t.y,t.x],zoom:17});var l=new r;s.add(l);var p=null;void 0!=t&&null!=t&&(p=[[t.y1,t.x1],[t.y1,t.x],[t.y,t.x],[t.y,t.x1]]);p={type:"polygon",rings:p};var d={type:"simple-fill",color:[255,0,0,.35],outline:{color:[255,0,0],width:1}},c=new i({geometry:p,symbol:d});l.add(c)}).catch(e=>{console.error(e)})},GetDirection:function(){var e=this;navigator.geolocation?navigator.geolocation.getCurrentPosition(e.showRoutePosition,e.geoError):alert("Geolocation is not supported by this browser.")},geoError:function(){},showRoutePosition:function(e){var t=this;if(e){var a=e.coords.latitude,o=e.coords.longitude,n=new google.maps.LatLng(a,o),i=new google.maps.LatLng(t.Data[0].pinLatLong.latitude.split(",")[0],t.Data[0].pinLatLong.latitude.split(",")[1]),r=localStorage.getItem("UserImage");String(r).indexOf("blob")<=0&&(r="https://app.talygen.com/Content/images/Black/user.png");var s={lat:a,lng:o};if("Google"==t.mapType){var l={url:r,scaledSize:new google.maps.Size(40,40),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(0,0)},p=new google.maps.Marker({position:s,icon:l,map:t.map}),d=new google.maps.InfoWindow({content:"<div style='padding:8px;'><img style='float:left;' src='"+r+"' class='marker' /> <div style='display:block;width: 270px;'>@loggedUserInfo.Name </br>@loggedUserInfo.Email</div></div>"});p.addListener("click",(function(){d.open(t.map,this)})),t.imageMarker.push(p);var c={path:google.maps.SymbolPath.CIRCLE,fillOpacity:1,scale:3},m={strokeColor:"#ff0000",strokeOpacity:0,fillOpacity:0,icons:[{icon:c,offset:"0",repeat:"4px"}]},g={map:t.map,suppressMarkers:!1,polylineOptions:m},u=new google.maps.DirectionsService,f=new google.maps.DirectionsRenderer(g),y=new google.maps.LatLng(a,o);function L(e,t){var a="DRIVING";e.route({origin:n,destination:i,travelMode:google.maps.TravelMode[a]},(function(e,a){if("OK"==a){t.setDirections(e);var o='<span style="font-weight:bold;">Distance: </span>'+e["routes"][0].legs[0].distance.text+'<br /><span style="font-weight:bold;">Time: </span>'+e["routes"][0].legs[0].duration.text,n=new google.maps.InfoWindow({content:o});google.maps.event.addListener(m,"click",(function(e){n.setPosition(e.latLng),n.open(map)})),google.maps.event.addListener(map,"click",(function(){n.close()}))}else window.alert("Directions request failed due to "+a+". Route exceeds maximum distance limitation.")}))}f.setMap(t.map),L(u,f)}else if("MapBox"==t.mapType){var w={lon:parseFloat(s.lng,10),lat:parseFloat(s.lat,10)},b='<img src="'+r+'" style="width:100px;height:100px;" />',C=new h.a.Popup({offset:25}).setHTML(b),_=document.createElement("div");_.className="marker",_.style.backgroundImage="url("+r+")",_.style.backgroundSize="cover",_.style.width="40px",_.style.height="40px";p=new h.a.Marker(_).setPopup(C).setLngLat(w).addTo(t.map);t.imageMarker.push(p);var x="https://api.mapbox.com/directions/v5/mapbox/driving/"+o+","+a+";"+t.Data[0].pinLatLong.latitude.split(",")[1]+","+t.Data[0].pinLatLong.latitude.split(",")[0]+"?steps=true&geometries=geojson&access_token="+h.a.accessToken;t.map.getLayer("point")||t.map.addLayer({id:"point",type:"circle",source:{type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Point",coordinates:y}}]}},paint:{"circle-radius":10,"circle-color":"#3887be"}});var k=new XMLHttpRequest;k.open("GET",x,!0),k.onload=function(){var e=JSON.parse(k.response);if(""!=typeof e.code&&"InvalidInput"!=e.code){var a=e.routes[0],o=a.geometry.coordinates,n={type:"Feature",properties:{distance:a.distance,duration:a.duration},geometry:{type:"LineString",coordinates:o}};t.map.getSource("route")?t.map.getSource("route").setData(n):(t.map.addLayer({id:"route",type:"line",source:{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:n}}},layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#3887be","line-width":5,"line-opacity":.75}}),t.map.on("click","route",(function(e){t.map.queryRenderedFeatures(e.point,{layers:["route"]});var a=e.features[0].properties,o=a.distance;o=parseFloat(.000621371192*o,10).toFixed(2);var n='<span style="font-weight:bold;">Distance: </span>'+o+' mi<br /><span style="font-weight:bold;">Time: </span>'+timeConvert(a.duration);(new h.a.Popup).setLngLat(e.lngLat).setHTML(n).addTo(t.map)})))}else try{ShowMsgWithMsg("Route exceeds maximum distance limitation.","failure")}catch(i){alert("Route exceeds maximum distance limitation.")}},k.send()}else{var S=v.a.icon({iconUrl:r,iconSize:[40,40]});C=v.a.popup().setContent("<img src="+r+" />");v.a.marker([a,o],{icon:S}).bindPopup(C).openPopup().addTo(t.map);var A=v.a.Routing.control({waypoints:[v.a.latLng(a,o),v.a.latLng(t.Data[0].pinLatLong.latitude.split(",")[0],t.Data[0].pinLatLong.latitude.split(",")[1])],routeWhileDragging:!1,createMarker:function(){return null}}).addTo(t.map);A.on("routesfound",(function(e){var t=e.routes;t[0].summary}))}}},DeleteFeature:function(){var e=this;null!=e.currentSelectedShape&&"undefined"!=typeof e.currentSelectedShape&&(e.currentSelectedShape.setMap(null),e.currentSelectedShape=null,e.showAddZone=!1,e.showDeleteFeature=!1)},ShowDrawingManager:function(){var e=this;null==e.drawingManager&&void 0!=e.config&&1==e.config.isShowDrawButton&&(e.drawingManager=new google.maps.drawing.DrawingManager({drawingControl:!0,drawingControlOptions:{position:google.maps.ControlPosition.RIGHT_CENTER,drawingModes:["polygon"],setEditable:!0},polylineOptions:{editable:!0}}),e.drawingManager.setMap(e.map),google.maps.event.addListener(e.drawingManager,"overlaycomplete",e.GetGoogleAddressToDraw))},ViewLocatorOnMap:function(e){var t,a=this;a.isLoading=!0,t=void 0!=a.selectedUser?`selectedUser=${e}&reqFrom=`:"reqFrom=ETAMAP",i["a"].TrackByUserId(t).then((function(e){if(null!=e.data.data&&e.data.data.length>0){var t=e.data.data;a.ShowUserOnMap(t,a.map),a.isLoading=!1}else a.ShowAlert(a.$t("CurrentLocationNotFound"),"warning",!0,a.$t("Alert")),a.isLoading=!1}))},ShowUserOnMap:function(e,t){var a=this,o=[];$.each(e,(function(e,t){var n=t.IMAGE_PATH,i={lat:parseFloat(t.LATITUDE,10),lng:parseFloat(t.LONGITUDE,10)};o.push([i.lat,i.lng]);new google.maps.LatLng(i.lat,i.lng);String(n).indexOf("blob")<=0&&(n="/Content/images/user_avtar.png");var r='<div class="w-100 float-left popupcontent" style="padding:0px 6px 0px 0px;">';if(r+='<img src="'+n+'" class="float-left" style="width:50px;height:50px; border-radius: 100%;border: 3px solid #f2f2f2;" />',r+='<div style="padding-left:8px; padding-top:5px;width:80%;" class="float-left">',r+="<p style='margin-bottom: 2;'><b style='font-weight:bold;'>Name: </b>"+t.NAME+" </p>",r+="<p style='margin-bottom: 2;'><b style='font-weight:bold;'>Department: </b>"+t.DEPARTMENT_NAME+" </p></div>",t.TRACK_ID>0&&(r+="<p style='margin-bottom:2px;' class='px-2 float-left'><b style='font-weight:bold;'>"+t.NAME+" </b> is going to ticket number: "+t.TICKET_NUMBER+" </p>"),r+="</div>","Google"==a.mapType){var s={url:n,scaledSize:new google.maps.Size(40,40),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(0,0)},l=new google.maps.Marker({position:i,icon:s,map:a.map});a.imageMarker.push(l);var p=new google.maps.InfoWindow({content:r});try{l.addListener("click",(function(){p.open(a.map,this)}))}catch(u){console.log(u)}}else if("MapBox"==a.mapType){var d={lon:parseFloat(i.lng,10),lat:parseFloat(i.lat,10)},c=new h.a.Popup({offset:25}).setHTML(r),m=document.createElement("div");m.className="marker",m.style.backgroundImage="url("+n+")",m.style.backgroundSize="cover",m.style.width="50px",m.style.height="50px";l=new h.a.Marker(m).setPopup(c).setLngLat(d).addTo(a.map);a.map.flyTo({center:[d.lon,d.lat],essential:!0}),a.imageMarker.push(l)}else{var g=v.a.icon({iconUrl:n,iconSize:[40,40]});c=v.a.popup().setContent(r),l=v.a.marker([i.lat,i.lng],{icon:g}).bindPopup(c).openPopup().addTo(a.map);a.imageMarker.push(l),a.map.fitBounds(o)}}))},removeMarker(){this.markers.forEach(e=>e.remove()),this.markers=[];const e=this.draw.getAll().features;e.forEach(e=>{this.draw.delete(e.id)}),this.map.flyTo({center:[78.9629,20.5937],zoom:1,essential:!0})},deleteMarker(){this.markers.forEach(e=>e.remove()),this.markers=[];const e=this.draw.getAll().features;e.forEach(e=>{this.draw.delete(e.id)})},removeAllMarkersExceptCurrent(e){this.markers.forEach(t=>{t!==e&&t.remove()}),this.markers=[]},drawLocationPointer(e,t){const a=document.createElement("div");a.className="custom-popup",a.innerHTML=`\n        <div class="popup-box p-3">\n            <strong>Address:</strong><br/>\n            <span>${t}</span>\n        </div>\n    `;const o=new h.a.Popup({offset:25,closeButton:!1,closeOnClick:!1}).setDOMContent(a),n=new h.a.Marker({color:"red"}).setLngLat([this.meterReadingDetail.latitude,this.meterReadingDetail.longitude]).addTo(this.map),i=n.getElement();return i.addEventListener("mouseenter",()=>{o.setLngLat(n.getLngLat()).addTo(this.map)}),i.addEventListener("mouseleave",()=>{o.remove()}),this.markers.push(n),n},ViewOnMap:function(){var e=this;"MapBox"==e.mapType&&("AddTicket"!=e.mapContainer?(1==e.markers.length&&e.removeAllMarkersExceptCurrent(e.markers),e.markers.length>0?e.markers[0].features.forEach((function(t,a){e.map.flyTo({center:[e.latLng.location_nw.split(",")[1],e.latLng.location_nw.split(",")[0]],zoom:20,essential:!0}),t.properties.ticketNumber==(e.latLng.TicketNumber||e.latLng.ticket_number)&&new h.a.Popup({closeOnClick:!0}).setLngLat([e.latLng.location_nw.split(",")[1],e.latLng.location_nw.split(",")[0]]).setHTML(t.properties.address).addTo(e.map)})):(e.map.flyTo({center:[e.meterReadingDetail.latitude,e.meterReadingDetail.longitude],zoom:20,essential:!0}),e.drawLocationPointer(e.latLng,e.meterReadingDetail.property_address))):setTimeout(()=>{e.map.flyTo({center:[e.latLng.location_nw.split(",")[1],e.latLng.location_nw.split(",")[0]],zoom:20,essential:!0});var t={lon:e.latLng.location_nw.split(",")[1],lat:e.latLng.location_nw.split(",")[0]},a="",o="https://unpkg.com/leaflet@1.3.4/dist/images/marker-icon.png",n=document.createElement("div");n.className="marker",n.style.backgroundImage="url("+o+")",n.style.backgroundPosition="top center",n.style.backgroundSize="cover",n.style.width="40px",n.style.height="40px",new h.a.Marker(n).setLngLat(t).setPopup(a).addTo(e.map)},1e3))},gpxData:function(e,t,a){var o=this;o.Data=[],o.mapType="Google",o.emailString=t,o.ZoneType=a,o.Data.push(e),o.ShowLocationOnGoogleMap()},ShowLocationOnGoogleMap:function(){if("Google"==this.mapType){var e,t=this,a=null;const s=[];var o,n=null,i=new google.maps.InfoWindow;t.map=null,t.showLoader=!0,t.map=new google.maps.Map(document.getElementById(t.mapContainer),{zoom:7,zoomControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR,position:google.maps.ControlPosition.BOTTOM_RIGHT},zoomControlOptions:{position:google.maps.ControlPosition.RIGHT_CENTER},center:new google.maps.LatLng(30.7333,76.7794),mapTypeId:google.maps.MapTypeId.ROADMAP}),void 0!=t.config&&1==t.config.isShowDrawButton&&(t.drawingManager=new google.maps.drawing.DrawingManager({drawingControl:!0,drawingControlOptions:{position:google.maps.ControlPosition.RIGHT_CENTER,drawingModes:["polygon"]},polylineOptions:{editable:!0}}),t.drawingManager.setMap(t.map),google.maps.event.addListener(t.drawingManager,"overlaycomplete",(function(e,a,o){var n=e.overlay;t.currentSelectedShape=n,t.GetGoogleAddressToDraw(e)}))),(this.mapType="Google")&&$.each(t.Data,(function(r,l){null!=l.pinLatLong.latitude&&(a=l.pinLatLong.latitude.split(",")[0],n=l.pinLatLong.latitude.split(",")[1]),o="Critical"==l.priority?"https://talygenv.github.io/Vue-UI-Content/images/Ticketing/mapicon_critical.png":"High"==l.priority?"https://talygenv.github.io/Vue-UI-Content/images/Ticketing/mapicon_high.png":"Medium"==l.priority?"https://talygenv.github.io/Vue-UI-Content/images/Ticketing/mapicon_medium.png":"https://talygenv.github.io/Vue-UI-Content/images/Ticketing/mapicon_low.png";let p='<div id="content"><div class="map-pop-header '+l.priority+'" style="background-color:'+l.color_code+'"><div id="siteNotice"></div>'+l.popupHeaderHtml+'</div><div id="bodyContent">'+l.popupBodyHtml+'<p class="view-details">'+l.popupFooterHtml+"</p></div></div>";e=new google.maps.Marker({position:new google.maps.LatLng(a,n),icon:o,title:l.refValue,map:t.map,address:p}),s.push(e),t.markers.push(e);let d=[];if(void 0!=t.Data[r]&&t.Data[r].polygons.forEach((function(e){e.latLong.forEach((function(e){d.push(new google.maps.LatLng(e.longitude,e.latitude))})),t.myPolygon=new google.maps.Polygon({paths:d,draggable:!1,editable:1==t.config.isEditable,strokeColor:"undefined"!=typeof e.strokeColor?e.strokeColor:"#FF0000",strokeOpacity:"undefined"!=typeof e.strokeOpacity?e.strokeOpacity:"#FF0000",strokeWeight:"undefined"!=typeof e.strokeWeight?e.strokeWeight:"#FF0000",fillColor:"undefined"!=typeof e.fillColor?e.fillColor:"#FF0000",fillOpacity:"undefined"!=typeof e.opacity?e.opacity:.35,Id:t.Data[r].refValue,FormName:e.FormName,Description:e.Description,ZoneType:e.ZoneType,locatorids:e.locatorids}),t.zoneEditData.push({FormName:e.FormName,Description:e.Description,Refrence:"View",ZoneType:e.ZoneType,YardEmails:e.YardEmails,locatorids:e.locatorids}),t.myPolygon.setMap(t.map),google.maps.event.addListener(t.myPolygon,"click",(function(e,a){t.currentSelectedShape=this,t.currentSelectedShape.setOptions({editable:!0,ShapeId:t.polygonNewShapeId}),t.showDeleteFeature=!0,"zoneMapDiv"==t.mapContainer&&(t.showAddZone=!0)}))})),"zoneMapDiv"==t.mapContainer||"mapExtend"==t.mapContainer){for(var c=new google.maps.LatLngBounds,m=d,g=0,u=m.length;g<u;g++)c.extend(m[g]);t.map.fitBounds(c)}google.maps.event.addListener(t.myPolygon.getPath(),"set_at",(function(e,a){let o={FullAddress:""};if(t.lngLatData=[],"zoneMapDiv"==t.mapContainer){t.polygonNewShapeId=(new Date).getTime()+"_"+Math.floor(1e3*Math.random()),t.myPolygon.setOptions({ShapeId:t.polygonNewShapeId}),t.showAddZone=!0,r=t.myPolygon.getPath().getArray(),r.forEach((function(e,a){t.lngLatData.push({latitude:e.lat(),longitude:e.lng()})})),o={FullAddress:""};var n=new google.maps.LatLng(t.lngLatData[0].Lat,t.lngLatData[0].Lng),i=new google.maps.Geocoder;i.geocode({latLng:n},(function(e,t){o.FullAddress=e[0].formatted_address})),t.polygonData.push({Id:t.polygonNewShapeId,latLong:t.lngLatData,CompleteAddress:o,strokeOpacity:t.myPolygon.strokeOpacity,strokeWeight:t.myPolygon.strokeWeight,strokeColor:t.myPolygon.strokeColor,fillColor:t.myPolygon.fillColor,locatorids:""}),t.fullAddress.push({LatLng:t.lngLatData,CompleteAddress:o})}else{var r;t.lngLatData=[],r=t.myPolygon.getPath().getArray(),r.forEach((function(e,a){t.lngLatData.push({Lat:e.lat(),Lng:e.lng()})})),o={FullAddress:""};n=new google.maps.LatLng(t.lngLatData[0].Lat,t.lngLatData[0].Lng),i=new google.maps.Geocoder;i.geocode({latLng:n},(function(e,t){o.FullAddress=e[0].formatted_address})),t.fullAddress.push({LatLng:t.lngLatData,CompleteAddress:o})}})),google.maps.event.addListener(e,"click",function(e,a){return function(){i.setContent(p),i.open(t.map,e),"WorkOrderDetail"!=t.mapContainer&&"detailMapDiv"!=t.mapContainer||i.close()}}(e));var h=new google.maps.LatLng(t.Data[0].latlong.split(",")[0],t.Data[0].latlong.split(",")[1]);t.map.panTo(h),t.map.setZoom(4)}));var r={gridSize:40,maxZoom:15,styles:[{width:30,height:30,url:"https://talygenv.github.io/Vue-UI-Content/images/Ticketing/m1.png",textColor:"white",textSize:12}]};t.markerCluster=new MarkerClusterer(t.map,s,r)}},LoadLocatorDataonMap:function(){var e=this,t=null,a=null;navigator.geolocation?navigator.geolocation.getCurrentPosition((function(e){t=e.coords.latitude,a=e.coords.longitude})):console.log("Geolocation is not supported by this browser."),e.showSetting=!0,"Google"==e.mapType?setTimeout(()=>{e.LoadGoogleHeatMap(t,a)},2e3):"MapBox"==e.mapType?setTimeout(()=>{e.LoadMapboxHeatMap(t,a)},4e3):setTimeout(()=>{e.ShowEtaMap(t,a)},4e3)},initMapBox:function(e,t,a,o){var n=this,i="";let r=3;if(e){var s=$.grep(e,(function(e,t){return""!==e.location_nw&&null!==e.location_nw&&void 0!==typeof e.location_nw&&","!==e.location_nw}));s=s[0],s&&(i=[parseFloat(String(s.location_nw).split(",")[1],10),parseFloat(String(s.location_nw).split(",")[0],10)])}n.startingPoint=i,h.a.accessToken=t,n.map=new h.a.Map({container:n.mapContainer,style:"mapbox://styles/mapbox/streets-v11",zoom:r,zoomControl:!0,scrollZoom:!0,boxZoom:!0}),void 0!==n.config&&n.config.isShowSearchBox&&(n.geocoder=new b.a({accessToken:t,mapboxgl:h.a,marker:!1,placeholder:"Search for places in Barbados"}),n.map.addControl(n.geocoder)),void 0!==n.config&&n.config.isShowDrawButton&&(n.draw=new L.a({displayControlsDefault:!1,controls:{line_string:!1,polygon:!1,point:!1,trash:!1}}),n.map.addControl(n.draw),n.map.on("draw.create",n.GetMapBoxAddressToDraw),n.map.on("draw.delete",n.deleteMarker),n.navTopLeft=new h.a.NavigationControl,n.map.addControl(n.navTopLeft,"top-left")),n.navBottomRight=new h.a.NavigationControl,n.map.addControl(n.navBottomRight,"bottom-right");const l=document.querySelector(".mapboxgl-ctrl-geocoder");l&&(l.style.display="none")},resetMap(){var e=this;e.map&&e.draw&&e.draw.deleteAll()},clearSearchField(){var e=this;if(e.geocoder){var t=document.querySelector(".mapboxgl-ctrl-geocoder input");t&&(t.value="")}},initLeafletMap:function(e,t,a){var o,n=this;if(void 0!=e){if(n.map){n.map.off();try{n.map.remove()}catch{}}let t="",a="";if(null!=e&&e.length>0){var i=$.grep(e,(function(e,t){return""!=e.location_nw&&null!=e.location_nw&&"undefined"!=typeof e.location_nw&&","!=e.location_nw}));if(null!=i&&i.length>0){var r=i[0].location_nw;a=r.split(",")[1],t=r.split(",")[0]}}var s=v.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:22,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Points &copy '+(new Date).getFullYear()+" LINZ"}),l=(v.a.tileLayer("https://{s}.tiles.mapbox.com/v3/spatial.b625e395/{z}/{x}/{y}.png",{attribution:'<a href="http://www.mapbox.com/about/maps/" target="_blank">Terms &amp; Feedback</a>'}),v.a.latLng(t,a));n.startingPoint=[t,a];var p=10;if(""==t&&""==a&&(p=2),n.map=v.a.map(n.mapContainer,{zoom:p,center:l,layers:[s],zoomControl:!1}),v.a.control.zoom({position:"topright"}).addTo(n.map),void 0!=n.config&&1==n.config.isShowDrawButton&&n.GetLeafLetAddressToDraw(),void 0!=n.config&&1==n.config.isShowSearchBox){const e=new C["b"],t=new C["a"]({provider:e});n.map.addControl(t)}n.markers=v.a.markerClusterGroup({iconCreateFunction:function(e){return v.a.divIcon({html:'<div class="circle-leaflet">'+e.getChildCount()+"</div>"})}});var d=v.a.Icon.extend({options:{shadowSize:[50,64],iconAnchor:[22,94],shadowAnchor:[4,62],popupAnchor:[-3,-76]}});1==n.Data.length&&void 0!=n.Data[0].latlong&&n.map.flyTo([n.Data[0].latlong.split(",")[0],n.Data[0].latlong.split(",")[1]],16,{animate:!0,duration:2});new d({iconUrls:"https://talygenv.github.io/Vue-UI-Content/images/Ticketing/mapicon_critical.png"}),new d({iconUrl:"https://talygenv.github.io/Vue-UI-Content/images/Ticketing/mapicon_high.png"}),new d({iconUrls:"https://talygenv.github.io/Vue-UI-Content/images/Ticketing/mapicon_low.png"}),new d({iconUrls:"https://talygenv.github.io/Vue-UI-Content/images/Ticketing/mapicon_medium.png"}),new d({iconUrls:"https://talygenv.github.io/Vue-UI-Content/images/Ticketing/mapicon_fill.png"});function c(e){var i="",r="";if($.each(e,(function(e,s){if(""!=s.pinLatLong.latitude&&null!=s.pinLatLong.latitude&&void 0!=typeof s.pinLatLong.latitude||s.polygons.length>0){i=s.pinLatLong.latitude;let h=[];r=s.priority;if("[]"!=s.attachmentCountWithExt&&""!=s.attachmentCountWithExt&&null!=s.attachmentCountWithExt){var l=JSON.parse(s.attachmentCountWithExt);$.each(l,(function(e,t){"Video"==t.TYPE?t.COUNT:"Image"==t.TYPE?t.COUNT:parseInt(t.COUNT)}))}if(n.Data[e].polygons.forEach((function(e){e.latLong.forEach((function(e){h.push([e.longitude,e.latitude])}))})),void 0!=s.polygons[e]){if(n.Data[0].polygons[0].latLong.length>1){var p=v.a.polygon(h,{fill:!0}).addTo(n.editableLayers);n.map.fitBounds(p.getBounds())}}let f='<div class="gm-style-iw gm-style-iw-c"><div class="gm-style-iw-d"><div><div id="content"><div class="map-pop-header '+s.priority+'" style="background-color:'+s.color_code+'"><div id="siteNotice"></div>'+s.popupHeaderHtml+'</div><div id="bodyContent">'+s.popupBodyHtml+'<p class="view-details">'+s.popupFooterHtml+"</p></div></div></div></div></div>";a=i.split(",")[1],t=i.split(",")[0],a=parseFloat(a,10),t=parseFloat(t,10);var d=s.ticket_number,c=".leafleticoncustom_"+r+"{background-color:"+s.color_code+" }",m=document.createElement("style");m.innerHTML=c,document.head.appendChild(m);var g=v.a.icon({iconUrl:"https://talygenv.github.io/Vue-UI-Content/images/Ticketing/mapicon_high.png",iconSize:[30,30],color:s.color_code,"icon-color":s.color_code,"background-color":s.color_code,className:"leafleticoncustom_"+r});""!=i&&(o=v.a.marker(v.a.latLng(t,a),{icon:g}),o.bindPopup(f),n.markers.addLayer(o),n.leafLetReferenceNumber.push({TicketNumber:s.refValue,Address:f}),n.mapMarker.push(n.markers));try{o.on("click",(function(e){var t=$("a.ticketnumber[data-ticketnumber='"+d+"']");if("WorkOrderDetail"!=n.mapContainer&&"detailMapDiv"!=n.mapContainer||o.getPopup().getElement().classList.add("d-none"),t.length>0&&"true"==localStorage.getItem("isMapView")){var a=t.closest(".lists");a.addClass("alert-info"),setTimeout((function(){a.removeClass("alert-info")}),5e3)}t=$("a.ticketnumberlist[data-ticketnumber='"+d+"']"),t.length>0&&"false"==localStorage.getItem("isMapView")&&(t=t.closest("tr"),t.addClass("alert-info"),setTimeout((function(){t.removeClass("alert-info")}),5e3))}))}catch(u){console.log("err")}}})),null!=e.mapdetail&&e.mapdetail.length>0)if("MapBox"==e.mapdetail[0].MAP_TYPE){if(""!=e.mapdetail[0].LONGITUDE&&""!=e.mapdetail[0].LATITUDE&&""!=e.mapdetail[0].LAT_LNG){var s=JSON.parse(e.mapdetail[0].LAT_LNG),l=[];$.each(JSON.parse(e.mapdetail[0].LAT_LNG),(function(e,t){var a=[];a.push(t[1],t[0]),l.push(a)})),map.fitBounds(l)}}else if("Google"==e.mapdetail[0].MAP_TYPE&&""!=e.mapdetail[0].LONGITUDE&&""!=e.mapdetail[0].LATITUDE&&""!=e.mapdetail[0].LAT_LNG){var p=[];$.each(JSON.parse(e.mapdetail[0].LAT_LNG),(function(e,t){var a=[];a.push(t.lat,t.lng),p.push(a)}));s=p;var d=[];d.push(s),map.fitBounds(s)}n.map.addLayer(n.markers)}null!=e&&e.length>0&&c(e)}else n.map=v.a.map(n.mapContainer,{layers:[v.a.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'Map data © <a href="https://openstreetmap.org">OpenStreetMap</a> contributors'})],center:[0,0],zoom:5});void 0!=n.latLng&&n.ViewOnMap()},ShowEtaMap:function(e,t){var a=this,o=null,n=null,i="driving-car",r=600;if(a.showHideEtaMap)return $.each(a.mapLayer,(function(e,t){a.map.removeLayer(t)})),a.showHideEtaMap=!1,!1;function s(){navigator.geolocation?navigator.geolocation.getCurrentPosition(p,l,{timeout:1e4}):alert("Geolocation is not supported by this browser")}function l(e){e.code;var t=e.message;alert(t)}s();function p(e){e=$.post("geocoordinates.php",{lat:e.coords.latitude,lng:e.coords.longitude})}function d(e,t){if(a.map){$.each(a.mapLayer,(function(e,t){a.map.removeLayer(t)})),a.showHideEtaMap=!0;var o=new v.a.latLng(e,t);a.map.panTo(o),a.map.setZoom(11)}var n=localStorage.getItem("UserImage");String(n).indexOf("blob")<=0&&(n="https://app.talygen.com/Content/images/Black/user.png");var i=v.a.icon({iconUrl:n,iconSize:[40,40]}),r=v.a.popup().setContent("<div style='padding:8px;'><img style='float:left;' src='"+n+"' class='marker' /> <div style='display:block;'>"+a.UserName+"</br>"+a.UserEmailId+"</div></div>"),s=v.a.marker([e,t],{icon:i},{layers:""}).bindPopup(r).openPopup().addTo(a.map);a.imageMarker.push(s),c(!0)}function c(e){var t=[];$("input[name=duration]:checked").each((function(){t.push($(this).val())})),$.ajax({type:"POST",dataType:"json",headers:{Authorization:"5b3ce3597851110001cf62485ecdd7b54dd545c4901722c53ac3d1d3"},url:"https://api.openrouteservice.org/v2/isochrones/"+i,data:JSON.stringify({location_type:"start",range_type:"time",range:t,interval:r,locations:[[o,n],[o,n]],intersections:!1}),async:!1,contentType:"application/json; charset=utf-8",success:function(e){v.a.geoJson(e,{onEachFeature:function(e,t){t.bindPopup("Isochrone: "+e.properties.value),a.mapLayer.push(t)},style:function(e){var t=e.properties.value;return a.SetColor(t),{fillColor:a.colors,color:a.colors,weight:1,fillOpacity:.35}}}).addTo(a.map)}})}o=parseFloat(t,10)+.02,n=parseFloat(e,10)+.004,d(n,o),document.getElementById("params").addEventListener("change",(function(e){if("profile"===e.target.name)i=e.target.value,d(n,o);else if("duration"===e.target.name){var t="";if($(params).find("input:checkbox:checked").length>0){$(params).find("input:checkbox:checked").each((function(){t.length>0&&(t+=",");var e=$(this).val();t+=e}));var a=String(t).split(",");r=a[0],a[a.length-1]}else r="600","1800";d(n,o)}}))},SetColor:function(e){var t=this;if(e=parseInt(e,10),"MapBox"!=t.mapType?e/=60:t.time=10,"MapBox"==t.mapType)switch(e){case 10:t.colors="3CEA19";break;case 20:t.colors="EFF60B";break;case 30:t.colors="F6320B";break;default:t.colors="F6320B"}else switch(e){case 10:t.colors="green";break;case 20:t.colors="yellow";break;case 30:t.colors="red";break;default:t.colors="red"}},LoadGoogleHeatMap:function(e,t){var a=this,o="driving-car",n=600;if(a.showHideEtaMap)return a.map.data.forEach((function(e){a.map.data.remove(e)})),a.showHideEtaMap=!1,!1;function i(i,r){if(a.map){$.each(a.map,(function(e,t){try{a.map.removeLayer(t)}catch(o){}})),a.showHideEtaMap=!0;var s=new v.a.latLng(i,r);a.map.panTo(s),a.map.setZoom(11)}var l={lat:e,lng:t},p=(s=new google.maps.LatLng(e,t),localStorage.getItem("UserImage"));String(p).indexOf("blob")<=0&&(p="https://app.talygen.com/Content/images/Black/user.png");var d={url:p,scaledSize:new google.maps.Size(40,40),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(0,0)},c=new google.maps.Marker({position:l,icon:d,map:a.map}),m=new google.maps.InfoWindow({content:"<div style='padding:8px;'><img style='float:left;' src='"+p+"' class='marker' /> <div style='display:block;'>"+a.UserName+"</br>"+a.UserEmailId+"</div></div>"});c.addListener("click",(function(){m.open(a.map,this)})),a.imageMarker.push(c);var g=[];$("input[name=duration]:checked").each((function(){g.push($(this).val())})),$.ajax({type:"POST",dataType:"json",headers:{Authorization:"5b3ce3597851110001cf62485ecdd7b54dd545c4901722c53ac3d1d3"},url:"https://api.openrouteservice.org/v2/isochrones/"+o,data:JSON.stringify({location_type:"start",range_type:"time",range:g,interval:n,locations:[[r,i],[r,i]],intersections:!1}),async:!1,contentType:"application/json; charset=utf-8",success:function(e){a.map.data.addGeoJson(e)}}),a.map.data.setStyle((function(e){var t=e.getProperty("value");return a.SetColor(t),{fillColor:a.colors,opacity:.35,strokeWeight:1}}))}i(e,t),document.getElementById("params").addEventListener("change",(function(a){if("profile"===a.target.name)o=a.target.value,i(e,t);else if("duration"===a.target.name){var r="";if($(params).find("input:checkbox:checked").length>0){$(params).find("input:checkbox:checked").each((function(){r.length>0&&(r+=",");var e=$(this).val();r+=e}));var s=String(r).split(",");n=s[0],s[s.length-1]}else n="600","1800";i(e,t)}}))},Close:function(){var e=this;e.showAddZone=!1,e.showSaveZonePopUp=!1,e.showImportFilePopup=!1},GetZoneManagementData:function(e){var t=this;t.currentSelectedShape.setOptions({strokeOpacity:e.strokeOpacity,strokeColor:e.strokeColor,fillOpacity:.35,strokeWeight:e.strokeWeight,fillColor:e.fillColor}),t.polygonData.forEach((function(a,o){a.Id==e.Id&&(t.polygonData[o].strokeOpacity=e.strokeOpacity,t.polygonData[o].strokeWeight=e.strokeWeight,t.polygonData[o].fillColor=e.fillColor,t.polygonData[o].locatorids=e.locatorids,t.polygonData[o].strokeColor=e.strokeColor,t.polygonData[o].locatorids=e.locatorids,t.showAddZone=!1,t.showSaveZone=!0)}))},OpenSaveZone:function(){var e=this;e.showSaveZonePopUp=!0},SaveZoneData:function(e){var t=this;let a={ZoneId:0==t.zoneId?e.ZoneId:t.zoneId,ResolverUserId:null,JsonData:{type:"FeatureCollection",features:[]},ZoneName:e.Name,description:e.Description,ZoneType:null==e.ZoneType?t.ZoneType:e.ZoneType,YardEmails:null==e.YardEmails?t.emailString:e.YardEmails};t.polygonData.forEach((function(e,t){a.JsonData.features.push({type:"Feature",geometry:{type:"Polygon",coordinates:[[]]},properties:{stroke:e.strokeWeight,"stroke-opacity":e.strokeOpacity,"stroke-width":e.strokeWeight,fillColor:e.fillColor,"fill-opacity":e.fillOpacity,locatorname:null,locatorids:e.locatorids,userids:null}}),e.latLong.forEach((function(e,o){void 0!=a.JsonData.features[t]&&a.JsonData.features[t].geometry.coordinates[0].push([e.longitude,e.latitude])})),void 0!=a.JsonData.features[t]&&a.JsonData.features[t].geometry.coordinates[0].push([a.JsonData.features[t].geometry.coordinates[0][0][0],a.JsonData.features[t].geometry.coordinates[0][0][1]])})),t.zoneData.push(a);var o=JSON.stringify(t.zoneData);i["a"].UploadGeoJSON(o).then((function(e){0==t.zoneId?t.ShowAlert("Zone Succesfully Added.","success"):t.ShowAlert("Zone Succesfully Updated.","success"),t.showSaveZonePopUp=!1,t.currentSelectedShape=null,t.$emit("FetchData")}))},GetLeafLetAddressToDraw:function(){var e=this;let t={City:{Name:"",LongName:""},Country:{Name:"",LongName:""},AdministrativeAreaLevel1:{Name:"",LongName:""},AdministrativeAreaLevel2:{Name:"",LongName:""},AdministrativeAreaLevel3:{Name:"",LongName:""},State:{Name:"",LongName:""},PinCode:"",FullAddress:""};v.a.featureGroup().addTo(e.map);e.editableLayers=(new v.a.FeatureGroup).addTo(e.map);new v.a.Control.Draw({edit:{featureGroup:e.editableLayers,poly:{allowIntersection:!0}},draw:{polygon:{allowIntersection:!1,drawError:{color:"#e1e100",message:"<strong>Oh snap!<strong> you can't draw that!"},shapeOptions:{color:"#bada55"}},polyline:!1,circle:!1,marker:!1,circlemarker:!1}}).addTo(e.map);e.map.addLayer(e.editableLayers),e.map.on("draw:editvertex",(function(a){var o=a.poly;o.getLatLngs(),o.getLatLngs()[0].forEach((function(a,o){e.lngLatData.push({Lat:a.lat,Lng:a.lng});var n=new google.maps.LatLng(e.lngLatData[0].Lat,e.lngLatData[0].Lng),i=new google.maps.Geocoder;i.geocode({latLng:n},(function(e,a){t.FullAddress=e[0].formatted_address})),e.fullAddress.push({LatLng:e.lngLatData,CompleteAddress:t})}))})),e.map.on("draw:created",(function(a){var o=a.layerType,n=a.layer;if("polygon"===o){n.on("mouseover",(function(){console.log(n.getLatLngs())})),e.editableLayers.addLayer(n),n.getLatLngs()[0].forEach((function(t,a){e.lngLatData.push({Lat:t.lat,Lng:t.lng})}));var i=new google.maps.LatLng(n.getLatLngs()[0][0].lat,n.getLatLngs()[0][0].lng),r=new google.maps.Geocoder;r.geocode({latLng:i},(function(a,o){t.FullAddress=a[0].formatted_address,a[0].address_components.forEach((function(a,o){"country"==a.types[0]?(t.Country.Name=a.short_name,t.Country.LongName=a.long_name):"postal_code"==a.types[0]?t.PinCode=a.long_name:"administrative_area_level_1"==a.types[0]?(t.AdministrativeAreaLevel1.LongName=a.long_name,t.AdministrativeAreaLevel1.Name=a.short_name,t.State.LongName=a.long_name,t.State.Name=a.short_name):"administrative_area_level_2"==a.types[0]?(t.AdministrativeAreaLevel2.LongName=a.long_name,t.AdministrativeAreaLevel2.Name=a.short_name):"administrative_area_level_3"==a.types[0]?(e.address.push({AdministrativeArea3:a.long_name}),t.AdministrativeAreaLevel3.LongName=a.long_name,t.AdministrativeAreaLevel3.Name=a.short_name):"locality"==a.types[0]&&(e.address.push({City:a.long_name}),t.City.LongName=a.long_name,t.City.Name=a.short_name)})),e.fullAddress.push({LatLng:e.lngLatData,CompleteAddress:t}),e.$emit("GetAddress",e.fullAddress)}))}else{e.lngLatData.push({Lat:a.layer._latlng.lat,Lng:a.layer._latlng.lng});i=new google.maps.LatLng(a.layer._latlng.lat,a.layer._latlng.lng),r=new google.maps.Geocoder;r.geocode({latLng:i},(function(a,o){t.FullAddress=a[0].formatted_address,a[0].address_components.forEach((function(a,o){"country"==a.types[0]?(t.Country.Name=a.short_name,t.Country.LongName=a.long_name):"postal_code"==a.types[0]?t.PinCode=a.long_name:"administrative_area_level_1"==a.types[0]?(t.AdministrativeAreaLevel1.LongName=a.long_name,t.AdministrativeAreaLevel1.Name=a.short_name,t.State.LongName=a.long_name,t.State.Name=a.short_name):"administrative_area_level_2"==a.types[0]?(t.AdministrativeAreaLevel2.LongName=a.long_name,t.AdministrativeAreaLevel2.Name=a.short_name):"administrative_area_level_3"==a.types[0]?(e.address.push({AdministrativeArea3:a.long_name}),t.AdministrativeAreaLevel3.LongName=a.long_name,t.AdministrativeAreaLevel3.Name=a.short_name):"locality"==a.types[0]&&(e.address.push({City:a.long_name}),t.City.LongName=a.long_name,t.City.Name=a.short_name)})),e.fullAddress.push({LatLng:e.lngLatData,CompleteAddress:t}),e.$emit("GetAddress",e.fullAddress)}))}}))},GetGoogleAddressToDraw:function(e){var t=this,a=e.overlay;t.currentSelectedShape=a;let o={City:{Name:"",LongName:""},Country:{Name:"",LongName:""},AdministrativeAreaLevel1:{Name:"",LongName:""},AdministrativeAreaLevel2:{Name:"",LongName:""},AdministrativeAreaLevel3:{Name:"",LongName:""},State:{Name:"",LongName:""},PinCode:"",FullAddress:""};if("polygon"==e.type){var n=e.overlay;n.type=e.type,t.lngLatData=[],"zoneMapDiv"==t.mapContainer&&(t.polygonNewShapeId=(new Date).getTime()+"_"+Math.floor(1e3*Math.random()),t.showAddZone=!0),e.overlay.getPath().getArray().map(e=>{t.lngLatData.push({latitude:e.lat(),longitude:e.lng()})}),n["ShapeId"]=t.polygonNewShapeId,google.maps.event.addListener(n,"click",(function(e,a,o){"zoneMapDiv"==t.mapContainer&&(t.polygonNewShapeId=this.ShapeId,t.showAddZone=!0,t.currentSelectedShape=this)}));var i=new google.maps.LatLng(t.lngLatData[0].latitude,t.lngLatData[0].longitude),r=new google.maps.Geocoder;r.geocode({latLng:i},(function(e,a){o.FullAddress=e[0].formatted_address,a==google.maps.GeocoderStatus.OK&&(e[0].address_components.forEach((function(e,a){"country"==e.types[0]?(o.Country.Name=e.short_name,o.Country.LongName=e.long_name):"postal_code"==e.types[0]?o.PinCode=e.long_name:"administrative_area_level_1"==e.types[0]?(o.AdministrativeAreaLevel1.LongName=e.long_name,o.AdministrativeAreaLevel1.Name=e.short_name,o.State.LongName=e.long_name,o.State.Name=e.short_name):"administrative_area_level_2"==e.types[0]?(o.AdministrativeAreaLevel2.LongName=e.long_name,o.AdministrativeAreaLevel2.Name=e.short_name):"administrative_area_level_3"==e.types[0]?(t.address.push({AdministrativeArea3:e.long_name}),o.AdministrativeAreaLevel3.LongName=e.long_name,o.AdministrativeAreaLevel3.Name=e.short_name):"locality"==e.types[0]&&(t.address.push({City:e.long_name}),o.City.LongName=e.long_name,o.City.Name=e.short_name)})),t.fullAddress.push({LatLng:t.lngLatData,CompleteAddress:o}),t.$emit("GetAddress",t.fullAddress),t.polygonData.push({Id:t.polygonNewShapeId,latLong:t.lngLatData,CompleteAddress:o,strokeOpacity:"",strokeWeight:"",strokeColor:"",fillColor:"",locatorids:""}))}))}else if("marker"==e.type){t.lngLatData.push({name:"",latLong:[{latitude:e.overlay.getPosition().lat(),longitude:e.overlay.getPosition().lng()}]});i=new google.maps.LatLng(e.overlay.getPosition().lat(),e.overlay.getPosition().lng()),r=new google.maps.Geocoder;r.geocode({latLng:i},(function(e,a){a==google.maps.GeocoderStatus.OK&&(e[0].address_components.forEach((function(e,a){"country"==e.types[0]?(o.Country.Name=e.short_name,o.Country.LongName=e.long_name):"postal_code"==e.types[0]?o.PinCode=e.long_name:"administrative_area_level_1"==e.types[0]?(o.AdministrativeAreaLevel1.LongName=e.long_name,o.AdministrativeAreaLevel1.Name=e.short_name,o.State.LongName=e.long_name,o.State.Name=e.short_name):"administrative_area_level_2"==e.types[0]?(o.AdministrativeAreaLevel2.LongName=e.long_name,o.AdministrativeAreaLevel2.Name=e.short_name):"administrative_area_level_3"==e.types[0]?(t.address.push({AdministrativeArea3:e.long_name}),o.AdministrativeAreaLevel3.LongName=e.long_name,o.AdministrativeAreaLevel3.Name=e.short_name):"locality"==e.types[0]&&(t.address.push({City:e.long_name}),o.City.LongName=e.long_name,o.City.Name=e.short_name)})),t.fullAddress.push({LatLng:t.lngLatData,CompleteAddress:o}),t.$emit("GetAddress",t.fullAddress))}))}},LoadMapboxHeatMap:function(e,t){var a=this;if("undefined"!=typeof a.map.getLayer("isoLayer")&&a.map.removeLayer("isoLayer"),"undefined"!=typeof a.map.getSource("iso"))return a.map.removeSource("iso"),!1;var o=document.getElementById("params"),n="https://api.mapbox.com/isochrone/v1/mapbox/",i=null,r=null,s=(n="https://api.mapbox.com/isochrone/v1/mapbox/",parseFloat(r,10),parseFloat(i,10),"driving"),l="10,20,30";function p(){var o=n+s+"/"+t+","+e+"?contours_minutes="+l+"&contours_colors="+a.colors+"&polygons=true&access_token="+h.a.accessToken;$.ajax({method:"GET",url:o}).done((function(e){a.map.getSource("iso").setData(e)}))}a.colors="3CEA19,EFF60B,F6320B",c(),a.map.flyTo({center:[t,e],zoom:10,essential:!0});var d=new L.a;function c(){a.map.addSource("iso",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),a.map.addLayer({id:"isoLayer",type:"fill",source:"iso",layout:{},paint:{"fill-color":["get","fillColor"],"fill-opacity":.5}},"poi-label");var o={lon:t,lat:e},n=localStorage.getItem("UserImage");String(n).indexOf("blob")<=0&&(n="https://app.talygen.com/Content/images/Black/user.png");var i=new h.a.Popup({offset:25}).setHTML("<div style='padding:8px;'><img style='float:left;' src='"+n+"' class='marker' /> <div style='display:block;'>@loggedUserInfo.Name </br>@loggedUserInfo.Email</div></div>"),r=document.createElement("div");r.className="marker",r.style.backgroundImage="url("+n+")",r.style.backgroundPosition="top center",r.style.backgroundSize="cover",r.style.width="40px",r.style.height="40px";var s=new h.a.Marker(r).setLngLat(o).setPopup(i).addTo(a.map);a.imageMarker.push(s),p()}a.map.addControl(d,"bottom-left"),o.addEventListener("change",(function(e){if("profile"===e.target.name)s=e.target.value,"foot-walking"==s?s="walking":"cycling-regular"==s?s="cycling":"driving-car"==s&&(s="driving"),p();else if("duration"===e.target.name){var t="",n="";$(o).find("input:checkbox:checked").length>0?($(o).find("input:checkbox:checked").each((function(){t.length>0&&(t+=","),n.length>0&&(n+=",");var e=$(this).val();t+=e,a.SetColor(e),n+=a.colors})),l=t,a.colors=n,p()):(l="10,20,30",a.colors="3CEA19,EFF60B,F6320B",p())}})),a.map.on("load",(function(){c()}))},TravelMode:function(e){var t=this;t.time=t.time-e,"LeafLet"==t.mapType?t.ShowEtaMap():"Google"==t.mapType?t.LoadGoogleHeatMap():"MapBox"==t.mapType&&t.LoadMapboxHeatMap()},ShowTravelMode:function(){var e=this;0==e.showSettingPopup?($(".settingPopup").removeClass("d-none"),e.showSetting=!1,e.showSettingPopup=!0):($(".settingPopup").addClass("d-none"),e.showSetting=!0,e.showSettingPopup=!1)},GetMapBoxAddressToDraw:function(e){var t=this;let a={City:{Name:"",LongName:""},Country:{Name:"",LongName:""},AdministrativeAreaLevel1:{Name:"",LongName:""},AdministrativeAreaLevel2:{Name:"",LongName:""},AdministrativeAreaLevel3:{Name:"",LongName:""},PinCode:"",State:{Name:"",LongName:""},FullAddress:""};const o=t.draw.getAll().features;if(o.length>1){const a=e.features[0].id;o.forEach((function(e){e.id!==a&&t.draw.delete(e.id)}));let n={location_nw:e.features[0].geometry.coordinates[0]+","+e.features[0].geometry.coordinates[1]};const i=t.drawLocationPointer(n);t.removeAllMarkersExceptCurrent(i)}if("Polygon"==e.features[0].geometry.type){e.features[0].geometry.coordinates[0].forEach((function(e,a){t.lngLatData.push({Lat:e[1],Lng:e[0]})}));var n=new google.maps.LatLng(e.features[0].geometry.coordinates[0][0][1],e.features[0].geometry.coordinates[0][0][0]),i=new google.maps.Geocoder;i.geocode({latLng:n},(function(e,o){a.FullAddress=e[0].formatted_address,o==google.maps.GeocoderStatus.OK&&(e[0].address_components.forEach((function(e,o){"country"==e.types[0]?(a.Country.Name=e.short_name,a.Country.LongName=e.long_name):"postal_code"==e.types[0]?a.PinCode=e.long_name:"administrative_area_level_1"==e.types[0]?(a.AdministrativeAreaLevel1.LongName=e.long_name,a.AdministrativeAreaLevel1.Name=e.short_name,a.State.LongName=e.long_name,a.State.Name=e.short_name):"administrative_area_level_2"==e.types[0]?(a.AdministrativeAreaLevel2.LongName=e.long_name,a.AdministrativeAreaLevel2.Name=e.short_name):"administrative_area_level_3"==e.types[0]?(t.address.push({AdministrativeArea3:e.long_name}),a.AdministrativeAreaLevel3.LongName=e.long_name,a.AdministrativeAreaLevel3.Name=e.short_name):"locality"==e.types[0]&&(t.address.push({City:e.long_name}),a.City.LongName=e.long_name,a.City.Name=e.short_name)})),t.fullAddress.push({LatLng:t.lngLatData,CompleteAddress:a}),t.$emit("GetAddress",t.fullAddress))}))}else{t.lngLatData.push({Lat:e.features[0].geometry.coordinates[1],Lng:e.features[0].geometry.coordinates[0]});n=new google.maps.LatLng(e.features[0].geometry.coordinates[1],e.features[0].geometry.coordinates[0]),i=new google.maps.Geocoder;i.geocode({latLng:n},(function(e,o){a.FullAddress=e[0].formatted_address,o==google.maps.GeocoderStatus.OK&&e[0].address_components.forEach((function(e,o){"country"==e.types[0]?(a.Country.Name=e.short_name,a.Country.LongName=e.long_name):"postal_code"==e.types[0]?a.PinCode=e.long_name:"administrative_area_level_1"==e.types[0]?(a.AdministrativeAreaLevel1.LongName=e.long_name,a.AdministrativeAreaLevel1.Name=e.short_name):"administrative_area_level_2"==e.types[0]?(a.AdministrativeAreaLevel2.LongName=e.long_name,a.AdministrativeAreaLevel2.Name=e.short_name,a.State.LongName=e.long_name,a.State.Name=e.short_name):"administrative_area_level_3"==e.types[0]?(t.address.push({AdministrativeArea3:e.long_name}),a.AdministrativeAreaLevel3.LongName=e.long_name,a.AdministrativeAreaLevel3.Name=e.short_name):"locality"==e.types[0]&&(t.address.push({City:e.long_name}),a.City.LongName=e.long_name,a.City.Name=e.short_name)}))}))}}}},k=x,S=(a("d953"),a("0c7c")),A=Object(S["a"])(k,m,g,!1,null,null,null),D=A.exports,M={components:{MapComponent:D},props:{latLngValues:{},meterReadingDetail:{type:Object}},data(){return{Longitude:null,Latitude:null,config:{isShowDrawButton:!0,isShowSearchBox:!0}}},created(){console.log("meterReadingDetail",this.meterReadingDetail)},mounted(){},methods:{closePopup(){this.$parent.isViewMap=!1}}},N=M,E=Object(S["a"])(N,d,c,!1,null,null,null),T=E.exports,I=a("c1df"),P=a.n(I),O=a("e8b2"),R={components:{ViewMap:T,VueImageLightboxCarousel:O["a"]},data(){return{meterTypeId:"",TotalRecords:0,noRecord:!1,isLoading:!1,CompanyId:null,PageSize:10,statusId:"",PageNumber:1,isPaged:1,TotalPages:0,widgets:[],SortBy:"",SortExp:"",Headers:[{COLUMN_NAME:"MeterMappingName",DATA_TYPE:"string",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"MeterSerialNumber",DISPLAY_ORDER:1},{COLUMN_NAME:"CurrentReading",DATA_TYPE:"string",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:this.$t("ReadingValue"),DISPLAY_ORDER:2},{COLUMN_NAME:"ReadingDate",DATA_TYPE:"string",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:this.$t("ReadingDate"),DISPLAY_ORDER:3,settings:{isInSlot:!0}},{COLUMN_NAME:"customer_name",DATA_TYPE:"string",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:this.$t("CustomerName"),DISPLAY_ORDER:3},{COLUMN_NAME:"meter_type",DATA_TYPE:"string",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:this.$t("Utility"),DISPLAY_ORDER:3},{COLUMN_NAME:"property_address",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("propertyaddress"),DISPLAY_ORDER:5},{COLUMN_NAME:"status_code",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("Status"),DISPLAY_ORDER:10,settings:{isInSlot:!0}},{COLUMN_NAME:"file_names",DATA_TYPE:"image",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("Image"),DISPLAY_ORDER:10,settings:{isInSlot:!0}},{COLUMN_NAME:"location",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("Location"),DISPLAY_ORDER:6,settings:{isInSlot:!0}}],leftSearchFields:p.leftsearchSchema,listheaderbuttons:p.buttons,ListingData:[],meterIds:"",planIds:"",dateFrom:"",dateTo:"",searchCondition:"",isViewMap:!1,meterReadingDetail:{},showLightbox:!1,images:[]}},created(){this.FetchData(),p.bindleftCommonSearchdropdown(this,"MeterReading","Customer")},methods:{async FetchData(){const e=this;e.ListingData=[],e.isLoading=!0;const t=`pageSize=${e.PageSize}&pageNum=${e.PageNumber}&meter_type_id=${e.meterTypeId}&sortBy=${e.SortBy}&sortExp=${e.SortExp}&customerTypeId=1&meterids=${e.meterIds}&plans=${e.planIds}&isPartial=0&${this.searchCondition}`;try{const o=await i["a"].GetMeterReadingList(t);if(null!==o&&void 0!==o&&o.data){let t=JSON.parse(o.data.result).data;var a;if(t.length>0)e.isLoading=!1,""!=e.meterTypeId?e.isCheckbox=!0:e.isCheckbox=!1,e.ListingData=t,e.ListingData.forEach(e=>{e.ReadingDate=new Date(e.ReadingDate),e.isCheckBoxDisabled=!1,1==e.is_Billed&&(e.isCheckBoxDisabled=!0)}),e.noRecord=!1,e.TotalRecords=(null===(a=e.ListingData[0])||void 0===a?void 0:a.TotalRecords)||0;else e.ListingData=[],e.noRecord=!0,e.TotalRecords=0,e.isLoading=!1}else e.ListingData=[],e.noRecord=!0,e.TotalRecords=0,e.isLoading=!1}catch(o){console.error("Error fetching meter reading data:",o),e.ListingData=[],e.noRecord=!0,e.TotalRecords=0,e.isLoading=!1}},leftCommonSearch(e){this.PageNumber=e.PageNumber,this.isPaged=1,"undefined"!=typeof e.searchCondition&&""!=e.searchCondition?this.searchCondition=this.transformParams(e.searchConditionJson):this.searchCondition="",this.FetchData()},transformParams(e){const t=e.split("&");let a=null,o=null;const n=[];return t.forEach(e=>{const[t,i]=e.split("="),r=t.trim(),s=i?i.trim():"";if("MeterReadingDate"===r){const e=s.split("|");a=e[0],o=e[1]}else n.push(`${r}=${s}`)}),(a||o)&&(n.push("datefrom="+(a||"")),n.push("dateto="+(o||""))),n.join("&")},openMap(e){let t={location_nw:`${e.longitude},${e.latitude}`};this.meterReadingDetail=e,this.latLngValues=t,this.isViewMap=!0},renderActions(e){var t=this;let a=[];return t.listActions.forEach(e=>{let t={...e};switch(t.title){case"Delete":t.isVisible=!0;break;default:t.isVisible=!0}a.push(t)}),a},formatDate(e){return e?P()(e).format("MMMM Do, YYYY"):""},pagerMethod(e){this.PageSize=e.PageSize,this.PageNumber=e.PageNumber,this.FetchData()},actionButtonClick(e,t){},openLightbox(e){var t=this;if(null==e||void 0==e);else{var a=e.split(",");a.forEach(e=>{var a={path:e,caption:e.split("/")[6].split(".")[0]};t.images.push(a)})}t.showLightbox=!0},closeshowLightbox(){var e=this;e.images=[],e.showLightbox=!1},commonHeaderButtonClick(e){switch(e.callbackfunction){case"Delete":this.DeleteMeterReading();break}},DeleteMeterReading:function(){var e=this,t="";$(".chkItems:checkbox:checked").not("[id^='chkAll']").each((function(){t.length>0&&(t+=","),t+=$(this).val()})),t.length>0?e.confirmR(e.$t("ConfirmDelete"),!0,e.$t("Delete")+"  "+e.$t("Plan"),(function(){var a={ids:t,moduleName:"CompanySetup",refCode:"Delete_Meter_Reading"},o=JSON.stringify(a);i["a"].CommonCommonDelete(o).then(t=>{200==t.status?(e.FetchData(),e.ShowAlert("Deleted Data Successfully!","Success",!0,e.$t("Alert"))):e.ShowAlert(e.$t("DeleteingRecordMsg"),"danger",e.$t("Alert"))})})):e.ShowAlert(e.$t("DeleteingRecordMsg"),"danger",e.$t("Alert"))},sortdata(e){var t="sort tb_headerSortDown";this.SortBy=e,e===this.SortBy&&(""==this.SortExp?(this.SortExp="ASC",t="sort tb_headerSortDown"):"ASC"==this.SortExp?(this.SortExp="DESC",t="sort tb_headerSortUp"):(this.SortExp="ASC",t="sort tb_headerSortDown")),this.FetchData(),$("#"+e+"  span:first-child").attr("class",t)}}},B=R,F=Object(S["a"])(B,o,n,!1,null,null,null);t["default"]=F.exports},"73a2":function(e,t,a){var o=a("24fb");t=o(!1),t.push([e.i,'.mapboxgl-popup-content button.mapboxgl-popup-close-button{font-size:23px;top:3px}.mapboxgl-popup{width:340px;max-width:340px!important}.leaflet-popup-content .popupcontent{background:#fff}.leaflet-left .leaflet-control-zoom{display:none}.leaflet-marker-icon{border-radius:100%!important}.leaflet-popup-content p{margin:auto!important}.leaflet-popup-content-wrapper{padding:0!important}.leaflet-popup-content{margin:auto!important;line-height:1.4!important;width:340px!important}.leaflet-container a.leaflet-popup-close-button{color:#5c5c5c!important;padding:6px 5px 0 0!important}.gm-style-iw.gm-style-iw-c{background-color:#fff!important;padding-right:0!important;padding-bottom:0!important;max-width:648px!important;min-height:150px!important;padding:0!important;width:340px!important;border-radius:0}.gm-style-iw.gm-style-iw-c button.gm-ui-hover-effect{background:0 0!important;display:block!important;font-size:18px!important;border:0!important;margin:0!important;padding:0!important;position:absolute!important;cursor:pointer!important;-webkit-user-select:none!important;-moz-user-select:none!important;user-select:none!important;top:-6px!important;right:-6px!important;width:36px!important;height:40px!important}.gm-style-iw.gm-style-iw-c .gm-style-iw-d{overflow:hidden!important;width:100%!important}.gm-style-iw.gm-style-iw-c #content{padding:0!important;transition:all .3s;width:100%}.gm-style-iw.gm-style-iw-c .map-pop-header{color:#fff}.gm-style-iw.gm-style-iw-c .map-pop-header.Medium{background:#4cb4fb}.gm-style-iw.gm-style-iw-c .map-pop-header.Low{background:#4db567}.gm-style-iw.gm-style-iw-c .map-pop-header.High{background:#fbc648}.gm-style-iw.gm-style-iw-c .map-pop-header.Critical{background:#ef8934}.gm-style-iw.gm-style-iw-c .map-pop-header.highprofile{background:#de0303}.gm-style-iw.gm-style-iw-c .firstHeading{font-size:16px;display:flex;align-items:center;padding:5px 10px}.gm-style-iw.gm-style-iw-c .status{font-size:12px;background:#5c5c5c;font-weight:400;color:#fff;padding:4px 6px;margin-left:5px}.gm-style-iw.gm-style-iw-c p.details{display:flex;width:100%;font-weight:bolder;font-size:14px;padding:5px 10px;margin-bottom:4px}.gm-style-iw.gm-style-iw-c p.details span{font-size:12px;font-weight:400;text-transform:capitalize}.gm-style-iw.gm-style-iw-c .view-details{display:flex;width:100%;font-weight:bolder;font-size:14px;margin-bottom:0;border-top:2px solid #bfbfbf;flex-direction:row}.gm-style-iw.gm-style-iw-c .view-details a{padding:0 5px;margin-right:5px;color:#525e65}.mapboxgl-popup-content{padding:0!important}.mail-box-pop.dialog{background:rgba(0,0,0,.5)!important}.mail-box-pop .modal-dialog{max-width:570px!important;min-height:500px!important}.mail-box-pop.eta .modal-dialog{max-width:1200px!important;min-height:500px!important}.mail-box-pop.eta .modal-body{max-height:800px!important;height:800px!important}.motabod{border-right:10px solid #e5e5e5}.movedivider{background-repeat:no-repeat;background-position:0 0;width:37px;height:57px;position:absolute;z-index:999;right:-24px;top:160px;display:none}tr.bg-danger{background-color:#f7ccd0!important}.ui-resizable-handle{z-index:9999}.custom-tab-content ul.responsive-tabs.fsmtabcontrol li a{padding:10px}.tags-input-badge{font-size:12px!important;padding-top:5px!important;padding-bottom:5px!important;background-color:#3f637e!important;color:#fff!important}.tags-input-remove:after,.tags-input-remove:before{background:#fff!important}.tags-input span{margin-bottom:.3em}.circle-leaflet{width:55px!important;height:55px!important;line-height:55px;background-image:url(https://talygenv.github.io/Vue-UI-Content/images/Ticketing/m2.png)!important;text-align:center!important;font-weight:700!important;position:absolute!important;top:-22px!important;left:-19px!important}.table-heading-wb .table-head-btn{padding:.5rem}.gmnoprint{right:0!important;left:auto!important}.bg-gray-faint{position:relative;background-color:#fff!important;font-family:Open Sans,sans-serif;padding:8px 16px!important;margin-top:55px!important;border:1px solid #2196f3;margin-left:12px!important}.bg-gray-faint:after{color:#2196f3;content:"\\f0d8";position:absolute;font:normal normal normal 14px/1 FontAwesome;top:-19px;left:10%;font-size:27px}.txt-m{font-size:15px;line-height:24px;margin-top:0;margin-bottom:0}.sliderchk{cursor:pointer;top:0;left:3px;right:0;bottom:0;background-color:#ccc}.sliderchk,.sliderchk:before{position:absolute;transition:.4s}.sliderchk:before{content:"";height:24px;width:24px;left:6px;bottom:4px;background-color:#fff}input:focus+.sliderchk{box-shadow:0 0 1px #2196f3}.sliderchk.round{border-radius:34px!important}.sliderchk.round:before{border-radius:50%;top:0}.textname{top:29px;position:absolute;left:4px;font-size:13px;color:#999;font-weight:700}.timelegend{height:10px;padding:0 15px;display:inline-block}.timelegend.min10{background-color:#96d52d}.timelegend.min20{background-color:#f0c141}.timelegend.min30{background-color:#f18d76}.showduration{float:left;color:#565656!important;position:absolute;left:4px;top:0;cursor:pointer;font-size:18px;background-color:#fff;padding:7px 18px;margin:10px;margin-left:8px;font-family:Roboto,Arial,sans-serif;z-index:999}.tags-input-root .typeahead-badges{padding-top:.25rem!important}#divmapdata .map-result img{width:auto!important}.filterscrollForCardView{scrollbar-width:thin;scrollbar-color:#848484}.filterscrollForCardView::-webkit-scrollbar{width:8px;height:8px}.filterscrollForCardView::-webkit-scrollbar-track{background-clip:content-box;border:2px solid transparent}.filterscrollForCardView::-webkit-scrollbar-thumb{background-color:#848484}.filterscrollForCardView::-webkit-scrollbar-corner,.scrollbar-1::-webkit-scrollbar-track{background-color:#848484}.typeahead-badges>span{max-width:195px}[data-color_code]:after{background-color:attr(data-color_code)}.fsm-ticket,.table-bordered tr.fsm-ticket{background-color:#f5f1ef!important}.pinscreenMap{background:#17a2b8;border-left:0!important}.pinscreenMap,.unpinscreenMap{padding:15px 0!important;width:50px;cursor:pointer}.unpinscreenMap{background:#525f65}.unpinscreenMap i{transform:rotate(-45deg)}.map-actions span.esri_prof:hover{transform:none!important}.map-actions span.esri_prof a{color:#212529}.mCustomScrollBox,.mCustomScrollBox .mCS-light{max-height:inherit!important}#scrollbarreplyuserguide{max-height:350px}.theme-primary.partition{overflow:visible}.custom-marker{display:flex;flex-direction:column;align-items:center;text-align:center}.marker-label{background-color:#fff;padding:2px 6px;border-radius:3px;font-size:12px;color:#000;margin-bottom:2px;white-space:nowrap;box-shadow:0 0 2px rgba(0,0,0,.5)}.marker-dot{width:10px;height:10px;background-color:red;border-radius:50%}',""]),e.exports=t},d953:function(e,t,a){"use strict";a("5eb3")}}]);
//# sourceMappingURL=chunk-05377832.js.map