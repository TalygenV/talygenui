(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1ec928f5"],{"00f4":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"main-content"},[a("loader",{attrs:{"is-visible":e.isLoading}}),a("div",{staticClass:"padding-t_10 p-0",attrs:{id:"reportstabsdata"}},[a("div",{staticClass:"left-menu-tab mt-2"},[a("div",{staticClass:"col-md-12 p-0"},[a("div",{staticClass:"theme-primary partition"},[a("span",{staticClass:"p-name text-white"},[e._v(e._s(e.$t(e.EditPlanDetail[0].PLAN_NAME)))])])]),a("ul",{staticClass:"nav nav-pills flex-column left-tab mt-2 responivecustomtab  nav-tabs"},e._l(e.tabs,(function(t){return a("li",{key:t.id,class:{"nav-item":!0,active:e.currentTab.title===t.title},on:{click:function(a){return e.changeTab(t)}}},[a("span",{class:{"nav-link left-menu":!0,active:e.currentTab.title===t.title}},[a("i",{staticClass:"p-1",class:t.icon}),e._v(" "+e._s(t.displayName))])])})),0)]),a("div",{staticClass:"right-content forms-for-billing-plandetails"},[a("div",{staticClass:"tab-content",attrs:{id:"myTabContent"}},[e._m(0),"Services"!==e.currentTab.title&&"Inventory Items"!==e.currentTab.title&&"Rates"!==e.currentTab.title&&"Subsidy"!==e.currentTab.title?a("div",{staticClass:"theme-primary partition  p-actions-expand mt-2",attrs:{id:"ReturnRequestHeading"}},[a("span",{staticClass:"p-name text-white"},[e._v(" "+e._s(e.currentTab.displayName))]),"Plan"===e.currentTab.title?a("span",[a("RouterLink",{staticClass:"p-action-btn text-white float-right",attrs:{to:"/Plan/PlanListing",title:"","data-toggle-tooltip":"tooltip","data-original-title":"Back to list"}},[a("i",{staticClass:"fa fa-angle-double-left pr-2"}),a("br"),e._v(e._s(e.$t("BacktoList")))]),a("a",{staticClass:"p-action-btn text-white float-right",attrs:{id:"addnewreview",href:"javascript:;",title:"Add Feedback"},on:{click:e.openEditPlan}},[a("i",{staticClass:"fa fa-pencil pr-2"}),a("br"),a("span",[e._v(e._s(e.$t("EditPlan")))])])],1):e._e(),"Billing Cycle"===e.currentTab.title||"EMI Configuration"===e.currentTab.title?a("span",[a("RouterLink",{staticClass:"p-action-btn text-white float-right",attrs:{to:"/Plan/PlanListing",title:"","data-toggle-tooltip":"tooltip","data-original-title":"Back to list"}},[a("i",{staticClass:"fa fa-angle-double-left pr-2"}),a("br"),e._v(e._s(e.$t("BacktoList")))])],1):e._e()]):e._e(),a("div",{staticClass:"col-md-12 p-0 main-content"},["Plan"==e.currentTab.title?a("PlanDetail",{key:e.refreshComponent}):e._e(),"Services"==e.currentTab.title?a("ServiceDetail",{attrs:{billingTypeOptions:e.BillingTypeOptions}}):e._e(),"Rates"==e.currentTab.title?a("SubscriptionRate"):e._e(),"Inventory Items"==e.currentTab.title?a("InventoryDetail"):e._e(),"Billing Cycle"==e.currentTab.title?a("BillingCycle",{attrs:{planid:e.planid}}):e._e(),"EMI Configuration"==e.currentTab.title?a("EMIConfiguration",{attrs:{planid:e.planid}}):e._e(),"Subsidy"==e.currentTab.title?a("PlanSubsidy"):e._e()],1)])])]),e.isCheckEditPlan?a("AddPlan",{attrs:{callbackfunction:e.FetchData,refCode:e.refCode,editDetail:e.EditPlanDetail,billingTypeOptions:e.BillingTypeOptions},on:{refreshPlanDetail:e.refreshPlanDetail}}):e._e()],1)},s=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"expand-list"},[a("a",{staticClass:"expand-list-btn justify-content-center align-items-center",attrs:{href:"javascript:;"}},[a("i",{staticClass:"icon-solid arrow-solid-left text-white",staticStyle:{"font-size":"9pt"}})])])}],r=a("3764"),l=a("8759"),n=a("32a9"),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("loader",{attrs:{"is-visible":e.isLoading}}),a("div",{staticClass:"col-md-12 p-0 border float-left plan-rate-detail"},[a("div",{staticClass:"col-md-12 mt-3 d-none"},[a("div",{staticClass:"col-md-12 mb-2 p-2 bg-light border d-flex"},[a("div",{staticClass:"form-check form-switch col-md-6 mt-1 p-0"},[a("label",{staticClass:"form-check-label mr-2",attrs:{for:"peakHoursSwitch"}},[e._v("Enable Minimum Charge")]),a("label",{staticClass:"switch"},[a("input",{staticClass:"form-check-input custom-control-input dynamic",attrs:{type:"checkbox"},domProps:{checked:e.isCheckedMinimiumCharge},on:{change:e.checkForEnableMinimiumCharge}}),a("span",{staticClass:"slider round",staticStyle:{cursor:"default"}},[a("span",{staticClass:"slider-yes"},[e._v(e._s(e.$t("Yes")))]),a("span",{staticClass:"slider-no"},[e._v(e._s(e.$t("No")))])])])])])]),a("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 float-left mt-2"},[e.isCheckedMinimiumCharge?a("div",{staticClass:"peak-rates listing mb-3"},[0==e.enableLimitData.length?a("div",{staticClass:"text-center text-danger"},[e._v(" No record found ")]):e._e(),e.enableLimitData.length>0?a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table table-bordered"},[e._m(0),a("tbody",[e.enableLimitData.length>0?a("tr",{key:0},[a("td",[e._v(e._s(e.monthNames()))]),a("td",[e._v(e._s(e.serviceNameList))]),a("td",{staticClass:"text-center single-action"},[a("a",{staticClass:"mr-3",attrs:{href:"javascript:;"},on:{click:function(t){return e.handleEdit(e.enableLimitData)}}},[a("em",{staticClass:"fa fa-edit text-success float-none"})]),a("a",{attrs:{href:"javascript:;"},on:{click:function(t){return e.handleDelete(0)}}},[a("em",{staticClass:"fa fa-trash text-danger float-none"})])])]):e._e()])])]):e._e()]):e._e()]),e._m(1),e._l(e.PlanRateListing,(function(t,i){return a("div",{key:i},[a("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 float-left"},[a("div",{staticClass:"form-group mb-0"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-3"},[a("div",{staticClass:"form-group"},[e._m(2,!0),a("input",{directives:[{name:"model",rawName:"v-model",value:t.rateScheduleName,expression:"item.rateScheduleName"}],staticClass:"form-control",attrs:{type:"text",id:"rateScheduleName",placeholder:"Enter rate schedule name",required:""},domProps:{value:t.rateScheduleName},on:{input:function(a){a.target.composing||e.$set(t,"rateScheduleName",a.target.value)}}})])]),a("div",{staticClass:"col-md-3"},[a("div",{staticClass:"form-group"},[e._m(3,!0),a("select",{directives:[{name:"model",rawName:"v-model",value:t.currencyId,expression:"item.currencyId"}],staticClass:"form-control",attrs:{id:"currency",required:""},on:{change:function(a){var i=Array.prototype.filter.call(a.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(t,"currencyId",a.target.multiple?i:i[0])}}},[a("option",{attrs:{value:""}},[e._v("Select Currency")]),e._l(e.currencies,(function(t,i){return a("option",{key:i,domProps:{value:t.value}},[e._v(e._s(t.name)+" ")])}))],2)])])])])]),e._l(t.serviceTypes,(function(t,s){return a("div",{key:s,staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 float-left mb-0"},[a("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 float-left p-0"},[a("div",{staticClass:"heading-border"},[a("h5",{staticClass:"h5"},[a("a",{class:{"card-link collapsed":s>1,"card-link":s<=1},staticStyle:{color:"#000"},attrs:{"data-toggle":"collapse",href:"#collapseOneThread"+s}},[a("div",{staticClass:"conversation-date heading-border"},[a("span",[e._v(e._s(t.serviceTypeName))])])])])])]),e._l(t.serviceList,(function(r,l){return a("div",{key:l,staticClass:"card mb-3"},[a("div",{staticClass:"card-header py-1"},[a("a",{class:{"card-link collapsed":l>1,"card-link":l<=1},staticStyle:{color:"#000"},attrs:{"data-toggle":"collapse",href:"#collapseOneThread_"+l+"_"+s}},[a("div",{staticClass:"conversation-date mb-0"},[a("span",[e._v(" Service name: "),a("strong",[e._v(e._s(r.serviceName))])])])])]),a("div",{class:{collapse:l>1,"collapse show":l<=1},attrs:{id:"collapseOneThread_"+l+"_"+s}},[a("div",{staticClass:"card-body pt-3"},["Usage Based"==t.serviceTypeName?a("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 float-left p-0"},[a("div",{staticClass:"form-group mb-0"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-6"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"billing-interval"}},[e._v("Billing Interval:")]),a("div",{staticClass:"row mb-3"},[a("div",{staticClass:"col-md-8 d-flex"},[a("select",{directives:[{name:"model",rawName:"v-model",value:r.serviceInterval,expression:"row.serviceInterval"}],staticClass:"form-control",attrs:{id:"billing-interval"},on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(r,"serviceInterval",t.target.multiple?a:a[0])},function(t){return e.handleIntervalChange(r)}]}},[a("option",{attrs:{value:"monthly"}},[e._v("Monthly")]),a("option",{attrs:{value:"quarterly"}},[e._v("Quarterly")]),a("option",{attrs:{value:"yearly"}},[e._v("Yearly")])]),a("span",{staticClass:"p-1 mx-3"},[e._v("Every")]),a("input",{directives:[{name:"model",rawName:"v-model.number",value:r.billingIntervalValue,expression:"row.billingIntervalValue",modifiers:{number:!0}}],staticClass:"form-control",staticStyle:{width:"60px"},attrs:{type:"number",min:"1"},domProps:{value:r.billingIntervalValue},on:{input:function(t){t.target.composing||e.$set(r,"billingIntervalValue",e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}}),"monthly"==r.serviceInterval?a("span",{staticClass:"p-1 mx-3"},[e._v("month(s)")]):a("span",{staticClass:"p-1 mx-3"},[e._v(e._s(r.serviceInterval))])])])])]),a("div",{staticClass:"col-md-3"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"billingType"}},[e._v("Billing Type")]),a("select",{directives:[{name:"model",rawName:"v-model",value:r.billingType,expression:"row.billingType"}],staticClass:"form-control",attrs:{id:"billingType"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(r,"billingType",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[e._v("Select Billing Type")]),a("option",{attrs:{value:"FLT"}},[e._v("Slab Rate")]),a("option",{attrs:{value:"INC"}},[e._v("Flat Incremental Rate")]),a("option",{attrs:{value:"PRE"}},[e._v("Preceding")])])])]),a("div",{staticClass:"col-md-3"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"billableUnit"}},[e._v("Billable Unit")]),a("select",{directives:[{name:"model",rawName:"v-model",value:r.billableUnit,expression:"row.billableUnit"}],staticClass:"form-control",attrs:{id:"billableUnit"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(r,"billableUnit",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[e._v("Select Billable Unit")]),e._l(e.usageMeasurementList,(function(t,i){return a("option",{key:i,domProps:{value:t.value}},[e._v(e._s(t.name))])}))],2)])])])])]):e._e(),a("div",{class:{listing:!0,"mt-0 mb-0":"Usage Based"==t.serviceTypeName}},[a("div",{staticClass:"heading-border"},[a("h5",{staticClass:"h5"},[a("span",[e._v("Rates:")]),"Electric"!=t.meterType?a("small",{staticClass:"float-right"},[a("a",{staticClass:"pr-3",attrs:{href:"javascript:;",title:"Add",id:"AddMember"},on:{click:function(t){return e.addNewRateLimit(r,l)}}},[a("i",{staticClass:"fa fa-plus pr-2"}),e._v(" Add New Slab")])]):e._e()])]),e._l(r.rateDetails,(function(i,s){return a("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 float-left p-0 mt-2 mb-3",staticStyle:{background:"#f8f9fa"}},[null!=i.rateLimitId?a("div",{staticClass:"row mx-0"},[a("i",{staticClass:"fa fa-times",staticStyle:{right:"6px",position:"absolute",top:"3px","border-radius":"15px",color:"red","z-index":"999999"},on:{click:function(t){return e.deleteRateDetailsWithLimit(r,s)}}}),a("div",{class:"Domestic"===e.customerType?"col-md-2":"col-md-3"},[a("div",{staticClass:"form-group"},[a("label",[e._v("Start Date:")]),a("div",{staticClass:"input-group"},[a("v-date-picker",{staticClass:"timedate input-group",attrs:{mode:"date"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.inputValue,i=e.togglePopover;return[a("input",{class:{"form-control":!0},attrs:{placeholder:"MM/DD/YYYY"},domProps:{value:t},on:{click:function(e){return i()}}}),a("div",{staticClass:"input-group-append",on:{click:function(e){return i()}}},[a("span",{staticClass:"input-group-text"},[a("em",{staticClass:"fa fa-calendar"})])])]}}],null,!0),model:{value:i.startDate,callback:function(t){e.$set(i,"startDate",t)},expression:"rateDetail.startDate"}})],1)])]),a("div",{class:"Domestic"===e.customerType?"col-md-2":"col-md-3"},[a("div",{staticClass:"form-group"},[a("label",[e._v("End Date:")]),a("div",{staticClass:"input-group"},[a("v-date-picker",{staticClass:"timedate input-group",attrs:{mode:"date"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.inputValue,i=e.togglePopover;return[a("input",{class:{"form-control":!0},attrs:{placeholder:"MM/DD/YYYY"},domProps:{value:t},on:{click:function(e){return i()}}}),a("div",{staticClass:"input-group-append",on:{click:function(e){return i()}}},[a("span",{staticClass:"input-group-text"},[a("em",{staticClass:"fa fa-calendar"})])])]}}],null,!0),model:{value:i.endDate,callback:function(t){e.$set(i,"endDate",t)},expression:"rateDetail.endDate"}})],1)])]),a("div",{staticClass:"col-md-2"},[a("div",{staticClass:"form-group"},[a("label",[e._v("Limit type:")]),a("select",{directives:[{name:"model",rawName:"v-model",value:i.limitType,expression:"rateDetail.limitType"}],staticClass:"form-control",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(i,"limitType",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"HM3"}},[e._v("HM3")]),a("option",{attrs:{value:"MMBTU"}},[e._v("MMBTU")])])])]),"Domestic"==e.customerType?a("div",{staticClass:"col-md-2"},[a("div",{staticClass:"form-group"},[a("label",[e._v("Customer Rate type:")]),a("select",{directives:[{name:"model",rawName:"v-model",value:i.customerRateType,expression:"rateDetail.customerRateType"}],staticClass:"form-control",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(i,"customerRateType",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"PR"}},[e._v("Protected")]),a("option",{attrs:{value:"NPR"}},[e._v("Non-Protected")])])])]):e._e(),a("div",{staticClass:"col-md-2"},[a("div",{staticClass:"form-group"},[a("label",[e._v("Limit from:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:i.limitFrom,expression:"rateDetail.limitFrom"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:i.limitFrom},on:{input:function(t){t.target.composing||e.$set(i,"limitFrom",t.target.value)}}})])]),a("div",{staticClass:"col-md-2"},[a("div",{staticClass:"form-group"},[a("label",[e._v("Limit to:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:i.limitTo,expression:"rateDetail.limitTo"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:i.limitTo},on:{input:function(t){t.target.composing||e.$set(i,"limitTo",t.target.value)}}})])])]):e._e(),a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table table-bordered dt-responsive nowrap mt-0"},[a("thead",{staticClass:"thead-bg border"},[a("tr",["Usage Based"==t.serviceTypeName?a("th",[e._v("Consumption From")]):e._e(),"Usage Based"==t.serviceTypeName?a("th",[e._v("Consumption To")]):e._e(),e._m(4,!0),"Usage Based"==t.serviceTypeName?a("th",{staticClass:"text-center"},[e._v("Action")]):e._e()])]),a("tbody",e._l(i.rates,(function(s,r){return a("tr",{key:r},["Usage Based"==t.serviceTypeName?a("td",[a("input",{directives:[{name:"model",rawName:"v-model.number",value:s.from,expression:"rate.from",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number"},domProps:{value:s.from},on:{input:function(t){t.target.composing||e.$set(s,"from",e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})]):e._e(),"Usage Based"==t.serviceTypeName?a("td",[a("input",{staticClass:"form-control",attrs:{type:"text"},domProps:{value:e.toDisplay(s.to)},on:{input:function(t){s.to=e.fromDisplay(t.target.value)}}})]):e._e(),a("td",[a("input",{directives:[{name:"model",rawName:"v-model.number",value:s.rate,expression:"rate.rate",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",step:"0.01"},domProps:{value:s.rate},on:{input:function(t){t.target.composing||e.$set(s,"rate",e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})]),"Usage Based"==t.serviceTypeName?a("td",{staticClass:"text-center"},[0==r?a("a",{staticClass:"mr-2",attrs:{href:"javascript:;"},on:{click:function(t){return e.addRow(i,e.index)}}},[a("em",{staticClass:"round-icon-small fa fa-plus bg-success float-none"})]):e._e(),r>0?a("a",{attrs:{href:"javascript:;"},on:{click:function(t){return t.preventDefault(),e.removeRow(i,r)}}},[a("em",{staticClass:"round-icon-small fa fa-trash bg-danger float-none"})]):e._e()]):e._e()])})),0)])])])}))],2),"Usage Based"==t.serviceTypeName?a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("div",{staticClass:"col-md-12 mb-2 p-2 bg-light border d-flex"},[a("div",{staticClass:"form-check form-switch col-md-6 mt-1 p-0"},[a("label",{staticClass:"form-check-label mr-2",attrs:{for:"peakHoursSwitch"}},[e._v("Peak Hours Applicable?")]),a("label",{staticClass:"switch"},[a("input",{staticClass:"form-check-input custom-control-input dynamic",attrs:{type:"checkbox"},domProps:{checked:r.isPeakHoursEnabled},on:{change:function(t){return e.checkForPeakHoursApplicable(r)}}}),a("span",{staticClass:"slider round",staticStyle:{cursor:"default"}},[a("span",{staticClass:"slider-yes"},[e._v(e._s(e.$t("Yes")))]),a("span",{staticClass:"slider-no"},[e._v(e._s(e.$t("No")))])])])]),a("div",{staticClass:"col-md-6 float-right"},[r.isPeakHoursEnabled?a("a",{staticClass:"float-right btn btn-primary formbtn widthhalf",attrs:{href:"javascript:;"},on:{click:function(t){return e.openPeakHour(r,i,s,l)}}},[a("em",{staticClass:"fa fa-plus mr-2"}),e._v("Add Peak Hours")]):e._e()])])])]),r.isPeakHoursEnabled?a("div",{staticClass:"peak-rates listing mb-3"},[0==r.peakRates.length?a("div",{staticClass:"text-center text-danger"},[e._v(" No record found ")]):e._e(),r.peakRates.length>0?a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table table-bordered"},[e._m(5,!0),a("tbody",e._l(r.peakRates,(function(t,n){return a("tr",{key:n},[a("td",[e._v(e._s(e.showPeakHourType(t.selectValue)))]),a("td",[e._v(e._s(e.showSelectedPeakHourOption(t.selectValue,t)))]),a("td",{staticClass:"text-center single-action"},[a("a",{staticClass:"mr-3",attrs:{href:"javascript:;"}},[a("em",{staticClass:"fa fa-edit text-success float-none",on:{click:function(a){return e.editPeakRate(t,n,i,s,l)}}})]),a("a",{attrs:{href:"javascript:;"}},[a("em",{staticClass:"fa fa-trash text-danger float-none",on:{click:function(t){return e.deletePeakRate(r,n)}}})])])])})),0)])]):e._e()]):e._e()]):e._e()])])])}))],2)}))],2)})),e.isRetroActive&&e.retroactiveData?a("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 float-left mt-2"},[a("a",{class:e.card-e.link,staticStyle:{color:"#000"},attrs:{"data-toggle":"collapse",href:"javascript:;"}},[e._m(6)]),a("div",{staticClass:"row alert alert-success m-0 mb-3"},[a("div",{staticClass:"col-md-4"},[a("strong",[e._v("From Month")]),e._v(": "+e._s(e.formatDate(e.retroactiveData.StartDate))+" to "+e._s(e.formatDate(e.retroactiveData.EndDate))+" ")]),"1"==e.retroactiveData.ActionType||1==e.retroactiveData.ActionType?a("div",{staticClass:"col-md-4"},[a("strong",[e._v("Action")]),e._v(": Create new invoices for affected months ")]):e._e(),"2"==e.retroactiveData.ActionType||2==e.retroactiveData.ActionType?a("div",{staticClass:"col-md-4"},[a("strong",[e._v("Adjustment")]),e._v(": Adjust in next billing cycle ")]):e._e(),a("div",{staticClass:"col-md-4 text-right single-action"},[a("a",{attrs:{href:"#"}},[a("em",{staticClass:"fa fa-edit mx-2 text-success",on:{click:function(t){return e.editRetroactiveDetail(e.retroactiveData)}}})]),a("a",{attrs:{href:"#"}},[a("em",{staticClass:"fa fa-times mx-2 text-danger",on:{click:function(t){return e.deleteRetroactiveDetail(e.retroactiveData)}}})])])])]):e._e(),a("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 float-left mb-2 mt-0"},[a("div",{staticClass:"row flex-row-reverse"},[a("div",{staticClass:"col-lg-6 text-right"},[a("a",{staticClass:"btn btn-success formbtn widthhalf mr-2",attrs:{href:"javascript:;",title:"","data-toggle-tooltip":"tooltip","data-original-title":"Save"},on:{click:e.handleSave}},[a("i",{staticClass:"fa fa-save pr-2"}),e._v("Save")])]),a("div",{staticClass:"col-lg-6 text-left"},[a("a",{staticClass:"btn btn-primary formbtn widthhalf",attrs:{href:"javascript:;",title:"","data-toggle-tooltip":"tooltip","data-original-title":"Save"},on:{click:e.addRateSchedule}},[a("i",{staticClass:"fa fa-plus pr-2"}),e._v("Add Rate Schedule")])])])])],2),e.isModalRetroactive?a("ModalRetroactive",{attrs:{refCodeRetro:e.refCodeRetro,retroActDetail:e.retroActDetail},on:{retroActiveDetail:e.handleRetroActiveDetail,cancelRetroActiveList:e.cancelRetroActiveDetail}}):e._e(),e.isAddPeakHours?a("AddPeakHours",{attrs:{peakRateData:e.peakRateData,refCode:e.refCode,currentEditIndex:e.currentEditIndex},on:{peakHoursDetail:e.handlePeakHoursDetail,updatePeakHoursDetail:e.handleUpdatePeakHoursDetail}}):e._e(),e.isEnableMinimiumCharge?a("ModalEnableMinimumCharge",{attrs:{editEnableLimitData:e.editEnableLimitData,MonthApplicable:e.MonthApplicable,refCodeCharge:e.refCodeCharge},on:{minimumChargesDetail:e.handleMinimumChargesDetail}}):e._e()],1)},d=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("thead",{staticClass:"thead-bg"},[a("tr",[a("th",[e._v("Applicable From Month")]),a("th",[e._v("Service Name")]),a("th",{staticClass:"text-center",attrs:{width:"100"}},[e._v("Action")])])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 float-left mt-2"},[a("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 float-left p-0 mb-3"},[a("div",{staticClass:"heading-border"},[a("h5",{staticClass:"h5"},[a("span",[e._v("Details ")])])])])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("label",{attrs:{for:"rateScheduleName"}},[e._v("Rate Schedule Name:"),a("span",{staticClass:"text-danger"},[e._v("*")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("label",{attrs:{for:"currency"}},[e._v("Currency:"),a("span",{staticClass:"text-danger"},[e._v("*")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("th",[e._v("Base Rate "),a("sup",{staticClass:"text-danger",staticStyle:{"font-size":"18px",top:"auto !important"}},[e._v("*")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("thead",{staticClass:"thead-bg"},[a("tr",[a("th",[e._v("Schedule Type")]),a("th",[e._v("Schedule Range")]),a("th",{staticClass:"text-center",attrs:{width:"100"}},[e._v("Action")])])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"conversation-date heading-border"},[a("span",[e._v(" Retroactive ")])])}],c=(a("14d9"),a("9769")),u=a("3fdf"),m=a("7525"),v=a("9dac"),p={components:{AddPeakHours:u["a"],ModalRetroactive:m["a"],ModalEnableMinimumCharge:v["a"]},data(){return{billingInterval:"monthly",billingIntervalText:"Monthly",billingIntervalValue:1,PlanRateListing:[],isAddPeakHours:!1,currentEditIndex:null,SortBy:"",SortExp:"",PageSize:"100000",isChecked:!1,rateScheduleName:"",refCode:"",refCodeRetro:"",refCodeCharge:"",PageNumber:"1",customerType:"",isLoading:!1,serviceTypes:[],serviceList:[],selectedCurrency:"",selectedBillingType:"",selectedBillableUnit:"",isModalRetroactive:!1,currencies:[],usageMeasurementList:[],rateArray:[],planRateId:0,monthsArray:[{name:"Jan",value:"1"},{name:"Feb",value:"2"},{name:"Mar",value:"3"},{name:"Apr",value:"4"},{name:"May",value:"5"},{name:"Jun",value:"6"},{name:"Jul",value:"7"},{name:"Aug",value:"8"},{name:"Sep",value:"9"},{name:"Oct",value:"10"},{name:"Nov",value:"11"},{name:"Dec",value:"12"}],peakHoursData:[],peakRateData:[],retroActDetail:null,previousJsonPlanListing:null,isRetroActive:!1,retroactiveData:null,isCheckedMinimiumCharge:!1,MonthApplicable:[],editEnableLimitData:{},enableLimitData:[],serviceNameList:"",isEnableMinimiumCharge:!1,addPeakHourPopupData:{serviceId:null,rIndex:null,stIndex:null,sIndex:null}}},created:async function(){var e=this;e.PlanId=parseInt(this.$route.params.id),e.GetDDLCurrencyData(),await e.GetDDLUsageMeasurement(),await e.FetchRecords()},methods:{monthNames(){return this.MonthApplicable?this.monthsArray.filter(e=>this.MonthApplicable.includes(e.value)).map(e=>e.name).join(", "):""},handleEdit(e){this.editEnableLimitData={},this.editEnableLimitData=e,this.refCodeCharge="Update",this.isEnableMinimiumCharge=!0},handleDelete(e){this.enableLimitData=[],this.isCheckedMinimiumCharge=!1},checkForEnableMinimiumCharge(e){this.isCheckedMinimiumCharge=e.target.checked,this.isEnableMinimiumCharge=this.isCheckedMinimiumCharge},deleteRateDetailsWithLimit:function(e,t){e.rateDetails.length>1&&e.rateDetails.splice(t,1)},editRetroactiveDetail:function(e){var t=this;t.retroActDetail=e,t.refCodeRetro="Update",t.isModalRetroactive=!0},addNewRateLimit:function(e,t){e.rateDetails.splice(0,0,{rateLimitId:e.rateDetails.length,startDate:"",endDate:"",limitType:"",limitFrom:"",customerRateType:"",limitTo:"",rates:[{from:1,to:1/0,rate:0}]})},openPeakHour(e,t,a,i){var s=this;s.refCode="Insert",s.addPeakHourPopupData={serviceId:e.serviceId,rIndex:t,stIndex:a,sIndex:i},s.isAddPeakHours=!0},showPeakHourType:function(e){let t=[{name:"Day",value:"1"},{name:"Month",value:"2"},{name:"Dates",value:"3"},{name:"Month with dates",value:"4"}];return t.filter(t=>t.value==e)[0].name},showSelectedPeakHourOption:function(e,t){var a=[];let i=[{name:"Monday",value:"1"},{name:"Tuesday",value:"2"},{name:"Wednesday",value:"3"},{name:"Thursday",value:"4"},{name:"Friday",value:"5"},{name:"Saturday",value:"6"},{name:"Sunday",value:"0"}],s=[{name:"Jan",value:"1"},{name:"Feb",value:"2"},{name:"Mar",value:"3"},{name:"Apr",value:"4"},{name:"May",value:"5"},{name:"Jun",value:"6"},{name:"Jul",value:"7"},{name:"Aug",value:"8"},{name:"Sep",value:"9"},{name:"Oct",value:"10"},{name:"Nov",value:"11"},{name:"Dec",value:"12"}];var r="";if(null!=t.selectedOptions&&""!=t.selectedOptions&&(r=t.selectedOptions.split(",")),null!=t.selectedOptions&&""!=t.selectedOptions&&"1"==e)return r.forEach(e=>{a.push(i.filter(t=>t.value==e)[0].name)}),a.join(", ");if(null!=t.selectedOptions&&""!=t.selectedOptions&&"2"==e)return r.forEach(e=>{a.push(s.filter(t=>t.value==e)[0].name)}),a.join(", ");if(null!=t.selectedOptions&&""!=t.selectedOptions&&"3"==e)return t.selectedOptions;if("4"==e){const e=s.filter(e=>e.value==t.fromStartMonth)[0].name,a=s.filter(e=>e.value==t.tillEndMonth)[0].name,i=t.fromStartDay+", "+e+" - "+t.tillEndDay+", "+a;return i}},editPeakRate(e,t,a,i,s){var r=this;r.peakRateData=e,r.addPeakHourPopupData={serviceId:e.serviceId,rIndex:a,stIndex:i,sIndex:s},r.refCode="Update",r.isAddPeakHours=!0,r.currentEditIndex=t},deletePeakRate(e,t){e.peakRates.splice(t,1)},handlePeakHoursDetail(e){var t=this;e.serviceId=t.addPeakHourPopupData.serviceId,t.PlanRateListing[t.addPeakHourPopupData.rIndex].serviceTypes[t.addPeakHourPopupData.stIndex].serviceList[t.addPeakHourPopupData.sIndex].peakRates.push({...e}),t.isAddPeakHours=!1},handleMinimumChargesDetail(e){var t=this;t.MonthApplicable=e.applicableForMonth,t.enableLimitData=e.limitData,t.serviceNameList=e.serviceNamesCSV,t.isEnableMinimiumCharge=!1},handleUpdatePeakHoursDetail(e,t){var a=this;t.serviceId=a.addPeakHourPopupData.serviceId,a.PlanRateListing[a.addPeakHourPopupData.rIndex].serviceTypes[a.addPeakHourPopupData.stIndex].serviceList[a.addPeakHourPopupData.sIndex].peakRates[e]={...t},a.isAddPeakHours=!1},handleRetroActiveDetail(e){this.retroactiveData=JSON.parse(e),this.isRetroActive=null!=this.retroactiveData,this.isModalRetroactive=!1,this.retroSaveData()},deleteRetroactiveDetail(){var e=this;e.retroactiveData=null},cancelRetroActiveDetail(e){this.retroSaveData()},formatDate(e){const t=new Date(e),a=String(t.getDate()).padStart(2,"0"),i=t.toLocaleString("default",{month:"long"});return`${a} ${i}`},addRateSchedule(){const e={currencyId:this.selectedCurrency||"",rateScheduleName:"New Rate Schedule",serviceTypes:[]};this.PlanRateListing.forEach(t=>{if(t.serviceTypes){const a=t.serviceTypes.map(e=>({serviceTypeName:e.serviceTypeName||"",serviceList:(e.serviceList||[]).map(e=>({...e,rates:(e.rates||[]).map(e=>({...e})),serviceInterval:e.serviceInterval||"",billingIntervalValue:e.billingIntervalValue||null}))}));e.serviceTypes.push(...a)}else console.warn("No serviceTypes found in schedule:",t)}),this.PlanRateListing.push(e)},checkForPeakHoursApplicable(e){e.isPeakHoursEnabled=!e.isPeakHoursEnabled},GetDDLUsageMeasurement:async function(){var e=this,t="id=&moduleName=&type=UNIT_OF_MEASUREMENTS&search=";await c["a"].GetDDLData(t).then(t=>{if(t.data){var a=t.data;null!=a&&(e.usageMeasurementList=t.data.DATA)}})},GetDDLCurrencyData:async function(){var e=this,t="id=&moduleName=&type=CURRENCY&search=";await c["a"].GetDDLData(t).then(t=>{if(t.data){var a=t.data;null!=a&&(e.currencies=t.data.DATA)}})},toDisplay(e){return e===1/0?"∞":e},fromDisplay(e){var t="";return t=""===e?"":"∞"===e?1/0:parseFloat(e),t},FetchRecords:async function(){var e=this;e.PlanRateListing=[],e.serviceTypes=[],e.serviceList=[],e.isLoading=!0;var t=`planId=${e.PlanId}&sortBy=${e.SortBy}&sortExp=${e.SortExp}&pagesize=${e.PageSize}&pagenumber=${e.PageNumber}`;await c["a"].GetPlanRateListing(t).then((function(t){if(""!=t.data&&null!=t.data)if(t.data.result.data.length>0){var a=t.data.result.data;e.planRateId=t.data.result.data[0].plan_rate_id,e.customerType=t.data.result.customer_type;let i="undefined"!=typeof t.data.result.RETROACTIVE_DATA&&t.data.result.RETROACTIVE_DATA.length>0?t.data.result.RETROACTIVE_DATA[0][0]:null;null!=i&&(e.retroactiveData=i,e.isRetroActive=null!=e.retroactiveData);let s="undefined"!=typeof t.data.result.ENABLE_MINIMUM_CHARGE_DATA&&t.data.result.ENABLE_MINIMUM_CHARGE_DATA.length>0?t.data.result.ENABLE_MINIMUM_CHARGE_DATA[0]:null;if(null!=s){e.MonthApplicable=s[0].type_value.split(",");const t=s.map(e=>e.service_names).join(", ");e.serviceNameList="",e.serviceNameList=t,e.enableLimitData=s,e.isCheckedMinimiumCharge=!0}e.serviceTypes=e.serviceTypes||[],e.serviceList=e.serviceList||[],a.forEach((function(t){var i=e.PlanRateListing.filter((function(e){return e.currencyId==t.currency_id}));if(0==i.length){var s={currencyId:t.currency_id,rateScheduleName:t.rate_schedule_name,serviceTypes:[]},r=a.filter((function(e){return e.currency_id==t.currency_id}));r.forEach((function(e){var a=s.serviceTypes.filter((function(t){return t.serviceTypeName===e.service_type_name}));if(0==a.length){var i=r.filter((function(t){return t.service_type_name===e.service_type_name})),l=[];i.forEach((function(e){var t=l.filter(t=>t.serviceId==e.service_id);if(0==t.length){var a,s,r={planRateId:e.plan_rate_id,planServiceId:e.plan_service_id,isPeakHoursEnabled:null!=e.peak_rates&&e.peak_rates.length>0,serviceInterval:null!=e.billing_interval?e.billing_interval:"monthly",billingIntervalValue:"1",billingType:null!=e.billing_type?e.billing_type:"FLT",billableUnit:null!==(a=e.billing_unit_id)&&void 0!==a?a:"",rateDetails:[],serviceId:e.service_id,serviceName:e.service_name,peakRates:null!==(s=e.peak_rates)&&void 0!==s?s:[]};let t=i.filter(t=>t.service_id==e.service_id);t.forEach((function(e){var a=r.rateDetails.filter(t=>t.rateLimitId==e.rate_limit_id);if(0==a.length){var i=[];t.filter(t=>{t.rate_limit_id==e.rate_limit_id&&i.push({from:null!==t.from?t.from:1,to:null!==t.to?t.to:1/0,rate:t.rate?t.rate:0})});var s={rateLimitId:e.rate_limit_id,limitType:e.limit_value_type,limitFrom:e.limit_from,limitTo:e.limit_to,customerRateType:e.customer_rate_type,startDate:e.start_date,endDate:e.end_date,rates:i};r.rateDetails.push(s)}})),l.push(r)}}));var n={serviceTypeName:e.service_type_name,meterType:t.utility_name,serviceList:l};s.serviceTypes.push(n)}})),e.PlanRateListing.push(s),e.previousJsonPlanListing=JSON.stringify(e.PlanRateListing)}})),e.isLoading=!1}else e.isLoading=!1,e.PlanRateListing=[];else e.isLoading=!1,e.PlanRateListing=[];setTimeout((function(){e.ResponsiveDataTable("tablelistingdata")}),500)}))},handleIntervalChange:function(e){switch(e.serviceInterval){case"monthly":e.billingIntervalValue="1";break;case"quarterly":e.billingIntervalValue="3";break;case"yearly":e.billingIntervalValue="12";break;default:e.billingIntervalValue="1";break}},addRow(e,t){const a=e.rates[e.rates.length-1];var i="";a.to===1/0?i=a.from:a.to>1?i=a.to+1:a.to>0&&a.to<1&&(i=a.to+.01),a.to===1/0&&(a.to=0);const s={from:i,to:1/0,rate:0};e.rates.push(s)},removeRow(e,t){e.rates.length>1&&e.rates.splice(t,1)},getJSONData(){var e=this;e.refCodeRetro="Insert",e.retroActDetail=null;const t={PlanRateListing:e.PlanRateListing.map(t=>({currencyId:107,rateScheduleName:t.rateScheduleName,serviceTypes:t.serviceTypes.map(t=>({serviceTypeName:t.serviceTypeName,serviceList:t.serviceList.map(t=>{const a=e.peakHoursData.find(e=>e.serviceId===t.service_id);return{...t,peakHoursList:a?e.peakHoursData:[]}})}))})),chargeDetails:{EnableMinimiumChargeData:e.enableLimitData,MonthApplicable:e.MonthApplicable},RetroActiveData:e.retroactiveData};return JSON.stringify(t)},retroSaveData(){var e=this;const t=e.getJSONData(),a=JSON.stringify(t),i={objData:a,planId:e.PlanId};c["a"].SavePlanRate(i).then(t=>{null!=t.data&&("Success"==t.data.Status&&"1"==t.data.Code?(e.ShowAlert(e.$t("UpdatedSuccess",[e.$t("Rate")]),"Success",!0,e.$t("Alert")),setTimeout(()=>{e.FetchRecords()},500),e.isLoading=!1):(e.ShowAlert(e.$t("ErrorWhileSaving",[e.$t("Rate")]),"danger",!0,e.$t("Alert")),e.isLoading=!1))})},handleSave(){var e=this;const t=e.getJSONData();if(e.planRateId>0){if(e.previousJsonPlanListing){const a=JSON.parse(t);delete a.RetroActiveData,a.PlanRateListing.forEach(e=>{e.serviceTypes.forEach(e=>{e.serviceList.forEach(e=>{delete e.peakHoursList})})});const i=JSON.stringify(a.PlanRateListing),s=JSON.stringify(e.previousJsonPlanListing)===JSON.stringify(i);s?e.ShowAlert("There are no changes in rates","danger",!0,e.$t("Alert")):e.isModalRetroactive=!0}}else{const a=JSON.stringify(t),i={objData:a,planId:e.PlanId};c["a"].SavePlanRate(i).then(t=>{null!=t.data&&("Success"==t.data.Status&&"1"==t.data.Code?(e.ShowAlert(e.$t("UpdatedSuccess",[e.$t("Rate")]),"Success",!0,e.$t("Alert")),setTimeout(()=>{e.FetchRecords()},500),e.isLoading=!1):(e.ShowAlert(e.$t("ErrorWhileSaving",[e.$t("Rate")]),"danger",!0,e.$t("Alert")),e.isLoading=!1))})}}}},f=p,h=a("0c7c"),y=Object(h["a"])(f,o,d,!1,null,null,null),g=y.exports,_=a("4803"),b=a("652a"),S=a("8b13"),C=a("651f"),D=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("tg-list",{ref:"tgList",attrs:{IsShowAction:!0,showCheckBox:!1,ModuleName:"Billing",SubModuleCode:"SubsidyPlan",IdentityColumn:"Id",HeaderText:"Plan Subsidy",ListData:e.SubsidyData,listType:["List"],HeaderData:e.Headers,NorecordfoundText:e.$t("NoRecordfound"),TotalRecords:e.TotalRecords,SearchFields:e.leftsearchSchema,RenderRowActionMethod:e.renderActions,ListDataCallBackFunction:e.GetSubsidyPlanData,LegendArray:e.LegendArray,SortExp:e.SortExp,SortBy:e.SortBy,HeaderButtons:e.listheaderbuttons,CurrentPageNumber:e.pageNum,widgets:[]},on:{LeftsearchButtonClick:!1,PagerButtonClick:e.pagerMethod,HeaderButtonClick:e.commonHeaderButtonClick,ActionButtonClick:e.actionButtonClick,SortdataButtonClick:e.sortdata},scopedSlots:e._u([{key:"slotdata",fn:function(t){var i=t.data;return["increasedecrease"===i.column.COLUMN_NAME?[a("div",{staticClass:"buttonsdlt ml-2",staticStyle:{float:"right","min-width":"50px"}},[1===i.row.ROWNUMBER&&null==i.row.parent?a("div",[a("a",{staticClass:"aDelete enable deleteNodeConf ml-2",attrs:{href:"javascript:;","data-original-title":"Move down"},on:{click:function(t){return e.MoveRow(i.row,i.row.ROWNUMBER-1,"down")}}},[a("em",{staticClass:"fa fa-arrow-circle-down text-dark action-icon DownDisplayOrder",staticStyle:{"font-size":"18px"}})])]):i.row.ROWNUMBER>1&&i.row.ROWNUMBER<i.row.total_records&&null==i.row.parent?a("div",[a("a",{staticClass:"aDelete enable deleteNodeConf",attrs:{href:"javascript:;","data-original-title":"Move up"},on:{click:function(t){return e.MoveRow(i.row,i.row.ROWNUMBER-1,"up")}}},[a("em",{staticClass:"fa fa-arrow-circle-up text-dark action-icon UpDisplayOrder",staticStyle:{"font-size":"18px"}})]),a("a",{staticClass:"aDelete enable deleteNodeConf ml-2",attrs:{href:"javascript:;","data-original-title":"Move down"},on:{click:function(t){return e.MoveRow(i.row,i.row.ROWNUMBER-1,"down")}}},[a("em",{staticClass:"fa fa-arrow-circle-down text-dark action-icon DownDisplayOrder",staticStyle:{"font-size":"18px"}})])]):i.row.ROWNUMBER===i.row.total_records&&null==i.row.parent?a("div",[a("a",{staticClass:"aDelete enable deleteNodeConf ml-2",attrs:{href:"javascript:;","data-original-title":"Move up"},on:{click:function(t){return e.MoveRow(i.row,i.row.ROWNUMBER-1,"up")}}},[a("em",{staticClass:"fa fa-arrow-circle-up text-dark action-icon UpDisplayOrder",staticStyle:{"font-size":"18px"}})])]):e._e()])]:e._e()]}}])}),e.IsShowPlanSubsidy?a("AddPlanMappedSubsidy",{attrs:{PlanId:e.PlanId}}):e._e(),e.isModalAddRule?a("RuleServiceUpdate",{attrs:{configurationId:e.configurationId,billingServiceId:e.billingServiceId,conditionId:e.conditionId,nodeName:e.nodeName,reqFrom:"ViewBillingConditionForService",closeModalType:"isModalAddRule"}}):e._e(),e.IsShowCondition?a("AddConditionWithSubsidy",{attrs:{selectedServiceIds:e.selectedServiceIds},on:{"conditions-selected":e.onConditionsSelected}}):e._e()],1)},A=[],I=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("div",{staticClass:"my-popups"},[a("div",{staticClass:"modal d-block"},[a("div",{staticClass:"modal-dialog modal-dialog-centered ui-draggable"},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header ui-draggable-handle py-1"},[a("h5",{staticClass:"pt-2",attrs:{name:"header"}},[e._v(" Map Subsidy Records with Plan ")]),a("button",{staticClass:"close",on:{click:e.ClosePopUp}},[a("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"heading-border mb-2"},[a("h5",{staticClass:"h5"},[a("span",[e._v(e._s(e.$t("Billing Conditions")))])])]),a("div",{staticClass:"listing"},[a("div",{staticClass:"table-responsive table-fix-header"},[a("table",{staticClass:"table table-bordered"},[e._m(0),a("tbody",[e._l(e.SubsidyList,(function(t){return[a("tr",{class:{selected_tr:e.isSubsidySelected(t.Id)}},[a("td",[e._v(e._s(t.Subsidy_Name))]),a("td",[e._v(e._s(t.Subsidy_Type))]),a("td",[e._v(e._s(t.Subsidy_Value))]),a("td",[a("span",[e._v(e._s(t.status_name))])]),a("td",{staticClass:"text-center"},[a("button",{class:["btn",e.isTypeAlreadySelected(t.Subsidy_Type)&&!e.isSubsidySelected(t.Id)?"btn-secondary":e.isSubsidySelected(t.Id)?"btn-outline-primary":"btn-primary"],attrs:{type:"button",disabled:e.isTypeAlreadySelected(t.Subsidy_Type)&&!e.isSubsidySelected(t.Id)},on:{click:function(a){return e.AddCondition(t)}}},[a("i",{staticClass:"fa fa-plus"}),e._v(" Add Conditions ")])])]),e.getConditionsBySubsidy(t.Id).length>0?a("tr",{staticClass:"bg-light"},[a("td",{attrs:{colspan:"5"}},[a("div",{staticClass:"conditions-container"},e._l(e.getConditionsBySubsidy(t.Id),(function(i,s){return a("div",{key:s,staticClass:"conditionbase"},[a("strong",[e._v("Condition:")]),e._v(" "+e._s(i.expression)+" "),a("em",{staticClass:"fa fa-times text-danger ml-3",attrs:{title:"Remove"},on:{click:function(a){return e.removeCondition(t.Id,i.conditionId)}}})])})),0)])]):e._e()]})),0==e.SubsidyList.length?a("tr",[a("td",{staticClass:"text-danger text-center border-0",attrs:{colspan:"5"}},[e._v(" "+e._s(e.$t("NorecordfoundText")))])]):e._e()],2)])])])]),a("div",{staticClass:"modal-footer"},[a("div",[a("button",{staticClass:"btn btn-success mr-2",on:{click:function(t){return e.SavePlanMappedSubsidy()}}},[a("em",{staticClass:"fa fa-save"}),e._v(" "+e._s(e.$t("Save")))]),a("button",{staticClass:"btn btn-danger",on:{click:e.ClosePopUp}},[a("em",{staticClass:"fa fa-times"}),e._v(" "+e._s(e.$t("Cancel")))])])])])])])]),e.IsShowCondition?a("AddConditionsWithPlan",{attrs:{existingConditions:e.currentSubsidyConditions},on:{"condition-selected":e.onConditionSelected}}):e._e()],1)},E=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("thead",{staticClass:"thead-bg"},[a("tr",[a("th",[e._v("Subsidy")]),a("th",[e._v("Type")]),a("th",[e._v("Value")]),a("th",[e._v("Status")]),a("th",{staticClass:"text-center"},[e._v("Conditions")])])])}],P=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("div",{staticClass:"my-popups"},[a("div",{staticClass:"modal d-block"},[a("div",{staticClass:"modal-dialog modal-dialog-centered ui-draggable"},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header ui-draggable-handle py-1"},[a("h5",{staticClass:"pt-2",attrs:{name:"header"}},[e._v(" Select Conditions ")]),a("button",{staticClass:"close",on:{click:e.ClosePopUp}},[a("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"mb-3 position-relative"},[a("em",{staticClass:"fa fa-search position-absolute text-muted",staticStyle:{left:"10px",top:"50%",transform:"translateY(-50%)"}}),a("input",{directives:[{name:"model",rawName:"v-model",value:e.searchQuery,expression:"searchQuery"}],staticClass:"form-control pl-4",attrs:{type:"text",placeholder:"Search conditions"},domProps:{value:e.searchQuery},on:{input:function(t){t.target.composing||(e.searchQuery=t.target.value)}}})]),a("ul",{staticClass:"list-group conditions-list mb-3"},[e._l(e.filteredConditions,(function(t,i){return a("li",{key:i,staticClass:"list-group-item condition-item",class:{active:e.selectedCondition&&e.selectedCondition.SERVICEID===t.SERVICEID,disabled:e.isAlreadyAdded(t.SERVICEID)},on:{click:function(a){!e.isAlreadyAdded(t.SERVICEID)&&e.selectCondition(t)}}},[a("strong",[e._v(e._s(t.SERVICENAME))]),a("br"),a("small",{staticClass:"text-muted"},[e._v(e._s(t.CONDITION))]),e.isAlreadyAdded(t.SERVICEID)?a("span",{staticClass:"badge badge-light float-right font-weight-medium p-2"},[e._v(" Added ")]):e._e()])})),0===e.filteredConditions.length?a("li",{staticClass:"list-group-item text-muted text-center"},[e._v(" No conditions found ")]):e._e()],2)]),a("div",{staticClass:"modal-footer py-2"},[a("button",{staticClass:"btn btn-secondary btn-sm",attrs:{type:"button"},on:{click:e.ClosePopUp}},[e._v(" Cancel ")]),a("button",{staticClass:"btn btn-primary btn-sm",attrs:{type:"button",disabled:!e.selectedCondition},on:{click:e.applySelectedCondition}},[e._v(" Apply Selected Condition ")])])])])])])])},T=[],R={props:{existingConditions:{type:Array,default:()=>[]}},data(){return{Searchvalue:"",ConditionsData:[],PageSize:1e3,PageNumber:1,SortBy:"",SortExp:"",TotalRecords:0,searchQuery:"",selectedCondition:null}},computed:{filteredConditions(){const e=this.searchQuery.toLowerCase();return this.ConditionsData.filter(e=>!this.existingConditions.some(t=>t.conditionId===e.SERVICEID)).filter(t=>!this.searchQuery||t.SERVICENAME&&t.SERVICENAME.toLowerCase().includes(e))}},created(){this.getConditionRecords()},methods:{ClosePopUp(){this.$parent.IsShowCondition=!1},selectCondition(e){this.selectedCondition=e},isAlreadyAdded(e){return this.existingConditions.some(t=>t.conditionId===e)},applySelectedCondition(){this.selectedCondition&&(this.$emit("condition-selected",this.selectedCondition),this.ClosePopUp())},getConditionRecords(){const e=this,t=`serviceName=&pageSize=${e.PageSize}&pageNumber=${e.PageNumber}&sortBy=${e.SortBy}&sortExp=${e.SortExp}&setupId=`;c["a"].GetBillServiceListing(t).then(t=>{t&&t.data&&t.data.length>0?(e.ConditionsData=t.data,e.TotalRecords=t.data[0].TOTALRECORDS||t.data.length):(e.ConditionsData=[],e.TotalRecords=0)})}}},N=R,M=(a("bb1a"),Object(h["a"])(N,P,T,!1,null,"73316fa6",null)),L=M.exports,k={components:{AddConditionsWithPlan:L},props:{PlanId:{type:Number,required:!0}},data:function(){return{isModalAddRule:!1,searchvalue:"",PageSize:10,PageNumber:1,SortBy:"",SortExp:"",TotalRecords:0,SubsidyList:[],selectedConditions:[],IsShowCondition:!1,selectedSubsidyIds:[],currentSubsidy:null}},computed:{currentSubsidyConditions(){return this.currentSubsidy?this.getConditionsBySubsidy(this.currentSubsidy.Id):[]}},created:function(){var e=this;e.PlanId,e.GetSubsidyMappedByPlan()},methods:{ClosePopUp(){var e=this;e.selectedSubsidyId=null,e.$parent.IsShowPlanSubsidy=!1},GetSubsidyMappedByPlan:function(){var e=this,t=`pageSize=${e.PageSize}&pageNum=${e.PageNumber}&sortBy=${e.SortBy}&sortExp=${e.SortExp}&search=${e.searchvalue}&planId=${e.PlanId}`;c["a"].GetSubsidyMappedByPlan(t).then(t=>{if(t.data){const a=JSON.parse(t.data[0]);e.SubsidyList=a.Data}e.TotalRecords=e.SubsidyList[0].total_records})},AddCondition(e){var t=this;t.currentSubsidy=e,t.IsShowCondition=!0},isTypeAlreadySelected(e){return this.selectedConditions.some(t=>{const a=this.SubsidyList.find(e=>e.Id===t.subsidyId);return a&&a.Subsidy_Type===e})},isSubsidySelected(e){return this.selectedConditions.some(t=>t.subsidyId===e)},getConditionsBySubsidy(e){return this.selectedConditions.filter(t=>t.subsidyId===e)},onConditionSelected(e){if(!this.currentSubsidy)return;const t={planId:this.PlanId,subsidyId:this.currentSubsidy.Id,conditionId:e.SERVICEID,expression:e.CONDITION},a=this.selectedConditions.some(e=>e.subsidyId===t.subsidyId&&e.conditionId===t.conditionId);a||this.selectedConditions.push(t),this.IsShowCondition=!1},removeCondition(e,t){this.selectedConditions=this.selectedConditions.filter(a=>!(a.subsidyId===e&&a.conditionId===t))},async SavePlanMappedSubsidy(){var e=this;const t=e.selectedConditions.map(t=>({planId:e.PlanId,conditionId:t.conditionId,subsidyId:t.subsidyId})),a={postString:JSON.stringify(t)};try{const t=await c["a"].AddSubsidyPlanData(a);null!=t.data&&"Success"===t.data[0]?(e.ShowAlert(e.$t("DataSavedSuccessfully"),"success",e.$t("Alert")),e.ClosePopUp(),e.$parent.GetSubsidyPlanData()):e.ShowAlert(e.$t("ErrorWhileSaving",[e.$t("Service")]),"danger",!0,e.$t("Alert"))}catch(i){console.error("Error saving subsidy plan:",i),e.ShowAlert(e.$t("ErrorWhileSaving",[e.$t("Service")]),"danger",!0,e.$t("Alert"))}finally{e.isLoading=!1}}}},x=k,B=(a("c782"),Object(h["a"])(x,I,E,!1,null,"7b601fb4",null)),O=B.exports,w=a("418c"),F=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("div",{staticClass:"my-popups"},[a("div",{staticClass:"modal d-block"},[a("div",{staticClass:"modal-dialog modal-dialog-centered ui-draggable"},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header ui-draggable-handle py-1"},[a("h5",{staticClass:"pt-2",attrs:{name:"header"}},[e._v(" Select Conditions ")]),a("button",{staticClass:"close",on:{click:e.ClosePopUp}},[a("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"mb-3 position-relative"},[a("em",{staticClass:"fa fa-search position-absolute text-muted",staticStyle:{left:"10px",top:"50%",transform:"translateY(-50%)"}}),a("input",{directives:[{name:"model",rawName:"v-model",value:e.searchQuery,expression:"searchQuery"}],staticClass:"form-control pl-4",attrs:{type:"text",placeholder:"Search conditions"},domProps:{value:e.searchQuery},on:{input:function(t){t.target.composing||(e.searchQuery=t.target.value)}}})]),a("ul",{staticClass:"list-group conditions-list mb-3"},[e._l(e.filteredConditions,(function(t,i){return a("li",{key:i,staticClass:"list-group-item condition-item",class:{active:e.isConditionSelected(t.SERVICEID)},on:{click:function(a){return e.toggleCondition(t)}}},[a("strong",[e._v(e._s(t.SERVICENAME))]),a("br"),a("small",{staticClass:"text-muted"},[e._v(e._s(t.CONDITION))]),e.isConditionSelected(t.SERVICEID)?a("span",{staticClass:"badge badge-light float-right font-weight-medium p-2"},[e._v(" Added ")]):e._e()])})),0===e.filteredConditions.length?a("li",{staticClass:"list-group-item text-center text-danger"},[e._v(" No conditions found ")]):e._e()],2)]),a("div",{staticClass:"modal-footer py-2"},[a("div",{staticClass:"row flex-row-reverse"},[a("div",{staticClass:"col-lg-12 text-right p-0"},[a("a",{staticClass:"btn btn-success mr-2",attrs:{href:"javascript:;",title:"@Resources.Save"},on:{click:e.applySelectedConditions}},[a("em",{staticClass:"fa fa-save pr-2"}),e._v("Update Conditions")]),a("a",{staticClass:"btn btn-danger",attrs:{href:"javascript:;",title:"@Resources.Cancel"},on:{click:e.ClosePopUp}},[a("em",{staticClass:"fa fa-times pr-2"}),e._v("Cancel")])])])])])])])])])},U=[],Y={props:{selectedServiceIds:{type:Array,default:()=>[]}},data(){return{ConditionsData:[],PageSize:1e3,PageNumber:1,SortBy:"",SortExp:"",TotalRecords:0,searchQuery:"",selectedConditions:[]}},computed:{filteredConditions(){const e=this.searchQuery.toLowerCase();return this.ConditionsData.filter(t=>!this.searchQuery||t.SERVICENAME&&t.SERVICENAME.toLowerCase().includes(e))}},created(){this.getConditionRecords(),this.selectedConditions=[...this.selectedServiceIds]},methods:{ClosePopUp(){this.$parent.IsShowCondition=!1},isConditionSelected(e){return this.selectedConditions.includes(parseInt(e))},toggleCondition(e){const t=parseInt(e.SERVICEID),a=this.selectedConditions.indexOf(t);-1===a?this.selectedConditions.push(t):this.selectedConditions.splice(a,1)},applySelectedConditions(){const e=this.ConditionsData.filter(e=>this.selectedConditions.includes(parseInt(e.SERVICEID)));this.$emit("conditions-selected",e),this.ClosePopUp()},getConditionRecords(){const e=this,t=`serviceName=&pageSize=${e.PageSize}&pageNumber=${e.PageNumber}&sortBy=${e.SortBy}&sortExp=${e.SortExp}&setupId=`;c["a"].GetBillServiceListing(t).then(t=>{t&&t.data&&t.data.length>0?(e.ConditionsData=t.data,e.TotalRecords=t.data[0].TOTALRECORDS||t.data.length):(e.ConditionsData=[],e.TotalRecords=0)})}}},V=Y,G=(a("97ba"),Object(h["a"])(V,F,U,!1,null,"2bf6b272",null)),q=G.exports,H={components:{AddPlanMappedSubsidy:O,RuleServiceUpdate:w["a"],AddConditionWithSubsidy:q},data(){return{noRecords:!1,IsRuleListing:!1,TotalRecords:0,serviceId:0,CurrentPage:1,PlanId:0,paymentType:"",isForService:!0,TotalPages:0,StatusListForListing:[{STATUS:"Active",STATUS_ID:1001,STATUS_COLOR:"#ffffff",STATUS_BG_COLOR:"#28a745"},{STATUS:"Inactive",STATUS_ID:1002,STATUS_COLOR:"#ffffff",STATUS_BG_COLOR:"#d72435"}],SortBy:"",SortExp:"",PageSize:"10",PageNumber:"1",GroupStart:1,GroupEnd:3,Headers:[{COLUMN_NAME:"Subsidy_Name",DATA_TYPE:"string",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Subsidy Name",DISPLAY_ORDER:1},{COLUMN_NAME:"service_name",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Condition Name",DISPLAY_ORDER:2},{COLUMN_NAME:"Subsidy_Type",DATA_TYPE:"string",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Subsidy Type",DISPLAY_ORDER:3},{COLUMN_NAME:"Subsidy_Value",DATA_TYPE:"string",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Subsidy Value",DISPLAY_ORDER:4},{COLUMN_NAME:"Effective_From",DATA_TYPE:"string",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Effective From",DISPLAY_ORDER:5},{COLUMN_NAME:"Effective_To",DATA_TYPE:"string",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Effective To",DISPLAY_ORDER:6},{COLUMN_NAME:"increasedecrease",DATA_TYPE:"string",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Move Record",DISPLAY_ORDER:6,settings:{isInSlot:!0}}],listActions:[{title:"Delete",href:"javascript:void(0)",icon:"fa fa-trash",isDisabled:!1,callbackfunction:"deleteItem",additionalSpan:""}],listheaderbuttons:[{title:"Map Subsidy",iconClass:"fa fa-plus",callbackfunction:"AddPlanSubsidy",additionalClass:"",isdisabled:!1,isvisible:!0,checkPrivilege:!1},{title:"Back",iconClass:"fa fa-arrow-left",href:"/Plan/PlanListing",additionalClass:"",isdisabled:!1,isvisible:!0,checkPrivilege:!1}],ServicePlanListing:[],isExistingService:!1,isCreateService:!1,planCode:"",serviceDetailForBillingRule:[],serviceDetailConditions:!1,serviceRuleItem:null,servicePlanId:null,IsShowPlanSubsidy:!1,searchCondition:"",SubsidyData:[],reqFrom:"fromBillingService",conditionId:0,isModalAddRule:!1,serviceDetailForBillingRule:[],nodeName:"",configurationId:"",IsShowCondition:!1,CurrentSubsidyId:null,selectedServiceIds:[],PlanMappedConditionIds:"",PlanSubsidyList:[]}},created:async function(){var e=this;e.PlanId=parseInt(this.$route.params.id),e.GetSubsidyPlanData()},methods:{AddPlanSubsidy(){var e=this;e.IsShowPlanSubsidy=!0},renderActions(e){var t=this;let a=[];return t.listActions.forEach(t=>{let i={...t};switch(i.title){case"Delete":null!=e.Subsidy_Name?i.isVisible=!0:i.isVisible=!1;break}a.push(i)}),a},GetSubsidyPlanData:function(){var e=this,t=`pageSize=${e.PageSize}&pageNum=${e.PageNumber}&sortBy=${e.SortBy}&sortExp=${e.SortExp}&search=${e.searchCondition}&PlanId=${e.PlanId}`;c["a"].GetSubsidyPlanData(t).then(t=>{if(t.data)try{const a=JSON.parse(t.data[0]);e.SubsidyData=a.Data||[],e.Headers.forEach(t=>{t.settings=null,"increasedecrease"===t.COLUMN_NAME&&(t.settings={isInSlot:!0}),"service_name"===t.COLUMN_NAME&&(t.settings={clickEvent:e.UpdateCondition})}),e.SubsidyData.length>0?(e.TotalRecords=e.SubsidyData[0].total_records||0,e.TotalPages=Math.ceil(e.TotalRecords/e.PageSize),e.CurrentPage=e.PageNumber):(e.TotalRecords=0,e.TotalPages=0,e.CurrentPage=1)}catch(a){console.error("Error parsing subsidy data:",a),e.SubsidyData=[]}else e.SubsidyData=[],e.TotalRecords=0,e.TotalPages=0}).catch(t=>{console.error("Error fetching subsidy plan data:",t),e.SubsidyData=[],e.TotalRecords=0,e.TotalPages=0})},sortdata:function(e){var t="sort tb_headerSortDown";this.SortBy=e,e===this.SortBy&&(""==this.SortExp?(this.SortExp="ASC",t="sort tb_headerSortDown"):"ASC"==this.SortExp?(this.SortExp="DESC",t="sort tb_headerSortUp"):(this.SortExp="ASC",t="sort tb_headerSortDown")),this.GetSubsidyPlanData(),$("#"+e+"  span:first-child").attr("class",t)},pagerMethod:function(e){this.pageSize=e.pageSize,this.pageNum=e.pageNum,this.GetSubsidyPlanData()},commonHeaderButtonClick:function(e){switch(e.callbackfunction){case"AddPlanSubsidy":this.AddPlanSubsidy();break}},actionButtonClick(e,t,a,i){switch(e){case"deleteItem":this.deleteItem(t);break}},deleteItem(e){var t=this;null!=e.Id&&void 0!=e.Id?t.confirmR(t.$t("ConfirmDelete"),!0,t.$t("Delete")+"  "+t.$t("Plan"),(function(){var a={PlanId:t.PlanId,SubsidyId:e.Id,ConditionId:""},i=JSON.stringify(a);c["a"].UpdatePlanMappedCondition(i).then(e=>{e.data?(t.GetSubsidyPlanData(),t.ShowAlert("Deleted Data Successfully!","Success",!0,t.$t("Alert"))):t.ShowAlert(t.$t("DeleteingRecordMsg"),"danger",t.$t("Alert"))})})):t.ShowAlert(t.$t("DeleteingRecordMsg"),"danger",t.$t("Alert"))},UpdateCondition(e){var t=this;t.IsShowCondition=!0,t.CurrentSubsidyId=e.Id,t.selectedServiceIds=e.service_id?e.service_id.split(",").map(e=>parseInt(e.trim())):[]},async onConditionsSelected(e){var t=this;const a=e.map(e=>e.SERVICEID).filter(e=>null!=e).join(",");t.PlanMappedConditionIds=a;var i={PlanId:t.PlanId,SubsidyId:t.CurrentSubsidyId,ConditionId:t.PlanMappedConditionIds},s=JSON.stringify(i);await c["a"].UpdatePlanMappedCondition(s).then(e=>{e.data?(t.IsShowCondition=!1,t.ShowAlert("Update Successfully","success",t.$t("Alert")),t.GetSubsidyPlanData()):t.ShowAlert(t.$t("ErrorWhileSaving",[t.$t("Service")]),"danger",!0,t.$t("Alert"))}),t.IsShowCondition=!1},MoveRow:function(e,t,a){const i=this,s=i.SubsidyData[t];if("up"===a&&t>0){const e=i.SubsidyData[t-1];[s.DISPLAY_ORDER,e.DISPLAY_ORDER]=[e.DISPLAY_ORDER,s.DISPLAY_ORDER],i.SubsidyData.splice(t,1),i.SubsidyData.splice(t-1,0,s),r(s,e,"up")}else if("down"===a&&t<i.SubsidyData.length-1){const e=i.SubsidyData[t+1];[s.DISPLAY_ORDER,e.DISPLAY_ORDER]=[e.DISPLAY_ORDER,s.DISPLAY_ORDER],i.SubsidyData.splice(t,1),i.SubsidyData.splice(t+1,0,s),r(s,e,"down")}function r(e,t,a){const s={COMPANY_ID:i.GetUserInfo.CompanyId,ID:e.Plan_Subsidy_Data_Id,IDC:t.Plan_Subsidy_Data_Id,DISPLAY_ORDER:e.DISPLAY_ORDER,DISPLAY_ORDER_CHANGE:t.DISPLAY_ORDER,TYPE:a};c["a"].MovePlanSubsidyDisplayOrder(s).then((function(e){"Success"===e.data.status?(i.ShowAlert(i.$t("RecordMovedSuccessfully"),"success",!0,i.$t("Alert")),i.GetSubsidyPlanData()):i.ShowAlert(e.data.msg||"Something went wrong!","error",!0,i.$t("Alert"))}))}}}},j=H,J=Object(h["a"])(j,D,A,!1,null,null,null),W=J.exports,z={components:{ServiceDetail:r["a"],InventoryDetail:l["a"],RateDetail:g,PlanDetail:n["a"],AddPlan:_["a"],BillingCycle:b["a"],EMIConfiguration:S["a"],SubscriptionRate:C["a"],PlanSubsidy:W},data(){return{activeTab:1,tabs:[{title:"Plan",displayName:this.$t("Plan"),icon:"fa fa-file-text",id:1},{title:"Services",displayName:this.$t("Services"),icon:"fa fa-file-text",id:2},{title:"Rates",displayName:this.$t("Rates"),icon:"fa fa-money",id:3},{title:"Inventory Items",displayName:this.$t("InventoryItems"),icon:"fa fa-wrench",id:4},{title:"Billing Cycle",displayName:this.$t("BillingCycle"),icon:"fa-solid fa-money-bill",id:5},{title:"EMI Configuration",displayName:this.$t("PaymentInstallmentSetttings"),icon:"fas fa-credit-card",id:6},{title:"Subsidy",displayName:"Subsidy",icon:"fas fa-credit-card",id:7}],currentTab:{title:"Plan",displayName:this.$t("Plan"),icon:"fa fa-file-text",id:1},isLoading:!1,isCheckEditPlan:!1,EditPlanDetail:[],refCode:"",refreshComponent:0,BillingTypeOptions:[],componentKey:0}},created:async function(){var e=this;await e.GetExtraFeatures(),e.PlanId=parseInt(e.$route.params.id),e.BindPlanDetails(e.PlanId)},methods:{GetExtraFeatures:async function(){var e=this,t="featureCode=GET_EXTRA_FEATURE_BILLING&outputType=list";await c["a"].CheckExtraFeatures(t).then((function(t){var a=JSON.parse(t.data);e.BillingTypeOptions=a}))},refreshPlanDetail(){this.refreshComponent++},changeTab(e){this.currentTab=e},openEditPlan:function(){var e=this;e.BindPlanDetails(e.PlanId,"Edit")},BindPlanDetails:function(e,t){var a=this,i="planId="+e;c["a"].displayPlanDetails(i).then(e=>{"Success"==e.data.status&&JSON.parse(e.data.result).data.length>0&&(a.EditPlanDetail=JSON.parse(e.data.result).data,"Edit"==t&&(a.isCheckEditPlan=!0,a.refCode="Update"))})}}},Q=z,K=Object(h["a"])(Q,i,s,!1,null,null,null);t["default"]=K.exports},"32a9":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"main-content",attrs:{id:"main-content"}},[a("div",{staticClass:"card mb-3 probx"},[a("div",{staticClass:"card-body"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-4 col-lg-3"},[a("div",{staticClass:"form-group"},[a("label",[a("b",[e._v(e._s(e.$t("UtilityType"))+": ")]),e._v(" "),"UTILITY_BILLING"==e.planDetail[0].PLAN_CODE?a("span",[e._v("Utility Billing")]):"SUBSCRIPTION_BILLING"==e.planDetail[0].PLAN_CODE?a("span",[e._v("Subscription Billing")]):e._e()])])]),"SUBSCRIPTION_BILLING"!=e.planDetail[0].PLAN_CODE?a("div",{staticClass:"col-md-4 col-lg-3"},[a("div",{staticClass:"form-group"},[a("label",[a("b",[e._v(e._s(e.$t("MeterType"))+": ")]),e._v(" "+e._s(e.planDetail[0].METER_TYPE))])])]):e._e(),"SUBSCRIPTION_BILLING"!=e.planDetail[0].PLAN_CODE?a("div",{staticClass:"col-md-4 col-lg-3"},[a("div",{staticClass:"form-group"},[a("label",[a("b",[e._v(e._s(e.$t("CustomerType"))+": ")]),e._v(" "+e._s(e.planDetail[0].CUSTOMER_SEGMENT))])])]):e._e(),a("div",{staticClass:"col-md-4 col-lg-3"},[a("div",{staticClass:"form-group"},[a("label",[a("b",[e._v(e._s(e.$t("PlanType"))+": ")]),"1"==e.planDetail[0].IS_FOR_PLAN?a("span",[e._v(" Prepaid ")]):e._e(),"2"==e.planDetail[0].IS_FOR_PLAN?a("span",[e._v(" Postpaid ")]):e._e()])])]),a("div",{staticClass:"col-md-4 col-lg-3"},[a("div",{staticClass:"form-group"},[a("label",[a("b",[e._v(e._s(e.$t("Status"))+": ")]),a("span",{class:e.getStatusClassList(e.planDetail[0].STATUS_NAME,"STATUS_NAME"),staticStyle:{float:"right"}},[e._v(" "+e._s(e.planDetail[0].STATUS_NAME)+" ")])])])]),a("div",{staticClass:"col-md-4 col-lg-3"},[a("div",{staticClass:"form-group"},[a("label",[a("b",[e._v(e._s(e.$t("PlanName"))+": ")]),e._v(" "+e._s(e.planDetail[0].PLAN_NAME)+" ")])])]),"SUBSCRIPTION_BILLING"==e.planDetail[0].PLAN_CODE?a("div",{staticClass:"col-md-4 col-lg-3"},[a("div",{staticClass:"form-group"},[a("label",[a("b",[e._v(e._s(e.$t("BillingFrequency"))+": ")]),e._v(" "),"One Time"==e.planDetail[0].PAYMENT_TYPE?a("span",[e._v("One Time")]):a("span",[e._v(e._s(e.planDetail[0].PAYMENT_TYPE))])])])]):e._e(),e.parsedFrequencies.length&&"SUBSCRIPTION_BILLING"==e.planDetail[0].PLAN_CODE?a("div",{staticClass:"col-md-4 col-lg-3"},[a("div",{staticClass:"form-group"},[a("label",[a("b",[e._v(e._s(e.$t("Additional Frequency with Discount"))+":")])]),a("span",[e._v(" "+e._s(e.frequencyLabels.join(", "))+" ")])])]):e._e(),a("div",{staticClass:"col-md-4 col-lg-3"},[a("div",{staticClass:"form-group"},[a("label",[a("b",[e._v(e._s(e.$t("InvoiceTemplate"))+": ")]),e._v(" "+e._s(e.planDetail[0].INVOICE_TEMPLATE))])])]),a("div",{staticClass:"col-md-4 col-lg-3"},[a("div",{staticClass:"form-group"},[a("label",[a("b",[e._v(e._s(e.$t("EffectiveDate"))+":")]),e._v(" "+e._s(null!=e.planDetail[0].EFFECTIVE_DATE?e.$d(e.planDetail[0].EFFECTIVE_DATE):""))])])]),a("div",{staticClass:"col-md-4 col-lg-3"},[a("div",{staticClass:"form-group"},[a("label",[a("b",[e._v(e._s(e.$t("ExpirationDate"))+":")]),e._v(" "+e._s(null!=e.planDetail[0].EXPIRATION_DATE?e.$d(e.planDetail[0].EXPIRATION_DATE):""))])])]),a("div",{staticClass:"col-md-4 col-lg-3"},[a("div",{staticClass:"form-group"},[a("label",[a("b",[e._v(e._s(e.$t("DESCRIPTION"))+":")]),e._v(" "+e._s(e.planDetail[0].PLAN_DESCRIPTION))])])]),e.planDetail[0].no_of_plan?a("div",{staticClass:"col-md-4 col-lg-3"},[a("div",{staticClass:"form-group"},[a("label",[a("b",[e._v(e._s(e.$t("Days"))+":")]),e._v(" "+e._s(e.planDetail[0].no_of_plan))])])]):e._e()])])])])},s=[],r=a("9769"),l={data(){return{planDetail:[]}},created:function(){var e=this;e.PlanId=parseInt(this.$route.params.id),e.displayPlanDetails()},computed:{parsedFrequencies(){try{var e;const t=null===(e=this.planDetail[0])||void 0===e?void 0:e.ADDITIONAL_FREQUENCY;if(!t)return[];const a=`[${t}]`;return JSON.parse(a)}catch(t){return console.error("Error parsing ADDITIONAL_FREQUENCY:",t),[]}},frequencyLabels(){return this.parsedFrequencies.map(e=>`${e.frequency} (${Number(e.discount)}%)`)}},methods:{displayPlanDetails:function(){var e=this,t="planId="+e.PlanId;r["a"].displayPlanDetails(t).then(t=>{"Success"==t.data.status&&JSON.parse(t.data.result).data.length>0&&(e.planDetail=JSON.parse(t.data.result).data,e.planDetail.forEach(e=>{["EFFECTIVE_DATE","EXPIRATION_DATE"].forEach(t=>{e[t]&&(e[t]=new Date(e[t]))})}))})},getStatusClassList:function(e){var t="";switch(e){case"UnPublish":t="px-2 text-center bg-danger text-white d-block";break;case"Active":t="px-2 text-center bg-success text-white d-block";break;case"Published":t="px-2 bg-primary text-center text-white d-block";break;case"Draft":t="px-2 text-center bg-warning text-white d-block";break;case"Inactive":t="px-2 text-center bg-danger text-white d-block";break;default:t=""}return t}}},n=l,o=a("0c7c"),d=Object(o["a"])(n,i,s,!1,null,null,null);t["a"]=d.exports},3764:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("div",{staticClass:"col-md-12 p-0 pt-2"},[a("div",{staticClass:"ticketsmallfix theme-primary partition p-actions-expand"},[a("span",{staticClass:"p-name text-white"},[e._v(e._s(e.$t("Services")))]),a("span",{staticClass:"p-actions float-right"},[a("a",{staticClass:"p-action-btn text-white",attrs:{href:"javascript:;"},on:{click:function(t){return e.openExistingService()}}},[a("em",{staticClass:"fa fa fa-check"}),a("br"),e._v(e._s(e.$t("SelectService")))]),a("a",{staticClass:"p-action-btn text-white",attrs:{href:"javascript:;"},on:{click:function(t){return e.openCreateService()}}},[a("em",{staticClass:"fa fa fa-plus"}),a("br"),e._v(e._s(e.$t("CreateService")))]),a("router-link",{staticClass:"p-action-btn text-white",attrs:{to:"/Plan/PlanListing"}},[a("em",{staticClass:"fa fa-angle-double-left"}),a("br"),e._v(e._s(e.$t("BacktoList")))])],1)])]),a("div",{staticClass:"listing mt-2"},[a("div",{staticClass:"table-responsive table-fix-header"},[a("table",{staticClass:"table table-bordered mt-0"},[a("thead",{staticClass:"thead-bg"},[a("tr",[e._l(e.Headers,(function(t){return e.shouldHideColumn(t)?e._e():a("th",{key:t.COLUMN_NAME},[e._v(" "+e._s(t.DISPLAY_NAME)+" ")])})),a("th",{staticClass:"text-center"},[e._v(e._s(e.$t("Action")))])],2)]),a("tbody",[e._l(e.ServicePlanListing,(function(t){return[a("tr",[a("td",[e._v(e._s(t.service_name))]),a("td",[e._v(e._s(t.service_code))]),"SUBSCRIPTION_BILLING"!=e.planCode?a("td",[e._v(e._s(t.usage_measurement))]):e._e(),"SUBSCRIPTION_BILLING"!=e.planCode?a("td",[null!=t.RuleDetails?a("span",[a("a",{attrs:{href:"javascript:;",title:t.RuleDetails[0].billing_config_name},on:{click:function(a){return e.OpenRuleDetail(t)}}},[a("i",{attrs:{"aria-hidden":"true"}}),e._v(" "+e._s(t.RuleDetails[0].billing_config_name)+" ")])]):a("span",[e._v(" --")])]):e._e(),a("td",{staticClass:"single-action text-center",staticStyle:{"max-width":"100px",width:"100px"}},[a("div",{staticClass:"d-flex content-justify-between"},["SUBSCRIPTION_BILLING"!=e.planCode?a("a",{staticClass:"actions-onclick",attrs:{title:"Map Rule"},on:{click:function(a){return e.MapBillingRule(t.plan_service_id,t.service_id)}}},[a("em",{staticClass:"fa fa-plus text-success "})]):e._e(),a("a",{staticClass:"actions-onclick",attrs:{href:"javascript:;"},on:{click:function(a){return e.DeleteServiceData(t.plan_service_id)}}},[a("em",{staticClass:"fa fa-trash-o text-danger action-icon"})])])])]),1==t.isRuleView?a("tr",[a("td",{attrs:{colspan:e.Headers.length+2}},[a("div",{staticClass:"listing"},[a("div",{staticClass:"table-responsive table-fix-header"},[a("table",{staticClass:"table table-bordered mt-0"},[a("thead",{staticClass:"thead-bg"},[a("tr",[a("th",[e._v(e._s(e.$t("Rule_Name")))]),a("th",[e._v(e._s(e.$t("PRODUCT_TYPE_DESC")))]),a("th",[e._v(e._s(e.$t("EfficativeDateFrom")))]),a("th",[e._v(e._s(e.$t("EfficativeDateTo")))]),a("th",[e._v(e._s(e.$t("ServiceName")))]),a("th",[e._v(e._s(e.$t("payment_type")))]),a("th",[e._v(e._s(e.$t("Created_by_Id")))]),a("th",[e._v(e._s(e.$t("CREATED_ON")))]),a("th",[e._v(e._s(e.$t("Action")))])])]),a("tbody",[e._l(t.RuleDetails,(function(t,i){return a("tr",{key:i},[a("td",[e._v(e._s(t.billing_config_name))]),a("td",[e._v(e._s(t.description))]),a("td",[e._v(e._s(e.$options.filters.formatDate(t.efficative_date_from))+" ")]),a("td",[e._v(e._s(e.$options.filters.formatDate(t.efficative_date_to))+" ")]),a("td",[e._v(e._s(t.service_name))]),a("td",[e._v(e._s(t.payment_type))]),a("td",[e._v(e._s(t.created_by))]),a("td",[e._v(e._s(e.$options.filters.formatDate(t.created_at)))]),a("td",{staticClass:"single-action text-center",staticStyle:{width:"150px"}},[a("a",{staticClass:"actions-onclick",attrs:{href:"javascript:;"},on:{click:function(a){return e.ViewRuleData(t)}}},[a("em",{staticClass:"fa fa-eye text-info action-icon"})]),a("a",{staticClass:"actions-onclick",attrs:{href:"javascript:;"},on:{click:function(a){return e.DeleteRuleData(t.id)}}},[a("em",{staticClass:"fa fa-trash-o text-danger action-icon"})])])])})),0==t.RuleDetails.length?a("tr",[a("td",{staticClass:"text-center text-danger",attrs:{colspan:"9"}},[e._v(" "+e._s(e.$t("NorecordfoundText")))])]):e._e()],2)])])])])]):e._e()]})),0==e.ServicePlanListing.length?a("tr",[a("td",{staticClass:"text-center text-danger",attrs:{colspan:e.Headers.length+2}},[e._v(" "+e._s(e.$t("NorecordfoundText")))])]):e._e()],2)])])]),e.isExistingService?a("ModalExistingService",{attrs:{callbackfunction:e.FetchRecords,PlanId:e.PlanId,planCode:e.planCode,paymentType:e.paymentType}}):e._e(),e.isCreateService?a("AddNewService",{attrs:{callbackfunction:e.FetchRecords,PlanId:e.PlanId,isForService:e.isForService,planCode:e.planCode,billingTypeOptions:e.billingTypeOptions,serviceId:e.serviceId,paymentType:e.paymentType}}):e._e(),e.serviceDetailConditions?a("ServiceRuleCondition",{attrs:{serviceRuleItem:e.serviceRuleItem,serviceDetailForBillingRule:e.serviceDetailForBillingRule},on:{close:function(t){e.serviceDetailConditions=!1}}}):e._e(),e.IsRuleListing?a("ModalBillingRuleListing",{attrs:{servicePlanId:e.servicePlanId,serviceId:e.serviceId}}):e._e(),e.isModalBillingConfiguration?a("ModalManageBillingConfiguration",{attrs:{serviceId:e.serviceId,reqType:"fromServiceMapping",configurationId:e.configurationId}}):e._e()],1)},s=[],r=(a("14d9"),a("6b09")),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("div",{staticClass:"my-popups"},[a("div",{staticClass:"modal d-block"},[a("div",{staticClass:"modal-dialog modal-dialog-centered ui-draggable"},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header ui-draggable-handle py-1"},[a("h5",{staticClass:"pt-2",attrs:{name:"header"}},[e._v(" "+e._s(e.$t("Services"))+" ")]),a("button",{staticClass:"close",on:{click:e.ClosePopUp}},[a("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"listing"},[a("div",{staticClass:"table-responsive table-fix-header",staticStyle:{"max-height":"500px"}},[a("table",{staticClass:"table table-bordered dt-responsive nowrap mt-0"},[a("thead",{staticClass:"thead-bg"},[a("tr",{staticClass:"text-capitalize"},[a("th",{staticClass:"text-center",staticStyle:{width:"5%"}},[a("label",{staticClass:"form-check form-check-inline"},[a("div",{staticClass:"custom-control custom-checkbox custom-control-inline"},[a("input",{staticClass:"chkitems1 custom-control-input",attrs:{type:"checkbox",id:"talygenServicesCheckAll",name:"selectedItems1"},domProps:{checked:e.selectAll},on:{change:e.selectAllItems}}),a("label",{staticClass:"custom-control-label",attrs:{for:"talygenServicesCheckAll"}})])])]),a("th",{attrs:{scope:"col"}},[e._v(e._s(e.$t("ServiceName")))]),a("th",{staticClass:"text-center",attrs:{scope:"col"}},[e._v(e._s(e.$t("ServiceType")))]),"SUBSCRIPTION_BILLING"!=e.planCode?a("th",{staticClass:"text-center",attrs:{scope:"col"}},[e._v(e._s(e.$t("UsageMeasurement")))]):e._e()])]),a("tbody",[0===e.ServiceListing.length?a("tr",[a("td",{staticClass:"text-center text-danger no-record",attrs:{colspan:"4"}},[e._v(" "+e._s(e.$t("NoRecordfound"))+" ")])]):e._l(e.ServiceListing,(function(t,i){return a("tr",{key:i},[a("td",{staticClass:"text-center"},[a("label",{staticClass:"form-check form-check-inline"},[a("div",{staticClass:"custom-control custom-checkbox custom-control-inline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedItems,expression:"selectedItems"}],staticClass:"chkitems custom-control-input",attrs:{type:"checkbox",id:"tabletablebordered"+i,name:"selectedItems",disabled:1002===t.status_id},domProps:{value:t.service_id,checked:Array.isArray(e.selectedItems)?e._i(e.selectedItems,t.service_id)>-1:e.selectedItems},on:{change:[function(a){var i=e.selectedItems,s=a.target,r=!!s.checked;if(Array.isArray(i)){var l=t.service_id,n=e._i(i,l);s.checked?n<0&&(e.selectedItems=i.concat([l])):n>-1&&(e.selectedItems=i.slice(0,n).concat(i.slice(n+1)))}else e.selectedItems=r},e.updateSelectAll]}}),a("label",{staticClass:"custom-control-label",attrs:{for:"tabletablebordered"+i}})])])]),a("td",[e._v(e._s(t.service_name))]),a("td",{staticClass:"text-center"},[e._v(e._s(t.service_code))]),"SUBSCRIPTION_BILLING"!=e.planCode?a("td",{staticClass:"text-center"},[e._v(e._s(t.usage_measurement))]):e._e()])}))],2)])])])]),a("div",{staticClass:"modal-footer"},[a("a",{staticClass:"btn btn-success save-btn mr-2",attrs:{href:"javascript:;",title:"Save"},on:{click:e.SaveData}},[a("i",{staticClass:"fa fa-floppy-o pr-2"}),e._v(e._s(e.$t("Save"))+" ")]),a("a",{staticClass:"btn btn-danger delete-btn",attrs:{href:"javascript:;",title:"Cancel"},on:{click:e.ClosePopUp}},[a("i",{staticClass:"fa fa-times pr-2"}),e._v(e._s(e.$t("Cancel"))+" ")])])])])])])])},n=[],o=a("9769"),d={props:{callbackfunction:{type:Function},PlanId:{type:Number,required:!1},planCode:{type:String,required:!1},paymentType:{type:String,required:!1}},data(){return{isLoading:!1,ServiceListing:[],selectedItems:[],selectAll:!1,noRecord:!1,CurrentPage:1,TotalPages:0,TotalRecords:0,SortBy:"",SortExp:"",PageSize:"10",GroupStart:1,GroupEnd:3,PageNumber:"1"}},async created(){await this.GetServiceList()},methods:{async GetServiceList(){var e=this;e.isLoading=!0;const t=`pagesize=${e.PageSize}&pagenumber=${e.PageNumber}&plan_id=${e.PlanId}&sortBy=${e.SortBy}&sortExp=${e.SortExp}&planCode=${e.planCode}&search=`;await o["a"].GetServiceListing(t).then(t=>{(t.data.Status="Success")&&(""!=t.data&&null!=t.data&&t.data.result.data.length>0?(e.ServiceListing=t.data.result.data,"One Time"==e.paymentType&&(e.ServiceListing=e.ServiceListing.filter(e=>"Order Based"!==e.service_code&&"Recurring"!==e.service_code&&"Recurring Arrears"!==e.service_code&&"Usage Based"!==e.service_code)),e.TotalRecords=t.data.result.data[0].TOTALRECORDS,e.noRecord=!1):(e.noRecord=!0,e.TotalRecords=0,e.ServiceListing=[]))})},selectAllItems(){var e=this;this.selectAll=!this.selectAll,this.selectAll?this.ServiceListing.forEach((function(t){e.selectedItems.push(t.service_id)})):this.selectedItems=[]},updateSelectAll(){var e=this;const t=this.ServiceListing.length,a=this.selectedItems.length;e.selectAll=t>0&&a===t},async SaveData(){var e=this;const t=e.ServiceListing.filter(e=>this.selectedItems.includes(e.service_id)),a=JSON.stringify(t);var i={objData:a,planId:e.PlanId};await o["a"].AddSelectedService(i).then(t=>{null!=t.data&&("Success"==t.data.Status&&"1"==t.data.Code?(e.ShowAlert(e.$t("AddedSuccess",[e.$t("Service")]),"Success",!0,e.$t("Alert")),e.ClosePopUp(),e.callbackfunction(),e.isLoading=!1):"Success"==t.data.Status&&"-1"==t.data.Code?(this.ShowAlert(this.$t("AlreadyExists",[this.$t("Service")]),"failure",!0,this.$t("Alert")),e.ClosePopUp()):(e.ShowAlert(e.$t("ErrorWhileSaving",[e.$t("Service")]),"danger",!0,e.$t("Alert")),e.isLoading=!1))})},ClosePopUp(){this.$parent.isExistingService=!1}}},c=d,u=a("0c7c"),m=Object(u["a"])(c,l,n,!1,null,null,null),v=m.exports,p=a("9154"),f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"my-popups"},[a("loader",{attrs:{"is-visible":e.isLoading}}),a("div",{staticClass:"modal d-block"},[a("div",{staticClass:"modal-dialog modal-dialog-centered"},[a("div",{staticClass:"modal-content pt-0",attrs:{id:"content"}},[a("div",{staticClass:"modal-header theme-primary partition-full  d-flex"},[a("h4",{staticClass:"modal-title"},[e._v(e._s(e.$t("ManageBillingRule")))]),a("button",{staticClass:"close",attrs:{type:"button"},on:{click:e.Close}},[a("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"theme-primary partition p-actions-expand"},[a("span",{staticClass:"p-actions float-right"},[a("a",{staticClass:"p-action-btn text-white",attrs:{title:"",id:"AddBillingRules",href:"javascript:;","data-toggle-tooltip":"tooltip","data-original-title":"Add Billing Rule"},on:{click:function(t){return e.commonHeaderButtonClick("AddBillingRule")}}},[a("em",{staticClass:" fa fa-plus pr-2"}),e._v(" "),a("br"),e._v(e._s(e.$t("AddBillingRule"))+" ")])])]),a("div",{staticClass:"listing mt-2"},[a("div",{staticClass:"table-responsive table-fix-header"},[a("table",{staticClass:"table table-bordered"},[a("thead",{staticClass:"thead-bg"},[a("tr",[a("th",{staticStyle:{width:"20px"}}),e._l(e.Headers,(function(t){return a("th",{key:t.COLUMN_NAME},[e._v(" "+e._s(t.DISPLAY_NAME)+" ")])})),a("th",{staticClass:"text-center"},[e._v(e._s(e.$t("View")))])],2)]),a("tbody",[0===e.BillingRuleData.length?a("tr",[a("td",{staticClass:"text-center text-danger",attrs:{colspan:"8"}},[e._v(e._s(e.$t("NoRecordfound")))])]):e._e(),e._l(e.BillingRuleData,(function(t,i){return a("tr",{key:i},[a("td",[a("div",{staticClass:"custom-control custom-radio custom-control-inline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.ConditionSelected,expression:"ConditionSelected"}],staticClass:"custom-control-input",attrs:{type:"radio",name:"RadioForCondition",id:"RadioForCondition"+t.CONFIGURATION_ID},domProps:{value:t.CONFIGURATION_ID,checked:e._q(e.ConditionSelected,t.CONFIGURATION_ID)},on:{change:function(a){e.ConditionSelected=t.CONFIGURATION_ID}}}),a("label",{staticClass:"custom-control-label",attrs:{for:"RadioForCondition"+t.CONFIGURATION_ID}},[e._v(" "+e._s(t.CONFIGURATION_NAME)+" ")])])]),a("td",[e._v(e._s(t.RULE_NAME))]),a("td",[e._v(e._s(t.SERVICE_NAME))]),a("td",[e._v(e._s(t.STATENAME))]),a("td",[e._v(e._s(null!=t.EFFICATIVE_DATE_FROM?e.$d(t.EFFICATIVE_DATE_FROM):"--"))]),a("td",[e._v(e._s(null!=t.EFFICATIVE_DATE_TO?e.$d(t.EFFICATIVE_DATE_TO):"--"))]),a("td",[e._v(e._s(t.CREATED_BY_NAME))]),a("td",{staticClass:"text-center single-action"},[a("a",{attrs:{title:"View Details"},on:{click:function(a){return e.BindModelChart(t)}}},[a("em",{staticClass:"fa fa-eye text-info"})])])])}))],2)])]),a("Pager",{attrs:{numberofrecords:e.TotalRecords,prevText:e.$t("Previous"),nextText:e.$t("Next"),callbackfunction:e.FetchData,firstText:e.$t("First"),lastText:e.$t("Last")},on:{SetCurrentPage:e.SetCurrentPage}})],1),a("div",{staticClass:"my-popups"},[a("loader",{attrs:{"is-visible":e.isLoading}}),e.isCloneModel?a("div",{staticClass:"modal d-block"},[a("div",{staticClass:"modal-dialog modal-dialog-centered"},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header theme-primary partition-full d-flex justify-content-between align-items-center"},[a("h5",{staticClass:"modal-title"},[e._v(" "+e._s("CloneRule")+" ")]),a("button",{staticClass:"close",attrs:{type:"button"},on:{click:e.CloseCloneModel}},[a("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),a("div",{staticClass:"modal-body"},[a("dynamic-form",{ref:"validatePlan",attrs:{lang:"en",buttons:e.buttons,schema:e.FormSchema,mandatorytext:e.$t("MandatoryString")}})],1)])])]):e._e()],1)]),a("div",{staticClass:"modal-footer"},[a("a",{staticClass:"btn btn-primary save-btn mr-2",attrs:{href:"javascript:;",type:"submit",title:"Save"},on:{click:function(t){return e.SaveMapRuleData()}}},[a("em",{staticClass:"fa fa-save pr-2",attrs:{"aria-hidden":"true"}}),a("span",[e._v(e._s(e.$t("Save")))])]),a("a",{staticClass:"btn btn-primary delete-btn",attrs:{href:"javascript:;",type:"submit",title:"Cancel"},on:{click:e.Close}},[a("em",{staticClass:"fa fa-times pr-2",attrs:{"aria-hidden":"true"}}),a("span",[e._v(e._s(e.$t("Cancel")))])])])])])]),e.modelopen?a("VerticalFlowChartModel",{attrs:{modelDetail:e.modelDetail}}):e._e(),e.isModalBillingConfiguration?a("ModalManageBillingConfiguration",{attrs:{serviceId:e.serviceId,reqType:"fromServiceMapping"}}):e._e()],1)},h=[];let y=[{id:"AddBillingRules",title:"AddBillingRule",iconClass:"fa-plus",callbackfunction:"AddBillingRule",additionalClass:"",isdisabled:!1,isvisible:!0,checkPrivilage:!0}],g=[{title:"CloneRule",callbackfunction:"CloneRule",icon:"fa fa-copy",additionalSpan:"",isDisabled:!1,isvisible:!0},{title:"View",callbackfunction:"ViewBillingRule",icon:"fa fa-eye text-success",additionalSpan:"",isDisabled:!1,isvisible:!0},{title:"Edit",callbackfunction:"CloneService",href:"javascript:void(0)",icon:"fa fa-pencil text-success",additionalSpan:"",isDisabled:!1,isvisible:!0},{title:"ViewHistory",callbackfunction:"CloneService",href:"javascript:void(0)",icon:"fa fa-history text-danger",additionalSpan:"",isDisabled:!1,isvisible:!0}];var _={buttons:y,listActions:g},b=a("4555"),S=a("b91c"),C=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("div",{staticClass:"my-popups"},[a("div",{staticClass:"modal d-block"},[a("div",{staticClass:"modal-dialog modal-dialog-centered ui-draggable",staticStyle:{"max-width":"1400px !important"}},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header ui-draggable-handle py-1"},[a("h5",{staticClass:"pt-2",attrs:{name:"header"}},[e._v(" "+e._s(e.$t("Configuration"))+" ")]),a("button",{staticClass:"close",on:{click:e.ClosePopUp}},[a("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),a("div",{staticClass:"modal-body"},[a("ManageConfiguration",{attrs:{serviceId:e.serviceId,reqType:e.reqType,configurationId:e.configurationId}})],1),a("div",{staticClass:"modal-footer"})])])])])])},D=[],A=a("568d"),I={components:{ManageConfiguration:A["default"]},props:{serviceId:{type:String,required:!1},reqType:{type:String,required:!1},configurationId:{type:String,required:!1}},methods:{ClosePopUp(){this.$parent.isModalBillingConfiguration=!1,this.$parent.FetchData()}}},E=I,P=Object(u["a"])(E,C,D,!1,null,null,null),T=P.exports,R={components:{Pager:b["a"],VerticalFlowChartModel:S["a"],ModalManageBillingConfiguration:T},props:{servicePlanId:{type:Object,required:!0},serviceId:{type:Object,required:!0}},data(){return{isModalBillingConfiguration:!1,isLoading:!1,modelopen:!1,ConditionSelected:0,BillingRuleData:[],isCloneModel:!1,listActions:_.listActions,listheaderbuttons:_.buttons,cloneItem:[],leftSearchFields:[{fieldName:"Search",fieldType:"text",fieldSearchConditionName:[""],paramName:"tagname",isSearch:!0,value:"",listOptions:[]}],StatusListForListing:[{STATUS:"Active",STATUS_ID:1001,STATUS_COLOR:"#ffffff",STATUS_BG_COLOR:"#28a745"},{STATUS:"Inactive",STATUS_ID:1002,STATUS_COLOR:"#ffffff",STATUS_BG_COLOR:"#d72435"}],Headers:[{COLUMN_NAME:"RULE_NAME",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:this.$t("BillingRuleName"),DISPLAY_ORDER:1},{COLUMN_NAME:"ServiceName",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("ServiceName"),DISPLAY_ORDER:5},{COLUMN_NAME:"STATENAME",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("STATE"),DISPLAY_ORDER:5},{COLUMN_NAME:"EFFICATIVE_DATE_FROM",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:this.$t("EffectiveFrom"),DISPLAY_ORDER:6},{COLUMN_NAME:"EFFICATIVE_DATE_TO",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:this.$t("EffectiveTo"),DISPLAY_ORDER:7},{COLUMN_NAME:"CREATED_BY_NAME",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("CreatedBy"),DISPLAY_ORDER:9}],FormSchema:[{layoutType:"double",Data:[{astype:"TextField",label:this.$t("RuleName"),name:"RuleName",palceholder:"Rule Name",value:"",validationRules:{required:!0},disabled:!1},{astype:"SelectField",label:this.$t("CompanyName"),name:"CompanyName",value:"",placeholder:"Select",config:{options:[]},validationRules:{required:!0}},{astype:"DateField",label:this.$t("EffectiveFrom"),name:"Effectivefrom",value:(new Date).toLocaleDateString(),placeholder:"",config:{format:"MM/DD/YYYY",minDate:new Date,onChange:this.setTimerDate,maxDate:!1},validationRules:{required:!0}},{astype:"DateField",label:this.$t("EffectiveTo"),name:"Effectiveto",value:new Date("12/31/2099").toLocaleDateString(),placeholder:"",config:{format:"MM/DD/YYYY",minDate:new Date,onChange:this.setTimerDate,maxDate:!1},validationRules:{required:!1}},{astype:"RadioField",label:this.$t("Is Rule Applicable to All Utilities"),name:"allutilities",value:"0",config:{options:[{value:"1",name:"Yes"},{value:"0",name:"No"}],onChange:this.Ddlutilitys},validationRules:{required:!1,max:100}},{astype:"SelectField",label:this.$t("Contract Name"),name:"ContractName",value:"",placeholder:"Select",config:{options:[],onChange:this.GetUtility},validationRules:{required:!0}},{astype:"MultiSelectField",label:this.$t("Utility Name"),name:"UtilityName:",value:"",placeholder:"Select",visibility:!0,config:{options:[{name:"select",value:1}]},validationRules:{required:!0}}]}],buttons:[{type:"submit",class:"btn btn-success",text:"<i class='fa fa-save pr-2'></i>Save",onClick:this.CreateClone},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Cancel",onClick:this.CloseCloneModel}],leftSearchFields:_.leftsearchSchema,searchByName:"",searchByClientName:"",utilities:"",searchByState:[],SortBy:"",SortExp:"",noRecords:"",PageSize:"10",PageNumber:"1",TotalRecords:0,CurrentPage:1,TotalPages:0,searchCondition:"",ListingData:[],modelDetail:[]}},created:async function(){var e=this;e.FetchData(),e.GetCompanylist(),e.GetGroupList()},methods:{BindModelChart(e){var t=this;t.modelopen=!0,t.modelDetail=e},FetchData:async function(){var e=this;const t=`searchByName=${e.searchByName}&searchByClientName=${e.searchByClientName}&utilities=${e.utilities}&searchByState=${e.searchByState}&sortBy=${e.SortBy}&sortExp=${e.SortExp}&pageSize=${e.PageSize}&pageNumber=${e.PageNumber}&Plan_service_id=${e.servicePlanId}`;try{const a=await o["a"].GetBillingRuleList(t);a.data&&a.data.length>0?(e.Headers.forEach(e=>{e.settings=null,["EFFICATIVE_DATE_FROM","EFFICATIVE_DATE_TO","STATUS_ID"].includes(e.COLUMN_NAME)&&(e.settings={isInSlot:!0})}),a.data.forEach(e=>{["EFFICATIVE_DATE_FROM","EFFICATIVE_DATE_TO"].forEach(t=>{e[t]&&(e[t]=new Date(e[t]))})}),e.BillingRuleData=a.data,e.TotalRecords=a.data[0].TOTAL_RECORDS,e.TotalPages=Math.ceil(e.TotalRecords/e.PageSize),e.CurrentPage=e.PageNumber,e.noRecords=!1):(e.BillingRuleData=[],e.TotalRecords=0,e.noRecords=!0)}catch(a){console.error("Error fetching data:",a)}},SetCurrentPage:function(e){this.PageNumber=e.PageNumber,this.PageSize=e.PageSize},getConditionRecords:function(e,t){var a=this;null!=a.BillingRuleData&&(a.BillingRuleData.forEach((function(e){e.isLeafChecked=!1,e.showPopup=!1,e.rateCode="",e.selectedFlag={value:"grey",color:"grey"}})),a.conditions=a.BillingRuleData,a.TotalRecords=a.conditions[0].TOTALRECORDS)},GetUtility(){var e=this,t=e.cloneItem.CONFIGURATION_ID,a=e.$refs.validatePlan.getPropertyValue("ContractName","value"),i=`clientId=${a}&configId=${t}&reqFrom=&clientsIds=`;o["a"].GetDdlUtility(i).then(t=>{""!=t.data&&(result=t.data,result.forEach(t=>{let a={name:t.UTILITY_NAME,value:t.UTILITY_ID};e.FormSchema[0].Data[6].config.options.push(a)}))})},CreateClone:async function(){var e=this;const t=await e.$refs.validatePlan.validateForm.validate();if(!t)return void(this.isLoading=!1);var a=e.cloneItem.CONFIGURATION_ID,i=e.cloneItem.SERVICE_ID,s=e.$refs.validatePlan.getPropertyValue("RuleName","value"),r=e.$refs.validatePlan.getPropertyValue("CompanyName","value"),l=e.$refs.validatePlan.getPropertyValue("Effectivefrom","value"),n=e.$refs.validatePlan.getPropertyValue("Effectiveto","value"),d=e.$refs.validatePlan.getPropertyValue("ContractName","value"),c=e.$refs.validatePlan.getPropertyValue("allutilities","value"),u=e.$refs.validatePlan.getPropertyValue("UtilityName","value");const m={Id:a,ServiceId:i,Client_Id:d,RuleName:s,CompanyName:r,EffectiveFrom:l,EffectiveTo:n,ContractName:d,isRuleApplication:c,SelectedUtility:u};var v=JSON.stringify(m);await o["a"].CreateRuleClone(v).then(t=>{""!=t.data&&(0==t.data?(this.ShowAlert(this.$t("AddedSuccess",[this.$t("Clone")]),"Success",!0,this.$t("Alert")),e.FetchData(),e.cloneItem=[],e.CloseCloneModel()):this.ShowAlert(this.$t("ErrorWhileSaving",[this.$t("Clone")]),"danger",!0,this.$t("Alert")))})},Ddlutilitys(){var e=this.$refs.validatePlan.getPropertyValue("allutilities","value");switch(e){case"1":this.FormSchema[0].Data[6].visibility=!1;break;default:this.FormSchema[0].Data[6].visibility=!0}},setTimerDate:function(e,t,a){var i=this;"Effectivefrom"==t.name&&(i.$refs.validatePlan.updateProperty("Effectivefrom","config.minDate",e),i.$refs.validatePlan.UpdateKeyValue())},GetCompanylist(){var e=this;o["a"].GetDdlCompanyList().then(t=>{""!=t.data&&t.data.length&&t.data.forEach(t=>{var a={name:t.Company_Name,value:t.company_id};e.FormSchema[0].Data[1].config.options.push(a)})})},GetGroupList(){var e=this;o["a"].GetDdlGroupList().then(t=>{t.data&&t.data.length&&t.data.forEach(t=>{var a={name:t.CHILD_NAME,value:t.CHILD_USER_ID};e.FormSchema[0].Data[5].config.options.push(a)})})},DeleteData:function(){var e=this,t="";$(".chkItems:checkbox:checked").not("[id^='chkAll']").each((function(){t.length>0&&(t+=","),t+=$(this).val()})),t.length>0?e.confirmR(e.$t("ConfirmDelete"),!0,e.$t("Delete")+"  "+e.$t("SERVICE"),(function(){let a=`ids=${t}&tableName=TALYGEN_BE_CLIENT_CONFIGURATION&primaryKey=CONFIGURATION_ID`;o["a"].Delete(a).then(t=>{"DeletedSuccess"==t.data?e.ShowAlert(e.$t("DeletedSuccessfully"),"Success",!0,e.$t("Alert")):e.ShowAlert(e.$t("DeletedError",[e.$t("val")]),"failure",!0,e.$t("Alert")),e.FetchData()})})):e.ShowAlert(e.$t("Selectanyrecordtodelete"),"failure",!0,e.$t("Alert"))},renderActions(e){let t=[];return this.listActions.forEach(e=>{let a={...e};a.isVisible=!0,t.push(a)}),t},leftCommonSearch:function(e){if(this.PageNumber=e.PageNumber,this.isPaged=1,e.searchCondition){let t=e.searchConditionJson;const a=/(RULE_NAME|CLIENT_NAME|UTILITYNAME|STATENAME)\s*(?:LIKE\s+'?%?|=)\s*([^%')\s]+).*?/i,i=t.match(a),s=i[1],r=i[2];switch(s){case"RULE_NAME":this.searchByName=r;break;case"CLIENT_NAME":this.searchByClientName=r;break;case"UTILITYNAME":this.utilities=r;break;case"STATENAME":this.searchByState=r;break}}else this.searchByState=[],this.utilities="",this.searchByClientName="",this.searchCondition="";this.FetchData()},actionButtonClick:function(e,t,a,i){switch(e){case"ViewHistory":this.OpenHistoryModal(t);break;case"ResourceImpact":this.ResourceImpact(t);break;case"CloneRule":this.cloneItem=t,this.CloneRule(t);break}},CloneRule(e){var t=this;t.isCloneModel=!0},CloseCloneModel(){var e=this;e.$refs.validatePlan.updateProperty("RuleName","value",""),e.$refs.validatePlan.updateProperty("CompanyName","value",""),e.$refs.validatePlan.updateProperty("ContractName","value",""),this.isCloneModel=!1,this.cloneItem=[],this.FetchData()},Close:function(){this.$parent.IsRuleListing=!1},commonHeaderButtonClick:function(e){switch(e){case"AddBillingRule":this.AddBillingRule();break;case"ExportToExcel":this.DownloadExcelData();break;case"DeleteRecord":this.DeleteData();break}},sortdata:function(e){this.SortBy=e;var t="ASC";"ASC"==this.SortExp&&(t="DESC"),this.SortExp=t,this.SortBy=e,this.SortExp=t,this.PageNumber=1,this.FetchData()},pagerMethod:function(e){this.PageSize=e.PageSize,this.PageNumber=e.PageNumber,this.FetchData()},getStatusClassList:function(e){var t="";switch(e){case"Active":t="px-2 text-center text-white d-block bg-success";break;case"Inactive":t="px-2 text-center text-white d-block bg-danger";break;default:t=""}return t},AddBillingRule:function(){var e=this;e.isModalBillingConfiguration=!0},SaveMapRuleData:function(){var e=this,t=e.ConditionSelected;if(t){var a=e.servicePlanId,i={servicePlanId:a,SELECTEDCOLUMNS:t},s=JSON.stringify(i);o["a"].SaveMapData(s).then((function(t){"Success"==t.data.status&&(e.$parent.FetchRecords(),e.Close())}))}else e.ShowAlert(e.$t("SelectRuleMapping"),"warning",e.$t("Alert"))}}},N=R,M=Object(u["a"])(N,f,h,!1,null,null,null),L=M.exports,k={components:{ModalExistingService:v,AddNewService:r["a"],ServiceRuleCondition:p["a"],ModalBillingRuleListing:L,ModalManageBillingConfiguration:T},props:{paymentType:{type:String,required:!1},billingTypeOptions:{type:Array,default:[]}},data(){return{isModalBillingConfiguration:!1,noRecords:!1,IsRuleListing:!1,TotalRecords:0,serviceId:0,CurrentPage:1,PlanId:0,paymentType:"",isForService:!0,TotalPages:0,StatusListForListing:[{STATUS:"Active",STATUS_ID:1001,STATUS_COLOR:"#ffffff",STATUS_BG_COLOR:"#28a745"},{STATUS:"Inactive",STATUS_ID:1002,STATUS_COLOR:"#ffffff",STATUS_BG_COLOR:"#d72435"}],SortBy:"",SortExp:"",PageSize:"10",PageNumber:"1",GroupStart:1,GroupEnd:3,Headers:[{COLUMN_NAME:"service_name",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("ServiceName"),DISPLAY_ORDER:1},{COLUMN_NAME:"service_code",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("ServiceType"),DISPLAY_ORDER:2},{COLUMN_NAME:"usage_measurement",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("UsageMeasurement"),DISPLAY_ORDER:3},{COLUMN_NAME:"RuleDetails",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("BillingRuleName"),DISPLAY_ORDER:3}],HeaderButtons:[{title:"Select Service",iconClass:"fa fa-plus",callbackfunction:"openExistingService",additionalClass:"",isdisabled:!1,isvisible:!0,checkPrivilege:!0,id:"ExistingService"},{title:"Create New",iconClass:"fa fa-plus",callbackfunction:"openCreateService",additionalClass:"",isdisabled:!1,isvisible:!0,checkPrivilege:!0,id:"CreateNew"},{title:"BacktoList",iconClass:"fa fa-angle-double-left",href:"/Plan/PlanListing",additionalClass:"",isdisabled:!1,isvisible:!0,checkPrivilege:!0,id:"BackToList"}],listActions:[{title:"View Rule",href:"javascript:void(0)",icon:"fa fa-eye text-success",callbackfunction:"ViewBillingRule",additionalSpan:""},{title:"Delete",href:"javascript:void(0)",icon:"fa fa-trash",isDisabled:!1,callbackfunction:"DeleteService",additionalSpan:""}],ServicePlanListing:[],isExistingService:!1,isCreateService:!1,planCode:"",serviceDetailForBillingRule:[],serviceDetailConditions:!1,serviceRuleItem:null,servicePlanId:null,configurationId:0}},created:async function(){var e=this;e.PlanId=parseInt(this.$route.params.id),await e.displayPlanDetails(),await e.FetchRecords()},methods:{OpenRuleDetail:function(e){var t=this;t.isModalBillingConfiguration=!0,t.serviceId=e.service_id,t.configurationId=e.configuration_id},shouldHideColumn(e){return"SUBSCRIPTION_BILLING"===this.planCode&&("payment_type"===e.COLUMN_NAME||"RuleDetails"===e.COLUMN_NAME||"usage_measurement"===e.COLUMN_NAME)},saveServiceRules:function(e){var t={planServiceId:e.plan_service_id,configurationId:e.configuration_id,rules:[]};e.rules.forEach((function(e,a){var i={ruleId:0,ruleName:e.ruleName,conditionId:e.ruleCondition.conditionId,rateCodeId:e.ruleCondition.rateCode,isLeafChecked:e.ruleCondition.isLeafChecked,selectedflag:e.ruleCondition.selectedFlag.value,version:e.version};t.rules.push(i)})),o["a"].SaveServiceRules(JSON.stringify(t)).then((function(e){}))},MapBillingRule:function(e,t){var a=this;a.servicePlanId=e,a.serviceId=t,a.IsRuleListing=!0},addRuleCondition:function(e,t){this.serviceDetailConditions=!this.serviceDetailConditions,this.serviceRuleItem=e,this.serviceDetailForBillingRule=t},addMoreRule:function(e){e.rules.push({ruleDisplayOrder:e.rules.length+1,ruleName:"Rule "+(e.rules.length+1),version:e.rules.length+1,ruleCondition:{}})},displayPlanDetails:async function(){var e=this,t="planId="+e.PlanId;await o["a"].displayPlanDetails(t).then(t=>{"Success"==t.data.status&&JSON.parse(t.data.result).data.length>0&&(e.planDetail=JSON.parse(t.data.result).data,e.paymentType=e.planDetail[0].PAYMENT_TYPE,e.planCode=e.planDetail[0].PLAN_CODE,console.log("vm.planCode",e.planCode),e.planDetail[0].CLIENT_COUNT>0&&(e.listActions[1].isDisabled=!0))})},FetchRecords:async function(){var e=this;e.ServicePlanListing=[];var t=`planId=${e.PlanId}&sortBy=${e.SortBy}&sortExp=${e.SortExp}&planCode=${e.planCode}&pagesize=${e.PageSize}&pagenumber=${e.PageNumber}`;await o["a"].GetPlanServiceListing(t).then((function(t){if(""!=t.data&&null!=t.data)if(e.Headers.forEach(e=>{e.settings=null,"service_name"==e.COLUMN_NAME&&(e.settings={isInSlot:!0}),"service_code"==e.COLUMN_NAME&&(e.settings={isInSlot:!0}),"usage_measurement"==e.COLUMN_NAME&&(e.settings={isInSlot:!0})}),t.data.result.data.length>0){let a=t.data.result.data;a.forEach((function(e){e.isRuleView=!1,e.rules=[]})),e.ServicePlanListing=a,e.TotalRecords=t.data.result.data[0].TOTALRECORDS,e.TotalPages=Math.ceil(e.TotalRecords/e.PageSize),e.CurrentPage=e.PageNumber,e.noRecord=!1,e.$emit("Bind-Plan-Details",e.PlanId)}else e.noRecord=!0,e.TotalRecords=0,e.ServicePlanListing=[];else e.noRecord=!0,e.TotalRecords=0,e.ServicePlanListing=[]}))},pagerMethod:function(e){this.PageSize=e.PageSize,this.PageNumber=e.PageNumber,this.FetchRecords()},sortdata:function(e){this.SortBy=e;var t="ASC";"ASC"==this.SortExp&&(t="DESC"),this.SortExp=t,this.SortBy=e,this.SortExp=t,this.PageNumber=1,this.GroupStart=this.PageNumber,this.GroupEnd=this.PageNumber+2,this.FetchRecords()},commonHeaderButtonClick:function(e){switch(e.callbackfunction){case"openExistingService":this.openExistingService();break;case"openCreateService":this.openCreateService();break}},openExistingService:function(){var e=this;e.isExistingService=!0},openCreateService:function(){var e=this;e.serviceId=0,e.isCreateService=!0},renderActions:function(e){var t=this;let a=[];return t.listActions.forEach(e=>{let t={...e};switch(t.title){case"Delete":t.isVisible=!0;break;case"Map Rule":t.isVisible=!0;break;default:t.isVisible=!0}a.push(t)}),a},ViewBillingRule:function(e){e.RuleDetails&&0!==e.RuleDetails.length||(e.RuleDetails=[]),"isRuleView"in e?e.isRuleView=!e.isRuleView:this.$set(e,"isRuleView",!0)},DeleteServiceData:function(e){var t=this,a=e;a>0?t.confirmR(t.$t("ConfirmDelete"),!0,t.$t("Delete")+"  "+t.$t("Service"),(function(){var e={ids:a,moduleName:"BILLING",refCode:"TALYGEN_PLAN_SERVICE"},i=JSON.stringify(e);o["a"].CommonCommonDelete(i).then(e=>{200==e.status?(t.FetchRecords(),t.ShowAlert(t.$t("DeletedSuccess",[t.$t("Service")]),"Success",!0,t.$t("Alert")),t.$emit("Bind-Plan-Details",t.PlanId)):t.ShowAlert(t.$t("DeletedError",[t.$t("Service")]),"failure",!0,t.$t("Alert"))})})):t.ShowAlert(t.$t("Selectanyrecordtodelete"),"warning",!0,t.$t("Alert"))},DeleteRuleData(e){var t=this,a=e;a>0?t.confirmR(t.$t("ConfirmDelete"),!0,t.$t("Delete")+"  "+t.$t("Rule"),(function(){var e={ids:a,moduleName:"BILLING",refCode:"TALYGEN_BE_RULE_PLAN_SERVICE_MAPPING"},i=JSON.stringify(e);o["a"].CommonCommonDelete(i).then(e=>{200==e.status?(t.FetchRecords(),t.ShowAlert(t.$t("DeletedSuccess",[t.$t("Rule")]),"Success",!0,t.$t("Alert"))):t.ShowAlert(t.$t("DeletedError",[t.$t("Rule")]),"failure",!0,t.$t("Alert"))})})):t.ShowAlert(t.$t("Selectanyrecordtodelete"),"warning",!0,t.$t("Alert"))},ViewRuleData(e){var t=this;t.$router.push({name:"ManageConfiguration",params:{id:e.configuration_id}})}}},x=k,B=Object(u["a"])(x,i,s,!1,null,null,null);t["a"]=B.exports},"3fdf":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("div",{staticClass:"my-popups"},[a("loader",{attrs:{"is-visible":e.isLoading}}),a("div",{staticClass:"modal d-block"},[a("div",{staticClass:"modal-dialog modal-dialog-centered"},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[a("h5",{staticClass:"modal-title"},[e._v("Peak Hours")]),a("button",{staticClass:"close",attrs:{type:"button"},on:{click:e.Close}},[a("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),a("div",{staticClass:"modal-body"},[a("dynamic-form",{ref:"validatePeakHours",attrs:{lang:"en",buttons:e.buttons,schema:e.FormSchema},scopedSlots:e._u([{key:"tgslot-FromDateMonth",fn:function(t){t.data;return[a("div",{staticClass:"form-group mb-0"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedDay,expression:"selectedDay"}],staticClass:"form-control",staticStyle:{display:"inline-block",width:"120px"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selectedDay=t.target.multiple?a:a[0]}}},e._l(e.daysInMonth,(function(t){return a("option",{key:t,domProps:{value:t}},[e._v(e._s(t))])})),0),a("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedMonth,expression:"selectedMonth"}],staticClass:"form-control ml-3",staticStyle:{display:"inline-block",width:"120px"},on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selectedMonth=t.target.multiple?a:a[0]},e.adjustDays]}},e._l(e.monthNames,(function(t,i){return a("option",{key:i,domProps:{value:i+1}},[e._v(e._s(t))])})),0)])]}},{key:"tgslot-TillDateMonth",fn:function(t){t.data;return[a("div",{staticClass:"form-group mb-0"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedEndDay,expression:"selectedEndDay"}],staticClass:"form-control",staticStyle:{display:"inline-block",width:"120px"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selectedEndDay=t.target.multiple?a:a[0]}}},e._l(e.daysEndInMonth,(function(t){return a("option",{key:t,domProps:{value:t}},[e._v(e._s(t))])})),0),a("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedEndMonth,expression:"selectedEndMonth"}],staticClass:"form-control ml-3",staticStyle:{display:"inline-block",width:"120px"},on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selectedEndMonth=t.target.multiple?a:a[0]},e.adjustEndDays]}},e._l(e.monthEndNames,(function(t,i){return a("option",{key:i,domProps:{value:i+1}},[e._v(e._s(t))])})),0)])]}},{key:"tgslot-DurationLayout",fn:function(t){t.data;return e._l(e.Mainleveldiv,(function(t,i){return a("div",{key:i,staticClass:"row"},[a("div",{staticClass:"col-md-2"},[a("label",{attrs:{for:"start-time"}},[e._v("Start Time:")]),a("div",{staticClass:"input-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.startTime,expression:"item.startTime"}],staticClass:"form-control",attrs:{type:"time"},domProps:{value:t.startTime},on:{change:function(a){return e.calculateDuration(t)},input:function(a){a.target.composing||e.$set(t,"startTime",a.target.value)}}})])]),a("div",{staticClass:"col-md-2"},[a("label",{attrs:{for:"end-time"}},[e._v("End Time:")]),a("div",{staticClass:"input-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.endTime,expression:"item.endTime"}],staticClass:"form-control",attrs:{type:"time"},domProps:{value:t.endTime},on:{change:function(a){return e.calculateDuration(t)},input:function(a){a.target.composing||e.$set(t,"endTime",a.target.value)}}}),t.isErrorDurationValid?a("span",{staticStyle:{color:"red","font-size":"14px"}},[e._v(e._s(t.durationError))]):e._e()])]),a("div",{staticClass:"col-md-2"},[a("label",{attrs:{for:"duration"}},[e._v("Duration:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.duration,expression:"item.duration"}],staticClass:"form-control",attrs:{type:"text",id:"duration",readonly:""},domProps:{value:t.duration},on:{input:function(a){a.target.composing||e.$set(t,"duration",a.target.value)}}}),a("input",{directives:[{name:"model",rawName:"v-model",value:t.durationInSeconds,expression:"item.durationInSeconds"}],staticClass:"form-control d-none",attrs:{type:"text",id:"durationInSeconds",readonly:""},domProps:{value:t.durationInSeconds},on:{input:function(a){a.target.composing||e.$set(t,"durationInSeconds",a.target.value)}}})]),a("div",{staticClass:"col-md-2"},[a("label",{attrs:{for:"is-per-unit"}},[e._v("Is Per Unit:")]),a("div",{staticClass:"form-group mb-0"},[a("label",{staticClass:"switch"},[a("input",{staticClass:"form-check-input custom-control-input dynamic",attrs:{type:"checkbox"},domProps:{checked:t.isPerUnit},on:{change:function(t){return e.checkIsPerUnit(t,i)}}}),a("span",{staticClass:"slider round",staticStyle:{cursor:"default"}},[a("span",{staticClass:"slider-yes"},[e._v(e._s(e.$t("Yes")))]),a("span",{staticClass:"slider-no"},[e._v(e._s(e.$t("No")))])])])])]),t.isPerUnit?a("div",{staticClass:"col-md-2"},[a("label",{attrs:{for:"unit-rate"}},[e._v("Unit Rate:")]),a("div",{staticClass:"input-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.unitRate,expression:"item.unitRate"}],staticClass:"form-control",attrs:{type:"number",id:"unit-rate"},domProps:{value:t.unitRate},on:{input:function(a){a.target.composing||e.$set(t,"unitRate",a.target.value)}}})])]):a("div",{staticClass:"col-md-2"},[a("label",{attrs:{for:"fixed-rate"}},[e._v("Fixed Rate:")]),a("div",{staticClass:"input-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.fixedRate,expression:"item.fixedRate"}],staticClass:"form-control",attrs:{type:"number",id:"fixed-rate"},domProps:{value:t.fixedRate},on:{input:function(a){a.target.composing||e.$set(t,"fixedRate",a.target.value)}}})])]),a("div",{staticClass:"col-md-2"},[a("label",{attrs:{for:"action"}}),a("div",{staticClass:"input-group"},[0==i?a("em",{staticClass:"round-icon-small fa fa-plus bg-success float-none",on:{click:e.addRow}}):e._e(),0!=i?a("em",{staticClass:"round-icon-small fa fa-minus bg-danger float-none",on:{click:function(t){return e.deleteRow(i)}}}):e._e()])])])}))}}])})],1)])])])],1)])},s=[],r=(a("14d9"),a("9769"),{props:{peakRateData:{type:Function,required:!1},refCode:{type:String,required:!1},currentEditIndex:{type:Number,required:!1}},data(){return{isLoading:!1,monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],monthEndNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekDaysArry:[{name:"Sun",value:"0"},{name:"Mon",value:"1"},{name:"Tue",value:"2"},{name:"Wed",value:"3"},{name:"Thu",value:"4"},{name:"Fri",value:"5"},{name:"Sat",value:"6"}],monthsArray:[{name:"Jan",value:"1"},{name:"Feb",value:"2"},{name:"Mar",value:"3"},{name:"Apr",value:"4"},{name:"May",value:"5"},{name:"Jun",value:"6"},{name:"Jul",value:"7"},{name:"Aug",value:"8"},{name:"Sep",value:"9"},{name:"Oct",value:"10"},{name:"Nov",value:"11"},{name:"Dec",value:"12"}],selectedMonth:(new Date).getMonth(),selectedDay:(new Date).getDate(),selectedEndMonth:(new Date).getMonth(),selectedEndDay:(new Date).getDate(),Mainleveldiv:[{startTime:"",endTime:"",duration:"",unitRate:"",fixedRate:"",isPerUnit:!1,durationError:"",durationInSeconds:"",isErrorDurationValid:!1}],daysInMonth:[],daysEndInMonth:[],FormSchema:[{layoutType:"single",Data:[{astype:"RadioField",label:this.$t("Select Type"),name:"Select",value:"1",placeholder:"",config:{options:[{name:"Day",value:"1"},{name:"Month",value:"2"},{name:"Dates",value:"3"},{name:"Month with dates",value:"4"}],onChange:this.changeRadioFieldValue},validationRules:{required:!0}}]},{layoutType:"single",Data:[{astype:"CheckBoxField",label:"Select Options",name:"SelectedOption",value:"",mode:"tag",placeholder:"",visibility:!0,config:{options:[]},validationRules:""}]},{layoutType:"four",Data:[{astype:"SlotField",label:"From Date Month",name:"FromDateMonth",value:"",placeholder:"",visibility:!1,validationRules:"",settings:{isInSlot:!0}},{astype:"SlotField",label:"Till Date Month",name:"TillDateMonth",value:"",placeholder:"",visibility:!1,validationRules:"",settings:{isInSlot:!0}}]},{layoutType:"single",group_name:"Duration",visibility:!1,Data:[{astype:"SlotField",label:"",name:"DurationLayout",value:"",visibility:!1,placeholder:"",config:{options:[]},validationRules:""}]}],buttons:[{type:"submit",class:"btn btn-success save",value:"Y",text:"<i class='fa fa-save pr-2'></i>Save",onClick:this.SaveData},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Cancel",onClick:this.Close}]}},created:async function(){var e=this;e.adjustDays(),e.adjustEndDays(),"Update"==e.refCode&&setTimeout(()=>{this.BindPeakRateDetail(e.peakRateData)},500),e.FormSchema[3].Data[0].visibility=!0,e.FormSchema[1].Data[0].config.options=e.weekDaysArry},methods:{BindPeakRateDetail(e){var t=this;null!==e.fromStartDay&&null!==e.fromStartMonth&&(t.selectedDay=e.fromStartDay,t.selectedMonth=e.fromStartMonth),null!==e.tillEndDay&&null!==e.tillEndMonth&&(t.selectedEndDay=e.tillEndDay,t.selectedEndMonth=e.tillEndMonth),t.Mainleveldiv=e.peakHours.map(e=>({startTime:e.startTime,endTime:e.endTime,duration:null==e.durationInSeconds?"":t.formattedDuration(e.durationInSeconds),durationInSeconds:e.durationInSeconds,unitRate:e.isPerUnit?e.peakRate:null,fixedRate:e.isPerUnit?null:e.peakRate,isPerUnit:e.isPerUnit,durationError:"",isErrorDurationValid:!1}));const a=e.selectValue,i=e.selectedOptions?e.selectedOptions.split(","):[];if(t.$refs.validatePeakHours.updateProperty("Select","value",a),"3"===a){t.$refs.validatePeakHours.updateProperty("SelectedOption","astype","MultiSelectField");var s=Array.from({length:30},(e,t)=>({name:(t+1).toString(),value:(t+1).toString()}));t.$refs.validatePeakHours.updateProperty("SelectedOption","config.options",s);var r=[];i.forEach((e,t)=>{r.push({value:e,label:e})}),t.$refs.validatePeakHours.updateProperty("SelectedOption","value",r)}else"2"===a?(t.$refs.validatePeakHours.updateProperty("SelectedOption","config.options",t.monthsArray),t.$refs.validatePeakHours.updateProperty("SelectedOption","value",i)):"4"===a?(t.$refs.validatePeakHours.updateProperty("SelectedOption","visibility",!1),t.$refs.validatePeakHours.updateProperty("FromDateMonth","visibility",!0),t.$refs.validatePeakHours.updateProperty("TillDateMonth","visibility",!0)):t.$refs.validatePeakHours.updateProperty("SelectedOption","value",i);t.$refs.validatePeakHours.UpdateKeyValue()},addRow(){this.Mainleveldiv.push({startTime:"",endTime:"",duration:"",durationInSeconds:"",unitRate:"",fixedRate:"",isPerUnit:!1,durationError:"",isErrorDurationValid:!1})},deleteRow(e){this.Mainleveldiv.splice(e,1)},SaveData(){const e=this.$refs.validatePeakHours.getPropertyValue("Select","value");let t=this.$refs.validatePeakHours.getPropertyValue("SelectedOption","value");t="3"==e?t.map(e=>e.label).join(", "):"4"!=e?t.join(","):null;const a={serviceId:0,selectValue:this.$refs.validatePeakHours.getPropertyValue("Select","value"),selectedOptions:t,fromStartDay:"4"==e?this.selectedDay:null,fromStartMonth:"4"==e?this.selectedMonth:null,tillEndDay:"4"==e?this.selectedEndDay:null,tillEndMonth:"4"==e?this.selectedEndMonth:null,peakHours:this.Mainleveldiv.map(e=>({startTime:e.startTime,endTime:e.endTime,duration:e.duration,durationInSeconds:e.durationInSeconds,peakRate:0==e.isPerUnit?e.fixedRate:e.unitRate,isPerUnit:e.isPerUnit}))};null!==this.currentEditIndex&&"Update"==this.refCode?this.$emit("updatePeakHoursDetail",this.currentEditIndex,a):this.$emit("peakHoursDetail",a)},checkIsPerUnit(e,t){this.Mainleveldiv[t].isPerUnit=e.target.checked},adjustDays(){const e=this.selectedMonth+1,t=(new Date).getFullYear(),a=new Date(t,e,0).getDate();this.daysInMonth=Array.from({length:a},(e,t)=>t+1),this.selectedDay>a&&(this.selectedDay=a)},adjustEndDays(){const e=this.selectedEndMonth+1,t=(new Date).getFullYear(),a=new Date(t,e,0).getDate();this.daysEndInMonth=Array.from({length:a},(e,t)=>t+1),this.selectedEndDay>a&&(this.selectedEndDay=a)},changeRadioFieldValue(e,t){var a=this;const i=t.value;if(a.$refs.validatePeakHours.updateProperty("SelectedOption","visibility",!0),a.$refs.validatePeakHours.updateProperty("FromDateMonth","visibility",!1),a.$refs.validatePeakHours.updateProperty("TillDateMonth","visibility",!1),a.$refs.validatePeakHours.updateProperty("SelectedOption","value",""),a.$refs.validatePeakHours.updateProperty("SelectedOption","astype","CheckBoxField"),"1"===i)a.$refs.validatePeakHours.updateProperty("SelectedOption","config.options",a.weekDaysArry),a.$refs.validatePeakHours.UpdateKeyValue();else if("2"===i)a.$refs.validatePeakHours.updateProperty("SelectedOption","config.options",a.monthsArray),a.$refs.validatePeakHours.UpdateKeyValue();else if("3"===i){a.$refs.validatePeakHours.updateProperty("SelectedOption","astype","MultiSelectField");var s=Array.from({length:30},(e,t)=>({name:(t+1).toString(),value:(t+1).toString()}));a.$refs.validatePeakHours.updateProperty("SelectedOption","config.options",s),a.$refs.validatePeakHours.UpdateKeyValue()}else"4"===i&&(a.$refs.validatePeakHours.updateProperty("SelectedOption","visibility",!1),a.$refs.validatePeakHours.updateProperty("FromDateMonth","visibility",!0),a.$refs.validatePeakHours.updateProperty("TillDateMonth","visibility",!0),a.$refs.validatePeakHours.UpdateKeyValue())},Close:function(){var e=this;e.$parent.isAddPeakHours=!1},formattedDuration(e){const t=Math.floor(e/60),a=Math.floor(t/60),i=t%60;return`${a} hours and ${i} minutes`},calculateDuration(e){if(e.startTime&&e.endTime){const t=this.parseTime(e.startTime),a=this.parseTime(e.endTime);if(a>=t){e.durationInSeconds=(a-t)/1e3;const i=(a-t)/6e4,s=Math.floor(i/60),r=i%60;e.duration=`${s} hours and ${r} minutes`,e.isErrorDurationValid=!1}else e.isErrorDurationValid=!0,e.durationError="End time must be after start time",e.duration="",e.durationInSeconds=""}else e.isErrorDurationValid=!1,e.duration="",e.durationInSeconds="",e.durationError=""},parseTime(e){const[t,a]=e.split(":").map(Number),i=new Date;return i.setHours(t),i.setMinutes(a),i.setSeconds(0),i}}}),l=r,n=a("0c7c"),o=Object(n["a"])(l,i,s,!1,null,null,null);t["a"]=o.exports},"651f":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("loader",{attrs:{"is-visible":e.isLoading}}),a("tg-list",{ref:"tgList",attrs:{listType:["List"],IsShowAction:!0,showCheckBox:!0,ModuleName:"Plan",SubModuleCode:"Plan",IdentityColumn:"rate_schedule_id",HeaderText:e.$t("Rates"),ListData:e.ListingData,HeaderData:e.Headers,widgets:e.widgets,HeaderButtons:e.Buttons,TotalRecords:e.TotalRecords,RenderRowActionMethod:e.renderActions,ListDataCallBackFunction:e.GetWorkCodeMappingList,SortExp:e.SortExp,SortBy:e.SortBy,NorecordfoundText:e.$t("NoRecordfound"),SearchFields:e.leftSearchFields,LegendArray:e.LegendArray},on:{PagerButtonClick:e.pagerMethod,HeaderButtonClick:e.commonHeaderButtonClick,SortdataButtonClick:e.sortdata,LeftsearchButtonClick:e.leftCommonSearch,ActionButtonClick:e.actionButtonClick},scopedSlots:e._u([{key:"slotdata",fn:function(t){var i=t.data;return["status_name"==i.column.COLUMN_NAME?[a("a",{staticClass:"inactive-disabled"},[a("span",{staticClass:"text-center text-white d-block",style:{backgroundColor:i.row.status_bg_color}},[e._v(" "+e._s(e.$t(i.row.status_name))+" ")])])]:e._e(),"rate"==i.column.COLUMN_NAME?[a("a",{staticClass:"task-dec",on:{click:function(t){return e.EditRateCode(i.row)}}},[e._v(e._s(null!=i.row.rate?parseFloat(i.row.rate).toFixed(2):"--")+" ")])]:e._e(),"created_at"==i.column.COLUMN_NAME?[a("span",{attrs:{title:e.$d(i.row.created_at)}},[e._v(" "+e._s(e.$d(i.row.created_at))+" ")])]:e._e(),"start_date"==i.column.COLUMN_NAME?[a("span",{attrs:{title:e.$d(i.row.start_date)}},[e._v(" "+e._s(null!=i.row.start_date?e.$d(i.row.start_date):"--")+" ")])]:e._e(),"end_date"==i.column.COLUMN_NAME?[a("span",{attrs:{title:e.$d(i.row.end_date)}},[e._v(" "+e._s(null!=i.row.end_date?e.$d(i.row.end_date):"--")+" ")])]:e._e(),"modified_at"==i.column.COLUMN_NAME?[a("span",{staticClass:"text-center",attrs:{title:e.$d(i.row.modified_at)}},[e._v(" "+e._s(null!=i.row.modified_at?e.$d(i.row.modified_at):"--")+" ")])]:e._e(),"modified_by"==i.column.COLUMN_NAME?[a("span",{staticClass:"text-center"},[e._v(" "+e._s(null!=i.row.modified_by?i.row.modified_by:"--")+" ")])]:e._e(),"billing_code"==i.column.COLUMN_NAME?[a("span",{staticClass:"text-center"},[e._v(" "+e._s(i.row.billing_code?i.row.billing_code:"--")+" ")])]:e._e(),"service_name"==i.column.COLUMN_NAME?[a("span",{staticClass:"text-center"},[e._v(" "+e._s(i.row.service_name?i.row.service_name:"--")+" ")])]:e._e(),"comment"==i.column.COLUMN_NAME?[a("span",{staticClass:"text-center"},[e._v(" "+e._s(i.row.comment?i.row.comment:"--")+" ")])]:e._e()]}}])}),e.IsAddRate?a("AddRate",{attrs:{RateObj:e.RateObj},on:{CloseRateCode:e.CloseRateCode}}):e._e()],1)},s=[],r=(a("14d9"),a("9769")),l=a("8584"),n={components:{AddRate:l["a"]},data(){return{isLoading:!1,PageSize:10,PageNumber:1,isPaged:1,TotalPages:0,widgets:[],LegendArray:[],ListingData:[],TotalRecords:0,SortBy:"",SortExp:"",listActions:[{title:"Edit",href:"javascript:void(0)",callbackfunction:"EditRateCode",icon:"fa fa-pencil action-icon text-success",additionalSpan:""},{title:"Delete",href:"javascript:void(0)",callbackfunction:"DeleteRateCode",icon:"fa fa-trash-o action-icon text-danger",additionalSpan:""}],Headers:[{COLUMN_NAME:"work_code",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("RateCode"),DISPLAY_ORDER:1},{COLUMN_NAME:"service_name",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!1,DISPLAY_NAME:this.$t("ServiceName"),DISPLAY_ORDER:2,settings:{isInSlot:!0}},{COLUMN_NAME:"comment",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("Comment"),DISPLAY_ORDER:3,settings:{isInSlot:!0}},{COLUMN_NAME:"billing_code",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("BillingCode"),DISPLAY_ORDER:4,settings:{isInSlot:!0}},{COLUMN_NAME:"rate",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("Rate"),DISPLAY_ORDER:5,settings:{isInSlot:!0}},{COLUMN_NAME:"status_name",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("HBStatus"),DISPLAY_ORDER:6,settings:{isInSlot:!0}},{COLUMN_NAME:"start_date",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("EventStartDate"),DISPLAY_ORDER:7,settings:{isInSlot:!0}},{COLUMN_NAME:"end_date",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("EndDate"),DISPLAY_ORDER:8,settings:{isInSlot:!0}},{COLUMN_NAME:"created_by",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("SACreatedBy"),DISPLAY_ORDER:9},{COLUMN_NAME:"created_at",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("SACreatedAt"),DISPLAY_ORDER:10,settings:{isInSlot:!0}},{COLUMN_NAME:"modified_by",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("modified_by"),DISPLAY_ORDER:11,settings:{isInSlot:!0}},{COLUMN_NAME:"modified_at",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("ModifiedAt"),DISPLAY_ORDER:12,settings:{isInSlot:!0}}],Buttons:[{title:"addrate",iconClass:"fa fa-plus pr-2 ",callbackfunction:"EditRateCode",additionalClass:"",isdisabled:!1,isvisible:!0},{title:"Delete",iconClass:"fa fa-trash-o action-icon",callbackfunction:"DeleteAll",additionalClass:"",isdisabled:!0,isvisible:!0}],IsAddRate:!1,RateObj:null,PlainId:0}},mounted(){var e=this;$(document).on("change",".chkItems, #chkAll_0",(function(){e.updateDeleteButtonState()}))},created:function(){var e=this;e.PlainId=this.$route.params.id,e.Headers.forEach(t=>{t.DISPLAY_NAME=e.$t(t.DISPLAY_NAME)}),e.GetWorkCodeMappingList()},methods:{leftCommonSearch(){},renderActions:function(e){var t=this;let a=[];return t.listActions.forEach(e=>{let t={...e};switch(t.title){case"Edit":t.isVisible=!0;break;default:t.isVisible=!0}a.push(t)}),a},pagerMethod:function(e){this.PageSize=e.PageSize,this.PageNumber=e.PageNumber,this.GetWorkCodeMappingList()},actionButtonClick:function(e,t){switch(e){case"EditRateCode":this.EditRateCode(t);break;case"DeleteRateCode":this.commonDeleteData(t.rate_schedule_id);break}},commonHeaderButtonClick:async function(e){var t=this;switch(e.callbackfunction){case"EditRateCode":t.EditRateCode(null);break;case"DeleteAll":t.commonDeleteData("ALL");break}},sortdata:function(e){var t="sort tb_headerSortDown";this.SortBy=e,e===this.SortBy&&(""==this.SortExp?(this.SortExp="ASC",t="sort tb_headerSortDown"):"ASC"==this.SortExp?(this.SortExp="DESC",t="sort tb_headerSortUp"):(this.SortExp="ASC",t="sort tb_headerSortDown")),this.GetWorkCodeMappingList(),$("#"+e+"  span:first-child").attr("class",t)},GetWorkCodeMappingList(){var e=this;e.isLoading=!0;var t=`Planid=${e.PlainId}&pageSize=${e.PageSize}&pageNum=${e.PageNumber}&sortBy=${e.SortBy}&sortExp=${e.SortExp}&Clientid=`;r["a"].GetWorkCodeMappingList(t).then(t=>{e.isLoading=!1,t.data.result.DATA.length>0?(e.ListingData=t.data.result.DATA,e.ListingData.forEach(e=>{["start_date","end_date","created_at","modified_at"].forEach(t=>{e[t]&&(e[t]=new Date(e[t]))})}),e.TotalRecords=t.data.result.DATA[0].TOTAL_RECORDS,e.TotalPages=Math.ceil(e.TotalRecords/e.PageSize)):(e.ListingData=[],e.TotalRecords=0,e.TotalPages=0)}).catch(()=>{e.isLoading=!1})},EditRateCode(e){var t=this;t.RateObj=e,t.IsAddRate=!0,t.GetWorkCodeMappingList()},CloseRateCode(){var e=this;e.IsAddRate=!1,e.GetWorkCodeMappingList()},commonDeleteData:function(e){var t=this,a="";if($(".chkItems:checkbox:checked").not("[id^='chkAll_0']").each((function(){a.length>0&&(a+=","),a+=$(this).val()})),"ALL"===e){if(0===a.length)return void t.ShowAlert(t.$t("Selectanyrecordtodelete"),"failure",!0,t.$t("Alert"))}else 0===a.length&&"undefined"!==typeof e&&null!==e&&""!==e&&(a=String(e));if(a&&0!==String(a).length){a=String(a);var i=-1!==a.indexOf(","),s=(i?t.$t("DeleteMultiple"):t.$t("Delete"))+" "+t.$t("RateCode");t.confirmR(t.$t("ConfirmDelete"),!0,s,(async function(){var e={ids:a,moduleName:"RateCode",subModuleCode:"RateCode",refCode:"PLAN_RATE_CODE"};r["a"].CommonCommonDelete(JSON.stringify(e)).then((async function(e){200==e.status?(t.ShowAlert(t.$t("DeletedSuccess",[t.$t("RateCode")]),"Success",!0,t.$t("Alert")),$(".chkItems:checkbox:checked,#chkAll_0").prop("checked",!1).removeAttr("checked"),"function"===typeof t.updateDeleteButtonState&&t.updateDeleteButtonState(),await t.GetWorkCodeMappingList()):t.ShowAlert(t.$t("DeletedError",[t.$t("RateCode")]),"failure",!0,t.$t("Alert"))})).catch((function(e){console.error("Delete API error:",e),t.ShowAlert(t.$t("DeletedError",[t.$t("RateCode")]),"failure",!0,t.$t("Alert"))}))}))}else t.ShowAlert(t.$t("Selectanyrecordtodelete"),"failure",!0,t.$t("Alert"))},updateDeleteButtonState:function(){var e=this,t=$(".chkItems:checkbox:checked").not("[id^='chkAll_0']").length,a=e.Buttons.find(e=>"DeleteAll"===e.callbackfunction);a&&(a.isdisabled=0===t)}}},o=n,d=(a("e78d"),a("0c7c")),c=Object(d["a"])(o,i,s,!1,null,null,null);t["a"]=c.exports},"652a":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("div",{staticClass:"col-md-12 border p-3"},[a("div",{staticClass:"col-md-12 p-0"},[a("dynamic-form",{ref:"refAddress",attrs:{lang:"en",buttons:!1,schema:e.FormSchema},scopedSlots:e._u([{key:"tgslot-PaymentTerm",fn:function(t){t.data;return[a("div",{staticClass:"listing mb-0"},[a("div",{staticClass:"table-responsive table-fix-header"},[a("table",{staticClass:"table table-bordered mt-0"},[a("thead",{staticClass:"thead-bg"},[a("tr",[a("th",[e._v(e._s(e.$t("TermDays")))]),a("th",[e._v(e._s(e.$t("TermPercentage")))])])]),a("tbody",e._l(e.termRows,(function(t,i){return a("tr",{key:i,staticClass:"termPay"},[a("td",[a("div",{staticClass:"d-flex"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.days,expression:"row.days"}],class:{"form-control col-8":!0,disabled:"On Registration"==t.days,"border-danger":t.daysError},attrs:{type:"text"},domProps:{value:t.days},on:{change:function(a){return e.handleUntilDays(t)},input:function(a){a.target.composing||e.$set(t,"days",a.target.value)}}}),a("span",{staticClass:"col-4 float-left mt-1"},[e._v(e._s(e.$t("days")))])])]),a("td",[a("div",{staticClass:"d-flex"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.percentage,expression:"row.percentage"}],class:{"form-control col-8":!0,"border-danger":t.exceedError,"border-danger":t.inpError},attrs:{type:"number",disabled:i===e.termRows.length-1},domProps:{value:t.percentage},on:{change:function(t){return e.handlePercentageChange(i)},input:function(a){a.target.composing||e.$set(t,"percentage",a.target.value)}}}),a("span",{staticClass:"col-4 float-left mt-1"},[e._v("%")])]),t.exceedError?a("span",{staticClass:"text-danger small"},[e._v(e._s(e.$t("ValidateTermPercentage")))]):e._e()])])})),0)])])])]}},{key:"tgslot-Occurs_Every",fn:function(t){var i=t.data;return[a("Field",{attrs:{name:"Occurs Every",rules:{required:!0}},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("div",{staticClass:"input-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:i.fieldInfo.value,expression:"data.fieldInfo.value"}],class:{"txtitems form-control ":!0},attrs:{type:"number",id:"",min:"1",maxlength:"8"},domProps:{value:i.fieldInfo.value},on:{keyup:function(t){return e.checkQuantity(t,i.fieldInfo,i.fieldInfo.value)},input:function(t){t.target.composing||e.$set(i.fieldInfo,"value",t.target.value)}}}),a("span",{staticClass:"input-group-append"},[a("span",{staticClass:"input-group-text",attrs:{id:"spnOutOF"}},[e._v("Hours")])])]),s[0]?a("span",{staticClass:"invalid-feedback d-block",attrs:{name:"Occurs Every"}},[e._v(e._s(s[0]))]):e._e()]}}],null,!0)})]}},{key:"tgslot-UtilityBillingFrequencyType",fn:function(t){t.data;return[a("div",{staticClass:"row"},["month"===e.BillFrequencyVal&&1==e.GenerationDate&&("UTILITY_BILLING"!==e.callfrom||"UTILITY_BILLING"===e.callfrom&&"1"!==e.form.GenerateBill)?a("div",{staticClass:"col-sm-12 col-md-6 col-lg-6 col-xl-6 float-left mb-3"},[a("label",[e._v(e._s(e.$t("BillGenerationDate"))+":")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.form.BillGenerationDate,expression:"form.BillGenerationDate"}],staticClass:"form-control",attrs:{"v-model":e.form.BillingFrequency},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"BillGenerationDate",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[e._v(e._s(e.$t("SelectDate")))]),e._l(31,(function(t){return a("option",{key:t,domProps:{value:t}},[e._v(e._s(t))])}))],2)]):e._e(),"bymonthly"===e.BillFrequencyVal?a("div",{staticClass:"col-sm-12 col-md-6 col-lg-6 col-xl-6 float-left mb-3"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.form.byMonthly,expression:"form.byMonthly"}],staticClass:"form-control",attrs:{"v-model":e.form.byMonthly},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"byMonthly",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[e._v(e._s(e.$t("Select")))]),e._l(e.months,(function(t){return a("option",{key:t,domProps:{value:t}},[e._v(e._s(t))])}))],2),a("small",{staticClass:"text-muted"},[e._v("Cycle Range: "+e._s(e.getCycleRange(2,e.form.byMonthly)))])]):e._e(),"week"===e.BillFrequencyVal?a("div",{staticClass:"col-sm-12 col-md-6 col-lg-6 col-xl-6 float-left mb-3"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.form.weeklyDay,expression:"form.weeklyDay"}],staticClass:"form-control",attrs:{"v-model":e.form.weeklyDay},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"weeklyDay",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[e._v(e._s(e.$t("Select")))]),e._l(e.daysOfWeek,(function(t){return a("option",{key:t,domProps:{value:t}},[e._v(e._s(t))])}))],2)]):e._e(),"biweek"===e.BillFrequencyVal?a("div",{staticClass:"col-sm-12 col-md-6 col-lg-6 col-xl-6 float-left mb-3"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.form.byMonthlys,expression:"form.byMonthlys"}],staticClass:"form-control",attrs:{"v-model":e.form.quarterCycle},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"byMonthlys",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[e._v(e._s(e.$t("Select")))]),e._l(e.daysOfWeek,(function(t){return a("option",{key:t,domProps:{value:t}},[e._v(e._s(t))])}))],2)]):e._e(),"quarterly"===e.BillFrequencyVal?a("div",{staticClass:"col-sm-12 col-md-6 col-lg-6 col-xl-6 float-left mb-3"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.form.quarterCycle,expression:"form.quarterCycle"}],staticClass:"form-control mb-2",attrs:{"v-model":e.form.quarterCycle},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"quarterCycle",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[e._v(e._s(e.$t("Select")))]),a("option",{attrs:{value:"Q1"}},[e._v("Q1 (Jan–Mar)")]),a("option",{attrs:{value:"Q2"}},[e._v("Q2 (Apr–Jun)")]),a("option",{attrs:{value:"Q3"}},[e._v("Q3 (Jul–Sep)")]),a("option",{attrs:{value:"Q4"}},[e._v("Q4 (Oct–Dec)")]),a("option",{attrs:{value:"custom"}},[e._v("Custom")])]),"custom"===e.form.quarterCycle?a("div",{staticClass:"mb-2 mt-3"},[a("label",[e._v(e._s(e.$t("customquarterstartmonth"))+":")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.form.customQuarterStartMonth,expression:"form.customQuarterStartMonth"}],staticClass:"form-control mb-1",attrs:{"v-model":e.form.quarterlyBillDate},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"customQuarterStartMonth",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[e._v(e._s(e.$t("Select")))]),e._l(e.months,(function(t){return a("option",{key:t,domProps:{value:t}},[e._v(e._s(t)+" ")])}))],2),a("small",{staticClass:"text-muted"},[e._v("Cycle Range: "+e._s(e.getCycleRange(3,e.form.customQuarterStartMonth)))])]):e._e()]):e._e(),"quarterly"===e.BillFrequencyVal&&1==e.GenerationDate&&("UTILITY_BILLING"!==e.callfrom||"UTILITY_BILLING"===e.callfrom&&"1"!==e.form.GenerateBill)?a("div",{staticClass:"col-sm-12 col-md-6 col-lg-6 col-xl-6 float-left mb-3"},[a("label",[e._v(e._s(e.$t("BillGenerationDate"))+":")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.form.BillGenerationDate,expression:"form.BillGenerationDate"}],staticClass:"form-control",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"BillGenerationDate",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[e._v(e._s(e.$t("Select")))]),e._l(31,(function(t){return a("option",{key:t,domProps:{value:t}},[e._v(e._s(t))])}))],2)]):e._e(),"halfyear"===e.BillFrequencyVal?a("div",{staticClass:"col-sm-12 col-md-6 col-lg-6 col-xl-6 float-left mb-3"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.form.halfYearCycle,expression:"form.halfYearCycle"}],staticClass:"form-control mb-2",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"halfYearCycle",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[e._v(e._s(e.$t("Select")))]),a("option",{attrs:{value:"H1"}},[e._v("Jan–Jun")]),a("option",{attrs:{value:"H2"}},[e._v("Jul–Dec")]),a("option",{attrs:{value:"custom"}},[e._v("Custom")])]),"custom"===e.form.halfYearCycle?a("div",{staticClass:"mb-2 mt-3"},[a("label",[e._v(e._s(e.$t("customcyclestartmonth"))+":")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.form.customQuarterStartMonth,expression:"form.customQuarterStartMonth"}],staticClass:"form-control mb-1",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"customQuarterStartMonth",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[e._v(e._s(e.$t("Select")))]),e._l(e.months,(function(t){return a("option",{key:t,domProps:{value:t}},[e._v(e._s(t)+" ")])}))],2),a("small",{staticClass:"text-muted"},[e._v("Cycle Range: "+e._s(e.getCycleRange(6,e.form.customQuarterStartMonth)))])]):e._e(),1==e.GenerationDate&&("UTILITY_BILLING"!==e.callfrom||"UTILITY_BILLING"===e.callfrom&&"1"!==e.form.GenerateBill)?a("div",[a("label",[e._v(e._s(e.$t("BillGenerationDate"))+":")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.form.BillGenerationDate,expression:"form.BillGenerationDate"}],staticClass:"form-control",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"BillGenerationDate",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[e._v(e._s(e.$t("Select")))]),e._l(31,(function(t){return a("option",{key:t,domProps:{value:t}},[e._v(e._s(t))])}))],2)]):e._e()]):e._e(),"annual"===e.BillFrequencyVal&&1==e.GenerationDate?a("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 float-left mb-3"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.form.annualMonth,expression:"form.annualMonth"}],staticClass:"form-control",attrs:{"v-model":e.form.annualMonth},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"annualMonth",t.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[e._v(e._s(e.$t("Select")))]),e._l(e.months,(function(t){return a("option",{key:t,domProps:{value:t}},[e._v(e._s(t))])}))],2)]):e._e(),"custom"===e.BillFrequencyVal?a("div",{staticClass:"col-sm-12 col-md-6 col-lg-6 col-xl-6 float-left mb-3"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.form.customMonthsCount,expression:"form.customMonthsCount"}],staticClass:"form-control mb-2",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"customMonthsCount",t.target.multiple?a:a[0])}}},e._l(12,(function(t){return a("option",{key:t,domProps:{value:t}},[e._v(e._s(t))])})),0),a("label",[e._v(e._s(e.$t("customcyclestartmonth"))+":")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.form.customQuarterStartMonth,expression:"form.customQuarterStartMonth"}],staticClass:"form-control mb-1",attrs:{"v-model":e.form.customQuarterStartMonth},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"customQuarterStartMonth",t.target.multiple?a:a[0])}}},e._l(e.months,(function(t){return a("option",{key:t,domProps:{value:t}},[e._v(e._s(t))])})),0),a("small",{staticClass:"text-muted"},[e._v(e._s(e.$t("CycleRange"))+": "+e._s(e.getCycleRange(e.form.customMonthsCount,e.form.customQuarterStartMonth)))])]):e._e()])]}}])})],1),a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("div",{staticClass:"row flex-row-reverse my-3 "},[a("div",{staticClass:"col-lg-6 text-right"},[a("a",{staticClass:"btn btn-success",attrs:{title:"",id:"addAddress","data-toggle-tooltip":"tooltip","data-original-title":"Save"},on:{click:e.onSubmit}},[a("i",{staticClass:"fa fa-save mr-2"}),a("span",{attrs:{id:"btnAddressText"}},[e._v(" "+e._s(e.$t("Save")))])])]),a("div",{staticClass:"col-lg-6"},[a("div",{staticClass:"py-2"},[a("span",{staticClass:"mandatory"},[e._v(e._s(e.$t("Mandatory")))])])])])])])])])},s=[],r=(a("14d9"),a("9769")),l={props:{callfrom:{type:String,default:"UTILITY_BILLING"},paymentType:{type:String,required:!1}},data(){return{selectedFrequencyTRype:"",dateArray:[{value:1,name:"1"},{value:2,name:"2"},{value:3,name:"3"},{value:4,name:"4"},{value:5,name:"5"},{value:6,name:"6"},{value:7,name:"7"},{value:8,name:"8"},{value:9,name:"9"},{value:10,name:"10"},{value:11,name:"11"},{value:12,name:"12"},{value:13,name:"13"},{value:14,name:"14"},{value:15,name:"15"},{value:16,name:"16"},{value:17,name:"17"},{value:18,name:"18"},{value:19,name:"19"},{value:20,name:"20"},{value:21,name:"21"},{value:22,name:"22"},{value:23,name:"23"},{value:24,name:"24"},{value:25,name:"25"},{value:26,name:"26"},{value:27,name:"27"},{value:28,name:"28"},{value:29,name:"29"},{value:30,name:"30"},{value:31,name:"31"}],FormSchema:[{layoutType:"double",Data:[{astype:"RadioField",label:this.$t("GenerateBills"),name:"GenerateBill",value:"1",placeholder:"",visibility:!0,config:{options:[],onChange:this.OnChangeGenerateBill}},{astype:"SelectField",label:this.$t("NoofTerms"),name:"NoOfTerms",visibility:"SUBSCRIPTION_BILLING"==this.callfrom&&"One Time"==this.paymentType,value:"",config:{options:[{value:"1",name:"1"},{value:"2",name:"2"},{value:"3",name:"3"},{value:"4",name:"4"}],onChange:this.OnChangeNoOfTerms},validationRules:{required:!0,max:4}},{astype:"RadioField",label:this.$t("GenerateInvoice"),name:"GenerateSingleInvoice",value:"1",visibility:!1,placeholder:"",config:{options:[{value:"1",name:this.$t("GenerateSingleInvoice")},{value:"0",name:this.$t("GenerateInvoiceForEachTerm")}]}},{astype:"SlotField",label:this.$t("PaymentTerms"),name:"PaymentTerm",value:"",placeholder:"",visibility:!1,validationRules:"",settings:{isInSlot:!0}},{astype:"RadioField",label:this.$t("ReadingNotAvailable"),name:"ReadingNotAvailable",value:"NoBill",visibility:"SUBSCRIPTION_BILLING"!=this.callfrom,placeholder:"",config:{options:[{value:"NoBill",name:this.$t("DoNotGenerateBill")},{value:"AverageBill",name:this.$t("GenerateBillonAverage")},{value:"ZeroChargeBill",name:this.$t("Generateabillwithzerogascharges")}],onChange:this.OnChangeReadingNotAvailable}},{astype:"SlotField",label:"",name:"BillingFrequencyType",value:"",visibility:!0,placeholder:"",config:{options:[]},validationRules:""},{astype:"RadioField",label:this.$t("BillingMonth"),name:"BillingMonth",value:"BillGenerateDate",placeholder:"",visibility:"SUBSCRIPTION_BILLING"!=this.callfrom,config:{options:[{value:"ReadingStartDate",name:this.$t("MonthofCurrentReading")},{value:"ReadingEndDate",name:this.$t("MonthofEndReading")},{value:"BillGenerateDate",name:this.$t("MonthofBillGeneration")}]}},{astype:"NumericField",label:this.$t("DaysUntilDue"),name:"DaysUntilDue",value:"",placeholder:"",validationRules:{required:!0,max:250},config:{options:[]}},{astype:"RadioField",label:this.$t("LateFeesApplicable"),name:"LateFeesApplicable",value:"0",placeholder:"",config:{options:[{value:"0",name:this.$t("No")},{value:"1",name:this.$t("Yes")}],onChange:this.OnChangeLateFees}},{astype:"RadioField",label:this.$t("LateFeeType"),name:"LateFeeType",value:"2",placeholder:"",config:{options:[{value:"1",name:"Flat Fee"},{value:"2",name:"Percentage Fee"}],onChange:this.OnLateFeeTypeChange},validationRules:{required:!1},visibility:!1},{astype:"NumericField",label:this.$t("LateFeePercentage"),name:"LateFeePercentage",value:"0",placeholder:"",visibility:!1},{astype:"SelectField",label:this.$t("Dunning"),name:"Dunning",value:"",placeholder:"",validationRules:{required:!1},config:{options:[]},visibility:!0}]},{layoutType:"double",group_name:"Reading",visibility:!0,Data:[{astype:"RadioField",label:"Is Recurring",name:"IsRecurring",value:"1",mode:"tag",placeholder:"",visibility:!1,config:{options:[{name:"Recurring",value:"1"},{name:"One Time",value:"2"}],onChange:this.OnChangeIsRecurring},validationRules:{required:!1}},{astype:"SelectField",label:this.$t("BillingFrequency"),name:"BillingFrequency",value:"",placeholder:"",visibility:!1,config:{options:[{value:"week",name:"Weekly"},{value:"biweek",name:"Bi-Weekly"},{value:"month",name:"Monthly"},{value:"bymonthly",name:"Bi-Monthly"},{value:"quarterly",name:"Quarterly"},{value:"halfyear",name:"Half-Yearly"},{value:"annual",name:"Annualy"},{value:"custom",name:"Custom Date"}],onChange:this.OnChangeBillFrequency}},{astype:"SlotField",label:"",name:"UtilityBillingFrequencyType",value:"",visibility:!1,placeholder:"",config:{options:[]},validationRules:""},{astype:"DateField",label:this.$t("StartDate"),name:"StartDate",value:"",placeholder:"",config:{format:"MM/DD/YYYY",onChange:this.setEndMinDate,maxDate:!1},validationRules:{required:!1},visibility:!1},{astype:"DateField",label:this.$t("EndDate"),name:"EndDate",value:"",placeholder:"",config:{format:"MM/DD/YYYY",maxDate:!1,minDate:""},validationRules:{required:!1},visibility:!1},{astype:"SelectField",label:this.$t("ReadingStartDate"),name:"MeterReadingStartDate",value:"",placeholder:"",visibility:!1,config:{options:Array.from({length:31},(e,t)=>({value:t+1,name:(t+1).toString()}))}},{astype:"SelectField",label:this.$t("ReadingEndDate"),name:"MeterReadingEndDate",value:"",placeholder:"",visibility:!1,config:{options:Array.from({length:31},(e,t)=>({value:t+1,name:(t+1).toString()}))}}]},{layoutType:"double",group_name:"Billing",visibility:!0,Data:[{astype:"SelectField",label:this.$t("BillingStartDateDay"),name:"MeterReadingStartDate1",value:"",placeholder:"",visibility:!1,config:{options:Array.from({length:31},(e,t)=>({value:t+1,name:(t+1).toString()}))}},{astype:"SelectField",label:this.$t("BillingEndDateDay"),name:"MeterReadingEndDate2",value:"",placeholder:"",visibility:!1,config:{options:Array.from({length:31},(e,t)=>({value:t+1,name:(t+1).toString()}))}},{astype:"DateField",label:this.$t("BillingStartDateDay"),name:"Start_Date1",value:new Date,placeholder:"",config:{format:"MM/DD/YYYY",onChange:this.setScEndMinDate,maxDate:"",minDate:new Date},validationRules:{required:!1},visibility:!1},{astype:"DateField",label:this.$t("BillingEndDateDay"),name:"End_Date2",value:"",placeholder:"",config:{format:"MM/DD/YYYY",maxDate:"",onChange:this.setEndTime,minDate:""},validationRules:{required:!1},visibility:!1},{astype:"DateField",label:this.$t("EventStartTime"),name:"Start_Time",value:"",placeholder:this.$t("EventStartTime"),validationRules:{required:!1,max:100},config:{mode:"time",format:"hh:mm A",minDate:"",onChange:this.setEndTimeAds},visibility:!1},{astype:"DateField",label:this.$t("EndTime"),name:"End_Time",value:"",placeholder:this.$t("EndTime"),validationRules:{required:!1,max:100},config:{mode:"time",format:"hh:mm A",minDate:""},visibility:!1},{astype:"SlotField",label:this.$t("Occurs_Every"),name:"Occurs_Every",value:"",placeholder:"",validationRules:{required:!1,max:100},visibility:!1,group_name:"Frequency:"}]}],planId:"",bill_Cycle_Id:0,BillData:[],termRows:[],GenerationDate:!0,form:{BillingFrequency:"",monthlyBillDate:"",weeklyDay:"",biweeklyDay:"",quarterCycle:"",quarterlyBillDate:"",halfYearlyBillDate:"",customQuarterStartMonth:"",customMonthsCount:1,byMonthly:"",BillGenerationDate:"",GenerateBill:"1",IsRecurring:"1",StartDate:"",EndDate:"",MeterReadingStartDate:"",MeterReadingEndDate:"",MeterReadingStartDate1:"",MeterReadingEndDate2:"",Start_Date1:new Date,End_Date2:"",Start_Time:"",End_Time:"",AdvanceSettings:"",Occurs_Every:""},BillFrequencyVal:"month",frequencyOptions:[{value:"week",name:"Weekly"},{value:"biweek",name:"Bi-Weekly"},{value:"month",name:"Monthly"},{value:"quarterly",name:"Quarterly"},{value:"halfyear",name:"Half yearly"},{value:"annual",name:"Annually"},{value:"custom",name:"Custom Date"},{value:"daily",name:"Daily"}],daysOfWeek:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]}},created:function(){var e=this;e.planId=parseInt(e.$route.params.id);let t=[{value:"1",name:this.$t("UTILITY_BILLING"===e.callfrom?"ByPlan":"OnFixdate")},{value:"2",name:this.$t("AsPerRegistrationDate")},{value:"3",name:this.$t("ByBatch")}];t="UTILITY_BILLING"===e.callfrom?t.filter(e=>"2"!==e.value):t.filter(e=>"3"!==e.value),this.$nextTick(()=>{e.$refs.refAddress&&(e.$refs.refAddress.updateProperty("GenerateBill","config.options",t),e.$refs.refAddress.UpdateKeyValue())}),setTimeout((function(){e.BillGenerateDropDown(),e.GetBillCycleData(e.planId),e.GetDunningList(e.planId),e.$refs.refAddress.updateProperty("AdvanceSettings","value",!0)}),500)},methods:{GetDunningList(e){var t=this,a="palneId="+e;r["a"].GetDdlDunningList(a).then(e=>{if(""!=e.data){var a=[];e.data.length>0&&e.data.forEach((e,t)=>{a.push({value:e.ID,name:e.TITLE})}),t.$refs.refAddress.updateProperty("Dunning","config.options",a),t.$refs.refAddress.UpdateKeyValue()}})},getReadableDateTimeString:async function(e,t){if(!e||"string"!==typeof e)return null;const a=new Date,i=t||a.toISOString().split("T")[0],s=`${i}T${e}`,r=new Date(s);return isNaN(r.getTime())?null:r.toString()},extractTimeFromDateTime:function(e){if(!e||"string"!==typeof e)return"";if(e.match(/^\d{1,2}:\d{2}:\d{2}$/)||e.match(/^\d{1,2}:\d{2}\s(AM|PM)$/i))return e;const t=e.match(/(\d{1,2}:\d{2}:\d{2}|\d{1,2}:\d{2}\s?(AM|PM)?)/i);return t?t[1]:e},getCycleRange(e,t){if(!t||e<=0)return"";const a=this.months.indexOf(t);if(-1===a)return"";const i=[];for(let s=0;s<e;s++)i.push(this.months[(a+s)%12]);return i.join(" – ")},gethelfYearCycleRange(){const e=this.form.customQuarterStartMonth,t=this.months.indexOf(e),a=[this.months[t%12],this.months[(t+1)%12],this.months[(t+2)%12]];return""+a.join(" – ")},checkQuantity(e,t,a){a&&a>99999999&&(t.value=a.toString().slice(0,8))},OnChangeNoOfTerms:function(e,t,a){var i=this;i.$refs.refAddress.updateProperty("DaysUntilDue","value",""),i.termRows=[];const s=t.value;s>"1"?(i.$refs.refAddress.updateProperty("GenerateSingleInvoice","visibility",!0),i.$refs.refAddress.UpdateKeyValue()):(i.$refs.refAddress.updateProperty("GenerateSingleInvoice","visibility",!1),i.$refs.refAddress.UpdateKeyValue()),i.termRows=[];for(let r=0;r<s;r++){const e={days:0===r?"On Registration":"",percentage:null};1==s&&0===r&&(e.percentage=100),i.termRows.push(e)}i.$refs.refAddress.updateProperty("PaymentTerm","visibility",!0),i.$refs.refAddress.UpdateKeyValue()},handleUntilDays:function(e){var t=this;t.termRows.forEach((e,a)=>{t.$refs.refAddress.updateProperty("DaysUntilDue","value",e.days)})},handlePercentageChange:function(e){const t=this;let a=0,i=0;if(t.termRows.forEach((e,s)=>{if(s!==t.termRows.length-1){const t=parseFloat(e.percentage);isNaN(t)||(a+=t,i++)}}),a>100)t.termRows[e].percentage=null,t.termRows[e].exceedError=!0;else if(a<100){t.termRows[e].exceedError=!1,t.termRows[e].daysError=!1,t.termRows[e].inpError=!1;const s=100-a;t.termRows[t.termRows.length-1].percentage=0===i?100:s}},OnChangeReadingNotAvailable:function(e,t){var a=this;t.value=e.target.getAttribute("data-value");let i=t.value;"AverageBill"==i?(a.$refs.refAddress.updateProperty("AverageNumberOfMonth","visibility",!0),a.$refs.refAddress.UpdateKeyValue()):(a.$refs.refAddress.updateProperty("AverageNumberOfMonth","visibility",!1),a.$refs.refAddress.UpdateKeyValue())},BillGenerateDropDown:function(){var e=this;e.$refs.refAddress.updateProperty("BillGenerationDate","config.options",e.dateArray),e.$refs.refAddress.UpdateKeyValue()},OnChangeGenerateBill:function(e,t){var a=this;t.value=e.target.getAttribute("data-value");let i=t.value;if(a.GenerationDate=1==i,a.form.BillGenerationDate="",a.$refs.refAddress.updateProperty("DaysUntilDue","value",""),a.$refs.refAddress.updateProperty("LateFeesApplicable","value",0),a.$refs.refAddress.updateProperty("LateFeeType","value","1"),a.$refs.refAddress.updateProperty("LateFeePercentage","value",""),a.$refs.refAddress.updateProperty("Dunning","value",""),a.$refs.refAddress.updateProperty("LateFeeType","visibility",!1),a.$refs.refAddress.updateProperty("LateFeePercentage","visibility",!1),a.$refs.refAddress.updateProperty("BillingFrequency","value",""),a.$refs.refAddress.updateProperty("MeterReadingStartDate","value",""),a.$refs.refAddress.updateProperty("MeterReadingEndDate","value",""),"UTILITY_BILLING"===a.callfrom&&1==i){a.GenerationDate=!1,a.$refs.refAddress.updateProperty("IsRecurring","visibility",!0),a.$refs.refAddress.updateProperty("IsRecurring","value","1"),a.$refs.refAddress.updateProperty("BillingFrequency","visibility",!0),a.$refs.refAddress.updateProperty("UtilityBillingFrequencyType","visibility",!1),a.$refs.refAddress.updateProperty("StartDate","visibility",!0),a.$refs.refAddress.updateProperty("EndDate","visibility",!0),a.$refs.refAddress.updateProperty("MeterReadingStartDate","visibility",!0),a.$refs.refAddress.updateProperty("MeterReadingEndDate","visibility",!0),a.$refs.refAddress.updateProperty("AdvanceSettings","visibility",!0),a.$refs.refAddress.updateProperty("AdvanceSettings","value",!0);const e=a.$refs.refAddress.getPropertyValue("IsRecurring","value");"1"===e?(a.$refs.refAddress.updateProperty("MeterReadingStartDate","visibility",!0),a.$refs.refAddress.updateProperty("MeterReadingEndDate","visibility",!0),a.$refs.refAddress.updateProperty("MeterReadingStartDate1","visibility",!0),a.$refs.refAddress.updateProperty("MeterReadingEndDate2","visibility",!0),a.$refs.refAddress.updateProperty("StartDate","visibility",!1),a.$refs.refAddress.updateProperty("EndDate","visibility",!1)):"2"===e&&(a.$refs.refAddress.updateProperty("StartDate","visibility",!0),a.$refs.refAddress.updateProperty("EndDate","visibility",!0),a.$refs.refAddress.updateProperty("Start_Date1","visibility",!0),a.$refs.refAddress.updateProperty("End_Date2","visibility",!0)),a.$refs.refAddress.updateProperty("Occurs_Every","visibility",!0),this.showAdvanceSettings(!0)}else"UTILITY_BILLING"===a.callfrom?(a.GenerationDate=!0,a.$refs.refAddress.updateProperty("IsRecurring","visibility",!1),a.$refs.refAddress.updateProperty("BillingFrequency","visibility",!1),a.$refs.refAddress.updateProperty("UtilityBillingFrequencyType","visibility",!1),a.$refs.refAddress.updateProperty("StartDate","visibility",!1),a.$refs.refAddress.updateProperty("EndDate","visibility",!1),a.$refs.refAddress.updateProperty("MeterReadingStartDate","visibility",!1),a.$refs.refAddress.updateProperty("MeterReadingEndDate","visibility",!1),a.$refs.refAddress.updateProperty("AdvanceSettings","visibility",!1),a.$refs.refAddress.updateProperty("Occurs_Every","visibility",!1),this.showAdvanceSettings(!1)):a.GenerationDate=1==i;a.$refs.refAddress.UpdateKeyValue()},OnChangeBillGenerationDate:function(e,t){var a=this;t.value=e.target.getAttribute("data-value");let i=t.value;"UTILITY_BILLING"===a.callfrom&&1==i?(a.GenerationDate=!1,a.$refs.refAddress.updateProperty("BillGenerationDate","visibility",!1),a.$refs.refAddress.updateProperty("Occurs_Every","visibility",!0)):"UTILITY_BILLING"===a.callfrom&&(a.GenerationDate=!0,a.$refs.refAddress.updateProperty("BillGenerationDate","visibility",!0),a.$refs.refAddress.updateProperty("Occurs_Every","visibility",!1)),a.$refs.refAddress.UpdateKeyValue()},OnChangeBillFrequency:function(e,t){var a=this;switch(a.$refs.refAddress.updateProperty("UtilityBillingFrequencyType","visibility",!0),a.selectedFrequencyTRype=t.value,a.BillFrequencyVal=t.value,a.form.weeklyDay="",a.form.byMonthly="",a.form.byMonthlys="",a.form.quarterCycle="",a.form.halfYearCycle="",a.form.customQuarterStartMonth="",a.form.customMonthsCount=1,a.form.annualMonth="",t.value){case"bymonthly":a.$refs.refAddress.updateProperty("UtilityBillingFrequencyType","label",this.$t("BillingMonth"));break;case"week":a.$refs.refAddress.updateProperty("UtilityBillingFrequencyType","label",this.$t("billingdayofweek"));break;case"biweek":a.$refs.refAddress.updateProperty("UtilityBillingFrequencyType","label",this.$t("billingdayofweek"));break;case"quarterly":a.$refs.refAddress.updateProperty("UtilityBillingFrequencyType","label",this.$t("quartercycle"));break;case"halfyear":a.$refs.refAddress.updateProperty("UtilityBillingFrequencyType","label",this.$t("cycle"));break;case"custom":a.$refs.refAddress.updateProperty("UtilityBillingFrequencyType","label",this.$t("BillingMonthCount"));break;case"annual":a.$refs.refAddress.updateProperty("UtilityBillingFrequencyType","label",this.$t("BillingMonth"));break;case"month":default:a.$refs.refAddress.updateProperty("UtilityBillingFrequencyType","label","");break}a.$refs.refAddress.UpdateKeyValue()},OnChangeTerminationOption(e,t){var a=this;t.value=e.target.getAttribute("data-value");t.value;a.$refs.refAddress.UpdateKeyValue()},OnChangeLatePaymentOnPartialPayments:function(e,t){var a=this;t.value=e.target.getAttribute("data-value");t.value;a.$refs.refAddress.UpdateKeyValue()},GetBillCycleData:async function(e){var t=this;let a="planid="+e;r["a"].GetBillingCycleData(a).then(async e=>{if(0!=JSON.parse(e.data.result).DATA.length){t.BillData=JSON.parse(e.data.result).DATA;for(let e=0;e<t.BillData.length;e++){const i=t.BillData[e];if("One Time"==this.paymentType){if(i.no_of_terms>1&&t.$refs.refAddress.updateProperty("GenerateSingleInvoice","visibility",!0),t.$refs.refAddress.updateProperty("NoOfTerms","value",i.no_of_terms),null!=i.no_of_terms&&""!=i.no_of_terms&&null!=i.payment_term&&""!=i.payment_term){t.$refs.refAddress.updateProperty("PaymentTerm","visibility",!0);const e={days:"",percentage:null};var a=JSON.parse(i.payment_term);a.forEach(a=>{const i={...e};i.days=a.days,i.percentage=a.percentage,t.termRows.push(i)})}}else t.$refs.refAddress.updateProperty("NoOfTerms","visibility",!1);null!==i.days_until_due&&void 0!==i.days_until_due&&""!==i.days_until_due&&t.$refs.refAddress.updateProperty("DaysUntilDue","value",i.days_until_due),null!==i.billing_frequency&&void 0!==i.billing_frequency&&""!==i.billing_frequency&&t.$refs.refAddress.updateProperty("BillingFrequency","value",i.billing_frequency),null!==i.billing_dunning&&void 0!==i.billing_dunning&&""!==i.billing_dunning&&t.$refs.refAddress.updateProperty("Dunning","value",i.billing_dunning),1==i.bill_generate_on?(t.GenerationDate=!0,"UTILITY_BILLING"===t.callfrom?(t.$refs.refAddress.updateProperty("BillGenerationDate","visibility",!1),t.$refs.refAddress.updateProperty("IsRecurring","visibility",!0),t.$refs.refAddress.updateProperty("BillingFrequency","visibility",!0),t.$refs.refAddress.updateProperty("UtilityBillingFrequencyType","visibility",!0),t.$refs.refAddress.updateProperty("StartDate","visibility",!0),t.$refs.refAddress.updateProperty("EndDate","visibility",!0),t.$refs.refAddress.updateProperty("MeterReadingStartDate","visibility",!0),t.$refs.refAddress.updateProperty("MeterReadingEndDate","visibility",!0),t.$refs.refAddress.updateProperty("AdvanceSettings","visibility",!0),t.$refs.refAddress.updateProperty("AdvanceSettings","value",!0),this.showAdvanceSettings(!0),t.$refs.refAddress.updateProperty("Occurs_Every","visibility",!0)):t.$refs.refAddress.updateProperty("BillGenerationDate","visibility",!0)):(t.GenerationDate=!1,"UTILITY_BILLING"===t.callfrom?(t.$refs.refAddress.updateProperty("BillGenerationDate","visibility",!0),t.$refs.refAddress.updateProperty("IsRecurring","visibility",!1),t.$refs.refAddress.updateProperty("BillingFrequency","visibility",!1),t.$refs.refAddress.updateProperty("UtilityBillingFrequencyType","visibility",!1),t.$refs.refAddress.updateProperty("StartDate","visibility",!1),t.$refs.refAddress.updateProperty("EndDate","visibility",!1),t.$refs.refAddress.updateProperty("MeterReadingStartDate","visibility",!1),t.$refs.refAddress.updateProperty("MeterReadingEndDate","visibility",!1),t.$refs.refAddress.updateProperty("AdvanceSettings","visibility",!1),t.$refs.refAddress.updateProperty("Occurs_Every","visibility",!1)):t.$refs.refAddress.updateProperty("BillGenerationDate","visibility",!0));if(""!=i.billing_frequency&&null!=i.billing_frequency)switch(i.billing_frequency){case"month":t.form.monthlyBillDate;break;case"week":t.form.weeklyDay;break;case"biweek":t.form.biweeklyDay;break;case"quarterly":t.FormSchema[0].Data[6].config.options.value=i.quarterly,t.$refs.refAddress.updateProperty("quarterly","visibility",!0),t.form.quarterCycle=i.Custom_range;break;case"halfyear":t.form.halfYearCycle;break;case"custom":t.customQuarterStartMonth;break}if(""!=i.invoice_generation_date&&null!=i.invoice_generation_date&&(t.$refs.refAddress.updateProperty("BillGenerationDate","visibility",!0),this.form.BillGenerationDate=Number(i.invoice_generation_date)),t.$refs.refAddress.updateProperty("ReadingNotAvailable","value",i.when_reading_not_available),"AverageBill"==i.when_reading_not_available?(t.$refs.refAddress.updateProperty("AverageNumberOfMonth","visibility",!0),t.$refs.refAddress.updateProperty("AverageNumberOfMonth","value",i.average_billing_month)):t.$refs.refAddress.updateProperty("AverageNumberOfMonth","visibility",!1),t.$refs.refAddress.updateProperty("BillingMonth","value",i.billing_month_depend_on),null==i.billing_month_depend_on&&t.$refs.refAddress.updateProperty("BillingMonth","value","BillGenerateDate"),null==i.when_reading_not_available&&t.$refs.refAddress.updateProperty("ReadingNotAvailable","value","NoBill"),null==i.bill_generate_on&&(t.$refs.refAddress.updateProperty("GenerateBill","value",2),t.GenerationDate=!0),t.$refs.refAddress.updateProperty("GenerateBill","value",i.bill_generate_on),null==i.billing_frequency&&t.$refs.refAddress.updateProperty("BillingFrequency","value",""),t.$refs.refAddress.updateProperty("LateFeesApplicable","value",1==i.late_fees_applicable?1:0),1==i.late_fees_applicable&&(t.$refs.refAddress.updateProperty("LateFeeType","visibility",!0),t.$refs.refAddress.updateProperty("LateFeePercentage","visibility",!0)),t.$refs.refAddress.updateProperty("LateFeeType","value",i.late_fee_type),2==i.late_fee_type?t.$refs.refAddress.updateProperty("LateFeePercentage","label","Late Fee Amount (%)"):1==i.late_fee_type&&t.$refs.refAddress.updateProperty("LateFeePercentage","label","Late Fee Amount"),t.$refs.refAddress.updateProperty("LateFeePercentage","value",i.late_fee_amount),1==i.tiered_late_payment_charges&&t.$refs.refAddress.updateProperty("LateFeePercentage","visibility",!0),i.late_payment_on_partial_payments,"SUBSCRIPTION_BILLING"==t.callfrom&&(i.termination_configuration,i.termination_option),"UTILITY_BILLING"===t.callfrom&&1===t.$refs.refAddress.getPropertyValue("GenerateBill","value")){if(1==i.is_recurring||1==i.is_recurring){if(t.$refs.refAddress.updateProperty("IsRecurring","value","1"),await t.OnChangeIsRecurring("",{value:"1"},!0),t.$refs.refAddress.updateProperty("MeterReadingStartDate","value",i.reading_cycle_start_day),t.$refs.refAddress.updateProperty("MeterReadingEndDate","value",i.reading_cycle_end_day),i.sc_start_time&&"00:00:00"!=i.sc_start_time){if(t.$refs.refAddress.updateProperty("AdvanceSettings","value",!0),t.$refs.refAddress.updateProperty("MeterReadingStartDate1","value",i.sc_billing_start_day),t.$refs.refAddress.updateProperty("MeterReadingEndDate2","value",i.sc_billing_end_day),i.sc_start_time&&"00:00:00"!==i.sc_start_time){const e=await t.getReadableDateTimeString(i.sc_start_time);t.$refs.refAddress.updateProperty("Start_Time","value",e)}if(i.sc_end_time&&"00:00:00"!==i.sc_end_time){const e=await t.getReadableDateTimeString(i.sc_end_time);t.$refs.refAddress.updateProperty("End_Time","value",e)}t.$refs.refAddress.updateProperty("Occurs_Every","value",i.occurs_every)}}else{if(t.$refs.refAddress.updateProperty("IsRecurring","value","2"),i.start_date){const e=new Date(i.start_date);t.$refs.refAddress.updateProperty("StartDate","value",e)}if(i.end_date){const e=new Date(i.end_date);t.$refs.refAddress.updateProperty("EndDate","value",e)}if(await t.OnChangeIsRecurring("",{value:"2"},!1),i.sc_start_time&&"00:00:00"!=i.sc_start_time){if(t.$refs.refAddress.updateProperty("AdvanceSettings","value",!0),i.sc_start_date){const e=new Date(i.sc_start_date);t.$refs.refAddress.updateProperty("Start_Date1","value",e)}if(i.sc_end_date){const e=new Date(i.sc_end_date);t.$refs.refAddress.updateProperty("End_Date2","value",e)}if(i.sc_start_time&&"00:00:00"!==i.sc_start_time){const e=await t.getReadableDateTimeString(i.sc_start_time);t.$refs.refAddress.updateProperty("Start_Time","value",e)}if(i.sc_end_time&&"00:00:00"!==i.sc_end_time){const e=await t.getReadableDateTimeString(i.sc_end_time);t.$refs.refAddress.updateProperty("End_Time","value",e)}t.$refs.refAddress.updateProperty("Occurs_Every","value",i.occurs_every)}}if(t.BillFrequencyVal=i.billing_frequency,null!==i.billing_frequency&&void 0!==i.billing_frequency&&""!==i.billing_frequency){t.$refs.refAddress.updateProperty("BillingFrequency","value",i.billing_frequency);let e={};e.value=i.billing_frequency,await t.OnChangeBillFrequency("",e)}if(i.billing_frequency_value)switch(i.billing_frequency){case"month":case"annual":t.form.annualMonth=i.billing_frequency_value,t.$refs.refAddress.updateProperty("UtilityBillingFrequencyType","value",i.billing_frequency_value);break;case"week":t.form.weeklyDay=i.billing_frequency_value,t.$refs.refAddress.updateProperty("UtilityBillingFrequencyType","value",i.billing_frequency_value);break;case"biweek":t.form.byMonthlys=i.billing_frequency_value,t.$refs.refAddress.updateProperty("UtilityBillingFrequencyType","value",i.billing_frequency_value);break;case"bymonthly":t.form.byMonthly=i.billing_frequency_value,t.$refs.refAddress.updateProperty("UtilityBillingFrequencyType","value",i.billing_frequency_value);break;case"quarterly":"custom"===i.billing_frequency_value?(t.form.customQuarterStartMonth=i.custom_start_month,t.form.quarterCycle=i.billing_frequency_value):t.form.quarterCycle=i.billing_frequency_value,t.$refs.refAddress.updateProperty("UtilityBillingFrequencyType","value",i.billing_frequency_value);break;case"halfyear":"custom"===i.billing_frequency_value?(t.form.customQuarterStartMonth=i.custom_start_month,t.form.halfYearCycle=i.billing_frequency_value):t.form.halfYearCycle=i.billing_frequency_value,t.$refs.refAddress.updateProperty("UtilityBillingFrequencyType","value",i.billing_frequency_value);break;case"custom":t.form.customQuarterStartMonth=i.custom_start_month,t.form.customMonthsCount=i.custom_months_count,t.$refs.refAddress.updateProperty("UtilityBillingFrequencyType","value",i.billing_frequency_value);break}}t.$refs.refAddress.UpdateKeyValue()}}else t.BillData=[],t.$refs.refAddress.updateProperty("GenerateBill","value",1),"UTILITY_BILLING"===t.callfrom&&1===t.$refs.refAddress.getPropertyValue("GenerateBill","value")?(t.$refs.refAddress.updateProperty("GenerateBill","value",1),t.$refs.refAddress.updateProperty("BillGenerationDate","visibility",!1),t.$refs.refAddress.updateProperty("IsRecurring","visibility",!0),t.$refs.refAddress.updateProperty("BillingFrequency","visibility",!0),t.$refs.refAddress.updateProperty("UtilityBillingFrequencyType","visibility",!0),t.$refs.refAddress.updateProperty("StartDate","visibility",!1),t.$refs.refAddress.updateProperty("EndDate","visibility",!1),t.$refs.refAddress.updateProperty("MeterReadingStartDate","visibility",!0),t.$refs.refAddress.updateProperty("MeterReadingEndDate","visibility",!0),t.$refs.refAddress.updateProperty("AdvanceSettings","visibility",!0),t.$refs.refAddress.updateProperty("AdvanceSettings","value",!0),this.showAdvanceSettings(!0),t.$refs.refAddress.updateProperty("Occurs_Every","visibility",!0)):t.$refs.refAddress.updateProperty("GenerateBill","value",2),t.GenerationDate=!1})},OnChangeTieredLatePayment(e,t){var a=this;t.value=e.target.getAttribute("data-value");t.value;a.$refs.refAddress.UpdateKeyValue()},OnChangeTermination(e,t){var a=this;t.value=e.target.getAttribute("data-value");t.value;a.$refs.refAddress.UpdateKeyValue()},OnChangeLateFees(e,t){var a=this;t.value=e.target.getAttribute("data-value");let i=t.value;0==i?(a.$refs.refAddress.updateProperty("LateFeeType","visibility",!1),a.$refs.refAddress.updateProperty("LateFeePercentage","visibility",!1),a.$refs.refAddress.updateProperty("LateFeePercentage","value",""),a.$refs.refAddress.UpdateKeyValue()):(a.$refs.refAddress.updateProperty("LateFeeType","visibility",!0),a.$refs.refAddress.updateProperty("LateFeePercentage","visibility",!0),a.$refs.refAddress.UpdateKeyValue())},OnLateFeeTypeChange(e,t){var a=this;t.value=e.target.getAttribute("data-value");let i=t.value;2==i?(a.$refs.refAddress.updateProperty("LateFeePercentage","label","Late Fee Amount (%)"),a.$refs.refAddress.updateProperty("TieredLatePaymentCharges","visibility",!0),a.$refs.refAddress.UpdateKeyValue()):(a.$refs.refAddress.updateProperty("LateFeePercentage","label","Late Fee Amount"),a.$refs.refAddress.updateProperty("TieredLatePaymentCharges","visibility",!1),a.$refs.refAddress.UpdateKeyValue())},OnChangeIsRecurring:function(e,t,a){var i=this;let s="";var r;void 0===a?(t.value=(null===e||void 0===e||null===(r=e.target)||void 0===r?void 0:r.getAttribute("data-value"))||(null===t||void 0===t?void 0:t.value)||"1",s=t.value):s=!0===a?"1":"2";const l=["MeterReadingStartDate","MeterReadingEndDate","MeterReadingStartDate1","MeterReadingEndDate2","StartDate","EndDate","Start_Date1","End_Date2"];l.forEach(e=>{i.$refs.refAddress.updateProperty(e,"visibility",!1),i.$refs.refAddress.updateProperty(e,"value","")}),"1"===s?(i.$refs.refAddress.updateProperty("MeterReadingStartDate","visibility",!0),i.$refs.refAddress.updateProperty("MeterReadingEndDate","visibility",!0),i.$refs.refAddress.updateProperty("MeterReadingStartDate1","visibility",!0),i.$refs.refAddress.updateProperty("MeterReadingEndDate2","visibility",!0)):"2"===s&&(i.$refs.refAddress.updateProperty("StartDate","visibility",!0),i.$refs.refAddress.updateProperty("EndDate","visibility",!0),i.$refs.refAddress.updateProperty("Start_Date1","visibility",!0),i.$refs.refAddress.updateProperty("End_Date2","visibility",!0)),i.$refs.refAddress.UpdateKeyValue()},showAdvanceSettings:function(e,t){const a=this,i=a.$refs.refAddress.getPropertyValue("IsRecurring","value"),s=["MeterReadingStartDate1","MeterReadingEndDate2","Start_Date1","End_Date2","Start_Time","End_Time","Occurs_Every"];a.FormSchema.forEach(t=>{t.Data&&Array.isArray(t.Data)&&t.Data.forEach(t=>{s.includes(t.name)&&(("MeterReadingStartDate1"!==t.name&&"MeterReadingEndDate2"!==t.name||"1"!==i)&&("Start_Date1"!==t.name&&"End_Date2"!==t.name||"2"!==i)?"Start_Time"===t.name||"End_Time"===t.name||"Occurs_Every"===t.name?(t.visibility=e,t.validationRules=t.validationRules||{},t.validationRules.required=e,e||(t.value="")):(t.visibility=!1,t.validationRules&&(t.validationRules.required=!1),t.value=""):(t.visibility=e,t.validationRules=t.validationRules||{},t.validationRules.required=e,e||(t.value="")))})}),a.$refs.refAddress.UpdateKeyValue()},setEndMinDate:function(e,t){var a=this;t.value&&a.$refs.refAddress.updateProperty("EndDate","config.minDate",t.value),a.$refs.refAddress.UpdateKeyValue()},setScEndMinDate:function(e,t){var a=this;t.value&&a.$refs.refAddress.updateProperty("End_Date2","config.minDate",t.value),a.$refs.refAddress.UpdateKeyValue()},setEndTime:function(e,t){var a=this;t.value&&a.$refs.refAddress.updateProperty("End_Time","config.minDate",t.value),a.$refs.refAddress.UpdateKeyValue()},setEndTimeAds:function(e,t){var a=this;t.value&&a.$refs.refAddress.updateProperty("End_Time","config.minDate",t.value),a.$refs.refAddress.UpdateKeyValue()},getCycleRange(e,t){if(!t||e<=0)return"";const a=this.months.indexOf(t);if(-1===a)return"";const i=[];for(let s=0;s<e;s++)i.push(this.months[(a+s)%12]);return i.join(" – ")},gethelfYearCycleRange(){const e=this.form.customQuarterStartMonth,t=this.months.indexOf(e),a=[this.months[t%12],this.months[(t+1)%12],this.months[(t+2)%12]];return""+a.join(" – ")},async onSubmit(){var e=this;const t=await e.$refs.refAddress.validateForm.validate();if(t){let t=!0;if(e.termRows.forEach(e=>{null==e.percentage||""==e.percentage?(e.inpError=!0,t=!1):e.inpError=!1,null==e.days||""==e.days?(e.daysError=!0,t=!1):e.daysError=!1}),!t)return;var a="";switch(e.selectedFrequencyTRype){case"month":a=e.form.monthlyBillDate;break;case"week":a=e.form.weeklyDay;break;case"biweek":a=e.form.biweeklyDay;break;case"quarterly":a=e.form.quarterCycle;break;case"halfyear":a=e.form.halfYearCycle;break;case"bymonthly":a=e.form.byMonthly;break;case"custom":a="custom";break}var i="",s="";""!=e.form.BillGenerationDate&&(i=e.form.BillGenerationDate),""!=e.form.customQuarterStartMonth&&(s=e.form.customQuarterStartMonth);let o=e.$refs.refAddress.getPropertyValue("GenerateSingleInvoice","value");o="1"==o;let d=0,c=null,u=null,m="",v="",p=0,f=null,h=null,y=null,g=null,_=null,b=null;if("UTILITY_BILLING"===e.callfrom&&1===e.$refs.refAddress.getPropertyValue("GenerateBill","value")){let t=e.$refs.refAddress.getPropertyValue("IsRecurring","value");if(Array.isArray(t)&&(t=t[0]),d="1"===t?1:0,1===d){y=e.$refs.refAddress.getPropertyValue("MeterReadingStartDate","value"),g=e.$refs.refAddress.getPropertyValue("MeterReadingEndDate","value");let t=!0;if(t){f=e.$refs.refAddress.getPropertyValue("MeterReadingStartDate1","value"),h=e.$refs.refAddress.getPropertyValue("MeterReadingEndDate2","value");let t=e.$refs.refAddress.getPropertyValue("Start_Time","value"),a=e.$refs.refAddress.getPropertyValue("End_Time","value");m=t?t.toString().match(/(\d{1,2}:\d{2}:\d{2})/)?t.toString().match(/(\d{1,2}:\d{2}:\d{2})/)[1]:t:"",v=a?a.toString().match(/(\d{1,2}:\d{2}:\d{2})/)?a.toString().match(/(\d{1,2}:\d{2}:\d{2})/)[1]:a:"",p=e.$refs.refAddress.getPropertyValue("Occurs_Every","value")}}else{_=e.$refs.refAddress.getPropertyValue("StartDate","value"),b=e.$refs.refAddress.getPropertyValue("EndDate","value");let t=!0;if(t){c=e.$refs.refAddress.getPropertyValue("Start_Date1","value"),u=e.$refs.refAddress.getPropertyValue("End_Date2","value");let t=e.$refs.refAddress.getPropertyValue("Start_Time","value"),a=e.$refs.refAddress.getPropertyValue("End_Time","value");m=t?t.toString().match(/(\d{1,2}:\d{2}:\d{2})/)?t.toString().match(/(\d{1,2}:\d{2}:\d{2})/)[1]:t:"",v=a?a.toString().match(/(\d{1,2}:\d{2}:\d{2})/)?a.toString().match(/(\d{1,2}:\d{2}:\d{2})/)[1]:a:"",p=e.$refs.refAddress.getPropertyValue("Occurs_Every","value")}}}const S=[];"One Time"==this.paymentType&&e.termRows.length>0&&e.termRows.forEach(e=>{S.push({days:e.days,percentage:e.percentage})});var l={id:this.BillData.length>0?this.BillData[0].id:0,planId:this.planId,invoice_generation_date:i,days_until_due:e.$refs.refAddress.getPropertyValue("DaysUntilDue","value"),late_fees_applicable:e.$refs.refAddress.getPropertyValue("LateFeesApplicable","value"),late_fee_type:e.$refs.refAddress.getPropertyValue("LateFeeType","value"),late_fee_amount:e.$refs.refAddress.getPropertyValue("LateFeePercentage","value"),bill_generate_on:e.$refs.refAddress.getPropertyValue("GenerateBill","value"),when_reading_not_available:e.$refs.refAddress.getPropertyValue("ReadingNotAvailable","value"),billing_month_depend_on:e.$refs.refAddress.getPropertyValue("BillingMonth","value"),average_billing_month:e.$refs.refAddress.getPropertyValue("AverageNumberOfMonth","value"),billing_frequency:e.$refs.refAddress.getPropertyValue("BillingFrequency","value"),payment_term:"One Time"==this.paymentType?JSON.stringify(S):null,no_of_terms:"One Time"==this.paymentType?e.$refs.refAddress.getPropertyValue("NoOfTerms","value"):null,billing_frequency_type:"UTILITY_BILLING"===e.callfrom?e.$refs.refAddress.getPropertyValue("UtilityBillingFrequencyType","value"):e.$refs.refAddress.getPropertyValue("BillingFrequencyType","value"),billing_dunning:e.$refs.refAddress.getPropertyValue("Dunning","value"),Custom_range:a,custom_start_month:s,custom_months_count:e.form.customMonthsCount,genrate_single_invoice:o,is_recurring:d,sc_start_date:c,sc_end_date:u,sc_start_time:m,sc_end_time:v,occurs_every:p,sc_billing_start_day:f,sc_billing_end_day:h,reading_cycle_start_day:y,reading_cycle_end_day:g,start_date:_,end_date:b,billing_frequency_value:a},n=JSON.stringify(l);let C="objData="+n;await r["a"].SaveBillingCycle(C).then(t=>{if(null!=t.data)if(1==t.data.Code){e.ShowAlert(e.$t("Bill cycle saved successfully."),"success"),e.resetFrom();var a=parseInt(e.$route.params.id);e.GetBillCycleDatapalne(a)}else 2==t.data.Code?e.ShowAlert(e.$t("Bill cycle updated successfully."),"success"):e.ShowAlert(e.$t("UnknownError"),"failure",e.$t("Alert"))})}},resetFrom(){return{BillingFrequency:"",monthlyBillDate:"",weeklyDay:"",biweeklyDay:"",quarterCycle:"",quarterlyBillDate:"",halfYearlyBillDate:"",customQuarterStartMonth:""}}}},n=l,o=(a("efb9"),a("0c7c")),d=Object(o["a"])(n,i,s,!1,null,null,null);t["a"]=d.exports},"6b09":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("div",{staticClass:"my-popups"},[a("div",{staticClass:"modal d-block"},[a("div",{staticClass:"modal-dialog modal-dialog-centered ui-draggable"},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header ui-draggable-handle py-1"},[0==e.serviceId?a("h5",{staticClass:"pt-2",attrs:{name:"header"}},[e._v(" "+e._s(e.$t("CreateService"))+" ")]):0!=e.serviceId?a("h5",{staticClass:"pt-2",attrs:{name:"header"}},[e._v(" "+e._s(e.$t("EditService"))+" ")]):e._e(),a("button",{staticClass:"close",on:{click:e.ClosePopUp}},[a("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),a("div",{staticClass:"modal-body"},[a("dynamic-form",{ref:"validateService",attrs:{lang:"en",buttons:e.buttons,schema:e.FormSchema},scopedSlots:e._u([{key:"tgslot-ServiceType",fn:function(t){var i=t.data;return[a("div",{staticClass:"form-group mb-0"},[a("select",{directives:[{name:"model",rawName:"v-model",value:i.fieldInfo.value,expression:"data.fieldInfo.value"}],staticClass:"form-control",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(i.fieldInfo,"value",t.target.multiple?a:a[0])}}},e._l(i.fieldInfo.config.OptionsForBind,(function(t){return a("option",{key:t.value,domProps:{value:t.value}},[e._v(e._s(t.name))])})),0),a("span",{staticClass:"text-warning",staticStyle:{"font-size":"10px","font-weight":"400"}},[e._v(e._s(e.getServiceTypeDesc(i.fieldInfo.config.OptionsForBind,i.fieldInfo.value)))])])]}}])})],1)])])])])])},s=[],r=(a("14d9"),a("9769")),l={props:{planCode:{type:String,required:!1},isForService:{type:Boolean,required:!1},callbackfunction:{type:Function,required:!1},serviceId:{type:Number,required:!1},billingTypeOptions:{type:Array,default:[]},paymentType:{type:String,required:!1},reqform:{type:String,required:!1}},data(){return{FormSchema:[{layoutType:"triple",Data:[{astype:"SelectField",label:this.$t("billingtype"),name:"BillingTypeOptions",value:"",visibility:!0,config:{options:[],onChange:this.onChangeOfBillingType},placeholder:this.$t("Select"),validationRules:{required:!0,max:100}},{astype:"SelectField",label:this.$t("UtilityType"),name:"meterTypeId",visibility:!1,value:"",config:{options:[],onChange:this.onGetUnitByUtilityTypeId},placeholder:this.$t("Select"),validationRules:{required:!0,max:100}},{astype:"SlotField",label:this.$t("ServiceType"),name:"ServiceType",value:"",config:{options:[]},placeholder:this.$t("Select"),validationRules:{required:!0,max:100}},{astype:"TextField",label:this.$t("name"),name:"Name",value:"",placeholder:"Enter Name",validationRules:{required:!0,max:100}},{astype:"SelectField",label:this.$t("UsageMeasurement"),name:"UsageMeasurement",visibility:!1,value:"",config:{options:[]},placeholder:this.$t("Select"),validationRules:{required:!0,max:100}}]},{layoutType:"triple",Data:[{astype:"SelectField",label:this.$t("WorkType"),name:"WorkType",value:"",visibility:!1,config:{options:[]},placeholder:this.$t("Select"),validationRules:{required:!1,max:100}},{astype:"TextField",label:this.$t("ClientDefinedIdentifier"),name:"ClientDefinedIdentifier",value:"",placeholder:"",visibility:!1,validationRules:{required:!1,max:100}},{astype:"RadioField",label:this.$t("BillingFrequency"),name:"BillingFrequency",visibility:!1,disabled:!1,value:"",config:{options:[{value:"1",name:"One Time"},{value:"2",name:"Recurring"}]}},{astype:"SelectField",label:this.$t("Status"),name:"Status",value:"",config:{options:[{value:"1001",name:this.$t("Active")},{value:"1002",name:this.$t("Inactive")}]},placeholder:this.$t("Select"),validationRules:{required:!0,max:100}},{astype:"toggleField",label:this.$t("istaxble"),name:"IsTaxble",value:"",disabled:!1,config:{onChange:this.ChangeIsTaxble},validationRules:{required:!1,max:100}},{astype:"MultiSelectField",label:this.$t("SelectTaxType"),name:"SelectedTax",value:"",mode:"tag",placeholder:this.$t("SelectTaxType"),visibility:!1,config:{options:[]},validationRules:{required:!1}}]},{layoutType:"single",Data:[{astype:"TextAreaField",label:this.$t("DESCRIPTION"),name:"Description",value:"",placeholder:"",config:{rows:4},validationRules:{required:!1,max:2e3}}]}],buttons:[{type:"submit",class:"btn btn-success save",text:"<i class='fa fa-save pr-2'></i>"+this.$t("Save"),onClick:this.SaveData},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>"+this.$t("Cancel"),onClick:this.ClosePopUp}],serviceDetail:[]}},created:function(){var e=this;let t=[];e.billingTypeOptions.length>1?(e.billingTypeOptions.forEach(e=>{t.push({value:e.FEATURE_CODE,name:e.FEATURE_NAME})}),e.FormSchema.forEach((function(e,a){e.Data.forEach((function(a,i){"BillingTypeOptions"==a.name&&(a.config.options=t,a.visibility=!0,e.layoutType="triple"),"BillingFrequency"==a.name&&(a.visibility=!1)}))}))):e.FormSchema.forEach((function(t,a){t.Data.forEach((function(a,i){"BillingTypeOptions"==a.name?(a.config.options.push({name:e.billingTypeOptions[0].FEATURE_NAME,value:e.billingTypeOptions[0].FEATURE_CODE}),a.value=e.billingTypeOptions[0].FEATURE_CODE,t.layoutType="double","UTILITY_BILLING"==a.value&&(e.FormSchema[0].Data[1].visibility=!0)):"CustomerType"==a.name&&"UTILITY_BILLING"==e.billingTypeOptions[0].FEATURE_CODE&&(a.visibility=!0,t.layoutType="triple"),"BillingFrequency"==a.name&&(a.visibility=!1)}))}));var a=this.billingTypeOptions.filter((function(e){e.FEATURE_CODE}));a.length>0&&e.FormSchema.forEach((function(e,t){e.Data.forEach((function(e,t){"ClientDefinedIdentifier"==e.name&&(e.visibility=!0)}))})),e.GetTaxCategory(),e.GetDDLServiceType(),e.GetDDLWorkType(),setTimeout(()=>{e.ChangeServiceFor(),this.bindBillingFrequency(e.paymentType)},500),e.serviceId>0&&setTimeout((function(){e.BindEditDetail(e.serviceId)}),1e3),e.getMeterTypes()},methods:{getServiceTypeDesc:function(e,t){let a=this,i="";return e.forEach(e=>{e.value==t&&(i=a.$t(e.second_value))}),i},onGetUnitByUtilityTypeId:function(e,t,a){var i=this;if(""==t.value)i.$refs.validateService.updateProperty("UsageMeasurement","visibility",!1),i.$refs.validateService.UpdateKeyValue();else{var s="id=&moduleName=&type=UTILITY_UNIT_OF_MEASUREMENTS&search=&refId="+t.value;r["a"].GetDDLData(s).then(e=>{if(e.data){var t=e.data;null!=t&&(i.$refs.validateService.updateProperty("UsageMeasurement","visibility",!0),i.$refs.validateService.updateProperty("UsageMeasurement","config.options",e.data.DATA),i.$refs.validateService.UpdateKeyValue())}})}},async getMeterTypes(){const e=this;try{const t=await r["a"].GetMeterTypes();if(null!==t&&void 0!==t&&t.data){const a=JSON.parse(t.data.result).data;Array.isArray(a)&&a.length>0?(a.map(t=>{e.FormSchema[0].Data[1].config.options.push({value:t.meter_id,name:t.meter_name})}),e.$refs.validateService.UpdateKeyValue()):console.warn("No valid data found in the response")}else console.error("Invalid response structure:",t)}catch(t){console.error("Error fetching Meter types:",t)}},onChangeOfBillingType:function(e,t){let a=this;"UTILITY_BILLING"==t.value?a.FormSchema[0].Data[1].visibility=!0:a.FormSchema[0].Data[1].visibility=!1},bindBillingFrequency:function(e){var t=this;"One Time"==e?(t.$refs.validateService.updateProperty("BillingFrequency","value","1"),t.$refs.validateService.UpdateKeyValue()):(t.$refs.validateService.updateProperty("BillingFrequency","value","2"),t.$refs.validateService.UpdateKeyValue())},BindEditDetail:function(e){var t=this,a="serviceId="+e;r["a"].GetServiceListById(a).then(e=>{if("Success"==e.data.status&&JSON.parse(e.data.result).data.length>0)if(t.serviceDetail=JSON.parse(e.data.result).data,t.FormSchema[0].Data[0].value=t.serviceDetail[0].SERVICE_FOR.toUpperCase(),"UTILITY_BILLING"==t.serviceDetail[0].SERVICE_FOR?(t.FormSchema[0].Data[1].visibility=!0,t.FormSchema[0].Data[1].value=t.serviceDetail[0].METER_TYPE_ID):t.FormSchema[0].Data[1].visibility=!1,null!=t.serviceDetail[0].METER_TYPE_ID&&t.BindUnitByUtilityId(t.serviceDetail[0].METER_TYPE_ID,t.serviceDetail[0].USAGE_MEASUREMENT_ID),null!=t.serviceDetail.WORK_TYPE_ID&&(t.FormSchema[0].Data[5].value=t.serviceDetail[0].WORK_TYPE_ID),t.FormSchema[0].Data[2].value=t.serviceDetail[0].SERVICE_CODE_ID,t.FormSchema[0].Data[3].value=t.serviceDetail[0].SERVICE_NAME,t.FormSchema[0].Data[4].value=t.serviceDetail[0].USAGE_MEASUREMENT_ID,t.FormSchema[1].Data[1].value=t.serviceDetail[0].CLIENT_DEFINED_IDENTIFIER,"Recurring"==t.serviceDetail[0].SERVICE_TYPE_CODE||"Minimum Fee"==t.serviceDetail[0].SERVICE_TYPE_CODE||"Recurring Arrears"==t.serviceDetail[0].SERVICE_TYPE_CODE?t.FormSchema[1].Data[2].value="2":t.FormSchema[1].Data[2].value="1",t.FormSchema[1].Data[3].value=t.serviceDetail[0].STATUS_ID,t.FormSchema[2].Data[0].value=t.serviceDetail[0].DESCRIPTION,t.serviceDetail[0].is_taxable){t.FormSchema[1].Data[4].value=t.serviceDetail[0].is_taxable;var a=t.serviceDetail[0].TAX_IDS.split(","),i=t.TaxData.filter(e=>a.includes(e.value)),s=[];i.forEach(e=>{var t={value:e.value,label:e.name};s.push(t)}),t.FormSchema[1].Data[5].value=s,t.FormSchema[1].Data[5].visibility=!0}else t.FormSchema[1].Data[5].visibility=!1})},BindUnitByUtilityId:function(e,t){var a=this,i="id=&moduleName=&type=UTILITY_UNIT_OF_MEASUREMENTS&search=&refId="+e;r["a"].GetDDLData(i).then(e=>{if(e.data){var i=e.data;null!=i&&(a.$refs.validateService.updateProperty("UsageMeasurement","visibility",!0),a.$refs.validateService.updateProperty("UsageMeasurement","config.options",e.data.DATA),a.$refs.validateService.updateProperty("UsageMeasurement","value",t),a.$refs.validateService.UpdateKeyValue())}})},GetDDLServiceType:function(){var e=this;let t=[];e.billingTypeOptions.forEach((function(e,a){t.push(e.FEATURE_ID)}));var a="id=&moduleName=&type=TICKETING_SERVICE_TYPE&search=&refId="+t.join(",");r["a"].GetDDLData(a).then(t=>{if(t.data){var a="";a=t.data,"One Time"==e.paymentType&&null!=a?(a=a.DATA.filter(e=>"Order Based"!==e.name&&"Recurring"!==e.name&&"Recurring Arrears"!==e.name&&"Usage Based"!==e.name),e.$refs.validateService.updateProperty("ServiceType","config.options",a),e.$refs.validateService.UpdateKeyValue()):"One Time"!=e.paymentType&&null!=a&&(e.$refs.validateService.updateProperty("ServiceType","config.options",a.DATA),e.$refs.validateService.UpdateKeyValue())}})},GetDDLWorkType:function(){var e=this,t="id=&moduleName=TICKETING&type=FSM_WORKTYPE&search=&refId=";r["a"].GetDDLData(t).then(t=>{if(t.data){var a=t.data;null!=a&&e.FormSchema[1].Data[5].config.options.push(a)}})},ChangeServiceFor:function(){var e=this;("UTILITY_BILLING"==e.billingTypeOptions[0].FEATURE_CODE||"SUBSCRIPTION_BILLING"==e.billingTypeOptions[0].FEATURE_CODE)&&(e.$refs.validateService.updateProperty("WorkType","visibility",!1),e.$refs.validateService.UpdateKeyValue())},ClosePopUp:function(){var e=this;e.$parent.isCreateService=!1},async SaveData(){var e=this;const t=await e.$refs.validateService.validateForm.validate();if(t){var a=e.$refs.validateService.getPropertyValue("BillingTypeOptions","value"),i=e.$refs.validateService.getPropertyValue("meterTypeId","value"),s=e.$refs.validateService.getPropertyValue("ServiceType","value"),l=e.$refs.validateService.getPropertyValue("Name","value"),n=e.$refs.validateService.getPropertyValue("UsageMeasurement","value"),o=e.$refs.validateService.getPropertyValue("WorkType","value"),d=e.$refs.validateService.getPropertyValue("ClientDefinedIdentifier","value"),c=e.$refs.validateService.getPropertyValue("Status","value"),u=e.$refs.validateService.getPropertyValue("Description","value"),m=e.$refs.validateService.getPropertyValue("IsTaxble","value"),v=e.$refs.validateService.getPropertyValue("SelectedTax","value");if(""!=v)var p=v.map(e=>e.value).join(",");var f={ID:e.serviceId,ServiceFor:a,MeterTypeId:i,ServiceType:s,Name:l,UsageMeasurement:n,WorkType:o,ClientDefinedIdentifier:d,Status:c,Description:u,Istaxable:m,SelectedTax:p},h=JSON.stringify(f),y="objData="+encodeURIComponent(h);await r["a"].CreateNewService(y).then(t=>{null!=t.data&&("Success"==t.data.Status&&"1"==t.data.Code?(e.ShowAlert(e.$t("AddedSuccess",[e.$t("Service")]),"Success",!0,e.$t("Alert")),e.ClosePopUp(),1==e.isForService&&e.callbackfunction(),e.isLoading=!1):"Success"==t.data.Status&&"2"==t.data.Code?(e.ShowAlert(e.$t("UpdatedSuccess",[e.$t("Service")]),"Success",!0,e.$t("Alert")),e.ClosePopUp(),1==e.isForService&&e.callbackfunction(),e.isLoading=!1):"Success"==t.data.Status&&"4"==t.data.Code?e.ShowAlert(e.$t("AlreadyExists",[e.$t("Service")]),"failure",!0,e.$t("Alert")):(e.ShowAlert(e.$t("ErrorWhileSaving",[e.$t("Service")]),"danger",!0,e.$t("Alert")),e.isLoading=!1))})}},ChangeIsTaxble(e,t){var a=this;e?a.FormSchema[1].Data[5].visibility=!0:(a.FormSchema[1].Data[5].visibility=!1,a.FormSchema[1].Data[5].value="")},GetTaxCategory(){var e=this,t="id=&moduleName=&type=TAX_CATEGORY&search=&refId=";e.FormSchema[1].Data[5].config.options=[],r["a"].GetDDLData(t).then(t=>{200==t.status&&(void 0==t.data.DATA&&null==t.data.DATA||t.data.DATA.length>0&&(e.TaxData=t.data.DATA,t.data.DATA.forEach(t=>{let a={value:t.value,name:t.name};e.FormSchema[1].Data[5].config.options.push(a)}),e.$refs.validateService.UpdateKeyValue()))})}}},n=l,o=a("0c7c"),d=Object(o["a"])(n,i,s,!1,null,null,null);t["a"]=d.exports},"6c0e":function(e,t,a){var i=a("bf4b");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var s=a("499e").default;s("f0e77fc4",i,!0,{sourceMap:!1,shadowMode:!1})},7525:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("div",{staticClass:"my-popups"},[a("div",{staticClass:"modal d-block"},[a("div",{staticClass:"modal-dialog modal-dialog-centered"},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[a("h5",{staticClass:"modal-title"},[e._v("Price Change Detection")]),a("button",{staticClass:"close",attrs:{type:"button"},on:{click:e.Close}},[a("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),a("div",{staticClass:"modal-body"},[e._m(0),e.isCheckYesOrNo?a("div",{staticClass:"col-lg-12 float-left"},[a("div",{staticClass:"row flex-row-reverse mt-2"},[a("div",{staticClass:"col-lg-6 text-right"},[a("a",{staticClass:"btn btn-primary save-btn mr-2",attrs:{href:"javascript:;",title:e.$t("Yes")},on:{click:function(t){return e.CheckAdjustment("Yes")}}},[a("em",{staticClass:"fa fa-check pr-2",attrs:{"aria-hidden":"true"}}),e._v(e._s(e.$t("Yes")))]),a("a",{staticClass:"btn btn-primary delete-btn",attrs:{href:"javascript:;",title:e.$t("No")},on:{click:function(t){return e.CheckAdjustment("No")}}},[a("em",{staticClass:"fa fa-times pr-2",attrs:{"aria-hidden":"true"}}),e._v(e._s(e.$t("No")))])])])]):e._e(),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isCheckAdjustment,expression:"isCheckAdjustment"}]},[a("dynamic-form",{ref:"validateCheckAdjustment",attrs:{lang:"en",buttons:e.buttons,schema:e.FormSchema}})],1)])])])])])])},s=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("p",{staticClass:"alert alert-secondary"},[e._v("A new price change has been detected. Would you like to apply retroactive adjustments? Click 'Yes' to adjust past invoices, or 'No' to save the new pricing for future invoices.")])])])}],r={props:{retroActDetail:{type:Function,required:!1},refCodeRetro:{type:String,required:!1}},data(){return{isLoading:!1,isCheckYesOrNo:!0,isCheckAdjustment:!1,FormSchema:[{group_name:"Select Past Months for Adjustment:",layoutType:"double",Data:[{astype:"DateField",label:this.$t("StartDate"),name:"StartDate",value:"",placeholder:"",config:{format:"MM/DD/YYYY",maxDate:!1},validationRules:{required:!0}},{astype:"DateField",label:this.$t("EndDate"),name:"EndDate",value:"",placeholder:"",config:{format:"MM/DD/YYYY",maxDate:!1},validationRules:{required:!0}}]},{layoutType:"single",Data:[{astype:"RadioField",label:"What would you like to do with past invoices?",name:"chkPastInvoice",value:1,config:{options:[{value:"1",name:"Create new invoices for affected months"},{value:"2",name:"Adjust in next billing cycle"}]},placeholder:"Select",validationRules:{required:!1}}]}],buttons:[{type:"submit",class:"btn btn-success save",value:"Y",text:"<i class='fa fa-save pr-2'></i>Save",onClick:this.SaveData},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Cancel",onClick:this.Close}]}},created:async function(){var e=this;"Update"==e.refCodeRetro&&e.BindEditRetroActiveDetail(e.retroActDetail)},methods:{BindEditRetroActiveDetail(e){var t=this;this.isCheckAdjustment=!0,this.isCheckYesOrNo=!1,t.FormSchema[0].Data[0].value=e.StartDate,t.FormSchema[0].Data[1].value=e.EndDate,t.FormSchema[1].Data[0].value=e.ActionType},CheckAdjustment(e){"Yes"==e?(this.isCheckAdjustment=!0,this.isCheckYesOrNo=!1):(this.isCheckAdjustment=!1,this.$parent.isModalRetroactive=!1,this.Close())},Close:function(){var e=this;e.$parent.isModalRetroactive=!1,this.$emit("cancelRetroActiveList",!1)},async SaveData(){var e=this;const t=await e.$refs.validateCheckAdjustment.validateForm.validate();if(t){var a=e.FormSchema[0].Data[0].value,i=e.FormSchema[0].Data[1].value,s=e.FormSchema[1].Data[0].value,r={StartDate:a,EndDate:i,ActionType:s},l=JSON.stringify(r);this.$emit("retroActiveDetail",l)}}}},l=r,n=(a("944c"),a("0c7c")),o=Object(n["a"])(l,i,s,!1,null,null,null);t["a"]=o.exports},"789a":function(e,t,a){var i=a("dae9");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var s=a("499e").default;s("1ec71b44",i,!0,{sourceMap:!1,shadowMode:!1})},8584:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"my-popups"},[a("loader",{attrs:{"is-visible":e.isLoading}}),a("div",{staticClass:"modal d-block"},[a("div",{staticClass:"modal-dialog modal-dialog-centered",staticStyle:{"max-width":"1100px"}},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header theme-primary partition-full  d-flex"},[a("h4",{staticClass:"modal-title"},[e._v(e._s(e.$t("Add"))+" "+e._s(e.$t("RateCode")))]),a("button",{staticClass:"close",attrs:{type:"button"},on:{click:e.CloseRateCode}},[a("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),a("div",{staticClass:"modal-body"},[a("dynamic-form",{ref:"AddRate",attrs:{lang:"en",buttons:e.buttons,schema:e.FormSchema,mandatorytext:e.MandatoryString},on:{OnSubmit:e.SubmitData}})],1)])])])],1)},s=[],r=(a("14d9"),a("9769")),l={props:{RateObj:{type:Object,required:!0}},data(){return{isLoading:!1,ListingData:[],FormSchema:[{layoutType:"four",Data:[{astype:"SelectField",label:this.$t("RateCode"),name:"RateCode",value:"",disabled:!1,visibility:!0,config:{options:[]},placeholder:this.$t("RateCode"),validationRules:{required:!0,max:100}},{astype:"DateField",label:this.$t("EventStartDate"),name:"StartDate",value:new Date,placeholder:this.$t("EventStartDate"),config:{format:"MM/DD/YYYY",onChange:this.setTimerDate,maxDate:!1},validationRules:{required:!0}},{astype:"DateField",label:this.$t("EndDate"),name:"EndDate",value:new Date,placeholder:this.$t("EndDate"),config:{format:"MM/DD/YYYY",minDate:new Date,maxDate:!1},validationRules:{required:!0}},{astype:"NumericField",label:this.$t("Rate"),name:"Rate",value:"",placeholder:this.$t("Rate"),validationRules:{required:!0}},{astype:"SelectField",label:this.$t("Status"),name:"Status",value:"1001",placeholder:this.$t("Status"),config:{options:[{name:"Active",value:1001},{name:"Inactive",value:1002}]},validationRules:{required:!1}},{astype:"TextField",label:this.$t("CustomerWorkCode"),name:"CustomerWorkCode",value:"",placeholder:this.$t("CustomerWorkCode"),validationRules:{required:!1}}]},{layoutType:"single",Data:[{astype:"TextAreaField",label:this.$t("Comment"),name:"Comment",value:"",placeholder:"",config:{rows:3},validationRules:{required:!1,max:2e3}}]}],buttons:[{type:"submit",class:"btn btn-success",text:"<i class='fa fa-save pr-2'></i>"+this.$t("Save")},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>"+this.$t("Cancel"),onClick:this.CloseRateCode}],WorkCodeList:[],MandatoryString:this.$t("MandatoryString"),PlainId:0,RateCodeId:0}},created:function(){var e=this;e.PlainId=this.$route.params.id,e.GetWorkCodes(),null!=e.RateObj&&e.BindRateDetails()},methods:{setTimerDate:function(e,t,a){var i=this;"StartDate"==t.name&&(i.$refs.AddRate.updateProperty("EndDate","config.minDate",e),i.$refs.AddRate.UpdateKeyValue())},BindRateDetails(){var e=this;e.RateCodeId=e.RateObj.rate_schedule_id,e.FormSchema[0].Data[0].disabled=!0,e.FormSchema[0].Data[0].value=e.RateObj.workcode,e.FormSchema[0].Data[1].value=e.RateObj.start_date,e.FormSchema[0].Data[2].value=e.RateObj.end_date,e.FormSchema[0].Data[3].value=e.RateObj.rate,e.FormSchema[0].Data[4].value=e.RateObj.status_id,e.FormSchema[0].Data[5].value=e.RateObj.billing_code,e.FormSchema[1].Data[0].value=e.RateObj.comment},CloseRateCode(){this.$emit("CloseRateCode")},GetWorkCodes(){var e="moduleName=Billing&type=WORK_CODES",t=this;r["a"].GetDDLData(e).then(e=>{t.WorkCodeList=e.data.DATA,t.WorkCodeList.forEach(e=>{t.FormSchema[0].Data[0].config.options.push({name:""+e.name,value:""+e.value})}),this.$refs.AddRate.UpdateKeyValue()})},SubmitData(){var e=this;e.isLoading=!0,e.$refs.AddRate.validateForm.validate().then(async t=>{if(t){var a={RateCodeId:e.RateCodeId,PlainId:e.PlainId,WorkCodeId:e.FormSchema[0].Data[0].value,StartDate:e.FormSchema[0].Data[1].value,EndDate:e.FormSchema[0].Data[2].value,Rate:e.FormSchema[0].Data[3].value,Status:e.FormSchema[0].Data[4].value,CustomerWorkCode:e.FormSchema[0].Data[5].value,Comment:e.FormSchema[1].Data[0].value,ClientId:null},i=JSON.stringify(a);r["a"].SaveRateCode(i).then((function(t){t.data.Result.DATA.length>0?(e.isLoading=!1,"INSERT"==t.data.Result.DATA[0].VALUE?(e.ShowAlert(e.$t("AddedSuccess",[e.$t("Rate")]),"success",!0,e.$t("Alert")),e.CloseRateCode()):"UPDATE"==t.data.Result.DATA[0].VALUE?(e.ShowAlert(e.$t("UpdatedSuccess",[e.$t("Rate")]),"success",!0,e.$t("Alert")),e.CloseRateCode()):"EXISTS"==t.data.Result.DATA[0].VALUE?e.ShowAlert(e.$t("AlreadyExists",[e.$t("Rate")]),"warning",!0,e.$t("Alert")):e.ShowAlert(e.$t("UnknownErrorOccur"),"failure",!0,e.$t("Alert"))):e.ShowAlert(e.$t("UnknownErrorOccur"),"failure",!0,e.$t("Alert"))}))}else e.isLoading=!1})}}},n=l,o=a("0c7c"),d=Object(o["a"])(n,i,s,!1,null,null,null);t["a"]=d.exports},8759:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("tg-list",{attrs:{IsShowAction:!0,ModuleName:"Ticketing",SubModuleCode:"Ticketing",IdentityColumn:"plan_inventory_id",HeaderText:e.$t("Inventory"),listType:["List"],LegendArray:[],ListData:e.PlanInventoryListing,RenderRowActionMethod:e.renderActions,HeaderData:e.Headers,TotalRecords:e.TotalRecords,ListDataCallBackFunction:e.FetchRecords,showCheckBox:!1,SortExp:e.SortExp,SortBy:e.SortBy,NorecordfoundText:e.$t("NoRecordfound"),HeaderButtons:e.HeaderButtons},on:{ActionButtonClick:e.actionButtonClick,PagerButtonClick:e.pagerMethod,HeaderButtonClick:e.commonHeaderButtonClick,SortdataButtonClick:e.sortdata},scopedSlots:e._u([{key:"slotdata",fn:function(t){var i=t.data;return["product_code"==i.column.COLUMN_NAME?[e._v(" "+e._s(i.row.product_code)+" ")]:e._e(),"product_type"==i.column.COLUMN_NAME?[e._v(" "+e._s(i.row.product_type)+" ")]:e._e(),"product_name"==i.column.COLUMN_NAME?[e._v(" "+e._s(i.row.product_name)+" ")]:e._e(),"quantity"==i.column.COLUMN_NAME?[a("input",{directives:[{name:"model",rawName:"v-model",value:i.row.quantity,expression:"data.row.quantity"}],staticClass:"form-control",attrs:{type:"text",id:"quantity",name:"quantity"},domProps:{value:i.row.quantity},on:{input:function(t){t.target.composing||e.$set(i.row,"quantity",t.target.value)}}})]:e._e()]}}])}),e.isExistingInventory?a("AddInventory",{attrs:{callbackfunction:e.FetchRecords,PlanId:e.PlanId}}):e._e()],1)},s=[],r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("div",{staticClass:"my-popups"},[a("div",{staticClass:"modal d-block"},[a("div",{staticClass:"modal-dialog modal-dialog-centered ui-draggable"},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header ui-draggable-handle py-1"},[a("h5",{staticClass:"pt-2",attrs:{name:"header"}},[e._v(" "+e._s(e.$t("Inventory"))+" ")]),a("button",{staticClass:"close",on:{click:e.ClosePopUp}},[a("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"listing"},[a("div",{staticClass:"table-responsive table-fix-header",staticStyle:{"max-height":"500px"}},[a("table",{staticClass:"table table-bordered dt-responsive nowrap mt-0"},[a("thead",{staticClass:"thead-bg"},[a("tr",{staticClass:"text-capitalize"},[a("th",{staticClass:"text-center",staticStyle:{width:"5%"}},[a("label",{staticClass:"form-check form-check-inline"},[a("div",{staticClass:"custom-control custom-checkbox custom-control-inline"},[a("input",{staticClass:"chkitems1 custom-control-input",attrs:{type:"checkbox",id:"talygenAssetCheckAll",name:"selectedItems1"},domProps:{checked:e.selectAll},on:{change:e.selectAllItems}}),a("label",{staticClass:"custom-control-label",attrs:{for:"talygenAssetCheckAll"}})])])]),a("th",{attrs:{scope:"col"}},[e._v(e._s(e.$t("ProductName")))]),a("th",{staticClass:"text-center",attrs:{scope:"col"}},[e._v(e._s(e.$t("ProductType")))]),a("th",{staticClass:"text-center",attrs:{scope:"col"}},[e._v(e._s(e.$t("ProductCode")))]),a("th",{staticClass:"text-center",attrs:{scope:"col"}},[e._v(e._s(e.$t("Quantity")))])])]),a("tbody",[0===e.InventoryListing.length?a("tr",[a("td",{staticClass:"text-center text-danger no-record",attrs:{colspan:"4"}},[e._v(" "+e._s(e.$t("NoRecordfound"))+" ")])]):e._l(e.InventoryListing,(function(t,i){return a("tr",{key:i},[a("td",{staticClass:"text-center"},[a("label",{staticClass:"form-check form-check-inline"},[a("div",{staticClass:"custom-control custom-checkbox custom-control-inline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedItems,expression:"selectedItems"}],staticClass:"chkitems custom-control-input",attrs:{type:"checkbox",id:"tabletablebordered"+i,name:"selectedItems"},domProps:{value:t.asset_catalogue_id,checked:Array.isArray(e.selectedItems)?e._i(e.selectedItems,t.asset_catalogue_id)>-1:e.selectedItems},on:{change:[function(a){var i=e.selectedItems,s=a.target,r=!!s.checked;if(Array.isArray(i)){var l=t.asset_catalogue_id,n=e._i(i,l);s.checked?n<0&&(e.selectedItems=i.concat([l])):n>-1&&(e.selectedItems=i.slice(0,n).concat(i.slice(n+1)))}else e.selectedItems=r},e.updateSelectAll]}}),a("label",{staticClass:"custom-control-label",attrs:{for:"tabletablebordered"+i}})])])]),a("td",[e._v(e._s(t.product_name))]),a("td",{staticClass:"text-center"},[e._v(e._s(t.product_type))]),a("td",{staticClass:"text-center"},[e._v(e._s(t.product_code))]),a("td",{staticClass:"text-center"},[e._v(e._s(t.quantity))])])}))],2)])])])]),a("div",{staticClass:"modal-footer"},[a("a",{staticClass:"btn btn-success save-btn mr-2",attrs:{href:"javascript:;",title:"Save"},on:{click:e.SaveData}},[a("i",{staticClass:"fa fa-floppy-o pr-2"}),e._v(e._s(e.$t("Save"))+" ")]),a("a",{staticClass:"btn btn-danger delete-btn",attrs:{href:"javascript:;",title:"Cancel"},on:{click:e.ClosePopUp}},[a("i",{staticClass:"fa fa-times pr-2"}),e._v(e._s(e.$t("Cancel"))+" ")])])])])])])])},l=[],n=(a("14d9"),a("9769")),o={props:{PlanId:{type:Number,required:!1},callbackfunction:{type:Function}},data(){return{isLoading:!1,InventoryListing:[],selectedItems:[],selectAll:!1,noRecord:!1,CurrentPage:1,TotalPages:0,TotalRecords:0,SortBy:"",SortExp:"",PageSize:"10",GroupStart:1,GroupEnd:3,PageNumber:"1"}},async created(){await this.GetInventoryList()},methods:{async GetInventoryList(){var e=this;e.isLoading=!0;const t=`pagesize=${e.PageSize}&pagenumber=${e.PageNumber}&plan_id=${e.PlanId}&sortBy=${e.SortBy}&sortExp=${e.SortExp}&search=`;await n["a"].GetInventoryList(t).then(t=>{(t.data.Status="Success")&&(""!=t.data&&null!=t.data&&t.data.result.data.length>0?(e.InventoryListing=t.data.result.data,e.TotalRecords=t.data.result.data[0].TOTALRECORDS,e.noRecord=!1):(e.noRecord=!0,e.TotalRecords=0,e.InventoryListing=[]))})},selectAllItems(){var e=this;this.selectAll=!this.selectAll,this.selectAll?this.InventoryListing.forEach((function(t){e.selectedItems.push(t.asset_catalogue_id)})):this.selectedItems=[]},updateSelectAll(){var e=this;const t=this.InventoryListing.length,a=this.selectedItems.length;e.selectAll=t>0&&a===t},async SaveData(){var e=this;const t=e.InventoryListing.filter(e=>this.selectedItems.includes(e.asset_catalogue_id)),a=JSON.stringify(t);var i={objData:a,planId:e.PlanId};await n["a"].AddSelectedInventory(i).then(t=>{null!=t.data&&("Success"==t.data.Status&&"1"==t.data.Code?(e.ShowAlert(e.$t("AddedSuccess",[e.$t("Inventory")]),"Success",!0,e.$t("Alert")),e.ClosePopUp(),e.callbackfunction(),e.isLoading=!1):(e.ShowAlert(e.$t("ErrorWhileSaving",[e.$t("Inventory")]),"danger",!0,e.$t("Alert")),e.isLoading=!1))})},ClosePopUp(){this.$parent.isExistingInventory=!1}}},d=o,c=a("0c7c"),u=Object(c["a"])(d,r,l,!1,null,null,null),m=u.exports,v={components:{AddInventory:m},data(){return{noRecords:!1,TotalRecords:0,CurrentPage:1,PlanId:0,isExistingInventory:!1,TotalPages:0,StatusListForListing:[{STATUS:"Active",STATUS_ID:1001,STATUS_COLOR:"#ffffff",STATUS_BG_COLOR:"#28a745"},{STATUS:"Inactive",STATUS_ID:1002,STATUS_COLOR:"#ffffff",STATUS_BG_COLOR:"#d72435"}],SortBy:"",SortExp:"",PageSize:"10",PageNumber:"1",GroupStart:1,GroupEnd:3,Headers:[{COLUMN_NAME:"product_code",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("ProductCode"),DISPLAY_ORDER:1},{COLUMN_NAME:"product_type",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("ProductType"),DISPLAY_ORDER:2},{COLUMN_NAME:"product_name",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("ProductName"),DISPLAY_ORDER:3},{COLUMN_NAME:"quantity",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Quantity",DISPLAY_ORDER:4}],HeaderButtons:[{title:"SaveInventory",iconClass:"fa fa-save",callbackfunction:"saveInventory",additionalClass:"",isdisabled:!1,isvisible:!0,checkPrivilege:!0,id:"SaveInventory"},{title:"SelectInventory",iconClass:"fa fa-plus",callbackfunction:"openSelectInventory",additionalClass:"",isdisabled:!1,isvisible:!0,checkPrivilege:!0,id:"SelectInventory"},{title:"BacktoList",iconClass:"fa fa-angle-double-left",href:"/Plan/PlanListing",additionalClass:"",isdisabled:!1,isvisible:!0,checkPrivilege:!0,id:"BackToList"}],listActions:[{title:"Delete",href:"javascript:void(0)",icon:"fa fa-trash",callbackfunction:"DeleteService",additionalSpan:""}],PlanInventoryListing:[]}},created:async function(){this.PlanId=parseInt(this.$route.params.id),await this.FetchRecords()},methods:{FetchRecords:async function(){const e=`planId=${this.PlanId}&sortBy=${this.SortBy}&sortExp=${this.SortExp}&pagesize=${this.PageSize}&pagenumber=${this.PageNumber}`;try{const t=await n["a"].GetPlanInventoryListing(e);t.data&&t.data.result?(this.Headers.forEach(e=>{e.settings=null,"product_code"==e.COLUMN_NAME&&(e.settings={isInSlot:!0}),"product_type"==e.COLUMN_NAME&&(e.settings={isInSlot:!0}),"product_name"==e.COLUMN_NAME&&(e.settings={isInSlot:!0}),"quantity"==e.COLUMN_NAME&&(e.settings={isInSlot:!0})}),t.data.result.data.length>0?(this.PlanInventoryListing=t.data.result.data,this.TotalRecords=t.data.result.data[0].TOTALRECORDS,this.TotalPages=Math.ceil(this.TotalRecords/this.PageSize),this.CurrentPage=this.PageNumber,this.noRecords=!1):(this.noRecords=!0,this.TotalRecords=0,this.PlanInventoryListing=[])):(this.noRecords=!0,this.TotalRecords=0,this.PlanInventoryListing=[]),setTimeout(()=>{this.ResponsiveDataTable("tablelistingdata")},500)}catch(t){console.error("Error fetching records:",t),this.noRecords=!0,this.TotalRecords=0,this.PlanInventoryListing=[]}},pagerMethod:function(e){this.PageSize=e.PageSize,this.PageNumber=e.PageNumber,this.FetchRecords()},sortdata:function(e){this.SortBy=e,this.SortExp="ASC"===this.SortExp?"DESC":"ASC",this.PageNumber=1,this.GroupStart=this.PageNumber,this.GroupEnd=this.PageNumber+2,this.FetchRecords()},commonHeaderButtonClick:function(e){"openSelectInventory"===e.callbackfunction?this.openSelectInventory():"saveInventory"===e.callbackfunction&&this.SaveData()},openSelectInventory:function(){this.isExistingInventory=!0},renderActions:function(e){return this.listActions.map(e=>({...e,isVisible:!0}))},actionButtonClick(e,t){"DeleteService"===e&&this.DeleteInventoryData(t.plan_inventory_id)},DeleteInventoryData:function(e){e>0?this.confirmR(this.$t("ConfirmDelete"),!0,`${this.$t("Delete")} ${this.$t("Service")}`,()=>{const t={ids:e,moduleName:"BILLING",refCode:"TALYGEN_PLAN_INVENTORY"};n["a"].CommonCommonDelete(JSON.stringify(t)).then(e=>{200===e.status?(this.FetchRecords(),this.ShowAlert(this.$t("DeletedSuccess",[this.$t("Inventory")]),"Success",!0,this.$t("Alert"))):this.ShowAlert(this.$t("DeletedError",[this.$t("Inventory")]),"failure",!0,this.$t("Alert"))})}):this.ShowAlert(this.$t("Selectanyrecordtodelete"),"warning",!0,this.$t("Alert"))},async SaveData(){var e=this;const t=this.PlanInventoryListing.map(e=>({plan_inventory_id:e.plan_inventory_id,quantity:e.quantity,asset_catalogue_id:e.asset_catalogue_id})),a=JSON.stringify(t),i={objData:a,planId:e.PlanId};await n["a"].SavePlanInventory(i).then(t=>{null!=t.data&&("Success"==t.data.Status&&"1"==t.data.Code?(e.ShowAlert(e.$t("UpdatedSuccess",[e.$t("Inventory")]),"Success",!0,e.$t("Alert")),e.FetchRecords(),e.isLoading=!1):(e.ShowAlert(e.$t("ErrorWhileSaving",[e.$t("Inventory")]),"danger",!0,e.$t("Alert")),e.isLoading=!1))})}}},p=v,f=Object(c["a"])(p,i,s,!1,null,null,null);t["a"]=f.exports},"8b13":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("div",{staticClass:"col-md-12 border p-3"},[a("div",{staticClass:"col-md-12 p-0"},[a("dynamic-form",{ref:"refAddress",attrs:{lang:"en",buttons:!1,schema:e.FormSchema},scopedSlots:e._u([{key:"tgslot-NextBillCycle",fn:function(t){t.data;return[a("label",{staticClass:"mr-2",attrs:{for:"one"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.NextBillpicked,expression:"NextBillpicked"}],attrs:{type:"radio",id:"1",value:"1"},domProps:{checked:e._q(e.NextBillpicked,"1")},on:{change:[function(t){e.NextBillpicked="1"},function(t){return e.OnChangeIncludeUnpaidEMIinNextBill(t)}]}}),e._v(" "+e._s(e.$t("Yes")))]),a("label",{staticClass:"mr-2",attrs:{for:"two"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.NextBillpicked,expression:"NextBillpicked"}],attrs:{type:"radio",id:"0",value:"0"},domProps:{checked:e._q(e.NextBillpicked,"0")},on:{change:[function(t){e.NextBillpicked="0"},function(t){return e.OnChangeIncludeUnpaidEMIinNextBill(t)}]}}),e._v(" "+e._s(e.$t("No")))]),a("div",{staticClass:"impact",staticStyle:{display:"block"},attrs:{id:"impactYes"}},[a("strong",[e._v(e._s(e.$t("ImpactofSelecting"))+" "+e._s(e.$t(e.isUnpaidEMINextBill))+":")]),a("ul",[a("li",[e._v(e._s("Yes"==e.isUnpaidEMINextBill?e.$t("Theunpaidinstallmenamount"):e.$t("Theunpaidinstallmentamounwillnotbeincludedinyounextbill")))]),a("li",[e._v(e._s("Yes"==e.isUnpaidEMINextBill?e.$t("Thismayincreaseyourtotalbillamountsignificantly"):e.$t("Youwillneedtopayanyunpaidinstallmentsseparately")))]),a("li",[e._v(e._s("Yes"==e.isUnpaidEMINextBill?e.$t("Youwillreceivenotificationsabouttheupcomingpaymentdue"):e.$t("Thishelpsyoukeeptrackofyourcurrentchargesmoreclearly"))+" ")])])])]}}])})],1),a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("div",{staticClass:"row flex-row-reverse my-3 "},[a("div",{staticClass:"col-lg-6 text-right"},[a("a",{staticClass:"btn btn-success",attrs:{title:"",id:"addAddress","data-toggle-tooltip":"tooltip","data-original-title":"Save"},on:{click:e.onSubmit}},[a("i",{staticClass:"fa fa-save mr-2"}),a("span",{attrs:{id:"btnAddressText"}},[e._v(" "+e._s(e.$t("Save")))])])]),a("div",{staticClass:"col-lg-6"},[a("div",{staticClass:"py-2"},[a("span",{staticClass:"mandatory"},[e._v(e._s(e.$t("Mandatory")))])])])])])])])])},s=[],r=(a("14d9"),a("9769")),l={data(){return{isUnpaidEMINextBill:"No",NextBillpicked:0,checkedNames:[],FormSchema:[{layoutType:"double",group_name:"installment Conversion Options",Data:[{astype:"NumericField",label:this.$t("MaximumConversionsPerYear"),name:"Maximum Conversions per Year:",value:null,placeholder:"",validationRules:{required:!0}},{astype:"NumericField",label:this.$t("MinimumAmountforEMI"),name:"Minimum Amount for installment ($):",value:null,placeholder:"",validationRules:{required:!0}},{astype:"NumericField",label:this.$t("MaximumAmountforEMI"),name:"Maximum Amount for installment ($):",value:"",placeholder:""},{astype:"CheckBoxField",label:this.$t("InstallmentDurationOptions"),name:"EMIDurationOptions:",value:"",mode:"tag",placeholder:"",visibility:!0,config:{options:[{name:"3 "+this.$t("months"),value:"1"},{name:"6 "+this.$t("months"),value:"2"},{name:"12 "+this.$t("months"),value:"3"}],onChange:this.OnChangeEMIDurationOptions},validationRules:""},{astype:"NumericField",label:"Interest Rate for 3 Months (%)",name:"Interest Rate for 3 Months (%)",value:null,placeholder:"",visibility:!1},{astype:"NumericField",label:"Interest Rate for 6 Months (%)",name:"Interest Rate for 6 Months (%)",value:null,placeholder:"",visibility:!1},{astype:"NumericField",label:"Interest Rate for 12 Months (%)",name:"Interest Rate for 12 Months (%)",value:null,placeholder:"",visibility:!1},{astype:"NumericField",label:this.$t("ProcessingFee"),name:"Processing Fee ($):",value:null,placeholder:""}]},{layoutType:"single",group_name:"NextBillingCycleIntegration",Data:[{astype:"SlotField",label:this.$t("IncludeUnpaidinstallmentinNextBill"),name:"NextBillCycle",value:"",placeholder:"",settings:{isInSlot:!0}}]}]}},created:function(){this.planId=parseInt(this.$route.params.id),this.GetEMIConfigData(this.planId)},methods:{GetEMIConfigData:function(e){const t=this,a="planid="+e;r["a"].GetEMIOptionSettingData(a).then(e=>{const a=JSON.parse(e.data.result).DATA[0];if(a){if(a.emi_duration_options.length>0){const e=JSON.parse(a.emi_duration_options);t.FormSchema[0].Data[3].value=e,JSON.parse(a.emi_duration_options).forEach(e=>{switch(e){case"1":t.FormSchema[0].Data[4].visibility=!0,t.FormSchema[0].Data[4].value=a.interest_rate_for_three_months;break;case"2":t.FormSchema[0].Data[5].visibility=!0,t.FormSchema[0].Data[5].value=a.interest_rate_for_six_months;break;case"3":t.FormSchema[0].Data[6].visibility=!0,t.FormSchema[0].Data[6].value=a.interest_rate_for_twelve_months;break}})}else t.FormSchema[0].Data[4].visibility=!1,t.FormSchema[0].Data[5].visibility=!1,t.FormSchema[0].Data[6].visibility=!1;t.FormSchema[2].Data[0].value=[];const e=null!=a.upcoming_payment_reminders?a.upcoming_payment_reminders.toString():"",i=null!=a.due_date_alerts?a.due_date_alerts.toString():"";t.FormSchema[2].Data[0].value=[e,i],t.FormSchema[2].Data[1].value=[];const s=null!=a.show_emi_status?a.show_emi_status.toString():"",r=null!=a.show_remaining_balance?a.show_remaining_balance.toString():"";t.FormSchema[2].Data[1].value=[s,r],t.FormSchema[3].Data[4].value=[];const l=null!=a.Enable_automatic_payments_for_emi?a.Enable_automatic_payments_for_emi.toString():"",n=null!=a.is_terms_conditions?a.is_terms_conditions.toString():"";t.FormSchema[3].Data[4].value.push(l,n),t.FormSchema[0].Data[0].value=a.maximum_conversions_per_year.toString(),t.FormSchema[0].Data[1].value=a.minimum_Amount_For_EMI,t.FormSchema[0].Data[2].value=a.maximum_amount_for_eMI,t.FormSchema[0].Data[4].value=a.interest_rate_for_three_months,t.FormSchema[0].Data[5].value=a.interest_rate_for_six_months,t.FormSchema[0].Data[6].value=a.interest_rate_for_twelve_months,t.FormSchema[0].Data[7].value=a.processing_fee,t.NextBillpicked=a.include_unpaid_emi_in_next_bill?1:0,0==t.NextBillpicked?t.isUnpaidEMINextBill="No":t.isUnpaidEMINextBill="Yes",1==a.automatic_payments&&(t.FormSchema[3].Data[1].visibility=!0,t.FormSchema[3].Data[2].visibility=!0,t.FormSchema[3].Data[3].visibility=!0,t.FormSchema[3].Data[4].visibility=!0),t.FormSchema[3].Data[0].value=a.automatic_payments,t.FormSchema[3].Data[1].value=a.account_type,t.FormSchema[3].Data[2].value=a.bank_account_number,t.FormSchema[3].Data[3].value=a.routing_number}})},OnChangeIncludeUnpaidEMIinNextBill:function(e,t){var a=this;let i=e.target.value;a.isUnpaidEMINextBill=0==i?"No":"Yes"},OnChangeEMIDurationOptions:function(e,t){var a=this;e.target.getAttribute("data-value");a.FormSchema[0].Data[4].visibility=!1,a.FormSchema[0].Data[5].visibility=!1,a.FormSchema[0].Data[6].visibility=!1,a.FormSchema[0].Data[3].value.forEach(e=>{switch(e){case"1":a.FormSchema[0].Data[4].visibility=!0;break;case"2":a.FormSchema[0].Data[5].visibility=!0;break;case"3":a.FormSchema[0].Data[6].visibility=!0;break}})},onChangeAutomaticPayments:function(e,t){const a=this,i="1"==e.target.getAttribute("data-value");for(let s=1;s<=4;s++)a.FormSchema[3].Data[s].visibility=i},onSubmit(){var e=this;e.$refs.refAddress.validateForm.validate().then(async t=>{if(t)if(0!=e.FormSchema[0].Data[3].value.length){var a={planId:this.planId,maximum_conversions_per_year:e.FormSchema[0].Data[0].value,minimum_Amount_For_EMI:e.FormSchema[0].Data[1].value,maximum_amount_for_eMI:e.FormSchema[0].Data[2].value,emi_duration_options:JSON.stringify(e.FormSchema[0].Data[3].value),interest_rate_for_three_months:e.FormSchema[0].Data[4].value,interest_rate_for_six_months:e.FormSchema[0].Data[5].value,interest_rate_for_twelve_months:e.FormSchema[0].Data[6].value,processing_fee:e.FormSchema[0].Data[7].value,include_unpaid_emi_in_next_bill:e.NextBillpicked,automatic_payments:e.FormSchema[3].Data[1].value,account_type:e.FormSchema[3].Data[1].value,bank_account_number:e.FormSchema[3].Data[2].value,routing_number:e.FormSchema[3].Data[3].value,auto_pay_for_EMI:"",upcoming_payment_reminders:e.FormSchema[2].Data[0].value[0],due_date_alerts:e.FormSchema[2].Data[0].value[1],show_remaining_balance:e.FormSchema[2].Data[1].value[0],show_emi_status:e.FormSchema[2].Data[1].value[1],Enable_automatic_payments_for_emi:e.FormSchema[3].Data[4].value[0],is_terms_conditions:e.FormSchema[3].Data[4].value[1]},i=JSON.stringify(a);let t="objData="+i;r["a"].SaveEMIConfiguration(t).then(t=>{null!=t.data&&(1==t.data.Code?e.ShowAlert(e.$t("installment Configuration saved successfully."),"success"):2==t.data.Code?e.ShowAlert(e.$t("installment Configuration updated successfully."),"success"):e.ShowAlert(e.$t("UnknownError"),"failure",e.$t("Alert")))})}else e.ShowAlert(e.$t("Select at least one installment Duration."),"failure",e.$t("Alert"))})}}},n=l,o=a("0c7c"),d=Object(o["a"])(n,i,s,!1,null,null,null);t["a"]=d.exports},9362:function(e,t,a){var i=a("24fb");t=i(!1),t.push([e.i,".alert{background-color:#e9ecef;border:1px solid #ced4da;border-radius:.25rem;padding:1rem;font-size:1.1rem;color:#050505}",""]),e.exports=t},"944c":function(e,t,a){"use strict";a("a15a")},"97ba":function(e,t,a){"use strict";a("dc34")},"9dac":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("div",{staticClass:"my-popups"},[a("loader",{attrs:{"is-visible":e.isLoading}}),a("div",{staticClass:"modal d-block"},[a("div",{staticClass:"modal-dialog modal-dialog-centered"},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[a("h5",{staticClass:"modal-title"},[e._v("Enable Minimum Charge")]),a("button",{staticClass:"close",attrs:{type:"button"},on:{click:e.Close}},[a("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),a("div",{staticClass:"modal-body"},[a("dynamic-form",{ref:"validateEnableMinimumCharge",attrs:{lang:"en",buttons:e.buttons,schema:e.FormSchema},scopedSlots:e._u([{key:"tgslot-LimitLayout",fn:function(t){t.data;return e._l(e.Mainleveldiv,(function(t,i){return a("div",{key:i,staticClass:"row"},[a("div",{staticClass:"col-md-2"},[a("label",[e._v("Service Name:")]),a("Field",{attrs:{name:"ServiceName",rules:{required:!0}},scopedSlots:e._u([{key:"default",fn:function(s){var r=s.errors;return[a("select",{directives:[{name:"model",rawName:"v-model",value:t.serviceId,expression:"item.serviceId"}],staticClass:"form-control level",class:{"form-control":!0,"is-invalid":r[0]},attrs:{name:"ServiceName"},on:{change:function(a){var i=Array.prototype.filter.call(a.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(t,"serviceId",a.target.multiple?i:i[0])}}},[a("option",{attrs:{value:""}},[e._v("Select Service")]),e._l(e.ServiceNameData,(function(t){return a("option",{key:t.value,domProps:{value:t.value}},[e._v(e._s(t.name))])}))],2),r[0]?a("span",{staticClass:"invalid-feedback d-block",attrs:{name:"ServiceName"+i}},[e._v(" "+e._s(r[0])+" ")]):e._e()]}}],null,!0)})],1),a("div",{staticClass:"col-md-2"},[a("div",{staticClass:"form-group"},[a("label",[e._v("Limit type:")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.limitType,expression:"item.limitType"}],staticClass:"form-control",on:{change:function(a){var i=Array.prototype.filter.call(a.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(t,"limitType",a.target.multiple?i:i[0])}}},[a("option",{attrs:{value:"HM3"}},[e._v("HM3")]),a("option",{attrs:{value:"MMBTU"}},[e._v("MMBTU")])])])]),a("div",{staticClass:"col-md-2"},[a("div",{staticClass:"form-group"},[a("label",[e._v("Limit from:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.limitFrom,expression:"item.limitFrom"}],staticClass:"form-control",attrs:{type:"number"},domProps:{value:t.limitFrom},on:{input:function(a){a.target.composing||e.$set(t,"limitFrom",a.target.value)}}})])]),a("div",{staticClass:"col-md-2"},[a("div",{staticClass:"form-group"},[a("label",[e._v("Limit to:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.limitTo,expression:"item.limitTo"}],staticClass:"form-control",attrs:{type:"number"},domProps:{value:t.limitTo},on:{input:function(a){a.target.composing||e.$set(t,"limitTo",a.target.value)}}})])]),a("div",{staticClass:"col-md-2"},[a("div",{staticClass:"form-group"},[a("label",[e._v("Rate:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.rate,expression:"item.rate"}],staticClass:"form-control",attrs:{type:"number"},domProps:{value:t.rate},on:{input:function(a){a.target.composing||e.$set(t,"rate",a.target.value)}}})])]),a("div",{staticClass:"col-md-2"},[a("label",{attrs:{for:"action"}}),a("div",{staticClass:"input-group"},[0==i?a("em",{staticClass:"round-icon-small fa fa-plus bg-success float-none",on:{click:e.addRow}}):e._e(),0!=i?a("em",{staticClass:"round-icon-small fa fa-minus bg-danger float-none",on:{click:function(t){return e.deleteRow(i)}}}):e._e()])])])}))}}])})],1)])])])],1)])},s=[],r=(a("14d9"),a("9769")),l={props:{editEnableLimitData:{type:Function,required:!1},refCodeCharge:{type:String,required:!1},MonthApplicable:{type:Array,required:!1}},data(){return{isLoading:!1,Mainleveldiv:[{serviceId:"",limitType:"",limitFrom:"",limitTo:"",rate:""}],ServiceNameData:[],FormSchema:[{layoutType:"single",Data:[{astype:"CheckBoxField",label:"Applicable From Month",name:"ApplicableFromMonth",value:"",mode:"tag",placeholder:"",visibility:!0,config:{options:[{name:"Jan",value:"1"},{name:"Feb",value:"2"},{name:"Mar",value:"3"},{name:"Apr",value:"4"},{name:"May",value:"5"},{name:"Jun",value:"6"},{name:"Jul",value:"7"},{name:"Aug",value:"8"},{name:"Sep",value:"9"},{name:"Oct",value:"10"},{name:"Nov",value:"11"},{name:"Dec",value:"12"}]},validationRules:{required:!0}}]},{layoutType:"single",visibility:!0,Data:[{astype:"SlotField",label:"",name:"LimitLayout",value:"",visibility:!0,placeholder:"",config:{options:[]},validationRules:""}]}],buttons:[{type:"submit",class:"btn btn-success save",value:"Y",text:"<i class='fa fa-save pr-2'></i>Save",onClick:this.SaveData},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Cancel",onClick:this.Close}]}},created(){var e=this;e.GetDDLServiceName(),"Update"==e.refCodeCharge&&setTimeout(()=>{this.BindEnableChargeDetail(e.editEnableLimitData)},500)},methods:{BindEnableChargeDetail(e){var t=this;t.$refs.validateEnableMinimumCharge.updateProperty("ApplicableFromMonth","value",t.MonthApplicable),t.$refs.validateEnableMinimumCharge.UpdateKeyValue(),t.Mainleveldiv=e.map(e=>({serviceId:e.serviceId,limitType:e.limitType,limitFrom:e.limitFrom,limitTo:e.limitTo,rate:e.rate}))},SaveData(){const e=this.$refs.validateEnableMinimumCharge.getPropertyValue("ApplicableFromMonth","value"),t={applicableForMonth:e,limitData:this.Mainleveldiv.map(e=>{const t=this.ServiceNameData.find(t=>t.value===String(e.serviceId)),a=t?t.name:"";return{serviceId:e.serviceId,serviceName:a,limitType:e.limitType,limitFrom:e.limitFrom,limitTo:e.limitTo,rate:e.rate}})},a=t.limitData.map(e=>e.serviceName).join(", ");t.serviceNamesCSV=a,this.$emit("minimumChargesDetail",t)},addRow(){this.Mainleveldiv.push({serviceId:"",limitType:"",limitFrom:"",limitTo:"",rate:""})},deleteRow(e){this.Mainleveldiv.length>1&&this.Mainleveldiv.splice(e,1)},Close(){this.$parent.isEnableMinimiumCharge=!1},GetDDLServiceName:function(){var e=this,t="id=&moduleName=BILLING&type=BILLING_SERVICE_NAME&search=&refId=";r["a"].GetDDLData(t).then(t=>{200==t.status&&(void 0==t.data.DATA&&null==t.data.DATA||t.data.DATA.forEach(t=>{e.ServiceNameData.push({value:t.value,name:t.name})}))})}}},n=l,o=a("0c7c"),d=Object(o["a"])(n,i,s,!1,null,null,null);t["a"]=d.exports},a15a:function(e,t,a){var i=a("9362");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var s=a("499e").default;s("7d1ad68e",i,!0,{sourceMap:!1,shadowMode:!1})},b91c:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("div",{staticClass:"modal my-popups right fade show d-block"},[a("div",{staticClass:"modal-dialog modal-dialog-right"},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header mheader-user"},[a("button",{staticClass:"close",attrs:{type:"button"},on:{click:function(t){return e.close()}}},[a("i",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})]),a("h4",{staticClass:"modal-title"},[e._v(e._s(e.modelDetail.RULE_NAME?e.modelDetail.RULE_NAME:e.modelDetail.BILLING_RULE_NAME)+" ")])]),a("div",{staticClass:"modal-body p-0"},[e.modelDetail.CONFIGURATION_ID?a("div",{staticClass:"tab-content",staticStyle:{"overflow-x":"hidden",height:"800px","max-height":"800px"}},[a("FlowChartWrapper",{attrs:{configurationId:e.modelDetail.CONFIGURATION_ID.toString()}})],1):e._e()])])])])])},s=[],r=a("1d91"),l={components:{FlowChartWrapper:r["a"]},props:{modelDetail:{type:[Object,Array],required:!0}},data(){return{configId:""}},created(){var e;this.configId=(null===(e=this.modelDetail.CONFIGURATION_ID)||void 0===e?void 0:e.toString())||""},methods:{close(){this.$parent.modelopen=!1}}},n=l,o=a("0c7c"),d=Object(o["a"])(n,i,s,!1,null,"3846242c",null);t["a"]=d.exports},bb1a:function(e,t,a){"use strict";a("dfaf")},bc07:function(e,t,a){var i=a("24fb");t=i(!1),t.push([e.i,"AddConditionsWithPlan[data-v-7b601fb4]{position:relative;z-index:9999}.conditionbase[data-v-7b601fb4]{background-color:#f8f9fa;border:1px solid #dee2e6;border-radius:20px;padding:8px 15px;color:#495057;margin-right:10px;margin-bottom:10px;float:left}tr.selected_tr[data-v-7b601fb4]{background:#e8eaea!important}",""]),e.exports=t},bf4b:function(e,t,a){var i=a("24fb");t=i(!1),t.push([e.i,"#BillingFrequencyType{flex:0 0 100%;max-width:100%}",""]),e.exports=t},c782:function(e,t,a){"use strict";a("ecb4")},dae9:function(e,t,a){var i=a("24fb");t=i(!1),t.push([e.i,".task-dec{color:#007bff!important;text-decoration:none;background-color:transparent}td.single-action{width:120px}",""]),e.exports=t},db27:function(e,t,a){var i=a("24fb");t=i(!1),t.push([e.i,".form-control.pl-4[data-v-2bf6b272]{padding-left:2rem!important}.conditions-list[data-v-2bf6b272]{max-height:500px;overflow-y:auto;border:0 solid #ddd;border-radius:4px}.list-group-item[data-v-2bf6b272]{margin:8px 5px 8px 0;border:1px solid #cacaca!important;border-radius:10px!important;margin-top:10px}.conditions-list[data-v-2bf6b272]::-webkit-scrollbar{width:6px}.conditions-list[data-v-2bf6b272]::-webkit-scrollbar-thumb{background-color:#bbb;border-radius:3px}.conditions-list[data-v-2bf6b272]::-webkit-scrollbar-thumb:hover{background-color:#888}.condition-item[data-v-2bf6b272]{cursor:pointer;-webkit-user-select:none;-moz-user-select:none;user-select:none}.condition-item.active[data-v-2bf6b272]{background-color:#59a1da;color:#fff;margin-top:1px!important;border-color:#4a88ba!important}.condition-item.active small[data-v-2bf6b272]{color:#e9ecef}.modal-footer[data-v-2bf6b272]{display:flex;justify-content:flex-end;gap:10px}.condition-item.active small.text-muted[data-v-2bf6b272]{color:#fff!important}",""]),e.exports=t},dc34:function(e,t,a){var i=a("db27");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var s=a("499e").default;s("26529408",i,!0,{sourceMap:!1,shadowMode:!1})},dfaf:function(e,t,a){var i=a("edcd");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var s=a("499e").default;s("81570248",i,!0,{sourceMap:!1,shadowMode:!1})},e78d:function(e,t,a){"use strict";a("789a")},ecb4:function(e,t,a){var i=a("bc07");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var s=a("499e").default;s("51d95d52",i,!0,{sourceMap:!1,shadowMode:!1})},edcd:function(e,t,a){var i=a("24fb");t=i(!1),t.push([e.i,".form-control.pl-4[data-v-73316fa6]{padding-left:2rem!important}.conditions-list[data-v-73316fa6]{max-height:500px;overflow-y:auto;border:1px solid #ddd;border-radius:4px}.conditions-list[data-v-73316fa6]::-webkit-scrollbar{width:6px}.conditions-list[data-v-73316fa6]::-webkit-scrollbar-thumb{background-color:#bbb;border-radius:3px}.conditions-list[data-v-73316fa6]::-webkit-scrollbar-thumb:hover{background-color:#888}.condition-item[data-v-73316fa6]{cursor:pointer}.condition-item.active[data-v-73316fa6]{background-color:#007bff;color:#fff}.condition-item.active small[data-v-73316fa6]{color:#e9ecef}.modal-footer[data-v-73316fa6]{display:flex;justify-content:flex-end;gap:10px}.condition-item.disabled[data-v-73316fa6]{background-color:#f8f9fa;color:#999;pointer-events:none;opacity:.6}.condition-item.active small.text-muted[data-v-73316fa6]{color:#fff!important}",""]),e.exports=t},efb9:function(e,t,a){"use strict";a("6c0e")}}]);
//# sourceMappingURL=chunk-1ec928f5.js.map