{"version":3,"sources":["webpack:///./src/views/BiReportDashboard/BillingDashboard.vue?dbdd","webpack:///src/views/BiReportDashboard/BillingDashboard.vue","webpack:///./src/views/BiReportDashboard/BillingDashboard.vue?e32f","webpack:///./src/views/BiReportDashboard/BillingDashboard.vue"],"names":["render","_vm","this","_h","$createElement","_self","_c","_m","staticRenderFns","staticClass","staticStyle","attrs","envType","process","name","methods","moduleName","environment","response","DataService","DynamicEmbedReport","status","Error","embedData","data","reportId","embedUrl","embedToken","companyId","tables","filters","compnayFilters","$schema","target","table","column","operator","values","filterType","powerbi","FilterType","BasicFilter","push","console","log","embedConfig","type","id","accessToken","tokenType","TokenType","Embed","settings","panes","visible","pageNavigation","reportContainer","document","getElementById","powerbiService","Service","hpmFactory","wpmpFactory","routerFactory","report","embed","on","setFilters","filterErr","error","event","detail","err","mounted","loadPowerBIReport","component"],"mappings":"yHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAsBH,EAAII,MAAMC,GAAO,OAAOL,EAAIM,GAAG,IACnGC,EAAkB,CAAC,WAAa,IAAIP,EAAIC,KAASC,EAAGF,EAAIG,eAAmBE,EAAGL,EAAII,MAAMC,IAAIH,EAAG,OAAOG,EAAG,MAAM,CAACG,YAAY,OAAOC,YAAY,CAAC,OAAS,UAAU,CAACJ,EAAG,MAAM,CAACI,YAAY,CAAC,OAAS,qBAAqB,MAAQ,QAAQC,MAAM,CAAC,GAAK,yB,8CCQzP,MAAAC,EAAAC,QACe,OACfC,KAAA,0BAEAC,QAAA,CACA,0BACA,IAEA,IAAAC,EAAA,UACAC,EAAAL,EACA,MAAAM,QAAAC,OAAAC,mBAAAJ,EAAAC,GAEA,IAAAC,GAAA,MAAAA,EAAAG,OACA,UAAAC,MAAA,gCAGA,MAAAC,EAAAL,EAAAM,KAGA,IAAAD,EAAAE,SAAA,UAAAH,MAAA,wBACA,IAAAC,EAAAG,SAAA,UAAAJ,MAAA,wBACA,IAAAC,EAAAI,WAAA,UAAAL,MAAA,0BACA,IAAAC,EAAAK,UAAA,UAAAN,MAAA,yBAEA,MAAAM,EAAAL,EAAAK,UACAL,EAAAM,OAGA,IAAAC,EAAA,GAcA,MAAAC,EAAA,CACAC,QAAA,0CACAC,OAAA,CACAC,MAAA,kBACAC,OAAA,cAEAC,SAAA,KACAC,OAAA,CAAAT,GACAU,WAAAC,YAAAC,WAAAC,aAGAX,EAAAY,KAAAX,GAEAY,QAAAC,IAAA,2BAAAd,GAEA,MAAAe,EAAA,CACAC,KAAA,SACAC,GAAAxB,EAAAE,SACAC,SAAAH,EAAAG,SACAsB,YAAAzB,EAAAI,WACAsB,UAAAV,YAAAW,UAAAC,MACArB,UACAsB,SAAA,CACAC,MAAA,CACAvB,QAAA,CAAAwB,SAAA,GACAC,eAAA,CAAAD,SAAA,MAKAE,EAAAC,SAAAC,eAAA,mBAGAC,EAAA,IAAApB,aAAAqB,QACArB,eAAAsB,WACAtB,eAAAuB,YACAvB,eAAAwB,eAGAC,EAAAL,EAAAM,MAAAT,EAAAX,GAGAmB,EAAAE,GAAA,mBACA,UACAF,EAAAG,WAAArC,GACAa,QAAAC,IAAA,mDACA,MAAAwB,GACAzB,QAAA0B,MAAA,qCAAAD,MAIAJ,EAAAE,GAAA,QAAAI,IACA3B,QAAA0B,MAAA,wBAAAC,EAAAC,UAGA,MAAAC,GACA7B,QAAA0B,MAAA,kCAAAG,MAKAC,UACA,KAAAC,sBCjHsY,I,YCOlYC,EAAY,eACd,EACA3E,EACAQ,GACA,EACA,KACA,KACA,MAIa,aAAAmE,E","file":"js/chunk-2d0e8fa0.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"mt-2\",staticStyle:{\"height\":\"100vh\"}},[_c('div',{staticStyle:{\"height\":\"calc(100vh - 40px)\",\"width\":\"100%\"},attrs:{\"id\":\"reportContainer\"}})])}]\n\nexport { render, staticRenderFns }","<template>\r\n  <div style=\"height: 100vh;\" class=\"mt-2\">\r\n    <div id=\"reportContainer\" style=\"height: calc(100vh - 40px); width: 100%;\"></div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport * as powerbi from 'powerbi-client'\r\nimport DataService from '../../services/DataService';\r\nconst envType = process.env.VUE_APP_NODE_ENV;\r\nexport default {\r\n  name: 'StagingBillingDashboard',\r\n\r\n  methods: {\r\n    async loadPowerBIReport() {\r\n      try {\r\n        // Use DynamicEmbedReport for staging with moduleId 4 (Billing)\r\n        var moduleName='Billing';\r\n        var environment=envType;\r\n        const response = await DataService.DynamicEmbedReport(moduleName, environment);\r\n        \r\n        if (!response || response.status !== 200) {\r\n          throw new Error('Failed to fetch embed config');\r\n        }\r\n\r\n        const embedData = response.data;\r\n\r\n        // Basic validations\r\n        if (!embedData.reportId) throw new Error('Report ID is missing');\r\n        if (!embedData.embedUrl) throw new Error('Embed URL is missing');\r\n        if (!embedData.embedToken) throw new Error('Embed token is missing');\r\n        if (!embedData.companyId) throw new Error('Company ID is missing');\r\n\r\n        const companyId = embedData.companyId;\r\n        const tablesToFilter = embedData.tables;\r\n\r\n        // Create filters dynamically from table configurations\r\n        let filters = [];\r\n        // const filters = tablesToFilter\r\n        //   .filter(tableConfig => tableConfig.filterColumn && tableConfig.filterColumn.trim() !== '')\r\n        //   .map(tableConfig => ({\r\n        //     $schema: \"http://powerbi.com/product/schema#basic\",\r\n        //     target: {\r\n        //       table: tableConfig.tableName,\r\n        //       column: tableConfig.filterColumn\r\n        //     },\r\n        //     operator: \"In\",\r\n        //     values: [companyId],\r\n        //     filterType: powerbi.models.FilterType.BasicFilter\r\n        //   }));\r\n\r\n        const compnayFilters = {\r\n            $schema: \"http://powerbi.com/product/schema#basic\",\r\n            target: {\r\n              table: \"TALYGEN_company\",          // üî∏ Table name in your Power BI model (case-sensitive)\r\n              column: \"company_id\"       // üî∏ Column used in slicer & relationships\r\n            },\r\n            operator: \"In\",\r\n            values: [companyId],\r\n            filterType: powerbi.models.FilterType.BasicFilter\r\n          };\r\n\r\n        filters.push(compnayFilters)\r\n\r\n        console.log('Staging Report Filters: ', filters);\r\n\r\n        const embedConfig = {\r\n          type: 'report',\r\n          id: embedData.reportId,\r\n          embedUrl: embedData.embedUrl,\r\n          accessToken: embedData.embedToken,\r\n          tokenType: powerbi.models.TokenType.Embed,\r\n          filters: filters,\r\n          settings: {\r\n            panes: {\r\n              filters: { visible: false },\r\n              pageNavigation: { visible: true }\r\n            }\r\n          }\r\n        };\r\n\r\n        const reportContainer = document.getElementById('reportContainer');\r\n\r\n        // Embed the report\r\n        const powerbiService = new powerbi.service.Service(\r\n          powerbi.factories.hpmFactory,\r\n          powerbi.factories.wpmpFactory,\r\n          powerbi.factories.routerFactory\r\n        );\r\n\r\n        const report = powerbiService.embed(reportContainer, embedConfig);\r\n\r\n        // Optional: re-apply filter if needed after load\r\n        report.on('loaded', async () => {\r\n          try {\r\n            await report.setFilters(filters);\r\n            console.log(\"‚úÖ Staging Power BI report embedded successfully\");\r\n          } catch (filterErr) {\r\n            console.error('Error applying filters after load:', filterErr);\r\n          }\r\n        });\r\n\r\n        report.on('error', (event) => {\r\n          console.error('Staging Report Error:', event.detail);\r\n        });\r\n\r\n      } catch (err) {\r\n        console.error('‚ùå Staging Power BI embed error:', err);\r\n      }\r\n    }\r\n  },\r\n\r\n  mounted() {\r\n    this.loadPowerBIReport()\r\n  }\r\n}\r\n</script>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./BillingDashboard.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./BillingDashboard.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./BillingDashboard.vue?vue&type=template&id=5d8270c1\"\nimport script from \"./BillingDashboard.vue?vue&type=script&lang=js\"\nexport * from \"./BillingDashboard.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}