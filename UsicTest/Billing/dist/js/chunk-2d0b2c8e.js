(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b2c8e"],{"261e":function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("section",[e("tg-list",{attrs:{IsShowAction:!0,showCheckBox:!1,ModuleName:"Billing",listType:["List"],RenderRowActionMethod:t.renderActions,SubModuleCode:"Billing",IdentityColumn:"id",HeaderText:t.$t("BatchProcessing"),ListData:t.BatchProcessingListing,HeaderData:t.Headers,PageSize:t.pageSize,HeaderButtons:t.listheaderbuttons,TotalRecords:t.TotalRecords,SearchFields:t.leftSearchFields,ListDataCallBackFunction:t.FetchData,LegendArray:[],SortExp:t.sortExp,SortBy:t.sortBy,NorecordfoundText:t.$t("NoRecordfound")},on:{LeftsearchButtonClick:t.leftCommonSearch,ActionButtonClick:t.actionButtonClick,PagerButtonClick:t.pagerMethod,HeaderButtonClick:t.commonHeaderButtonClick,SortdataButtonClick:t.sortdata},scopedSlots:t._u([{key:"slotdata",fn:function(a){var s=a.data;return["created_at"==s.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(t.$d(s.row.created_at))+" ")])]:t._e(),"batch_name"==s.column.COLUMN_NAME?[e("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.OpenBatchDetail(s)}}},[e("span",[t._v(t._s(s.row.batch_name))])])]:t._e(),"status"==s.column.COLUMN_NAME?[e("span",[e("div",{staticClass:"progress mb-1"},["Starting"==s.row.status&&0==s.row.progressValue?e("div",{staticClass:"progress-bar progress-bar-striped bg-warning",style:{width:"100%"},attrs:{id:"progressBar-30"}},[e("span",[t._v(t._s(t.$t("Starting")))])]):t._e(),"Completed"==s.row.status&&0==s.row.progressValue?e("div",{staticClass:"progress-bar progress-bar-striped bg-success",style:{width:"100%"},attrs:{id:"progressBar-30"}},[e("span",[t._v(t._s(t.$t("Completed")))])]):"Generated"==s.row.status&&0==s.row.progressValue?e("div",{staticClass:"progress-bar progress-bar-striped bg-primary",style:{width:"100%"},attrs:{id:"progressBar-30"}},[e("span",[t._v(t._s(t.$t("created")))])]):"Failed"==s.row.status&&0==s.row.progressValue?e("div",{staticClass:"progress-bar progress-bar-striped bg-danger",style:{width:"100%"},attrs:{id:"progressBar-30"}},[e("span",[t._v(t._s(t.$t("Failure")))])]):"Started"==s.row.status&&s.row.progressValue<=0?e("div",{staticClass:"progress-bar progress-bar-striped bg-warning",style:{width:"100%"},attrs:{id:"progressBar-30"}},[e("span",[t._v(t._s(t.$t("Inprogress")))])]):t._e(),s.row.progressValue>0?e("div",{staticClass:"progress-bar progress-bar-striped bg-success",style:{width:s.row.progressValue+"%"}},[100===s.row.progressValue?e("span",[t._v(t._s(t.$t("Completed")))]):t._e(),e("span",[t._v(t._s(t.$t("Failure")))])]):"Started"==s.row.status&&s.row.progressValue<=0?e("div",{staticClass:"progress-bar progress-bar-striped bg-warning",style:{width:"100%"},attrs:{id:"progressBar-30"}},[e("span",[t._v(t._s(t.$t("Inprogress")))])]):t._e(),s.row.progressValue>0?e("div",{staticClass:"progress-bar progress-bar-striped bg-success",style:{width:s.row.progressValue+"%"}},[100===s.row.progressValue?e("span",[t._v(t._s(t.$t("Completed")))]):e("span",[t._v(t._s(s.row.progressValue)+"%")])]):"Pending"==s.row.status&&0==s.row.progressValue?e("div",{staticClass:"progress-bar progress-bar-striped bg-danger",style:{width:"100%"},attrs:{id:"progressBar-0"}},[e("span",[t._v(t._s(t.$t("Pending")))])]):t._e()])])]:t._e(),"stats"==s.column.COLUMN_NAME?["Generated"==s.row.status?e("span",[t._v(" -- ")]):e("span",[t._v(" "+t._s(s.row.stats)+" ")])]:t._e(),"record_count"==s.column.COLUMN_NAME?[e("span",[e("a",{class:{"text-dark text-center":!0,disabled:0==s.row.record_count},attrs:{id:"ancProjectDetail",href:"javascript:;"},on:{click:function(a){return t.OpenBatchProcessDataLising(s.row.batch_id)}}},[e("i",{staticClass:"fa fa-file-o",attrs:{"aria-hidden":"true"}}),e("span",{staticClass:"noti-circle noti-orange"},[t._v(t._s(s.row.record_count))])])])]:t._e()]}}])}),t.isCreateBatch?e("CreateBatch",{attrs:{callbackfunction:t.FetchData,BatchId:t.BatchId}}):t._e(),t.isRecordDetail?e("RecordDetails"):t._e(),t.isReprocess?e("Reprocess",{attrs:{reProcessDetail:t.reProcessDetail,reProcessIndex:t.reProcessIndex}}):t._e(),e("transition",{attrs:{name:"modal"}},[e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),t.isDetail?e("div",{staticClass:"modal d-block dialog"},[e("div",{staticClass:"modal-dialog modal-lg"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("BatchDetail")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.CloseBatchDetail}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"col-md-12 p-0"},[e("div",{staticClass:"listing"},[e("div",{staticClass:"card mb-3 probx"},[e("div",{staticClass:"card-header"},[e("h2",[t._v(t._s(t.$t("Details")))]),e("div",{staticClass:"cont_right"},[e("div",{staticClass:"bar"})])]),e("div",{staticClass:"card-body"},[e("div",{staticClass:"row"},t._l(t.displayFields,(function(a,s){return e("div",{key:s,staticClass:"col-md-6 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(t._s(a.label)+":")]),e("span",{staticClass:"answer rightlabeltext ml-1",class:"status"===a.key?"status-badge":"",staticStyle:{display:"inline !important"}},[t._v(t._s(t.formatFieldValue(a.key)))])])])])})),0)])])])])]),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-danger",on:{click:t.CloseBatchDetail}},[e("em",{staticClass:"fa fa-times pr-2",attrs:{"aria-hidden":"true"}}),t._v(" "+t._s(t.$t("Cancel"))+" ")])])])])]):t._e()],1)]),t.isOpenProcessData?e("BatchProcessDataListing",{attrs:{BatchId:t.BatchId}}):t._e()],1)},r=[],i=(e("14d9"),e("9769")),o=e("b3e8"),c=e("0edd"),n=e("f5cf"),l=e("8e2a"),d=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full  d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("BatchProcessDetail")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("tg-list",{attrs:{IsShowAction:!1,ModuleName:"Billing",SubModuleCode:"BatchProcess",LegendArray:[],RenderRowActionMethod:function(){},widgets:[],IdentityColumn:"",listType:["List"],ListData:t.batchProcessData,HeaderData:t.Headers,HeaderButtons:t.listheaderbuttons,TotalRecords:t.TotalRecords,ListDataCallBackFunction:t.FetchData,showCheckBox:!0,SortExp:t.SortExp,SortBy:t.SortBy,NorecordfoundText:t.$t("NoRecordfound")},on:{ActionButtonClick:t.actionButtonClick,LeftsearchButtonClick:t.leftCommonSearch,PagerButtonClick:t.pagerMethod,HeaderButtonClick:t.commonHeaderButtonClick,SortdataButtonClick:t.sortdata}})],1)])])])],1)},h=[],u={props:{BatchId:{type:Object,required:!0}},data(){return{isLoading:!1,HeaderText:"",TagId:0,TagArr:[],AddTagPopup:!1,listheaderbuttons:[],Headers:[{COLUMN_NAME:"Client_Name",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("ClientName"),DISPLAY_ORDER:1},{COLUMN_NAME:"serial_number",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("SerialNumber"),DISPLAY_ORDER:2},{COLUMN_NAME:"Consumption",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("Consumption"),DISPLAY_ORDER:3},{COLUMN_NAME:"Billing_days",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("BillingDays"),DISPLAY_ORDER:4}],SortBy:"",skillStringArr:[],SortExp:"",TotalRecords:0,searchCondition:"",PageNumber:1,PageSize:10,TagData:[],CurrentPage:1,TotalPages:0,skillString:"",leftSearchFields:[],noRecords:!1,batchProcessData:[]}},created:function(){var t=this;t.FetchData()},methods:{actionButtonClick:function(t,a,e,s){},leftCommonSearch:function(t){this.PageNumber=t.PageNumber,this.isPaged=1,"undefined"!=typeof t.searchCondition?this.searchCondition=t.searchConditionJson:this.searchCondition="",this.FetchData()},sortdata:function(t){this.SortBy=t;var a="ASC";"ASC"==this.SortExp&&(a="DESC"),this.SortExp=a,this.SortBy=t,this.SortExp=a,this.PageNumber=1,this.FetchData()},commonHeaderButtonClick:function(t){},pagerMethod:function(t){this.PageSize=t.PageSize,this.PageNumber=t.PageNumber,this.FetchData()},FetchData:async function(){var t=this,a=`batchId=${t.BatchId}&pageSize=${t.PageSize}&pageNum=${t.PageNumber}&sortBy=${t.SortBy}&SortExp=${t.SortExp}`;await i["a"].GetBatchProcessDataByBatchId(a).then(a=>{t.batchProcessData=[],a.data&&a.data.length>0?(t.batchProcessData=a.data,t.batchProcessData.length>0?(t.TotalRecords=a.data[0].Total_Record_Count,t.TotalPages=Math.ceil(t.TotalRecords/t.PageSize),t.CurrentPage=t.PageNumber,t.noRecords=!1):(t.noRecords=!0,t.batchProcessData=[])):(t.noRecords=!0,t.TotalRecords=0,t.batchProcessData=[])})},Close:function(){this.$parent.isOpenProcessData=!1}}},p=u,g=e("0c7c"),_=Object(g["a"])(p,d,h,!1,null,null,null),b=_.exports,C={components:{CreateBatch:o["a"],RecordDetails:n["a"],Reprocess:l["a"],BatchProcessDataListing:b},computed:{displayFields(){return[{key:"batch_name",label:this.$t("batchname")},{key:"customer_type_name",label:this.$t("CustomerType")},{key:"station_name",label:this.$t("StationName")},{key:"plan_name",label:this.$t("PlanName")},{key:"state",label:this.$t("State")},{key:"district",label:this.$t("District")},{key:"zip_code",label:this.$t("ZIPCODE")},{key:"status",label:this.$t("Status")},{key:"processed_by",label:this.$t("processedby")},{key:"created_at",label:this.$t("CreatedAt")},{key:"record_count",label:this.$t("RecordCount")},{key:"total_records",label:this.$t("TotalRecords")},{key:"progressValue",label:this.$t("ProgressValue")},{key:"stats",label:this.$t("Stats")}]}},data(){return{reProcessDetail:{},reProcessIndex:0,isReprocess:!1,Headers:[{COLUMN_NAME:"batch_name",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("batchname"),DISPLAY_ORDER:1,settings:{isInSlot:!0}},{COLUMN_NAME:"customer_type_name",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:this.$t("CustomerType"),DISPLAY_ORDER:2},{COLUMN_NAME:"plan_name",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:this.$t("Plan"),DISPLAY_ORDER:3},{COLUMN_NAME:"station_name",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:this.$t("StationName"),DISPLAY_ORDER:4},{COLUMN_NAME:"created_at",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("CreatedDate"),DISPLAY_ORDER:5,settings:{isInSlot:!0}},{COLUMN_NAME:"status",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("Status"),DISPLAY_ORDER:6,settings:{isInSlot:!0}},{COLUMN_NAME:"record_count",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("RecordCount"),DISPLAY_ORDER:7,settings:{isInSlot:!0}},{COLUMN_NAME:"stats",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("stats"),DISPLAY_ORDER:8,settings:{isInSlot:!0}}],TotalRecords:0,pageSize:10,pageNum:1,sortBy:"",searchCondition:"",leftSearchFields:c["a"].leftsearchSchema,listActions:[{title:"Edit",callbackfunction:"EditRuleService",href:"javascript:void(0)",icon:"fa fa-pencil text-success",additionalSpan:"",isDisabled:!1,isvisible:!0},{title:"Process",href:"javascript:void(0)",icon:"fa fa-share-square-o ",callbackfunction:"Process",additionalSpan:""},{title:"Detail",href:"javascript:void(0)",icon:"fa fa-eye",callbackfunction:"Detail",additionalSpan:""},{title:"reprocess",href:"javascript:void(0)",icon:"fa fa-repeat",callbackfunction:"Reprocess",additionalSpan:""}],listheaderbuttons:[],GroupStart:1,GroupEnd:3,PlanId:0,CurrentPage:1,TotalPages:0,sortExp:"",requestId:"",BatchProcessingListing:[],noRecords:!1,isCreateBatch:!1,isRecordDetail:!1,batchName:"",intervalId:[],BatchId:"",isDetail:!1,BatchData:[],isOpenProcessData:!1,batchProcessData:[]}},created:async function(){var t=this;await c["a"].bindleftCommonSearchdropdown(this,"Billing","CUSTOMER_TYPE",null),await c["a"].bindleftCommonSearchdropdown(this,"Billing","PLANS",null),await c["a"].bindleftCommonSearchdropdown(this,"Billing","STATION_LIST",null),t.BatchId=t.$route.params.id,await t.FetchData()},methods:{startAllProgress:function(){var t=this;t.BatchProcessingListing.forEach((a,e)=>{var s=a.status;"Started"==s&&t.getProgress(e,a.batch_id)})},getProgress:function(t,a){this.intervalId[a]=setInterval(async()=>{try{var t="batchId="+a;let e=await i["a"].GetBatchProgress(t);if(null!=e.data.result){this.BatchProcessingListing.filter(t=>t.batch_id==a)[0].status=JSON.parse(e.data.result).status;let t=JSON.parse(e.data.result).progress_value;t<100?this.BatchProcessingListing.filter(t=>t.batch_id==a)[0].progressValue=t:(this.BatchProcessingListing.filter(t=>t.batch_id==a)[0].progressValue=100,clearInterval(this.intervalId[a]),delete this.intervalId[a]),this.BatchProcessingListing.filter(t=>t.batch_id==a)[0].stats=JSON.parse(e.data.result).stats}}catch(e){console.error("Error fetching progress:",e),clearInterval(this.intervalId[a])}},15e3)},OpenBatchDetail:async function(t){var a=this;a.isDetail=!0,a.BatchData=t.row},formatFieldValue(t){if(!this.BatchData)return"--";const a=this.BatchData[t];let e=a;if("total_records"===t&&void 0!==this.BatchData.TOTALRECORDS&&(e=this.BatchData.TOTALRECORDS),null===e||void 0===e||""===e)return"--";if("created_at"===t){const t=new Date(e);if(isNaN(t))return e;{const a=t.toLocaleDateString(),e=t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"});return`${a}, ${e}`}}if("status"===t)return e.charAt(0).toUpperCase()+e.slice(1);if("stats"===t&&e)try{const t="string"===typeof e?JSON.parse(e):e;if(t&&"object"===typeof t){const a=t.success||0,e=t.failure||0;return`Success: ${a}, Failure: ${e}`}}catch(s){}return e},OpenBatchProcessDataLising:async function(t){this.BatchId=t,this.isOpenProcessData=!this.isOpenProcessData},callProcessBatch:async function(t,a,e){var s=this,r="";r=void 0==e||"undefined"==e||"null"==e?"batchId="+t.batch_id:`batchId=${t.batch_id}&reProcess=${e}`,this.BatchProcessingListing.filter(a=>a.batch_id==t.batch_id)[0].status="Starting",this.getProgress(a,t.batch_id),await i["a"].CallProcessBatchDataTask(r).then((function(t){""!=t.data&&null!=t.data?"Success"==t.data.status&&t.data.result&&""!==t.data.result&&(s.requestId=t.data.result.split("=")[1]):t.data.result.status_id}))},EditBatchProcessData:async function(t,a){var e=this;e.BatchId=t.batch_id,e.isCreateBatch=!0},CloseBatchDetail:function(){var t=this;t.isDetail=!1},CloseBatchProcess:function(){var t=this;t.isOpenProcessData=!1},FetchData:async function(){var t,a=this;a.BatchProcessingListing=[];var e=`search=${a.searchCondition}&pageSize=${a.pageSize}&pageNum=${a.pageNum}&sortBy=${a.sortBy}&sortExp=${a.sortExp}&batchId=${null!==(t=a.BatchId)&&void 0!==t?t:""}`;const s=JSON.stringify(e);var r={objData:s};await i["a"].GetBatchCycleListing(r).then((function(t){""!=t.data&&null!=t.data&&t.data.result.data.length>0?(a.BatchProcessingListing=t.data.result.data.map(t=>(t.created_at=new Date(t.created_at),t.progressValue=0,t)),a.TotalRecords=t.data.result.data[0].TOTALRECORDS,a.TotalPages=Math.ceil(a.TotalRecords/a.pageSize),a.CurrentPage=a.pageNum,a.noRecord=!1):(a.noRecord=!0,a.TotalRecords=0,a.BatchProcessingListing=[])}))},leftCommonSearch(t){this.pageNum=t.PageNumber,this.isPaged=1,"undefined"!==typeof t.searchConditionJson&&null!==t.searchConditionJson?this.searchCondition=t.searchConditionJson.replace("=",""):this.searchCondition="",this.FetchData()},actionButtonClick(t,a,e,s){switch(t){case"Process":this.callProcessBatch(a,e);break;case"Detail":this.recordDetail(a);break;case"Reprocess":this.reProcess(a,e);break;case"EditRuleService":this.EditBatchProcessData(a,e);break}},renderActions:function(t){var a=this;let e=[];return a.listActions.forEach(a=>{let s={...a};switch(s.title){case"Edit":s.isVisible=!0,s.isDisabled="Generated"!=t.status;break;case"Process":s.isVisible=!0,s.isDisabled="Completed"==t.status||"Started"==t.status;break;case"Detail":s.isVisible=!0;break;case"Reprocess":s.isVisible=!0,s.isDisabled="Generated"==t.status||"Started"==t.status;break}e.push(s)}),e},pagerMethod(t){this.pageSize=t.PageSize,this.pageNum=t.PageNumber,this.FetchData()},getStatusClass:function(t){var a="";switch(t){case"Active":a="px-2 text-center bg-success text-white d-block";break;case"Inactive":a="px-2 text-center bg-danger text-white d-block";break;default:a=""}return a},commonHeaderButtonClick(t){switch(t.callbackfunction){case"GenerateBatch":this.GenerateBatch();break;case"queueList":this.navigateToQueueList();break}},GenerateBatch:function(){var t=this;t.BatchId=0,t.isCreateBatch=!0},sortdata:function(t){this.sortBy=t;var a="ASC";"ASC"==this.sortExp&&(a="DESC"),this.sortExp=a,this.sortBy=t,this.sortExp=a,this.pageNum=1,this.GroupStart=this.pageNum,this.GroupEnd=this.pageNum+2,this.FetchData()},recordDetail(t){var a=this;null!==a.requestId&&""!==a.requestId?window.open(a.$router.resolve({name:"BillLog",params:{requestId:a.requestId}}).href,"_blank"):window.open(a.$router.resolve({name:"BillLog",params:{requestId:t.request_id}}).href,"_blank")},reProcess(t,a){this.isReprocess=!0,this.reProcessDetail=t,this.reProcessIndex=a},navigateToQueueList(){var t=this;t.$router.push({name:"QueueList"})}}},S=C,B=Object(g["a"])(S,s,r,!1,null,null,null);a["default"]=B.exports}}]);
//# sourceMappingURL=chunk-2d0b2c8e.js.map