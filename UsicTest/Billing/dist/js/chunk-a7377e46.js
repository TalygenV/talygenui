(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a7377e46"],{"1be4":function(e,t,o){"use strict";var i=o("d066");e.exports=i("document","documentElement")},"33d1":function(e,t,o){"use strict";var i=o("23e7"),a=o("7b0b"),s=o("07fa"),l=o("5926"),r=o("44d2");i({target:"Array",proto:!0},{at:function(e){var t=a(this),o=s(t),i=l(e),r=i>=0?i:o+i;return r<0||r>=o?void 0:t[r]}}),r("at")},"37e8":function(e,t,o){"use strict";var i=o("83ab"),a=o("aed9"),s=o("9bf2"),l=o("825a"),r=o("fc6a"),n=o("df75");t.f=i&&!a?Object.defineProperties:function(e,t){l(e);var o,i=r(t),a=n(t),d=a.length,c=0;while(d>c)s.f(e,o=a[c++],i[o]);return e}},"44d2":function(e,t,o){"use strict";var i=o("b622"),a=o("7c73"),s=o("9bf2").f,l=i("unscopables"),r=Array.prototype;void 0===r[l]&&s(r,l,{configurable:!0,value:a(null)}),e.exports=function(e){r[l][e]=!0}},"7c73":function(e,t,o){"use strict";var i,a=o("825a"),s=o("37e8"),l=o("7839"),r=o("d012"),n=o("1be4"),d=o("cc12"),c=o("f772"),u=">",p="<",v="prototype",f="script",m=c("IE_PROTO"),h=function(){},g=function(e){return p+f+u+e+p+"/"+f+u},C=function(e){e.write(g("")),e.close();var t=e.parentWindow.Object;return e=null,t},y=function(){var e,t=d("iframe"),o="java"+f+":";return t.style.display="none",n.appendChild(t),t.src=String(o),e=t.contentWindow.document,e.open(),e.write(g("document.F=Object")),e.close(),e.F},T=function(){try{i=new ActiveXObject("htmlfile")}catch(t){}T="undefined"!=typeof document?document.domain&&i?C(i):y():C(i);var e=l.length;while(e--)delete T[v][l[e]];return T()};r[m]=!0,e.exports=Object.create||function(e,t){var o;return null!==e?(h[v]=a(e),o=new h,h[v]=null,o[m]=e):o=T(),void 0===t?o:s.f(o,t)}},"8a4d":function(e,t,o){"use strict";var i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("section",[o("div",{staticClass:"my-popups"},[o("loader",{attrs:{"is-visible":e.isLoading}}),o("div",{staticClass:"modal d-block"},[o("div",{staticClass:"modal-dialog modal-dialog-centered"},[o("div",{staticClass:"modal-content"},[o("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[o("h5",{staticClass:"modal-title"},[e._v(" "+e._s(e.$t("BillingConditions")))]),o("button",{staticClass:"close",attrs:{type:"button"},on:{click:e.Close}},[o("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),o("div",{staticClass:"modal-body csscontrol_popup",staticStyle:{padding:"0"}},[o("div",{staticClass:"container-fluid p-0 main-content"},[o("div",{staticClass:"row",staticStyle:{margin:"0"}},[o("div",{staticClass:"right-content",staticStyle:{padding:"20px",width:"100%"}},[o("div",{staticClass:"form-group mb-4"},[e._m(0),o("input",{directives:[{name:"model",rawName:"v-model",value:e.conditionName,expression:"conditionName"}],class:["form-control",{"is-invalid":e.showError&&!e.conditionName}],attrs:{disabled:e.isEditMode,placeholder:"Enter condition name",required:""},domProps:{value:e.conditionName},on:{input:function(t){t.target.composing||(e.conditionName=t.target.value)}}}),e.showError&&!e.conditionName?o("div",{staticClass:"invalid-feedback text-danger small"},[e._v(" "+e._s(e.$t("MandatoryFieldConditionName"))+" ")]):e._e()]),o("div",{staticClass:"form-group mb-4"},[o("label",{staticStyle:{"font-weight":"600",color:"#495057","margin-bottom":"8px"}},[e._v("Condition Logic:")]),o("div",{staticStyle:{"background-color":"#f8f9fa",border:"1px solid #dee2e6","border-radius":"4px",padding:"12px","min-height":"60px",color:"#495057"}},[e._v(" "+e._s(e.conditionText)+" ")])]),o("div",{staticClass:"condition-builder border"},[e._l(e.conditionBlocks,(function(t,i){return o("div",{key:i,staticClass:"condition-block"},[i>0?o("div",{staticClass:"or-separator",staticStyle:{"text-align":"center",margin:"5px 0"}},[o("button",{staticClass:"btn btn-info",staticStyle:{border:"none","border-radius":"6px!important","font-weight":"600"},attrs:{type:"button",disabled:e.isEditMode},on:{click:function(t){return e.toggleJoinOperator(i)}}},[e._v(" "+e._s(t.joinWithPrevious||"OR")+" ")])]):e._e(),o("div",{staticClass:"block-header",staticStyle:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"5px"}},[o("h6",{staticStyle:{"font-weight":"600",color:"#495057",margin:"0"}},[e._v("Block "+e._s(i+1))]),o("div",{staticClass:"d-flex"},[o("button",{staticClass:"btn btn-sm btn-info",style:{border:"none",borderRadius:"8px!important",padding:"4px 12px",marginRight:"8px"},attrs:{type:"button",disabled:e.isEditMode},on:{click:function(t){return e.toggleBlockOperator(i)}}},[e._v(" "+e._s(t.operator||"AND")+" ")]),e.conditionBlocks.length>1?o("em",{directives:[{name:"show",rawName:"v-show",value:!e.isEditMode,expression:"!isEditMode"}],staticClass:"fa fa-trash-o text-danger ml-2 font-24",on:{click:function(t){return e.removeBlock(i)}}}):e._e()])]),o("div",{staticClass:"block-conditions"},[e._l(t.conditions,(function(a,s){return o("div",{key:s,staticClass:"condition-row",staticStyle:{display:"flex","align-items":"center","margin-bottom":"5px",gap:"10px"}},[o("select",{directives:[{name:"model",rawName:"v-model",value:a.field,expression:"row.field"}],staticClass:"form-control",staticStyle:{flex:"1"},attrs:{disabled:e.isEditMode},on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"field",t.target.multiple?o:o[0])},function(t){return e.handleFieldChange(a)}]}},[o("option",{attrs:{value:"",disabled:""}},[e._v("Select Field")]),e._l(e.groupedOptions,(function(t,i){return o("optgroup",{key:i,attrs:{label:i}},e._l(t,(function(t){return o("option",{key:t.value,domProps:{value:t.value}},[e._v(" "+e._s(e.$t(t.label))+" ")])})),0)}))],2),o("select",{directives:[{name:"model",rawName:"v-model",value:a.operator,expression:"row.operator"}],staticClass:"form-control",staticStyle:{flex:"0.5"},attrs:{disabled:e.isEditMode},on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"operator",t.target.multiple?o:o[0])},function(t){return e.handleDropdownValue(a)}]}},[o("option",{attrs:{value:"",disabled:""}},[e._v("Operator")]),e._l(a.operatorList||[],(function(t){return o("option",{key:t.OPERATOR_ID,domProps:{value:t.OPERATOR_ID}},[e._v(" "+e._s(t.OPERATOR_DISPLAY_NAME)+" ")])}))],2),o("div",{staticClass:"d-flex",staticStyle:{flex:"1",overflow:"visible!important","min-width":"320px"}},["date"!==a.sqlType||e.isValueHidden(a)||e.isShowIsWeekDay(a)?e._e():o("v-date-picker",{staticClass:"timedate input-group mr-2",attrs:{mode:"date"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.inputValue,i=e.togglePopover;return[o("input",{class:{"form-control":!0},attrs:{placeholder:"MM/DD/YYYY"},domProps:{value:t},on:{click:function(e){return i()}}}),o("div",{staticClass:"input-group-append",on:{click:function(e){return i()}}},[o("span",{staticClass:"input-group-text"},[o("em",{staticClass:"fa fa-calendar"})])])]}}],null,!0),model:{value:a.value,callback:function(t){e.$set(a,"value",t)},expression:"row.value"}}),"date"!==a.sqlType||e.isValueHidden(a)||!e.isValueToVisible(a)||e.isShowIsWeekDay(a)?e._e():o("v-date-picker",{staticClass:"timedate input-group",attrs:{mode:"date"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.inputValue,i=e.togglePopover;return[o("input",{class:{"form-control":!0},attrs:{placeholder:"MM/DD/YYYY"},domProps:{value:t},on:{click:function(e){return i()}}}),o("div",{staticClass:"input-group-append",on:{click:function(e){return i()}}},[o("span",{staticClass:"input-group-text"},[o("em",{staticClass:"fa fa-calendar"})])])]}}],null,!0),model:{value:a.valueTo,callback:function(t){e.$set(a,"valueTo",t)},expression:"row.valueTo"}}),"time"!==a.sqlType||e.isValueHidden(a)||e.isShowIsWeekDay(a)?e._e():o("v-date-picker",{staticClass:"timedate input-group mr-2",attrs:{mode:"time"},scopedSlots:e._u([{key:"default",fn:function(t){t.inputValue;var i=t.togglePopover;return[o("input",{directives:[{name:"model",rawName:"v-model",value:a.value,expression:"row.value"}],staticClass:"form-control",attrs:{placeholder:"HH:mm",disabled:e.isEditMode},domProps:{value:a.value},on:{click:function(e){return i()},input:function(t){t.target.composing||e.$set(a,"value",t.target.value)}}}),o("div",{staticClass:"input-group-append",on:{click:i}},[o("span",{staticClass:"input-group-text"},[o("em",{staticClass:"fa fa-clock"})])])]}}],null,!0),model:{value:a.value,callback:function(t){e.$set(a,"value",t)},expression:"row.value"}}),"time"!==a.sqlType||e.isValueHidden(a)||!e.isValueToVisible(a)||e.isShowIsWeekDay(a)?e._e():o("v-date-picker",{staticClass:"timedate input-group mr-2",attrs:{mode:"time"},scopedSlots:e._u([{key:"default",fn:function(t){t.inputValue;var i=t.togglePopover;return[o("input",{directives:[{name:"model",rawName:"v-model",value:a.valueTo,expression:"row.valueTo"}],staticClass:"form-control",attrs:{placeholder:"HH:mm",disabled:e.isEditMode},domProps:{value:a.valueTo},on:{click:function(e){return i()},input:function(t){t.target.composing||e.$set(a,"valueTo",t.target.value)}}}),o("div",{staticClass:"input-group-append",on:{click:i}},[o("span",{staticClass:"input-group-text"},[o("em",{staticClass:"fa fa-clock"})])])]}}],null,!0),model:{value:a.valueTo,callback:function(t){e.$set(a,"valueTo",t)},expression:"row.valueTo"}}),"select"!==a.sqlType&&"bool"!==a.sqlType||e.isValueHidden(a)||e.isValueToVisible(a)||e.isMultiSelectOperator(a)?e._e():o("select",{directives:[{name:"model",rawName:"v-model",value:a.value,expression:"row.value"}],staticClass:"form-control p-1",attrs:{disabled:e.isEditMode},on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"value",t.target.multiple?o:o[0])}}},[o("option",{attrs:{value:"",disabled:""}},[e._v(e._s(e.$t("Select")))]),e._l(a.valueOptions||[],(function(t){return o("option",{key:t.id,domProps:{value:t.value}},[e._v(" "+e._s(t.name)+" ")])}))],2),"select"===a.sqlType&&e.isMultiSelectOperator(a)&&!e.isValueHidden(a)?o("Multiselect",{attrs:{options:a.valueOptions||[],multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,searchable:!0,"show-no-results":!1,"internal-search":!0,label:"name","track-by":"value",placeholder:e.$t("Select"),disabled:e.isEditMode},model:{value:a.value,callback:function(t){e.$set(a,"value",t)},expression:"row.value"}}):e._e(),e.isShowIsWeekDay(a)?o("div",{staticClass:"d-flex gap-3 flex-wrap"},e._l(e.weekDaysList,(function(t){return o("div",{key:t.value+"-"+s,staticClass:"custom-control custom-checkbox"},[o("input",{staticClass:"custom-control-input",attrs:{type:"checkbox",disabled:e.isEditMode,id:"chk-"+s+"-"+t.value},domProps:{checked:e.getDayChecked(a.daysOfWeek,t.value)},on:{change:function(o){return e.toggleDay(a,t.value)}}}),o("label",{staticClass:"custom-control-label",attrs:{for:"chk-"+s+"-"+t.value}},[e._v(e._s(t.label))])])})),0):e._e(),e.isValueHidden(a)||"select"==a.sqlType||"date"==a.sqlType||"time"==a.sqlType||"bool"==a.sqlType?e._e():o("input",{directives:[{name:"model",rawName:"v-model",value:a.value,expression:"row.value"}],staticClass:"form-control p-1 mr-2",attrs:{disabled:e.isEditMode,placeholder:"Value"},domProps:{value:a.value},on:{input:function(t){t.target.composing||e.$set(a,"value",t.target.value)}}}),e.isValueToVisible(a)&&"select"!=a.sqlType&&"date"!=a.sqlType&&"time"!=a.sqlType&&"bool"!=a.sqlType?o("input",{directives:[{name:"model",rawName:"v-model",value:a.valueTo,expression:"row.valueTo"}],staticClass:"form-control p-1",attrs:{disabled:e.isEditMode,placeholder:"Value To"},domProps:{value:a.valueTo},on:{input:function(t){t.target.composing||e.$set(a,"valueTo",t.target.value)}}}):e._e()],1),t.conditions.length>1?o("a",{directives:[{name:"show",rawName:"v-show",value:!e.isEditMode,expression:"!isEditMode"}],attrs:{href:""},on:{click:function(t){return e.removeCondition(i,s,t)}}},[o("em",{staticClass:"fa fa-trash-o text-danger font-20"})]):e._e()])})),e.isEditMode?e._e():o("button",{staticClass:"btn btn-sm btn-success mt-2",staticStyle:{"border-radius":"4px"},attrs:{type:"button"},on:{click:function(t){return e.addCondition(i)}}},[e._v(" + Add Condition ")])],2)])})),e.isEditMode?e._e():o("div",{staticClass:"add-block-section"},[o("button",{staticClass:"btn btn-primary",staticStyle:{"border-radius":"4px","font-weight":"600"},attrs:{type:"button"},on:{click:e.addBlock}},[e._v(" + Add Block ")])])],2),e.isShowServiceDetail?o("div",{staticClass:"col-lg-12 mt-3 mb-3 p-0"},[o("div",{staticClass:"form-check form-switch col-md-6 mt-0 p-0 form-group"},[o("label",{staticClass:"mr-2",attrs:{for:"peakHoursSwitch"}},[e._v(e._s(e.$t("Apply"))+" "+e._s(e.$t("Rate"))+":")]),o("div",{staticClass:"row"},[o("div",{staticClass:"col-12 float-left"},[o("label",{staticClass:"switch"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.form.rateToggle,expression:"form.rateToggle"}],staticClass:"form-check-input custom-control-input dynamic",attrs:{type:"checkbox",id:"peakHoursSwitch",disabled:"View"===e.currentMode},domProps:{checked:Array.isArray(e.form.rateToggle)?e._i(e.form.rateToggle,null)>-1:e.form.rateToggle},on:{change:[function(t){var o=e.form.rateToggle,i=t.target,a=!!i.checked;if(Array.isArray(o)){var s=null,l=e._i(o,s);i.checked?l<0&&e.$set(e.form,"rateToggle",o.concat([s])):l>-1&&e.$set(e.form,"rateToggle",o.slice(0,l).concat(o.slice(l+1)))}else e.$set(e.form,"rateToggle",a)},e.fncApplyRate]}}),o("span",{staticClass:"slider round",staticStyle:{cursor:"default"}},[o("span",{staticClass:"slider-yes"},[e._v(e._s(e.$t("Yes")))]),o("span",{staticClass:"slider-no"},[e._v(e._s(e.$t("No")))])])])])])]),e.form.rateToggle&&"Dependent"!=e.serviceType?o("div",{staticClass:"input-group mt-3"},[o("span",[o("label",{staticClass:"form-check form-check-inline"},[o("div",{staticClass:"custom-control custom-radio custom-control-inline"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.form.isLeaf,expression:"form.isLeaf"}],staticClass:"custom-control-input",attrs:{type:"radio",id:"fixedRate",value:"true",disabled:"View"===e.currentMode},domProps:{checked:e._q(e.form.isLeaf,"true")},on:{change:[function(t){return e.$set(e.form,"isLeaf","true")},e.chkisLeafRule]}}),e.isCheckExtraFeatureUSICBILLING?o("label",{staticClass:"custom-control-label",attrs:{for:"IsLeafNode"}},[e._v(" "+e._s(e.$t("IsLeafNode"))+" ")]):o("label",{staticClass:"custom-control-label",attrs:{for:"Fixed"}},[e._v(" "+e._s(e.$t("Fixed"))+" ")])])]),o("label",{staticClass:"form-check form-check-inline"},[o("div",{staticClass:"custom-control custom-radio custom-control-inline"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.form.addAdder,expression:"form.addAdder"}],staticClass:"custom-control-input",attrs:{type:"radio",id:"usageBasedRate",value:"true",disabled:"View"===e.currentMode},domProps:{checked:e._q(e.form.addAdder,"true")},on:{change:[function(t){return e.$set(e.form,"addAdder","true")},e.onAdderChecked]}}),e.isCheckExtraFeatureUSICBILLING?o("label",{staticClass:"custom-control-label",attrs:{for:"AddAdder"}},[e._v(" "+e._s(e.$t("AddAdder"))+" ")]):o("label",{staticClass:"custom-control-label",attrs:{for:"UsageBased"}},[e._v(" "+e._s(e.$t("UsageBased"))+" ")])])])])]):e._e()]):e._e(),e.isShowServiceDetail&&e.form.rateToggle&&"Dependent"!=e.serviceType?o("div",{staticClass:"col-12 d-flex p-0"},[e.showIsLeafFlag?o("div",{staticClass:"col-lg-4"},[o("div",{staticClass:"form-group"},[o("label",[e._v(e._s(e.$t("ClientServiceFlag"))+":")]),o("br"),o("div",{staticClass:"flag-selector"},[o("span",{staticClass:"flag-icon",style:{color:e.form.selectedFlag.color},on:{click:e.isLeafTogglePopup}},[o("i",{staticClass:"fas fa-flag"})]),e.form.showPopup?o("div",{staticClass:"popup"},[o("div",{staticClass:"popup-header"},[o("span",[e._v("Flag Condition")]),o("button",{staticClass:"close-btn",on:{click:function(t){e.form.showPopup=!1}}},[e._v("×")])]),o("div",{staticClass:"flags"},e._l(e.flags,(function(t){return o("span",{key:t.value,staticClass:"flag-option",style:{color:t.color},on:{click:function(o){return e.isLeafSelectFlag(t)}}},[o("i",{staticClass:"fas fa-flag"})])})),0)]):e._e()])])]):e._e(),e.showIsLeafWorkCode?o("div",{staticClass:"col-lg-4"},[o("div",{staticClass:"form-group"},[o("label",[e._v(e._s(e.$t("RateCode"))+":")]),o("select",{directives:[{name:"model",rawName:"v-model",value:e.form.workCodeId,expression:"form.workCodeId"}],staticClass:"form-control p-1",attrs:{disabled:"View"===e.currentMode||!e.form.isLeaf},on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"workCodeId",t.target.multiple?o:o[0])}}},[o("option",{attrs:{disabled:"",value:""}},[e._v(e._s(e.$t("Select")))]),e._l(e.workCodeList,(function(t){return o("option",{key:t.value,domProps:{value:t.value}},[e._v(" "+e._s(t.name)+" ")])}))],2)])]):e._e()]):e._e(),e.isShowServiceDetail&&e.form.rateToggle&&"Dependent"!=e.serviceType?o("div",{staticClass:"col-12 d-flex flex-wrap p-0"},[e.showAdderType?o("div",{staticClass:"col-lg-10 p-0"},[o("div",{staticClass:"form-group"},[o("div",{staticClass:"custom-control custom-radio custom-control-inline"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.form.adderType,expression:"form.adderType"}],staticClass:"custom-control-input",attrs:{type:"radio",value:"T",id:"adderTier",disabled:"View"===e.currentMode},domProps:{checked:e._q(e.form.adderType,"T")},on:{change:[function(t){return e.$set(e.form,"adderType","T")},function(t){return e.onAdderTypeSelected("T","Add")}]}}),o("label",{staticClass:"custom-control-label",attrs:{for:"adderTier"}},[e._v(e._s(e.$t("TierWiseAdder")))])]),o("div",{staticClass:"custom-control custom-radio custom-control-inline"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.form.adderType,expression:"form.adderType"}],staticClass:"custom-control-input",attrs:{type:"radio",value:"P",id:"adderPeriodic",disabled:"View"===e.currentMode},domProps:{checked:e._q(e.form.adderType,"P")},on:{change:[function(t){return e.$set(e.form,"adderType","P")},function(t){return e.onAdderTypeSelected("P","Add")}]}}),o("label",{staticClass:"custom-control-label",attrs:{for:"adderPeriodic"}},[e._v(e._s(e.$t("PeriodicAdder")))])]),o("div",{staticClass:"custom-control custom-radio custom-control-inline"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.form.adderType,expression:"form.adderType"}],staticClass:"custom-control-input",attrs:{type:"radio",value:"M",id:"adderSlab",disabled:"View"===e.currentMode},domProps:{checked:e._q(e.form.adderType,"M")},on:{change:[function(t){return e.$set(e.form,"adderType","M")},function(t){return e.onAdderTypeSelected("M","Add")}]}}),o("label",{staticClass:"custom-control-label",attrs:{for:"adderSlab"}},[e._v(e._s(e.$t("MatchingAdder")))])]),o("div",{staticClass:"custom-control custom-radio custom-control-inline"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.form.adderType,expression:"form.adderType"}],staticClass:"custom-control-input",attrs:{type:"radio",value:"C",id:"adderCustom",disabled:"View"===e.currentMode},domProps:{checked:e._q(e.form.adderType,"C")},on:{change:[function(t){return e.$set(e.form,"adderType","C")},function(t){return e.onAdderTypeSelected("C","Add")}]}}),o("label",{staticClass:"custom-control-label",attrs:{for:"adderCustom"}},[e._v(e._s(e.$t("ProceedingAdder")))])])])]):e._e()]):e._e(),e.showAddAdderTypeTable&&e.isShowServiceDetail&&e.form.rateToggle&&"Dependent"!=e.serviceType?o("div",{staticClass:"col-12 p-0"},[o("div",{staticClass:"listing"},[o("div",{staticClass:"table-responsive overflowauto"},[o("table",{staticClass:"table table-bordered dt-responsive nowrap mb-0 mt-0"},[o("thead",{staticClass:"thead-bg"},[o("tr",[o("th",{attrs:{width:"20%"}},[e._v(e._s(e.$t("Units")))]),o("th",{attrs:{width:"10%"}},[e._v(e._s(e.$t("From")))]),o("th",{attrs:{width:"10%"}},[e._v(e._s(e.$t("To")))]),o("th",{staticStyle:{display:"none"},attrs:{width:"10%"}},[e._v(e._s(e.$t("Amount")))]),o("th",{attrs:{width:"10%"}},[e._v(e._s(e.$t("RateCode")))]),e.showRepeatAfter?o("th",{attrs:{width:"10%"}},[e._v(e._s(e.$t("RepeatAfter")))]):e._e(),e.showFlag?o("th",{staticClass:"text-center",attrs:{width:"5%"}}):e._e(),o("th",{attrs:{width:"5%"}})])]),o("tbody",e._l(e.visibleAdderRows,(function(t,i){return o("tr",{key:i},[o("td",[0==i?o("select",{directives:[{name:"model",rawName:"v-model",value:t.unit,expression:"adder.unit"}],staticClass:"form-control p-1",attrs:{disabled:"View"===e.currentMode},on:{change:function(o){var i=Array.prototype.filter.call(o.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(t,"unit",o.target.multiple?i:i[0])}}},[o("option",{attrs:{value:"",selected:""}},[e._v(e._s(e.$t("Select")))]),e._l(e.usageMeasurementList,(function(t){return o("option",{key:t.value,domProps:{value:t.value}},[e._v(" "+e._s(t.name)+" ")])}))],2):e._e()]),o("td",[o("input",{directives:[{name:"model",rawName:"v-model",value:t.from,expression:"adder.from"}],staticClass:"form-control p-1",attrs:{type:"number",disabled:"View"===e.currentMode},domProps:{value:t.from},on:{input:function(o){o.target.composing||e.$set(t,"from",o.target.value)}}})]),o("td",[o("input",{directives:[{name:"model",rawName:"v-model",value:t.to,expression:"adder.to"}],class:["form-control p-1",t.toInvalid?"border-danger":""],attrs:{type:"text",disabled:"View"===e.currentMode},domProps:{value:t.to},on:{input:[function(o){o.target.composing||e.$set(t,"to",o.target.value)},function(t){return e.onToValueChange(t.target.value,i)}]}})]),o("td",{staticStyle:{display:"none"}},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.amount,expression:"adder.amount"}],staticClass:"form-control p-1",attrs:{type:"number"},domProps:{value:t.amount},on:{input:function(o){o.target.composing||e.$set(t,"amount",o.target.value)}}})]),o("td",[o("select",{directives:[{name:"model",rawName:"v-model",value:t.workCodeBefore,expression:"adder.workCodeBefore"}],staticClass:"form-control p-1",attrs:{disabled:"View"===e.currentMode},on:{change:function(o){var i=Array.prototype.filter.call(o.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(t,"workCodeBefore",o.target.multiple?i:i[0])}}},[o("option",{attrs:{value:"",disabled:"",selected:""}},[e._v(e._s(e.$t("Select")))]),e._l(e.workCodeList,(function(t){return o("option",{key:t.value,domProps:{value:t.value}},[e._v(" "+e._s(t.name)+" ")])}))],2)]),e.showRepeatAfter?o("td",[o("input",{directives:[{name:"model",rawName:"v-model",value:t.repeatAfter,expression:"adder.repeatAfter"}],staticClass:"form-control p-1",attrs:{type:"number",disabled:"View"===e.currentMode},domProps:{value:t.repeatAfter},on:{input:function(o){o.target.composing||e.$set(t,"repeatAfter",o.target.value)}}})]):e._e(),e.showFlag?o("td",{staticClass:"text-center single-action service-flag-data"},[o("span",{staticClass:"flag-icon",style:{color:t.selectedFlag.color},on:{click:function(o){return e.isAdderTogglePopup(t)}}},[o("i",{staticClass:"fas fa-flag"})]),t.showPopup?o("div",{staticClass:"popup"},[o("div",{staticClass:"popup-header"},[o("span",[e._v("Flag Condition")]),o("button",{staticClass:"close-btn",on:{click:function(e){t.showPopup=!1}}},[e._v("×")])]),o("div",{staticClass:"flags"},e._l(e.flags,(function(i){return o("span",{key:i.value,staticClass:"flag-option",style:{color:i.color},on:{click:function(o){return e.isAdderSelectFlag(t,i)}}},[o("i",{staticClass:"fas fa-flag"})])})),0)]):e._e()]):e._e(),"View"!==e.currentMode?o("td",{staticClass:"text-center single-action"},[o("a",{attrs:{href:"javascript:;"},on:{click:function(t){return e.removeAdderRow(i)}}},[o("em",{staticClass:"fa fa-trash-o text-danger float-none"})])]):e._e()])})),0)])])]),o("div",{staticClass:"col-lg-12 float-left p-0 add-form-field text-right py-3",staticStyle:{display:"block"}},[e.showRepeatAfter?e._e():o("a",{directives:[{name:"show",rawName:"v-show",value:"View"!==e.currentMode,expression:"currentMode !== 'View'"}],staticClass:"btn btn-success text-white",attrs:{title:"Add Row",href:"javascript:;"},on:{click:e.addAdderRow}},[o("i",{staticClass:"fa fa-plus pr-2"}),e._v("Add Row ")])])]):e._e(),e.form.rateToggle&&"Dependent"==e.serviceType?o("div",{staticClass:"col-12 d-flex flex-wrap p-0"},[o("div",{staticClass:"col-md-3"},[o("label",[e._v("Dependent Type:")]),o("br"),o("select",{directives:[{name:"model",rawName:"v-model",value:e.form.dependentType,expression:"form.dependentType"}],staticClass:"form-control p-1",on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"dependentType",t.target.multiple?o:o[0])},function(t){return e.handleDependentType(e.form.dependentType)}]}},[o("option",{attrs:{value:"",disabled:"",selected:""}},[e._v(e._s(e.$t("Select")))]),o("option",{attrs:{value:"S"}},[e._v("Total number of a service")]),o("option",{attrs:{value:"M"}},[e._v("Sum of multiple service")])])]),o("div",{directives:[{name:"show",rawName:"v-show",value:""!=e.form.dependentType,expression:"form.dependentType != ''"}],staticClass:"col-md-3"},[o("label",[e._v("Services:")]),o("br"),o("Multiselect",{attrs:{multiple:e.isMultiple,options:e.serviceDdlList,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,searchable:!0,"show-no-results":!1,"internal-search":!0,label:"name","track-by":"value",placeholder:e.$t("Select")},model:{value:e.form.dependentOnServices,callback:function(t){e.$set(e.form,"dependentOnServices",t)},expression:"form.dependentOnServices"}})],1),o("div",{directives:[{name:"show",rawName:"v-show",value:""!=e.form.dependentType,expression:"form.dependentType != ''"}],staticClass:"col-md-3"},[o("label",{attrs:{for:"functionType"}},[e._v("Calculation Function:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:e.form.functionType,expression:"form.functionType"}],staticClass:"form-control",attrs:{id:"functionType"},on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.form,"functionType",t.target.multiple?o:o[0])}}},[o("option",{attrs:{value:"",disabled:"",selected:""}},[e._v(e._s(e.$t("Select")))]),o("option",{attrs:{value:"Sum"}},[e._v("Sum")]),o("option",{attrs:{value:"Multiply"}},[e._v("Multiply")]),o("option",{attrs:{value:"Divide"}},[e._v("Divide")]),o("option",{attrs:{value:"Subtract"}},[e._v("Subtract")])])]),o("div",{staticClass:"col-md-3"},[o("label",[e._v("Value:")]),o("br"),o("input",{directives:[{name:"model",rawName:"v-model",value:e.form.dependentPrice,expression:"form.dependentPrice"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:e.form.dependentPrice},on:{input:function(t){t.target.composing||e.$set(e.form,"dependentPrice",t.target.value)}}})])]):e._e()])]),o("div",{staticClass:"modal-footer p-2"},[o("div",{staticClass:"col-12 mt-3"},[o("div",{staticClass:"row flex-row-reverse"},[o("div",{staticClass:"col-lg-6 text-right p-0"},[e.isRateCode&&"View"!==e.currentMode?o("a",{staticClass:"btn btn-success save-btn mr-1",attrs:{title:e.$t("addratecode")},on:{click:function(t){return e.RateCodeModel()}}},[o("i",{staticClass:"fa fa-plus pr-2"}),e._v(e._s(e.$t("addratecode"))+" ")]):e._e(),"View"!==e.currentMode?o("a",{staticClass:"btn btn-success save-btn mr-1",attrs:{href:"javascript:;",title:e.$t("Save")},on:{click:function(t){return e.RuleModel()}}},[o("i",{staticClass:"fa fa-save pr-2"}),e._v(e._s(e.$t("Save"))+" ")]):e._e(),o("a",{staticClass:"btn btn-danger",attrs:{href:"javascript:;",title:e.$t("Close")},on:{click:e.Close}},[o("i",{staticClass:"fa fa-close pr-2"}),e._v(e._s(e.$t("Close"))+" ")])]),o("div",{staticClass:"col-lg-6"},[o("div",{staticClass:"py-2 text-danger"},[e._v(" "+e._s(e.$t("MandatoryString")))])])])])])])])]),e.openRuleMode?o("div",{staticClass:"modal d-block show",attrs:{role:"dialog","aria-modal":"true"}},[o("div",{staticClass:"modal-dialog modal-dialog-centered"},[o("div",{staticClass:"modal-content"},[o("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[o("h5",{staticClass:"modal-title"},[e._v(" "+e._s(e.$t("Alert")))]),o("button",{staticClass:"close",attrs:{type:"button"},on:{click:e.CloseRuleModel}},[o("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),o("div",{staticClass:"heading-border ml-2 mt-2"},[o("h5",{staticClass:"h5"},[o("span",[e._v(e._s(e.$t("Thisservicewasalreadyconsumed")))])])]),o("div",{staticClass:"modal-body"},[e._l(e.getRuleConditions,(function(t,i){return o("div",{key:i},[o("span",[e._v(e._s(i+1)+".")]),e._v("  "),o("span",[o("b",[e._v(e._s(t.RULE_NAME))])])])})),o("p",{staticClass:"mt-2"},[e._v(e._s(e.$t("overwriteallservicesusedinbillingrulemessage")))])],2),o("div",{staticClass:"modal-footer"},[o("div",{staticClass:"col-12 mt-3"},[o("div",{staticClass:"row flex-row-reverse"},[o("div",{staticClass:"col-lg-6 text-right"},[o("a",{staticClass:"btn btn-success  mr-2",attrs:{title:e.$t("Yes")},on:{click:function(t){return e.saveAddRule()}}},[o("i",{staticClass:"fa fa-check pr-2"}),e._v(e._s(e.$t("Yes"))+" ")]),o("a",{staticClass:"btn btn-primary mr-2",attrs:{href:"javascript:;",title:e.$t("Close")},on:{click:e.CloneService}},[o("i",{staticClass:"fa fa-close pr-2"}),e._v(e._s(e.$t("No"))+" ")]),o("a",{staticClass:"btn btn-danger",attrs:{href:"javascript:;",title:e.$t("Cancel")},on:{click:function(t){return e.CloseRuleModel()}}},[o("i",{staticClass:"fa fa-close pr-2"}),e._v(e._s(e.$t("Cancel"))+" ")])]),o("div",{staticClass:"col-lg-6"},[o("div",{staticClass:"py-2 text-danger"},[e._v(" "+e._s(e.$t("MandatoryString")))])])])])])])])]):e._e(),o("div",{staticClass:"my-popups"},[o("loader",{attrs:{"is-visible":e.isLoading}}),e.isCloneModel?o("div",{staticClass:"modal d-block"},[o("div",{staticClass:"modal-dialog modal-dialog-centered"},[o("div",{staticClass:"modal-content"},[o("div",{staticClass:"modal-header theme-primary partition-full d-flex justify-content-between align-items-center"},[o("h5",{staticClass:"modal-title"},[e._v(" "+e._s(e.$t("Alert"))+" ")]),o("button",{staticClass:"close",attrs:{type:"button"},on:{click:e.CloseCloneModel}},[o("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),o("div",{staticClass:"modal-body"},[o("dynamic-form",{ref:"validateClone",attrs:{lang:"en",buttons:e.buttons,schema:e.FormSchema,mandatorytext:e.$t("MandatoryString")}})],1)])])]):e._e()],1)])])],1),e.rateCode?o("RateCode",{on:{CloseAddWorkCode:e.CloseAddWorkCode}}):e._e()],1)},a=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("label",{staticStyle:{"font-weight":"600",color:"#495057","margin-bottom":"8px"}},[e._v(" Condition Name:"),o("span",{staticStyle:{color:"#dc3545"}},[e._v("*")])])}],s=(o("33d1"),o("14d9"),o("5377"),o("ea98"),o("9769")),l=o("a985"),r={components:{RateCode:l["a"]},props:{serviceDetailForBillingRule:{type:Array,required:!1},reqFrom:{type:String,required:!1},conditionId:{type:String,required:!1},viewType:{type:String,required:!1},nodeName:{type:String,required:!1},configurationId:{type:String,required:!1},serviceRuleItem:{type:Array,required:!1},reqType:{type:String,required:!1},serviceId:{type:String,required:!1},rateData:{type:String,required:!1},mode:{type:String,default:"Edit"}},data(){return{currentMode:"",openRuleMode:!1,isLoading:!1,isCloneModel:!1,operator:[],FormSchema:[{layoutType:"single",Data:[{astype:"TextField",label:this.$t("ConditionName"),name:"ServiceName",value:"",placeholder:"",validationRules:{required:!0},disabled:!1}]}],buttons:[{type:"submit",class:"btn btn-success",text:"<i class='fa fa-save pr-2'></i>"+this.$t("Save"),onClick:this.CreateClone},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>"+this.$t("Cancel"),onClick:this.CloseCloneModel}],form:{conditionId:0,conditions:[{relation:"",openingBracket:"(",field:"",operator:"",value:"",valueTo:"",daysOfWeek:"",closingBracket:")"}],isLeaf:!1,workCodeId:"",addAdder:!1,addAdderTypeTable:!1,adderType:"",adderRows:[{unit:"",from:0,to:"∞",toInvalid:!1,workCodeBefore:"",repeatAfter:"",workCodeAfter:"",selectedFlag:{value:"N",color:"grey"},showPopup:!1,statusId:1001}],selectedFlag:{value:"N",color:"grey"},showPopup:!1,rateToggle:!1,isUpdateRule:!1,dependentOnServices:null,dependentType:"",dependentPrice:0,functionType:"",serviceId:0},conditionBlocks:[{operator:"AND",joinWithPrevious:"OR",conditions:[{field:"",operator:"",value:"",valueTo:"",daysOfWeek:"",operatorList:[],valueOptions:[],sqlType:""}]}],serviceName:"",showAdder:!1,conditionName:"",showError:!1,showAdderType:!1,serviceType:"",billingFrequency:"",showRepeatAfter:!1,showWorkCode:!1,showFlag:!1,usageMeasurementList:[],workCodeList:[],meterReadingList:[],companyClientList:[],groupedOptions:{},expandedGroups:{},showIsLeafFlag:!1,showIsLeafWorkCode:!1,configurationId:0,isEditMode:!1,showAddAdderTypeTable:!1,isCheckExtraFeatureUSICBILLING:!1,isRateCodeDisabled:!1,weekDaysList:[{label:"Sun",value:"1"},{label:"Mon",value:"2"},{label:"Tue",value:"3"},{label:"Wed",value:"4"},{label:"Thu",value:"5"},{label:"Fri",value:"6"},{label:"Sat",value:"7"}],flags:[{value:"R",color:"red"},{value:"Y",color:"gold"},{value:"G",color:"green"},{value:"N",color:"grey"}],isShowServiceDetail:!1,rateCode:!1,isRateCode:!1,getRuleConditions:[],getServiceId:0,serviceDdlList:[],planId:0}},mounted(){for(const e in this.groupedOptions)this.$set(this.expandedGroups,e,!0);!0===this.mode||"true"===this.mode||"View"===this.mode?this.currentMode="View":!1===this.mode||"false"===this.mode||"Edit"===this.mode?this.currentMode="Edit":this.currentMode="Add",console.log(" Mounted Mode:",this.currentMode)},computed:{isMultiple(){return"M"===this.form.dependentType},isViewMode(){return!0===this.mode||"view"===String(this.mode).toLowerCase()},flatGroupedOptions(){const e=[];for(const t in this.groupedOptions)if(e.push({isGroup:!0,groupName:t}),this.expandedGroups[t]){const o=this.groupedOptions[t];o.forEach(o=>{e.push({...o,isGroup:!1,groupName:t})})}return e},fieldLabelMap(){const e={};return Object.values(this.groupedOptions).flat().forEach(t=>{e[t.value]=this.$t(t.label)}),e},fieldSqlConditionMap(){const e={};return Object.values(this.groupedOptions).flat().forEach(t=>{e[t.value]=t.joinFieldName}),e},conditionText(){return this.conditionBlocks.map((e,t)=>{const o=e.conditions.filter(e=>e.field).map((t,o)=>{var i,a,s,l;const r=this.fieldLabelMap[t.field]||t.field||"";if(!t.field)return"[Select Field]";if(!t.operator)return r+" [Select Operator]";let n="";if(t.operatorList&&Array.isArray(t.operatorList)){const e=t.operatorList.find(e=>e.OPERATOR_ID===t.operator);n=e?e.OPERATOR_DISPLAY_NAME:t.operator}else n="[Loading Operators...]";var d="";const c=null===(i=n)||void 0===i?void 0:i.toLowerCase(),u=["is empty","is not empty","is off day","is duplicate"],p=!u.includes(c);if(p)if("select"==t.sqlType&&"not equal to one of multiple possible values"!==c&&"equal to one of multiple possible values"!==c){var v;const e=null===(v=t.valueOptions)||void 0===v?void 0:v.find(e=>e.value===t.value);d=e?e.name:t.value||"[Select Value]"}else if("select"!=t.sqlType||"not equal to one of multiple possible values"!==c&&"equal to one of multiple possible values"!==c)if("bool"===t.sqlType){var f;const e=null===(f=t.valueOptions)||void 0===f?void 0:f.find(e=>e.value===t.value);d=e?e.name:t.value||"[Select Value]"}else if("date"==t.sqlType)t.value&&""!=t.value?("string"===typeof t.value&&(t.value=new Date(t.value)),d=""+this.$d(t.value)||""):d="[Select Date]";else if("time"==t.sqlType)if(t.value&&""!=t.value){const e=/^(0?[1-9]|1[0-2]):[0-5][0-9] (AM|PM)$/i;if(e.test(t.value))d=t.value;else{var m;const e=new Date(t.value),o=e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0});t.value=o,d=null!==(m=t.value)&&void 0!==m?m:""}}else d="[Select Time]";else{var h;d=null!==(h=t.value)&&void 0!==h?h:"[Enter Value]"}else if(t.value&&Array.isArray(t.value)&&t.value.length>0){const e=Array.isArray(t.value)?t.value:[t.value],o=e.map(e=>{var o;const i=null===(o=t.valueOptions)||void 0===o?void 0:o.find(t=>t.value===e.value);return i?i.name:e.name||e.value});d=o.join(", ")}else d="[Select Values]";else d="";var g="";if("between"===(null===(a=n)||void 0===a?void 0:a.toLowerCase())||"date range"===(null===(s=n)||void 0===s?void 0:s.toLowerCase()))if("date"==t.sqlType)t.valueTo&&""!=t.valueTo?("string"===typeof t.valueTo&&(t.valueTo=new Date(t.valueTo)),g=" AND "+this.$d(t.valueTo)||!1):g=" AND [Select Date]";else if("time"==t.sqlType)if(t.valueTo&&""!=t.valueTo){const e=/^(0?[1-9]|1[0-2]):[0-5][0-9] (AM|PM)$/i;if(e.test(t.valueTo)){var C;g=null!==(C=" AND "+t.valueTo)&&void 0!==C?C:""}else{var y;const e=new Date(t.valueTo),o=e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0});t.valueTo=o,g=null!==(y=" AND "+t.valueTo)&&void 0!==y?y:""}}else g=" AND [Select Time]";else"date"!=t.sqlType&&"time"!=t.sqlType&&(g=t.valueTo&&""!=t.valueTo?" AND "+t.valueTo:" AND [Enter Value]");var T="";if("is week end"===(null===(l=n)||void 0===l?void 0:l.toLowerCase().trim())){const e=(t.daysOfWeek||"").split(",").filter(Boolean);if(e.length>0){const t=e.map(e=>{const t=this.weekDaysList.find(t=>t.value===e);return t?t.label:e});T=` (${t.join(", ")})`}else T=" ([Select Days])"}const w=o>0?` ${e.operator||"AND"} `:"";return`${w}${r} ${n} ${d}${g}${T}`}).join("");return o?`(${o})`:""}).filter(e=>e).map((e,t,o)=>{if(0===t)return e;const i=this.conditionBlocks[t].joinWithPrevious||"OR";return`${"AND"===i?" AND ":" OR "}${e}`}).join("")},visibleAdderRows(){return this.form.adderRows.filter(e=>1003!==e.statusId)}},created:async function(){var e=this;const t=window.location.pathname;t.includes("/ManagePlan/")&&(e.planId=parseInt(this.$route.params.id)),this.serviceRuleItem&&this.serviceRuleItem.ruleCondition&&(this.form.selectedFlag=this.serviceRuleItem.ruleCondition.selectedFlag?this.serviceRuleItem.ruleCondition.selectedFlag:{value:"N",color:"grey"},this.form.workCodeId=this.serviceRuleItem.ruleCondition.rateCode?this.serviceRuleItem.ruleCondition.rateCode:""),e.configurationId=this.configurationId,await e.GetRuleListingByServiceId(e.conditionId),await e.GetBillingRuleFieldList(),e.BindWorkCode(),"addMapBillingRuleForService"===e.reqFrom||"EditMapBillingRuleForService"===e.reqFrom||"ViewBillingConditionForService"===e.reqFrom?(e.isShowServiceDetail=!0,e.isRateCode=!0,("EditMapBillingRuleForService"===e.reqFrom||"ViewBillingConditionForService"===e.reqFrom)&&setTimeout((function(){e.isEditMode=!0,e.BindRuleConditions(e.conditionId)}),200)):"fromBillingService"===e.reqFrom?(e.isEditMode=!1,await e.BindRuleConditions(e.conditionId),e.isShowServiceDetail=!1):"addBillingService"===e.reqFrom&&(e.isEditMode=!1,e.isShowServiceDetail=!1),e.toggleGroup(),e.checkSlabCondition(),e.GetAddonMapByServiceId(),e.syncConditionBlocks()},methods:{fncApplyRate(){console.log("rateToggle",this.form.rateToggle)},async GetRuleListingByServiceId(e){var t=this,o="serviceId="+(e>0?e:0);s["a"].GetRuleListingByServiceId(o).then(e=>{null!=e.data&&"[]"!=e.data?t.getRuleConditions=JSON.parse(e.data):t.getRuleConditions=[]})},RateCodeModel(){var e=this;e.rateCode=!0},CloseAddWorkCode(){this.rateCode=!1,this.BindWorkCode()},getDayChecked(e,t){return!!e&&e.split(",").includes(t)},toggleDay(e,t){let o=(e.daysOfWeek||"").split(",").filter(Boolean);const i=o.indexOf(t);i>=0?o.splice(i,1):o.push(t),e.daysOfWeek=o.join(",")},isMultiSelectOperator(e){var t;const o=(e.operatorList||[]).find(t=>t.OPERATOR_ID===e.operator);if(!o)return!1;const i=null===(t=o.OPERATOR_DISPLAY_NAME)||void 0===t?void 0:t.toLowerCase();return"equal to one of multiple possible values"===i||"not equal to one of multiple possible values"===i},isValueHidden(e){var t;const o=(e.operatorList||[]).find(t=>t.OPERATOR_ID===e.operator);if(!o)return!1;const i=null===(t=o.OPERATOR_DISPLAY_NAME)||void 0===t?void 0:t.toLowerCase();return"is empty"===i||"is not empty"===i||"is off day"===i||"is duplicate"===i},isShowIsWeekDay(e){var t;const o=(e.operatorList||[]).find(t=>t.OPERATOR_ID===e.operator);if(!o)return!1;const i=null===(t=o.OPERATOR_DISPLAY_NAME)||void 0===t?void 0:t.toLowerCase();return"is week end"===i},isValueToVisible(e){var t;if(!e.operator)return!1;const o=(e.operatorList||[]).find(t=>t.OPERATOR_ID===e.operator);if(!o)return!1;const i=null===(t=o.OPERATOR_DISPLAY_NAME)||void 0===t?void 0:t.toLowerCase();return"between"===i||"date range"===i},checkSlabCondition:async function(){var e=this,t=this.serviceId;const o="serviceId="+t,i=await s["a"].GetServiceTypeById(o);if(null!=i.data[0].SERVICE_TYPE_CODE){e.serviceType=i.data[0].SERVICE_TYPE_CODE;var a=i.data[0].METER_TYPE_ID,l=i.data[0].USAGE_MEASUREMENT_ID;e.GetDDLUsageMeasurement(a,l),"Dependent"==e.serviceType&&e.getServicelistForDependency()}},getServicelistForDependency:function(){var e=this,t=0==e.planId?"id=&moduleName=&type=BILLING_RULE_SERVICE_NAME&search=&refId=":"id=&moduleName=&type=BILLING_RULE_SERVICE_NAME_BY_PLAN_ID&search=&refId="+e.planId;s["a"].GetDDLData(t).then(t=>{if(t.data){var o=t.data;if(null!=o){e.serviceDdlList=t.data.DATA;let o=[];e.serviceDdlList.forEach((function(t){e.form.dependentOnServices.includes(t.value)&&o.push(t)})),e.form.dependentOnServices=[...o]}}})},BindRuleConditions:async function(e){const t=this,o="serviceId="+e,i=await s["a"].GetRuleConditionById(o);if(i&&i.data&&i.data.length>0){t.conditionName=i.data[0].SERVICE_NAME;const e=Object.values(t.groupedOptions).flat();t.form.conditions=await Promise.all(i.data.map(async o=>{const i=e.find(e=>e.value===o.TEMPLATE_ID);let a=[],l=[],r=null!==o.FIRST_VALUE&&void 0!==o.FIRST_VALUE?o.FIRST_VALUE:"",n=null!==o.SECOND_VALUE&&void 0!==o.SECOND_VALUE?o.SECOND_VALUE:"",d=(null===i||void 0===i?void 0:i.sqlType)||"";if(i){var c;const e=await s["a"].GetOperator(`dataType=${i.sqlType}&customField=${i.value}`);a=(null===e||void 0===e||null===(c=e.data)||void 0===c?void 0:c.DATA)||[]}if("select"==i.sqlType&&"lookup"!=i.picklistOptions.toLowerCase()){if(i.picklistOptions&&""!==i.picklistOptions.trim()){var u;const e=i.picklistOptions.split(",").map(e=>({first_value:null,name:e.trim(),value:e.trim().replace(/\s+/g,"-"),second_value:null}));l=e;const t=a.find(e=>e.OPERATOR_ID===o.OPERATOR_ID),s=["equal to one of multiple possible values","not equal to one of multiple possible values"],n=t&&s.includes(null===(u=t.OPERATOR_DISPLAY_NAME)||void 0===u?void 0:u.toLowerCase());if(n){const e=r.split(",").map(e=>e.trim());r=l.filter(t=>e.includes(String(t.value)))}else{const e=l.find(e=>String(e.value)===String(r));r=e&&void 0!==e.value?e.value:r}}}else if("select"===d&&"lookup"==i.picklistOptions.toLowerCase()){var p,v;const e=await s["a"].GetDDLData(`id=&moduleName=&type=${i.fieldCode}&search=`);l=(null===e||void 0===e||null===(p=e.data)||void 0===p?void 0:p.DATA)||[];const t=a.find(e=>e.OPERATOR_ID===o.OPERATOR_ID),n=["equal to one of multiple possible values","not equal to one of multiple possible values"],d=t&&n.includes(null===(v=t.OPERATOR_DISPLAY_NAME)||void 0===v?void 0:v.toLowerCase());if(d){const e=r.split(",").map(e=>e.trim());r=l.filter(t=>e.includes(String(t.value)))}else{const e=l.find(e=>String(e.value)===String(r));r=e&&void 0!==e.value?e.value:r}}else if("bool"===d){var f=t.MakeArray(i.picklistOptions,"radio");f.length>0&&(l=f)}else isNaN(r)||""===r||(r=Number(r));return{relation:o.RELATION_WITH_PARENT||"",openingBracket:o.OPENING_BRACKETS||"",field:o.TEMPLATE_ID||"",operator:o.OPERATOR_ID||"",value:r,valueTo:n,daysOfWeek:o.DaysofTheWeek,closingBracket:o.CLOSING_BRACKETS||"",operatorList:a,valueOptions:l,sqlType:d}})),t.syncConditionBlocks()}},GetAddonMapByServiceId:async function(){var e=this;if(e.form.isUpdateRule=!0,this.rateData.hasOwnProperty("nodeName")){var t=`serviceId=${e.conditionId}&nodeName=${e.nodeName}&configId=${e.configurationId}`;await s["a"].GetAddonMapByServiceId(t).then((function(t){t.data.length>0&&((t.data[0].IsAddon||t.data[0].IsLeafNode)&&(e.form.rateToggle=!0),e.form.addAdder=t.data[0].IsAddon,e.form.isLeaf=t.data[0].IsLeafNode,e.form.workCodeId=t.data[0].WorkCode,e.form.dependentPrice=t.data[0].AddonAmount,e.form.dependentType=t.data[0].DependentType,e.form.functionType=t.data[0].FunctionType,e.form.dependentOnServices=""!=t.data[0].DependentOnService?t.data[0].DependentOnService.split(","):"",e.form.selectedFlag=e.flags.find(e=>e.value===t.data[0].ClientServiceFlag)||{value:"N",color:"grey"},e.form.adderType=t.data[0].AddonType||"",e.onAdderTypeSelected(e.form.adderType,e.$route.params.mode),e.form.addAdder?(e.onAdderChecked(),e.showAddAdderTypeTable=!0):e.form.isLeaf&&(e.chkisLeafRule(),e.showAddAdderTypeTable=!1),e.form.adderRows=[],t.data.forEach(t=>{t.ServiceAddonMap.forEach(o=>{e.form.adderRows.push({unit:t.UnitOfMeasure||"",from:void 0!==o.AddonFromValue?o.AddonFromValue:0,to:0!==o.AddonToValue?o.AddonToValue:"∞",toInvalid:!1,workCodeBefore:o.WorkCode||"",repeatAfter:o.RepeatAfter||"",workCodeAfter:o.RepeatWorkCode||"",selectedFlag:e.flags.find(e=>e.value===o.ServiceFlag)||{value:"N",color:"grey"},showPopup:!1,addonId:t.AddonId,addonMapId:o.AddonMapId,statusId:1001})})}))}))}else e.form.rateToggle=!0,e.form.isLeaf=this.rateData.isLeafChecked,e.form.isLeaf&&(e.chkisLeafRule(),e.showAddAdderTypeTable=!1),e.form.workCodeId=this.rateData.rateCode},CheckFeaturesForCompany:async function(e){var t=this,o="featureCode="+e;await s["a"].CheckExtraFeatures(o).then((function(o){"USICBILLING"==e&&(1==o.data?t.isCheckExtraFeatureUSICBILLING=!0:t.isCheckExtraFeatureUSICBILLING=!1)}))},handleFieldChange:function(e){const t=Object.values(this.groupedOptions).flat(),o=t.find(t=>t.value===e.field);if(!o)return;this.$set(e,"sqlType",o.sqlType);const i="dataType="+o.sqlType+"&customField="+o.value;s["a"].GetOperator(i).then(t=>{const o=t.data;null!=o&&(this.$set(e,"operatorList",o.DATA),e.operator="",e.value="",e.valueTo="")})},handleDropdownValue:function(e){var t=this;const o=Object.values(this.groupedOptions).flat(),i=o.find(t=>t.value===e.field);if(i)if(this.$set(e,"sqlType",i.sqlType),this.$set(e,"valueOptions",[]),this.$set(e,"value",""),this.$set(e,"valueTo",""),"select"==i.sqlType&&"lookup"!=i.picklistOptions.toLowerCase()){if(i.picklistOptions&&""!==i.picklistOptions.trim()){const t=i.picklistOptions.split(",").map(e=>({first_value:null,name:e.trim(),value:e.trim().replace(/\s+/g,"-"),second_value:null}));this.$set(e,"valueOptions",t)}}else if("select"==i.sqlType&&"lookup"==i.picklistOptions.toLowerCase()){var a=`id=&moduleName=&type=${i.fieldCode}&search=`;s["a"].GetDDLData(a).then(t=>{if(t.data){var o=t.data;null!=o&&this.$set(e,"valueOptions",t.data.DATA)}})}else if("bool"==i.sqlType){var l=t.MakeArray(i.picklistOptions,"radio");l.length>0&&this.$set(e,"valueOptions",l)}},isLeafTogglePopup(){this.form.showPopup=!this.form.showPopup},isLeafSelectFlag(e){this.form.selectedFlag=e,this.form.showPopup=!1},isAdderTogglePopup(e){e.showPopup=!e.showPopup},isAdderSelectFlag(e,t){e.selectedFlag=t,e.showPopup=!1},toggleGroup(e){const t=e||"Client";this.$set(this.expandedGroups,t,!this.expandedGroups[t])},GetBillingRuleFieldList:async function(){await s["a"].GetBillingRuleFieldList().then(e=>{if("Success"==e.data.status&&null!=e.data.result.AVAILABLE_FIELDS){var t;const o=(null===(t=e.data.result.AVAILABLE_FIELDS)||void 0===t?void 0:t[0])||[],i={};o.forEach(e=>{const t=e.SubModule;Array.isArray(null===e||void 0===e?void 0:e.CustomFields)&&e.CustomFields.length>0&&(i[t]=e.CustomFields.map(e=>{var t;return{value:(null===e||void 0===e?void 0:e.CustomFieldId)||"",columnName:(null===e||void 0===e?void 0:e.FieldName)||"",label:(null===e||void 0===e?void 0:e.DisplayName)||"",tableName:(null===e||void 0===e?void 0:e.TableName)||"",sqlType:(null===e||void 0===e||null===(t=e.dttype)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.DataTypeCode)||"",picklistOptions:(null===e||void 0===e?void 0:e.picklist_options)||"",dtCode:(null===e||void 0===e?void 0:e.dt_code)||"",dropdownType:(null===e||void 0===e?void 0:e.dropdown_type)||"",fieldCode:(null===e||void 0===e?void 0:e.field_code)||"",joinFieldName:(null===e||void 0===e?void 0:e.JoinFieldName)||""}}))}),Object.keys(i).length>0&&(this.groupedOptions=i)}})},GetDDLUsageMeasurement:function(e,t){var o=this,i="id=&moduleName=&type=UTILITY_UNIT_OF_MEASUREMENTS&search=&refId="+e;s["a"].GetDDLData(i).then(e=>{if(e.data){var i=e.data;null!=i&&(o.usageMeasurementList=e.data.DATA,o.form.adderRows[0].unit=t)}})},BindWorkCode:function(){var e=this,t=e.configurationId,o="id=&moduleName=&type=WORK_CODE_BY_PLAN_ID&search=&refId="+t;s["a"].GetDDLData(o).then(t=>{if(t.data){var o=t.data;null!=o&&(e.workCodeList=t.data.DATA)}})},onToValueChange(e,t){const o=this.visibleAdderRows[t];if(o)if("∞"===e)o.to="∞";else if(""===e.trim())o.to="";else{const t=Number(e);o.to=isNaN(t)?"":t}},removeConditionRow:function(e){this.form.conditions.length>1&&this.form.conditions.splice(e,1)},removeAdderRow(e){const t=this.visibleAdderRows[e];t&&(t.statusId=1003)},addConditionRow(){this.form.conditions.push({relation:"",openingBracket:"(",field:"",operator:"",value:"",valueTo:"",daysOfWeek:"",closingBracket:")"})},addAdderRow(){const e=this.form.adderRows.filter(e=>1003!==e.statusId),t=e.at(-1),o={unit:"",to:"∞",workCodeBefore:"",toInvalid:!1,repeatAfter:"",workCodeAfter:"",selectedFlag:{value:"N",color:"grey"},showPopup:!1,statusId:1001};if(t&&t.from>=0){if("∞"===t.to)return void(t.toInvalid=!0);t.toInvalid=!1,this.form.adderRows.push({...o,from:Number(t.to)+1})}else this.form.adderRows.push({...o,from:0})},Close:function(){var e=this;e.$parent.isModalAddRule=!1},chkisLeafRule(){this.showAdder=this.form.isLeaf,this.showIsLeafFlag=this.showAdder,this.showIsLeafWorkCode=this.showAdder,this.form.addAdder=!1,this.showAdderType=!1,this.showAddAdderTypeTable=!1,this.form.isLeaf||(this.showAdderType=!1,this.form.adderType=!1,this.showAddAdderTypeTable=!1)},onAdderChecked(){this.showAdderType=this.form.addAdder,this.showIsLeafFlag=!1,this.showIsLeafWorkCode=!1,this.form.isLeaf=!1,this.form.addAdder||(this.form.adderType=!1,this.showAddAdderTypeTable=!1)},onAdderTypeSelected(e){let t="";t=!0===this.mode||"true"===this.mode||"View"===this.mode?"View":!1===this.mode||"false"===this.mode||"Edit"===this.mode?"Edit":"Add","Add"===t&&(this.form.adderRows=[{unit:"",from:0,to:"∞",toInvalid:!1,workCodeBefore:"",repeatAfter:"",workCodeAfter:"",selectedFlag:{value:"N",color:"grey"},showPopup:!1,statusId:1001}]),"T"==e?(this.showRepeatAfter=!1,this.showWorkCode=!1,this.showFlag=!0):"P"==e?(this.showRepeatAfter=!0,this.showWorkCode=!1,this.showFlag=!1):"M"==e?(this.showRepeatAfter=!1,this.showWorkCode=!1,this.showFlag=!0):"C"==e&&(this.showRepeatAfter=!1,this.showWorkCode=!1,this.showFlag=!1),this.form.adderType&&(this.showAddAdderTypeTable=!0),this.currentMode=t},formatDate(e){if(!e)return null;const t=new Date(e),o=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0");return`${o}-${i}-${a}`},databaseConditionText(){const e=e=>{const t=this.fieldSqlConditionMap[e.field]||e.field||"";let o="",i="";if(e.operatorList&&Array.isArray(e.operatorList)){const t=e.operatorList.find(t=>t.OPERATOR_ID===e.operator);o=t?t.OPERATOR_SQL_NAME||t.OPERATOR_EXPRESSION:e.operator,i=t&&t.OPERATOR_DISPLAY_NAME||""}else o=e.operator,i=e.operatorDisplay||"";o=(o||"").toLowerCase();const a=(i||"").trim().toLowerCase();if("not equal to one of multiple possible values"===a||"equal to one of multiple possible values"===a){const i=Array.isArray(e.value)?e.value:[e.value],a=i.map(t=>{var o;const i="object"===typeof t&&null!==t?t.value:t,a=null===(o=e.valueOptions)||void 0===o?void 0:o.find(e=>e.value===i),s=a?a.value:i;return isNaN(s)?`'${s}'`:s}),s=a.join(", ");return`(${t} ${o.toUpperCase()} (${s}))`}if("is week end"===o||"is working day"===o){const o=(e.daysOfWeek||"").split(",").filter(Boolean).join(",");return`(DATEPART(DW, ${t}) IN (${o}))`}if("is lowest"===o)return`(${t} IS LOWEST)`;if("is highest"===o)return`(${t} IS HIGHEST)`;if("is not lowest"===o)return`(${t} IS NOT LOWEST)`;if("is not highest"===o)return`(${t} IS NOT HIGHEST)`;if(["minutesdiff","hoursdiff","daydiff","monthdiff","yeardiff"].includes(o)){const i={minutesdiff:"minute",hoursdiff:"hour",daydiff:"day",monthdiff:"month",yeardiff:"year"},a=i[o],s=this.fieldSqlConditionMap[e.additionalField]||e.additionalField,l=e.additionalOperator||"=";return`(DATEDIFF(${a}, ${t}, ${s}) ${l} ${e.value})`}if("has with"===o){const o=this.fieldSqlConditionMap[e.hasWithField]||e.hasWithField,i=e.hasWithOperator||"=";return`(${t} HAS WITH ${o} ${i} '${e.value}')`}if(("between"===o||"daterange"===o)&&e.valueTo){if("time"===e.sqlType||"datetime"===e.sqlType){const o=e.value?`'${e.value}'`:"''",i=e.valueTo?`'${e.valueTo}'`:"''";return`((CONVERT(time, ${t}) >= ${o} AND CONVERT(time, ${t}) <= ${i}))`}if("date"===e.sqlType){const o=e.value instanceof Date?e.value:new Date(e.value),i=e.valueTo instanceof Date?e.valueTo:new Date(e.valueTo),a=this.formatDate(o),s=this.formatDate(i);return`(${t} BETWEEN '${a}' AND '${s}')`}return`(${t} BETWEEN ${e.value} AND ${e.valueTo})`}let s="";if("nvarchar"===e.sqlType||"string"===e.sqlType)if(o.includes("starts with"))o="LIKE",s=`'${e.value}%'`;else if(o.includes("ends with"))o="LIKE",s=`'%${e.value}'`;else if(o.includes("like"))o="LIKE",s=`'%${e.value}%'`;else if(o.includes("in")){o="IN";const t=Array.isArray(e.value)?e.value:(e.value||"").split(",");s=`(${t.map(e=>`'${e.trim()}'`).join(",")})`}else s=`'${e.value}'`;else if("date"===e.sqlType&&e.value){const t=e.value instanceof Date?e.value:new Date(e.value);s=`'${this.formatDate(t)}'`}else if("bool"===e.sqlType)s=e.value?1:0;else if("equal to"===a&&"select"===e.sqlType)"string"===typeof e.value&&(s=`'${e.value}'`||"");else{var l;s=null!==(l=e.value)&&void 0!==l?l:""}return`(${t} ${o.toUpperCase()} ${s})`};return this.conditionBlocks.map((t,o)=>{const i=t.conditions.filter(e=>e.field&&e.operator).map((o,i)=>{const a=i>0?` ${t.operator||"AND"} `:"";return`${a}${e(o)}`}).join("");if(!i)return"";const a=t.conditions.filter(e=>e.field&&e.operator).length>1||o>0,s=a?`(${i})`:i;if(0===o)return s;const l=t.joinWithPrevious||"OR";return` ${l} ${s}`}).filter(e=>e).join("")},CloneService(){var e=this;e.isCloneModel=!0},CloseCloneModel(){this.isCloneModel=!1},CloseRuleModel(){this.openRuleMode=!1},RuleModel(){this.syncFormConditions(),Number(this.conditionId)>0&&Array.isArray(this.getRuleConditions)&&this.getRuleConditions.length>0&&"fromBillingService"===this.reqFrom?this.openRuleMode=!0:this.saveAddRule()},async saveAddRule(){var e=this;if(this.showError=!0,!this.conditionName)return;0!=e.conditionId&&(this.form.conditionId=e.conditionId);const t=this.conditionText,o=this.databaseConditionText();Array.isArray(this.form.conditions)&&this.form.conditions.forEach(e=>{if("date"===e.sqlType&&(e.value&&(e.value=this.formatDate(e.value)),e.valueTo&&(e.valueTo=this.formatDate(e.valueTo))),null!==e&&void 0!==e&&e.operator&&Array.isArray(e.value)&&e.value.length>0){var t,o;const i=e.operator,a=e.operatorList.find(e=>e.OPERATOR_ID===i);!a||"equal to one of multiple possible values"!==(null===(t=a.OPERATOR_DISPLAY_NAME)||void 0===t?void 0:t.toLowerCase())&&"not equal to one of multiple possible values"!==(null===(o=a.OPERATOR_DISPLAY_NAME)||void 0===o?void 0:o.toLowerCase())||(e.value=e.value.map(e=>e.value).join(","))}}),this.form.serviceId=this.serviceId;const i=JSON.parse(JSON.stringify(this.form));i.adderRows.forEach(e=>{"∞"!==e.to&&e.to!==1/0||(e.to=null)}),1==i.rateToggle&&(i.isLeaf=!0);const a=JSON.stringify(i);var l={objData:a,ruleCondition:t,conditionName:this.conditionName,configuration_id:e.configurationId,sqlcondition:o};await s["a"].SaveAddRule(l).then(t=>{null!=t.data&&("Success"==t.data.Status&&"1"==t.data.Result?(e.Close(),"serviceRuleCondition"==e.viewType&&(e.ShowAlert(e.$t("AddedSuccess",[e.$t("BillingRule")]),"Success",!0,e.$t("Alert")),e.$parent.getConditionRecords()),"fromBillingService"!=e.reqFrom&&"addBillingService"!=e.reqFrom||(e.ShowAlert(e.$t("AddedSuccess",[e.$t("BillingCondition")]),"Success",!0,e.$t("Alert")),e.$parent.FetchData()),e.isLoading=!1,this.$emit("rule-saved",a)):"Success"==t.data.Status&&"3"==t.data.Result?(e.Close(),"fromBillingService"==e.reqFrom||"addBillingService"==e.reqFrom?(e.ShowAlert(e.$t("UpdatedSuccess",[e.$t("BillingCondition")]),"Success",!0,e.$t("Alert")),e.$parent.FetchData()):e.ShowAlert(e.$t("UpdatedSuccess",[e.$t("BillingRule")]),"Success",!0,e.$t("Alert")),e.isLoading=!1,this.$emit("rule-saved",a)):"2"==t.data.Result?"fromBillingService"==e.reqFrom||"addBillingService"==e.reqFrom?this.ShowAlert(this.$t("AlreadyExists",[this.$t("BillingCondition")]),"failure",!0,this.$t("Alert")):this.ShowAlert(this.$t("AlreadyExists",[this.$t("BillingRule")]),"failure",!0,this.$t("Alert")):"fromBillingService"==e.reqFrom||"addBillingService"==e.reqFrom?(e.ShowAlert(e.$t("ErrorWhileSaving",[e.$t("BillingCondition")]),"danger",!0,e.$t("Alert")),e.isLoading=!1):(e.ShowAlert(e.$t("ErrorWhileSaving",[e.$t("BillingRule")]),"danger",!0,e.$t("Alert")),e.isLoading=!1))})},addFieldToCondition(e){if(!e.isGroup&&this.conditionBlocks.length>0&&this.conditionBlocks[0].conditions.length>0){const t=this.conditionBlocks[0].conditions[0];if(t.field){this.addCondition(0);const t=this.conditionBlocks[0].conditions[this.conditionBlocks[0].conditions.length-1];t.field=e.value,t.sqlType=e.sqlType,this.handleFieldChange(t)}else t.field=e.value,t.sqlType=e.sqlType,this.handleFieldChange(t)}},toggleBlockOperator(e){const t=this.conditionBlocks[e];t.operator="AND"===t.operator?"OR":"AND"},toggleJoinOperator(e){const t=this.conditionBlocks[e];t&&(t.joinWithPrevious="AND"===t.joinWithPrevious?"OR":"AND")},removeBlock(e){this.conditionBlocks.length>1&&this.conditionBlocks.splice(e,1)},addCondition(e){const t=this.conditionBlocks[e];t.conditions.push({field:"",operator:"",value:"",valueTo:"",daysOfWeek:"",operatorList:[],valueOptions:[],sqlType:""})},removeCondition(e,t,o){o.preventDefault(),this.conditionBlocks[e].conditions.splice(t,1)},addBlock(){this.conditionBlocks.push({operator:"AND",joinWithPrevious:"OR",conditions:[{field:"",operator:"",value:"",valueTo:"",daysOfWeek:"",operatorList:[],valueOptions:[],sqlType:""}]})},syncConditionBlocks(){if(!(this.form.conditions&&this.form.conditions.length>0))return;const e=[];let t=null,o="";const i=()=>{if(t&&t.conditions.length>0){const o=(t._relations||[]).filter(e=>e&&""!==e.trim()).map(e=>e.toUpperCase());o.length>0?t.operator=o[0]:t.operator=t.operator||"AND",delete t._relations,e.push(t)}};this.form.conditions.forEach((a,s)=>{const l=(a.openingBracket||"").toString(),r=(a.closingBracket||"").toString(),n=(a.relation||"").toString().toUpperCase(),d=l.includes("("),c=r.includes(")");!d&&t||(i(),t={operator:"AND",joinWithPrevious:e.length>0?o||"OR":"",conditions:[],_relations:[]},o=n||o),t.conditions.push({field:a.field||"",operator:a.operator||"",value:a.value,valueTo:a.valueTo,daysOfWeek:a.daysOfWeek||"",operatorList:a.operatorList||[],valueOptions:a.valueOptions||[],sqlType:a.sqlType||""}),t.conditions.length>1&&t._relations.push(n),c&&(t.joinWithPrevious=e.length>0?o||"OR":"",o="",i(),t=null)}),i(),0===e.length?this.conditionBlocks=[{operator:"AND",joinWithPrevious:"",conditions:this.form.conditions.map(e=>({field:e.field||"",operator:e.operator||"",value:e.value,valueTo:e.valueTo,daysOfWeek:e.daysOfWeek||"",operatorList:e.operatorList||[],valueOptions:e.valueOptions||[],sqlType:e.sqlType||""}))}]:this.conditionBlocks=e},CreateClone:function(){var e=this,t=e.$refs.validateClone.getPropertyValue("ServiceName","value"),o=e.conditionId,i=`serviceId=${o}&serviceName=${t}`;s["a"].CloneBillingService(i).then(t=>{"Success"==t.data.status?(this.ShowAlert(this.$t("AddedSuccess",[this.$t("Service")]),"Success",!0,this.$t("Alert")),e.$refs.validateClone.updateProperty("ServiceName","value",""),e.CloseCloneModel(),e.CloseRuleModel()):this.ShowAlert(this.$t("ErrorWhileSaving",[this.$t("Service")]),"danger",!0,this.$t("Alert"))})},syncFormConditions(){this.form.conditions=[],this.conditionBlocks.forEach((e,t)=>{e.conditions.forEach((o,i)=>{const a=(o.operatorList||[]).find(e=>e.OPERATOR_ID===o.operator),s=a?a.OPERATOR_DISPLAY_NAME:o.operator,l=null===s||void 0===s?void 0:s.toLowerCase();"is empty"===l||"is not empty"===l?o.field&&o.operator&&this.form.conditions.push({relation:i>0?e.operator:t>0?e.joinWithPrevious||"OR":"",openingBracket:0===t&&0===i?"(":"",field:o.field,operator:o.operator,value:o.value,valueTo:o.valueTo||"",daysOfWeek:o.daysOfWeek||"",closingBracket:i===e.conditions.length-1?")":"",operatorList:o.operatorList||[],valueOptions:o.valueOptions||[],sqlType:o.sqlType||""}):o.field&&o.operator&&""!==o.value&&null!==o.value&&void 0!==o.value&&this.form.conditions.push({relation:i>0?e.operator:t>0?e.joinWithPrevious||"OR":"",openingBracket:0===t&&0===i?"(":"",field:o.field,operator:o.operator,value:o.value,valueTo:o.valueTo||"",daysOfWeek:o.daysOfWeek||"",closingBracket:i===e.conditions.length-1?")":"",operatorList:o.operatorList||[],valueOptions:o.valueOptions||[],sqlType:o.sqlType||""})})})}}},n=r,d=o("0c7c"),c=Object(d["a"])(n,i,a,!1,null,null,null);t["a"]=c.exports},df75:function(e,t,o){"use strict";var i=o("ca84"),a=o("7839");e.exports=Object.keys||function(e){return i(e,a)}},ea98:function(e,t,o){"use strict";var i=o("23e7"),a=o("e330"),s=o("1d80"),l=o("5926"),r=o("577e"),n=o("d039"),d=a("".charAt),c=n((function(){return"\ud842"!=="𠮷".at(-2)}));i({target:"String",proto:!0,forced:c},{at:function(e){var t=r(s(this)),o=t.length,i=l(e),a=i>=0?i:o+i;return a<0||a>=o?void 0:d(t,a)}})}}]);
//# sourceMappingURL=chunk-a7377e46.js.map