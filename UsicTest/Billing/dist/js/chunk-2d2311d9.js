(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d2311d9"],{eebe:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",[a("tg-list",{attrs:{IsShowAction:!0,showCheckBox:!1,ModuleName:"Billing",listType:["List"],RenderRowActionMethod:t.invoiceLogRenderActions,SubModuleCode:"Billing",IdentityColumn:"id",HeaderText:t.$t("billinglog"),ListData:t.LogListing,HeaderData:t.Headers,PageSize:t.pageSize,callbackfunction:t.FetchData,HeaderButtons:t.listheaderbuttons,TotalRecords:t.TotalRecords,SearchFields:t.leftSearchFields,ListDataCallBackFunction:t.FetchData,LegendArray:[],SortExp:t.sortExp,SortBy:t.sortBy,NorecordfoundText:t.$t("NoRecordfound")},on:{LeftsearchButtonClick:t.leftCommonSearch,ActionButtonClick:t.invoiceLogActionButtonClick,PagerButtonClick:t.pagerMethod,HeaderButtonClick:t.commonHeaderButtonClick,SortdataButtonClick:t.sortdata},scopedSlots:t._u([{key:"slotdata",fn:function(e){var i=e.data;return["created_at"==i.column.COLUMN_NAME?[a("span",[t._v(" "+t._s(t.$options.filters.formatDateTime(i.row.created_at))+" ")])]:t._e(),"status_message"==i.column.COLUMN_NAME?["GENERATED"==i.row.status_code?a("span",{staticClass:"dynamicstatus text-primary px-2 py-1"},[t._v(" "+t._s(i.row.status_message)+" ")]):"BILL_ALREADY_EXISTS"==i.row.status_code?a("span",{staticClass:"dynamicstatus text-danger px-2 py-1"},[t._v(" "+t._s(i.row.status_message)+" ")]):a("span",{staticClass:"dynamicstatus px-2 py-1"},[t._v(" "+t._s(i.row.status_message)+" ")])]:t._e()]}}])})],1)},o=[],n=(a("14d9"),a("88a7"),a("271a"),a("5494"),a("9769"));let s=[{title:"Download",iconClass:"fa fa-download",callbackfunction:"Download",additionalClass:"",isdisabled:!1,isvisible:!0,checkPrivilege:!1}],l=[{fieldName:"PLANS",fieldType:"ddl-check",fieldIcon:"fa fa-tasks",paramName:"TM.plan_id",fieldSearchConditionName:["TM.plan_id"],isSearch:!1,value:"",listOptions:[]},{fieldName:"BATCH NAME",fieldType:"ddl-check",fieldIcon:"fa fa-user",paramName:"tbpl.batch_id",fieldSearchConditionName:["tbpl.batch_id"],isSearch:!1,value:"",listOptions:[]},{fieldName:"CLIENT",fieldType:"ddl-check",fieldIcon:"fa fa-file",paramName:"TM.client_id",fieldSearchConditionName:["TM.client_id"],isSearch:!1,value:"",listOptions:[]},{fieldName:"ACCOUNT NO",fieldType:"text",fieldIcon:"fa fa-envelope",paramName:"tcc.crm_account_no",fieldSearchConditionName:["tcc.crm_account_no"],isSearch:!1,value:"",listOptions:[]},{fieldName:"METER NO",fieldType:"text",fieldIcon:"fa-user",paramName:"tacr.related_info_id",fieldSearchConditionName:["tacr.related_info_id"],isSearch:!1,value:"",listOptions:[]},{fieldName:"FROM Date",fieldType:"date",fieldIcon:"fa fa-calendar",fieldSearchConditionName:["TM.billing_from"],isSearch:!1,datePickerConfig:{useCurrent:!1,showClear:!0,showClose:!0,allowInputToggle:!0,widgetPositioning:{horizontal:"right",vertical:"bottom"}},value:"",listOptions:[]},{fieldName:"TO Date",fieldType:"date",fieldIcon:"fa fa-calendar",fieldSearchConditionName:["TM.billing_to"],isSearch:!1,datePickerConfig:{useCurrent:!1,showClear:!0,showClose:!0,allowInputToggle:!0,widgetPositioning:{horizontal:"right",vertical:"bottom"}},value:"",listOptions:[]}];async function r(t,e,a,i){var o=t;if("PLANS"==a){var s=`id=&moduleName=&type=${a}&search=&refId=`;await n["a"].GetDDLData(s).then(t=>{""!=t.data&&t.data.DATA.length&&t.data.DATA.forEach(t=>{let e={name:t.name,value:t.value};o.leftSearchFields[0].listOptions.push(e)})})}else if("CLIENTS"==a){s=`id=&moduleName=&type=${a}&search=&refId=`;await n["a"].GetDDLData(s).then(t=>{""!=t.data&&t.data.DATA.length&&t.data.DATA.forEach(t=>{let e={name:t.name,value:t.value};o.leftSearchFields[2].listOptions.push(e)})})}else if("BATCH_LIST"==a){s=`id=&moduleName=&type=${a}&search=&refId=${i}`;await n["a"].GetDDLData(s).then(t=>{""!=t.data&&t.data.DATA.length&&t.data.DATA.forEach(t=>{let e={name:t.name,value:t.value};o.leftSearchFields[1].listOptions.push(e)})})}}var c={leftsearchSchema:l,buttons:s,bindleftCommonSearchdropdown:r};const d="http://stagespa.talygen.com";var u={data(){return{Headers:[{COLUMN_NAME:"ROWNUMBER",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("srno"),DISPLAY_ORDER:1},{COLUMN_NAME:"bill_id",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("billid"),DISPLAY_ORDER:2},{COLUMN_NAME:"plan_name",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this$t("Plan"),DISPLAY_ORDER:3},{COLUMN_NAME:"batch_name",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("batchname"),DISPLAY_ORDER:4},{COLUMN_NAME:"client_name",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:this.$t("ClientName"),DISPLAY_ORDER:5},{COLUMN_NAME:"account_no",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:this.$t("AccountNo"),DISPLAY_ORDER:6},{COLUMN_NAME:"meter_name",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:this.$t("MeterName"),DISPLAY_ORDER:7},{COLUMN_NAME:"meter_no",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:this.$t("mitterno"),DISPLAY_ORDER:8},{COLUMN_NAME:"request_from",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("RequestFrom"),DISPLAY_ORDER:9},{COLUMN_NAME:"request_to",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("RequestTo"),DISPLAY_ORDER:10},{COLUMN_NAME:"created_at",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("CreatedDate"),DISPLAY_ORDER:11},{COLUMN_NAME:"created_by",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("CreatedBy"),DISPLAY_ORDER:12},{COLUMN_NAME:"status_message",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("Status"),DISPLAY_ORDER:13}],listActions:[{title:"Print Bill",href:"javascript:void(0)",icon:"fa fa-print text-info",callbackfunction:"PrintBill",additionalSpan:""}],listheaderbuttons:c.buttons,leftSearchFields:c.leftsearchSchema,list:[],TotalRecords:0,pageSize:100,pageNum:1,sortBy:"",searchCondition:"",GroupStart:1,GroupEnd:3,PlanId:0,CurrentPage:1,TotalPages:0,sortExp:"",LogListing:[],noRecords:!1,requestId:""}},created:async function(){var t=this;t.requestId=t.$route.params.requestId,await c.bindleftCommonSearchdropdown(this,"Billing","CLIENTS",null),await c.bindleftCommonSearchdropdown(this,"Billing","PLANS",null),t.leftSearchFields[0].onChange=t.getClickEvent,await t.FetchData()},methods:{getClickEvent:async function(){var t=this.leftSearchFields[0].value;await c.bindleftCommonSearchdropdown(this,"Billing","BATCH_LIST",t)},invoiceLogActionButtonClick(t,e,a,i){switch(t){case"PrintBill":this.openPopupForPrintBill(e);break}},openPopupForPrintBill(t){const e=`${d}/ClientBill/Draft?billId=${t.bill_id}&templateId=${t.template_id}&requestFrom=Yes`;window.open(e,"_blank")},invoiceLogRenderActions:function(t){var e=this;let a=[];return e.listActions.forEach(e=>{let i={...e};switch(i.title){case"Print Bill":i.isVisible=null!=t.bill_id;break}a.push(i)}),a},FetchData:async function(){var t=this;t.LogListing=[];var e=`search=${t.searchCondition}&requestId=${t.requestId}&pageSize=${t.pageSize}&pageNum=${t.pageNum}&sortBy=${t.sortBy}&sortExp=${t.sortExp}`;const a=JSON.stringify(e);var i={objData:a};await n["a"].GetInvoiceLogListing(i).then((function(e){t.Headers.forEach(t=>{t.settings=null,"created_at"==t.COLUMN_NAME&&(t.settings={isInSlot:!0}),"status_message"==t.COLUMN_NAME&&(t.settings={isInSlot:!0})}),""!=e.data&&null!=e.data&&e.data.result.data.length>0?(t.LogListing=e.data.result.data,t.TotalRecords=e.data.result.data[0].TOTALRECORDS,t.TotalPages=Math.ceil(t.TotalRecords/t.pageSize),t.CurrentPage=t.pageNum,t.noRecord=!1):(t.noRecord=!0,t.TotalRecords=0,t.LogListing=[])}))},leftCommonSearch(t){this.pageNum=t.PageNumber,this.isPaged=1,"undefined"!=typeof t.searchCondition?this.searchCondition=t.searchCondition:this.searchCondition="",this.FetchData()},pagerMethod(t){this.pageSize=t.PageSize,this.pageNum=t.PageNumber,this.FetchData()},commonHeaderButtonClick(t){switch(t.callbackfunction){case"Download":this.Download();break}},Download:async function(){var t=this,e=`search=${t.searchCondition}&requestId=${t.requestId}&pageSize=${t.TotalRecords}&pageNum=${t.pageNum}&sortBy=${t.sortBy}&sortExp=${t.sortExp}`;const a=JSON.stringify(e);var i={objData:a};await n["a"].GetInvoiceLogListing(i).then((function(e){""!=e.data&&null!=e.data&&e.data.result.data.length>0&&t.ConvertJSONToCSV(e.data.result.data,"InvoiceLog",!0)}))},ConvertJSONToCSV:function(t,e,a){const i=["template_id","status_id","TOTALRECORDS","batch_id","id"],o={ROWNUMBER:"Sr No",bill_id:"Bill Id",batch_name:"Batch Name",client_name:"Client Name",plan_name:"Plan Name",account_no:"Account No",meter_name:"Meter Name",meter_no:"Meter No",request_from:"Request From",request_to:"Request To",created_at:"Created At",created_by:"Created By",status_code:"Status Code",status_message:"Status Message"};if(t&&Array.isArray(t)&&t.length>0){const n=Object.keys(t[0]),s=n.filter(t=>!i.includes(t)),l=s.map(t=>o[t]||t),r=t.map(t=>l.map(e=>{const a=s[l.indexOf(e)];let i=void 0!==t[a]&&null!==t[a]?String(t[a]):"";return(i.includes(",")||i.includes("\n")||i.includes('"'))&&(i=`"${i.replace(/"/g,'""')}"`),i}).join(",")),c=(a?[l.join(",")]:[]).concat(r).join("\n"),d=new Blob([c],{type:"text/csv;charset=utf-8;"}),u=document.createElement("a");u.setAttribute("href",URL.createObjectURL(d)),u.setAttribute("download",e+".csv"),u.click()}else console.log("No valid data to convert.")},getStatusClass:function(t){var e="";switch(t){case"Active":e="px-2 text-center bg-success text-white d-block";break;case"Inactive":e="px-2 text-center bg-danger text-white d-block";break;default:e=""}return e},sortdata:function(t){this.sortBy=t;var e="ASC";"ASC"==this.sortExp&&(e="DESC"),this.sortExp=e,this.sortBy=t,this.sortExp=e,this.pageNum=1,this.GroupStart=this.pageNum,this.GroupEnd=this.pageNum+2,this.FetchData()}}},h=u,A=a("0c7c"),_=Object(A["a"])(h,i,o,!1,null,null,null);e["default"]=_.exports}}]);
//# sourceMappingURL=chunk-2d2311d9.js.map