(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3464d8e4"],{"384d":function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("section",[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"col-12 p-4 border mt-2 float-left w-100",domProps:{innerHTML:t._s(t.parsedHtml)}}),e("div",{staticClass:"search-btm-btn text-right mt-4"},[e("a",{staticClass:"btn btn-success mr-2",attrs:{href:"javascript:;",title:""},on:{click:t.printInvoice}},[e("i",{staticClass:"fa fa-print pr-2"}),t._v(t._s(t.$t("Print")))]),e("a",{staticClass:"btn btn-info mr-2",attrs:{href:"javascript:;",title:""},on:{click:t.downloadInvoice}},[e("i",{staticClass:"fa fa-download pr-2"}),t._v(t._s(t.$t("DownloadInvoice")))]),"SubscriptionList"!=t.hitFrom?e("a",{staticClass:"btn btn-danger",attrs:{href:"javascript:;",title:""},on:{click:function(e){return t.InvoicebacktoPlanDetails()}}},[e("i",{staticClass:"fa fa-cancel pr-2"}),t._v(t._s(t.$t("BacktoList")))]):t._e()])],1)},n=[],s=(a("d9e2"),a("14d9"),a("8baf")),o=a("62c5"),l=a.n(o),r=a("1321"),d=a.n(r),c=a("9769"),m={components:{VueApexCharts:d.a},props:{Details:{type:Array,required:!0},hitFrom:{type:String,required:!0}},data(){return{invoiceTemplate:"",isLoading:!1,imagepath:"",accountNumber:"",series:[{data:[400,430,448,470,540,580,690,1100,1200,1380]}],chartOptions:{chart:{type:"bar",height:250,toolbar:{show:!1}},plotOptions:{bar:{borderRadius:4,borderRadiusApplication:"end",horizontal:!1}},dataLabels:{enabled:!1},xaxis:{categories:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct"]},yaxis:{title:{text:"Average Kwh/day"}}}}},mounted(){this.generateBarcode(),this.renderChart()},computed:{parsedHtml(){let t=this;return t.isLoading=!0,t.invoiceTemplate?t.invoiceTemplate.replace(/\{\{(.*?)\}\}/g,(e,a)=>{if(setTimeout(()=>{this.isLoading=!1},1e3),t.accountNumber=this.Details[0].accountnumber,"items"==a.trim()){console.log("items match found",e);let t=this.Details[0]["itemlist"],a="";if(null!=t){t.forEach((function(t){a+="<tr><td>"+t.productname+"</td><td style='text-align:center;'>"+t.consumption+"</td><td>"+t.slabrate+"</td><td>"+t.TotalBillingDays+"</td><td>"+t.PF+"</td><td>"+t.totalamount+"</td></tr>"}));const i=a;return void 0!==i?i:e}return""}if("itemsutilitybilling"==a.trim()){let t=this.Details[0]["itemlist"],a="";if(null!=t){t.forEach((function(t){a+="<tr><td>"+t.productname+"</td><td style='text-align:center;'>"+t.consumption+"</td><td>"+t.slabrate+"</td><td>"+t.totalamount+"</td></tr>"}));const i=a;return void 0!==i?i:e}return""}if("ItemBillingService"==a.trim()){let t=this.Details[0]["BillServiceData"],a="";if(null!=t){t.forEach((function(t){a+="<tr><td style='vertical-align: top; font-size: 13px; line-height: 18px;'>"+t.productname+"</td><td style='vertical-align: top; font-size: 13px; line-height: 18px; text-align: right; '>"+t.consumption+"</td><td style='vertical-align: top; font-size: 13px; line-height: 18px; text-align: right; '>"+t.slabrate+"</td><td style='vertical-align: top; font-size: 13px; line-height: 18px; text-align: right; '>"+t.totalamount+"</td></tr>"}));const i=a;return void 0!==i?i:e}return""}if("ItemBillingSubsidy"==a.trim()){let t=this.Details[0]["BillSubsidyData"],a="";if(null!=t){t.forEach((function(t){a+="<tr><td style='vertical-align: top; font-size: 13px; line-height: 18px;'>"+t.productname+"</td><td style='vertical-align: top; font-size: 13px; line-height: 18px; text-align: right;'>"+t.consumption+"</td><td style='vertical-align: top; font-size: 13px; line-height: 18px; text-align: right; '>"+t.slabrate+"</td><td style='vertical-align: top; font-size: 13px; line-height: 18px; text-align: right;'>"+t.totalamount+"</td></tr>"}));const i=a;return void 0!==i?i:e}return""}if("ItemBillingTax"==a.trim()){let t=this.Details[0]["BillTaxData"],a="";if(null!=t){t.forEach((function(t){a+="<tr><td style='vertical-align: top; font-size: 13px; line-height: 18px;'>"+t.adjustment_name+" ("+t.adjustment_percentage+")</td><td style='vertical-align: top; font-size: 13px; line-height: 18px; text-align: right;'></td><td style='vertical-align: top; font-size: 13px; line-height: 18px; text-align: right;'></td><td style='vertical-align: top; font-size: 13px; line-height: 18px; text-align: right;'>"+t.adjustment_amount+"</td></tr>"}));const i=a;return void 0!==i?i:e}return""}if("ItemLastPayment"==a.trim()){let t=this.Details[0]["SomeLastPayment"],a="";if(null!=t){t.forEach((function(t){a+="<tr><td style='vertical-align: top; font-size: 13px; line-height: 18px;'>"+t.bill_number+"</td><td style='vertical-align: top; font-size: 13px; line-height: 18px;'>"+t.payment_date+"</td><td style='vertical-align: top; font-size: 13px; line-height: 18px; text-align: right;'>"+t.Transaction_Reference_Number+"</td><td style='vertical-align: top; font-size: 13px; line-height: 18px; text-align: right;'>"+t.paymentamount+"</td></tr>"}));const i=a;return void 0!==i?i:e}return""}if("currentchargesitems"==a.trim()){let t=this.Details[0]["itemlist"];if(null!=t){let a="<div class='payment-advice'><table width='100%' border='0' cellpadding='0' cellspacing='0'><tbody>  ";t.forEach((function(t){a+="<tr><td style='padding:5px;'>"+t.productname+"</td><td style='text-align:right;'>"+t.totalamount+"</td></tr>"})),a+=" </tbody></table></div>";const i=a;return void 0!==i?i:e}return""}if("currentchargesGSTitems"==a.trim()){let t=this.Details[0]["GSTitemlist"];if(null!=t){let a=" ";t.forEach((function(t){a+="<td style='padding:10px 10px 0px 10px;font-size: 0.9em;font-weight:600;border:none;'>"+t.productname+"</td><td style='text-align:right;font-size:0.9em;font-weight:600;padding:10px 5px 0px 10px;border:none;'>"+t.totalamount+"</td>"}));const i=a;return void 0!==i?i:e}return""}if("currentTaxItems"==a.trim()){let t=this.Details[0]["GSTitemlist"];if(null!=t){let a=" ";t.forEach((function(t){a+="<td style='padding:10px 10px 0px 10px;font-size: 0.9em;font-weight:600;border:none;'>"+t.productname+"</td><td style='text-align:right;font-size:0.9em;font-weight:600;padding:10px 5px 0px 10px;border:none;'>"+t.totalamount+"</td>"}));const i=a;return void 0!==i?i:e}return""}if("currentchargesDiscountitems"==a.trim()){let t=this.Details[0]["Discountitemlist"];if(null!=t){let a=" ";t.forEach((function(t){a+="<td style='padding:10px 10px 0px 10px;font-size: 0.9em;font-weight:600;border:none; '>"+t.productname+"</td><td style='text-align:right;font-size: 0.9em;font-weight:600;padding:10px 5px 0px 10px;border:none;'>"+t.totalamount+"</td>"}));const i=a;return void 0!==i?i:e}return""}if("currentDiscountItems"==a.trim()){let t=this.Details[0]["Discountitemlist"];if(null!=t){let a=" ";t.forEach((function(t){a+="<td style='padding:10px 10px 0px 10px;font-size: 0.9em;font-weight:600;border:none; '>"+t.productname+"</td><td style='text-align:right;font-size: 0.9em;font-weight:600;padding:10px 5px 0px 10px;border:none;'>"+t.totalamount+"</td>"}));const i=a;return void 0!==i?i:e}return""}if("discountItems"==a.trim()){let t=this.Details[0]["discountitemlist"];if(null!=t){let a=" ";t.forEach((function(t){a+="<table width='100%'><tr><td style='padding:10px 10px 0px 10px;font-size: 0.9em;font-weight:600;border:none; '>"+t.productname+"</td><td style='width:200px; text-align:right;font-size: 0.9em;font-weight:400;padding:10px 5px 0px 10px;border:none;'>"+t.slabrate+"</td></tr></table>"}));const i=a;return void 0!==i?i:e}return""}if("taxItems"==a.trim()){let t=this.Details[0]["taxItems"];if(null!=t){let a=" ";t.forEach((function(t){a+="<table width='100%'><tr><td style='padding:10px 10px 0px 10px;font-size: 0.9em;font-weight:600;border:none; '>"+t.productname+"</td><td style='width:200px; text-align:right;font-size: 0.9em;font-weight:400;padding:10px 5px 0px 10px;border:none;'>"+t.slabrate+"</td></tr></table>"}));const i=a;return void 0!==i?i:e}return""}if("chart"===a.trim())return"<div id='invoiceChart'></div>";if("barcode"==a.trim()){let t="";t+="<svg id='accountNoBarCode'></svg>";const a=t;return void 0!==a?a:e}if("totalitemamount"==a.trim()){var i;const t=null===(i=this.Details[0]["totalitemsamount"])||void 0===i?void 0:i[0];if(t){const e=t[a.trim()];return void 0!==e&&null!==e?e:""}}else if("totalAmountAfterGST"==a.trim()){var n;const t=null===(n=this.Details[0]["totalAmountsAfterGST"])||void 0===n?void 0:n[0];if(t){const e=t[a.trim()];return void 0!==e&&null!==e?e:""}}else if("totalAmountAfterDiscount"==a.trim()){var s;const t=null===(s=this.Details[0]["totalAmountsAfterDiscount"])||void 0===s?void 0:s[0];if(t){const e=t[a.trim()];return void 0!==e&&null!==e?e:""}}else{if("slabs"==a.trim()){let t=this.Details[0]["slabdetails"],a="";if(null!=t){t.forEach((function(t){a+="<tr><td>"+t.srno+"</td><td>"+t.slabes+"</td><td>"+t.slabrate+"</td></tr>"}));const i=a;return void 0!==i?i:e}return" <tr><td> No Records Found  </td></tr>  "}if("paymenthistory"==a.trim()){let t=this.Details[0]["paymenthistory"],a="";if(null!=t){t.forEach((function(t){a+="<tr><td>"+t.paymentdate+"</td><td style='text-align: right;'>"+t.consumption+"</td><td style='text-align: right;'>"+t.nettotal+"</td><td style='text-align: right;'>"+t.amountdue+"</td><td style='text-align: right;'>"+t.paymentamount+"</td></tr>"}));const i=a;return void 0!==i?i:e}return" <tr><td colspan='5' align='center' style='color:#ad0101; text-align:center;'> No Records Found  </td></tr>  "}if("servicedetails"==a.trim()){let t=this.Details[0]["servicedetails"],a="";if(null!=t){t.forEach((function(t){a+="<tr><td>"+t.ServiceName+"</td><td style='text-align: right;'>"+t.Rate+"</td></tr>"}));const i=a;return void 0!==i?i:e}}else if("GST_Adjustment"==a.trim()){let t=this.Details[0]["adjustments"],a="";if(null!=t){t.forEach((function(t){a+="<tr><td>"+t.adjustment_name+" :</td><td style='text-align: right;'>"+t.adjustment_amount+"</td></td></tr>"}));const i=a;return void 0!==i?i:e}}else if("slab_Unit"==a.trim()){let t=this.Details[0]["slabdatadetails"],a="";if(null!=t){t.forEach((function(t){a+=t.slabrate}));const i=a;return void 0!==i?i:e}}else{if("transaction_history"==a.trim()){let t=this.Details[0]["transaction_history"],a="";if(null!=t){t.forEach((function(t){a+=`<tr> <td bgcolor="#fff" align="left" valign="top" style="vertical-align: top; color: #000; font-family: Arial, Helvetica, sans-serif; font-size: 0.9em;text-align:left;width:150px"> ${t.paymentdate}</td>\n                <td bgcolor="#fff" align="left" valign="top" style="vertical-align: top; color: #000; font-family: Arial, Helvetica, sans-serif; font-size: 0.9em;text-align:left;width:150px">${t.paymentamount}</td>\n                <td bgcolor="#fff" align="left" valign="top" style="vertical-align: top; color: #000; font-family: Arial, Helvetica, sans-serif; font-size: 0.9em;text-align:left;width:150px">${t.status}</td>\n              </tr>`}));const i=a;return void 0!==i?i:e}return" <tr><td colspan='5' align='center' style='color:#ad0101; text-align:center;'> No Records Found  </td></tr>  "}if("transaction_data"==a.trim()){let t=this.Details[0]["transaction_data"],a="";if(null!=t){t.forEach((function(t){a+=`<tr> <td bgcolor="#fff" align="left" valign="top" style="vertical-align: top; color: #000; font-family: Arial, Helvetica, sans-serif; font-size: 0.9em;text-align:left;width:150px"> ${t.paymentdate}</td>\n                <td bgcolor="#fff" align="left" valign="top" style="vertical-align: top; color: #000; font-family: Arial, Helvetica, sans-serif; font-size: 0.9em;text-align:left;width:150px">${t.billnumber}</td>\n                <td bgcolor="#fff" align="left" valign="top" style="vertical-align: top; color: #000; font-family: Arial, Helvetica, sans-serif; font-size: 0.9em;text-align:left;width:150px">${t.paymentamount}</td>\n              </tr>`}));const i=a;return void 0!==i?i:e}return" <tr><td colspan='5' align='center' style='color:#ad0101; text-align:center;'> No Records Found  </td></tr>  "}if("adjustments"!=a.trim()){if(["meterno","currentreading","previousreading","difference","readingdate","billdays","multiplyfactor","consumption","billedunit","sanctionedload","meterreadingstartdate","meterreadingenddate","readingdifference","metertype","meterrate","statuscode","Energisation_Date"].includes(a.trim())){var o;const t=null===(o=this.Details[0]["meterreading"])||void 0===o?void 0:o[0];if(console.log("First meter reading:",t),null!=t){const e=t[a.trim()];return void 0!==e&&null!==e?e:""}return""}if(["lastbillamount","paymentamount","additional_activity","balancebeforenewcharges","newcharges","newchargesdueby","amount_of_last_bill","payment_received","balance_before_new_charges","DueAmountNew","payment_date"].includes(a.trim())){var l;const t=null===(l=this.Details[0]["lastpaymentdetails"])||void 0===l?void 0:l[0];if(null!=t){const e=t[a.trim()];return void 0!==e&&null!==e?e:""}return""}if(["month_names","monthly_consumption","monthly_cost","year","next_year"].includes(a.trim())){var r;const t=null===(r=this.Details[0]["chartdetails"])||void 0===r?void 0:r[0];if(null!=t){const e=t[a.trim()];return void 0!==e&&null!==e?e:""}return""}if(["current_year_consumption","last_year_consumption","current_year_service_days","last_year_service_days","current_year_per_day_consumption","last_year_per_day_consumption","current_year_per_day_cost","last_year_per_day_cost","current_year","last_year"].includes(a.trim())){var d;const t=null===(d=this.Details[0]["meterreadingdetails"])||void 0===d?void 0:d[0];if(null!=t){const e=t[a.trim()];return void 0!==e&&null!==e?e:""}return""}if(["paymentamount","amountdue","nettotal","allamountdue","totalbalance","balencebeforenewchrge","totaldueafterall","RemainingDue"].includes(a.trim())){var c;const t=null===(c=this.Details[0]["PaymentDetails"])||void 0===c?void 0:c[0];if(null!=t){const e=t[a.trim()];return void 0!==e&&null!==e?e:""}return""}if("paymentterms"==a.trim()){let t=this.Details[0]["paymentterms"],a=this.Details[0]["symbol"];if(t&&Array.isArray(t)){let i="<div class='payment-advice'><h4 style='border-top: 1px #ccc dashed; padding: 20px 0 0 0;''>Payment Terms</h3> <table width='100%'><thead><tr><th style='text-align:center;'>Description</th><th style='text-align:center;'>Due Date</th><th style='text-align:right;'>Amount ("+a+" )</th></tr></thead><tbody>  ";t.forEach((function(t){i+="<tr><td style='text-align:center;'> "+t.note+"</td><td style='text-align:center;'>"+t.due_date+"</td><td>"+t.due_amount+"</td></tr>"})),i+=" </tbody></table></div>";const n=i;return void 0!==n?n:e}return console.log("No payment terms available"),""}if("itemspostpaid"==a.trim()){console.log("item match found",e);let t=this.Details[0]["itemlist"],a="";if(null!=t){t.forEach((function(t){a+="<tr><td>"+t.productname+"</td><td>"+t.consumption+"</td><td>"+t.slabrate+"</td></tr>"}));const i=a;return void 0!==i?i:e}return""}if("discounttaxadjustments"==a.trim()){let t=this.Details[0]["adjustments"],a="",i="";if(null!=t){t.forEach((function(t){i=1==t.adjustment_operation?"tax":"discount",a+="<table width='100%'><tr><td style='padding:0px;font-size: 14px;border:none; '>"+t.adjustment_name+"</td><td style='width:80px; text-align:right;font-size: 14px;font-weight:400;padding:0px;border:none;'>"+t.adjustment_amount+"</td></tr></table>"}));const n=a;return void 0!==n?n:e}return""}{const t=this.Details[0][a.trim()];return void 0!==t?t:e}}{let t=this.Details[0]["adjustments"],a="";if(null!=t){t.forEach((function(t){a+="<tr><td colspan='3' style='text-align: right; vertical-align: middle; font-size: 0.9em; font-weight: bold; font-family: Arial, Helvetica, sans-serif;'>"+t.adjustment_name+" :</td><td style='padding-right: 10px; text-align: right; vertical-align: middle; font-size: 0.9em; width: 173px; font-family: Arial, Helvetica, sans-serif;'>"+t.adjustment_amount+"</td></td></tr>"}));const i=a;return void 0!==i?i:e}}}}t.isLoading=!1}):(t.isLoading=!1,"<p>Template not available</p>")}},created(){console.log("this.Details",this.Details),console.log("meter reading",this.Details[0]["items"]),console.log("amountNo",this.Details.accountnumber),this.Details.length>0&&this.Details[0].invoice_template[0]&&(this.invoiceTemplate=this.Details[0].invoice_template[0].template_content,this.imagepath=this.Details.company_logo,this.generateBarcode())},methods:{formatAmount(t){return new Intl.NumberFormat("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t)},generateBarcode(){this.accountNumber&&l()("#accountNoBarCode",this.accountNumber,{format:"code39",height:30,width:2,displayValue:!1})},async printInvoice(){const t=document.getElementById("accountNoBarCode"),e=(document.querySelectorAll("img"),"");if(null!=t){(new XMLSerializer).serializeToString(t)}const a=document.createElement("canvas"),i=a.getContext("2d"),n=new Image;a.width=n.width,a.height=n.height,i.drawImage(n,0,0);let s="";const o=this.parsedHtml.match(/<img[^>]*src=["']([^"']+)["'][^>]*>/i);if(o){const t=o[1];t&&(s=await this.ConvertLogoBase64(t))}let l="";l=null!=t?this.parsedHtml.replace(/<svg.*?<\/svg>/s,`<img src="${e}" style="max-width: 100%;" />`).replace(/<img id="invoiceLogo".*?>/s,`<img src="${s}" style="max-width: 150px;" />`):this.parsedHtml.replace(/<img id="invoiceLogo".*?>/s,`<img src="${s}" style="max-width: 150px;" />`);const r=document.createElement("iframe");r.style.position="absolute",r.style.width="0",r.style.height="0",r.style.border="none",document.body.appendChild(r);const d=r.contentDocument||r.contentWindow.document;d.open(),d.write(`\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <title>Invoice</title>\n          <style>\n            body { font-family: Arial, sans-serif; margin: 20px; }\n            table { width: 100%; border-collapse: collapse; margin-top: 20px; }\n            th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }\n            img { display: block; margin-bottom: 10px; }\n          </style>\n        </head>\n        <body>\n          ${l}\n        </body>\n      </html>\n    `),d.close(),r.contentWindow.focus(),r.contentWindow.print(),setTimeout(()=>document.body.removeChild(r),500),n.src=svgUrl},printInvoiceOld(){const t=document.createElement("iframe");t.style.position="absolute",t.style.width="0",t.style.height="0",t.style.border="none",document.body.appendChild(t);const e=t.contentDocument||t.contentWindow.document;e.open(),e.write(`\n          <!DOCTYPE html>\n          <html>\n            <head>\n              <title>Invoice</title>\n              <style>\n                body { font-family: Arial, sans-serif; margin: 20px; }\n                table { width: 100%; border-collapse: collapse; margin-top: 20px; }\n                th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }\n              </style>\n            </head>\n            <body>\n              ${this.parsedHtml}\n            </body>\n          </html>\n        `),e.close();const a=e.getElementById("barcodeImage");a?a.onload=()=>{t.contentWindow.focus(),t.contentWindow.print(),setTimeout(()=>document.body.removeChild(t),1e3)}:(t.contentWindow.focus(),t.contentWindow.print(),setTimeout(()=>document.body.removeChild(t),1e3))},async ConvertLogoBase64(t){try{let e="imageUrl="+encodeURIComponent(t);const a=await c["a"].getConvertBase64(e);if(200===a.status&&a.data&&a.data.base64Image){const t=a.data.base64Image;return t}throw new Error("Invalid Base64 response")}catch(e){return console.error("Error converting logo:",e),this.ShowAlert(this.$t("UnknownErrorOccur"),"failure",!0,this.$t("Alert")),null}},async downloadInvoice(){var t=this;t.isLoading=!0;const e=new s["a"]({unit:"mm",format:"a4"}),a=210,i=297,n=5,o=a-2*n,l=i-2*n,r=document.createElement("div");r.innerHTML=this.parsedHtml,r.style.width=o+"mm",r.style.height="auto",r.style.boxSizing="border-box",r.style.padding="10mm",document.body.appendChild(r);const d=r.offsetWidth,c=r.offsetHeight,m=o/d,u=l/c,f=Math.min(m,u),h=r.querySelectorAll("img");document.body.removeChild(r);for(let s=0;s<h.length;s++){const t=h[s],e=await this.ConvertLogoBase64(t.src);t.src=e}console.log("pdf element : ",r.innerHTML),e.html(r,{x:n,y:n,html2canvas:{scale:f,logging:!0,useCORS:!0},callback:function(e){t.isLoading=!1,e.save("invoice.pdf")}})},downloadInvoice111111(){const t=this;t.isLoading=!0;const e=new s["a"]({unit:"mm",format:"a4"}),a=210,i=297,n=5,o=a-2*n,l=i-2*n,r=document.createElement("div");r.innerHTML=this.parsedHtml,r.style.width=o+"mm",r.style.boxSizing="border-box",r.style.padding="10mm";const d=document.createElement("div");d.innerHTML=this.parsedHtml,d.querySelectorAll("img").forEach(t=>{t.setAttribute("crossorigin","anonymous")}),r.innerHTML=d.innerHTML,document.body.appendChild(r);const c=r.offsetWidth,m=r.offsetHeight,u=o/c,f=l/m,h=Math.min(u,f),p=r.querySelectorAll("img"),v=Array.from(p).map(t=>new Promise(e=>{t.complete?e():(t.onload=()=>e(),t.onerror=()=>e())}));Promise.all(v).then(()=>{setTimeout(()=>{e.html(r,{x:n,y:n,html2canvas:{scale:h,useCORS:!0,logging:!1},callback:function(e){t.isLoading=!1,e.save("invoice.pdf"),document.body.removeChild(r)}})},200)})},InvoicebacktoPlanDetails(){"Plans"==this.hitFrom?this.$emit("backtoPlanDetails"):this.$emit("backtoInvoiceList")},renderChart(){this.$nextTick(()=>{if(document.querySelector("#invoiceChart")&&this.Details.length>0){let e=this.Details[0].BillChartData;try{let t=[],a=[];e.forEach(e=>{void 0!==e.MonthlySales&&(t.push(e.MonthlySales),a.push(e.MonthName))});let i={...this.chartOptions,xaxis:{categories:a},series:[{name:"Monthly Consumption",data:t}]},n=new ApexCharts(document.querySelector("#invoiceChart"),i);n.render()}catch(t){console.error("Error parsing chart data:",t)}}})}}},u=m,f=a("2877"),h=Object(f["a"])(u,i,n,!1,null,null,null);e["a"]=h.exports},"390a":function(t,e,a){var i=a("9a6f");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=a("499e").default;n("4b9afa9f",i,!0,{sourceMap:!1,shadowMode:!1})},"5fb0":function(t,e,a){"use strict";a("cba1")},"66b5":function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h5",{staticClass:"modal-title"},[t._v(t._s(t.$t("History")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[t.InvoiceHistory.length?e("div",[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-6 col-lg-3"},[e("label",[e("b",[t._v(t._s(t.$t("InvoiceNumber"))+":")]),t._v(" "+t._s(t.InvoiceHistory[0].MainInvoiceNumber))])]),e("div",{staticClass:"col-md-6 col-lg-3"},[e("label",[e("b",[t._v(t._s(t.$t("IssueDate"))+":")]),t._v(" "+t._s(t.InvoiceHistory[0].MainInvoiceIssueDate))])]),e("div",{staticClass:"col-md-6 col-lg-3"},[e("label",[e("b",[t._v(t._s(t.$t("DueDate"))+":")]),t._v(" "+t._s(t.InvoiceHistory[0].MainInvoiceDueDate))])]),e("div",{staticClass:"col-md-6 col-lg-3"},[e("label",[e("b",[t._v(t._s(t.$t("Amount"))+":")]),t._v(" "+t._s(t.$n(t.InvoiceHistory[0].MainInvocieNetAmount,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])])]),t.InvoiceHistory[0].InvoiceListingGrid.Count>0?e("div",{staticClass:"listing mt-2"},[e("div",{staticClass:"table-responsive",attrs:{id:"divmemb"}},[e("table",{staticClass:"table table-bordered dt-responsive nowrap mt-0 w-100"},[e("thead",{staticClass:"thead-bg"},[e("tr",[t._m(0),e("th",{staticClass:"td2 tdcm"},[e("span",[t._v("Amount "+t._s(t.GetUserInfo.Currency))])]),t._m(1),t._m(2),t._m(3)])]),t.InvoiceHistory[0].InvoiceListingGrid.Count>0?e("tbody",t._l(t.InvoiceHistory[0].InvoiceListingGrid,(function(a,i){return e("tr",{key:i},[e("td",[t._v(" "+t._s(a.BillNumber)+" ")]),e("td",{staticClass:"tdcm"},[t._v(t._s(a.BillNetTotal.tofixed(2))+" ")]),e("td",{staticClass:"tdcm"},[t._v(" "+t._s(a.IssueDate)+" ")]),e("td",{staticClass:"tdcm"},[t._v(" "+t._s(a.BillDueDate)+" ")]),e("td",{staticClass:"tdcm"},[e("span",{staticClass:"px-2 py-1 text-white text-center",class:t.getStatusClass(a.StatusCode)},[t._v(" "+t._s(a.StatusName)+" ")])])])})),0):e("tbody",[e("tr",[e("td",{staticClass:"text-center text-danger py-3",attrs:{colspan:"5"}},[t._v(" "+t._s(t.$t("NoRecordfound"))+" ")])])])])])]):t._e(),e("div",{staticClass:"listing",attrs:{id:"divPostComment"}},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-12"},[e("ValidationProvider",{ref:"commentValidator",staticClass:"tt_textarea_span position-relative",attrs:{rules:"required",name:"title"},scopedSlots:t._u([{key:"default",fn:function({errors:a}){return[e("label",[t._v("Comment:"),e("span",{staticClass:"mandatory"},[t._v("*")])]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.comment,expression:"comment"}],staticClass:"form-control",class:a[0]?"is-invalid":"",attrs:{name:"title"},domProps:{value:t.comment},on:{keydown:t.textCounter,keyup:t.textCounter,mouseout:t.textCounter,input:function(e){e.target.composing||(t.comment=e.target.value)}}}),t._v(" "),e("span",{staticClass:"invalid-feedback"},[t._v(t._s(a[0]?t.$t("Comment"):""))])]}}],null,!1,414446076)}),e("br"),e("small",[e("strong",[e("span",{staticClass:"alert-warning px-2 mr-2",attrs:{id:"txtCount"}},[t._v(t._s(t.textCountertlength))])]),t._v(" "+t._s(t.$t("CharactersLeft"))+" ")])],1)]),e("div",{staticClass:"row flex-row-reverse"},[e("div",{staticClass:"col-lg-6 text-right"},[e("div",{staticClass:"search-btm-btn"},[e("a",{staticClass:"btn btn-success",attrs:{href:"javascript:;",id:"saveComment",name:"aSave",title:"PostNewComment"},on:{click:t.SaveComment}},[e("i",{staticClass:"fa fa-save pr-2"}),t._v(t._s(t.$t("PostNewComment")))]),e("a",{staticClass:"btn btn-danger ml-2",attrs:{href:"javascript:;",title:"Cancel"},on:{click:t.Close}},[e("i",{staticClass:"fa fa-close pr-2"}),t._v(t._s(t.$t("Cancel")))])])]),e("div",{staticClass:"col-lg-6"},[e("div",{staticClass:"py-2 text-danger"},[t._v(" "+t._s(t.$t("MandatoryString"))+" ")])])])]),e("div",{staticClass:"clearfix"}),e("div",{staticClass:"w-100 activity-tab mt-3",attrs:{id:"accordion"}},t._l(t.InvoiceHistory[0].CommentList,(function(a,i){return e("div",{key:i,staticClass:"card"},[e("div",{staticClass:"card-header"},[e("a",{staticClass:"card-link",attrs:{"data-toggle":"collapse",href:"#CommentAccordion"+i}},[e("div",{staticClass:"conversation-date heading-border"},[e("span",[t._v(t._s(a.DateGroup))])])])]),e("div",{staticClass:"collapse show",attrs:{id:"CommentAccordion"+i,"data-parent":"#accordion"}},t._l(a.CommentList,(function(i,n){return e("div",{staticClass:"card-body"},[e("div",{staticClass:"conversation-main"},[e("div",{staticClass:"conversation-time"},[e("span",[t._v(" "+t._s(t.FormatDateToTime(i.CommnetAt))+" ")])]),e("div",{staticClass:"conversation-box-con"},[e("div",{staticClass:"conversation-box"},[e("div",{staticClass:"name-circle light-yellow"},[null!=a.AVATAR?e("img",{staticClass:"img-circle avatar",attrs:{src:"https://cogniterblob.blob.core.windows.net/"+t.GetUserInfo.ContainerName+"/Upload/UserProfileImage/"+a.AVATAR,width:"51",height:"51",alt:"Image"}}):e("img",{staticClass:"img-circle avatar",attrs:{src:"/Content/images/DefaultImages/avatar-icon.jpg",width:"51",height:"51",alt:"Image"}})]),e("div",{staticClass:"conversation-header addednote-ticket"},[e("span",[e("span",{staticClass:"sender-name"}),e("span",{staticClass:"sender-department",attrs:{title:i.Comment}},[t._v(" "+t._s(i.Comment))])])]),e("div",{staticClass:"conversation-content"},[e("div",{staticClass:"col-12 p-0 notesdata"},[e("h6",{staticClass:"text-muted time"},[e("i",[e("b",[t._v(t._s(i.CommentByName))]),t._v(", Posted on: "),e("span",{staticClass:"text-danger"},[t._v(" "+t._s(i.CommnetAt)+" ")])])])])])])])])])})),0)])})),0)]):t._e()])])])])],1)])},n=[function(){var t=this,e=t._self._c;return e("th",{staticClass:"td1"},[e("span",[t._v("InvoiceNumber")])])},function(){var t=this,e=t._self._c;return e("th",{staticClass:"td3 tdcm"},[e("span",[t._v("DueDate")])])},function(){var t=this,e=t._self._c;return e("th",{staticClass:"td4 tdcm"},[e("span",[t._v("PaymentDate")])])},function(){var t=this,e=t._self._c;return e("th",{staticClass:"td4 tdcm"},[e("span",[t._v(" Status")])])}],s=(a("14d9"),a("9769")),o=(a("c1df"),{props:{BillId:{type:Number}},data(){return{isLoading:!1,InvoiceHistory:[],textCountertlength:2e3,comment:"",CurrencyCode:"PKR"}},created(){var t=this;this.fetchData(),t.CurrencyCode=t.GetUserInfo.Currency.replace(/[()]/g,"")},methods:{async fetchData(){this.isLoading=!0;try{const t=await s["a"].InvoiceHistory("invoiceId="+this.BillId),e=this.groupInvoiceData(t.data);this.InvoiceHistory=e}catch(t){console.error("Error fetching invoice data",t)}finally{this.isLoading=!1}},groupInvoiceData(t){const e=[];return t.forEach(t=>{let a=e.find(e=>e.MainInvoiceId===t.BILL_ID);a||(a={MainInvoiceId:t.BILL_ID,MainClientId:t.BILL_TO,MainInvoiceNumber:t.BILL_NUMBER,MainInvocieNetAmount:t.BILL_NET_TOTAL||0,MainInvoiceDueDate:new Date(t.DUE_DATE).toLocaleDateString(),MainInvoiceIssueDate:new Date(t.ISSUE_DATE).toLocaleDateString(),MainInvocieAmount:t.AMOUNT||0,CommentList:[],InvoiceListingGrid:[]},e.push(a)),this.addInvoiceDetails(a,t)}),e},addInvoiceDetails(t,e){if(t.CommentList||(t.CommentList=[]),1===e.ISPARENT&&e.COMMENT){let a=new Date(e.CREATED_AT),i=`${String(a.getDate()).padStart(2,"0")}-${a.toLocaleString("en-US",{month:"short"})}-${a.getFullYear()}`,n=t.CommentList.find(t=>t.DateGroup===i);n||(n={DateGroup:i,CommentList:[]},t.CommentList.push(n)),n.CommentList.push({CommnetAt:e.CREATED_AT?new Date(e.CREATED_AT).toLocaleString():"",Comment:e.COMMENT,CommentByName:e.CLIENT_NAME||"Unknown Client",UserTypeName:e.USER_TYPE_NAME||"Unknown Type",AVATAR:e.AVATAR})}0===e.ISPARENT&&(t.InvoiceListingGrid||(t.InvoiceListingGrid=[]),t.InvoiceListingGrid.push({BillId:e.BILL_ID,BillNumber:e.BILL_NUMBER,ClientName:e.CLIENT_NAME,ProjectName:e.PROJECT_NAME,BillDueDate:new Date(e.DUE_DATE).toLocaleDateString(),IssueDate:new Date(e.ISSUE_DATE).toLocaleDateString(),BillNetTotal:e.BILL_NET_TOTAL||0,StatusName:e.STATUS_NAME}))},Close(){this.$parent.isInvoiceHistory=!1},textCounter(){this.textCountertlength=2e3-this.comment.length},FormatDateToTime(t){const e=new Date(t.replace(/(\d{2})\/(\d{2})\/(\d{4}), (\d{2}):(\d{2}):(\d{2})/,"$2/$1/$3 $4:$5:$6"));let a=e.getHours(),i=e.getMinutes(),n=a>=12?"PM":"AM";a%=12,a=a||12,i=i<10?"0"+i:i;const s=`${a}:${i} ${n}`;return console.log(s),s},async SaveComment(){var t={invoiceId:this.BillId,comment:this.comment,invoiceNo:this.InvoiceHistory[0].MainInvoiceNumber,clientId:this.InvoiceHistory[0].MainClientId};let e=JSON.stringify(t);const a=await s["a"].CommentOnInvoice(e);if("Success"==a.data.Status){var i={message:a.data.Comment,notificationFor:a.data.NotificationFor,typeCode:"CB_INV_COMMENT",referenceId:a.data.InvoiceId,referenceId2:0};let t=JSON.stringify(i);await s["a"].InsertNotification(t);this.comment="",this.$refs.commentValidator.reset(),this.fetchData()}else this.ShowAlert(this.$t("ErrorWhileProcessingRequest"),"failure",!0,this.$t("Alert"))},getStatusClass(t){switch(t){case"CLBSND":return"bg-success";case"CLBDSPT":return"bg-info";case"CLBPAD":return"bg-primary";case"CLBRSTP":return"bg-danger";case"CLBBDBT":return"bg-dark";case"CLBDFT":return"bg-warning";default:return"bg-secondary"}}}}),l=o,r=a("2877"),d=Object(r["a"])(l,i,n,!1,null,null,null);e["a"]=d.exports},9908:function(t,e,a){"use strict";a("390a")},"9a6f":function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,".word-color[data-v-2273132f]{color:#007bff}.pdf-color[data-v-2273132f]{color:#e2211b}.text-color[data-v-2273132f]{color:#f0ad4e}.excel-color[data-v-2273132f]{color:#28a745}.default-color[data-v-2273132f]{color:#6c757d}.file-icon[data-v-2273132f]{font-size:20px}",""]),t.exports=e},"9bdb":function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,".m-0[data-v-53b0216e],.ps[data-v-53b0216e]{margin:0}.ps[data-v-53b0216e]{padding:5px 0}.invoice-container[data-v-53b0216e]{max-width:1100px;width:1100px;min-width:1100px;margin:0 auto;background:#fff;padding:20px;border:1px solid #ddd;border-radius:5px;box-shadow:0 2px 5px rgba(0,0,0,.1);float:left}.header[data-v-53b0216e]{margin-bottom:20px}.header img[data-v-53b0216e]{max-height:50px}.invoice-details[data-v-53b0216e],.payment-advice[data-v-53b0216e]{margin-bottom:20px;width:100%;float:left}.invoice-details table.secondtable[data-v-53b0216e],.payment-advice table.secondtable[data-v-53b0216e]{width:100%;border-collapse:collapse;margin-top:10px}table.secondtable td[data-v-53b0216e],table.secondtable th[data-v-53b0216e]{border:1px solid #ddd;padding:10px;text-align:left}table.secondtable th[data-v-53b0216e]{background-color:#f4f4f4}.totals[data-v-53b0216e]{float:right;margin-top:10px;text-align:right;width:100%}.totals div[data-v-53b0216e]{margin-bottom:5px}.footer[data-v-53b0216e]{text-align:center;font-size:.9em;color:#666;margin-top:20px;width:100%;display:inline-block}@media (max-width:600px){.header[data-v-53b0216e]{flex-direction:column;align-items:flex-start}.totals[data-v-53b0216e]{float:none;text-align:left}}table.secondtable tbody td[data-v-53b0216e]{text-align:left}.header .div1[data-v-53b0216e]{width:49%;float:left!important}.header .div3[data-v-53b0216e]{width:40%;float:right!important}.header .div2[data-v-53b0216e]{width:100%;float:left!important}",""]),t.exports=e},cba1:function(t,e,a){var i=a("9bdb");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=a("499e").default;n("346f5de7",i,!0,{sourceMap:!1,shadowMode:!1})},d00a:function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h5",{staticClass:"modal-title"},[t._v(t._s(t.$t("Attachment")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("dynamic-form",{ref:"fileForm",attrs:{mandatorytext:t.MandatoryString,buttons:t.buttons,schema:t.FormSchema},on:{OnSubmit:t.uploadFile}}),e("AttachmentList",{ref:"AttachmentList",attrs:{BillId:t.BillId}})],1)])])])],1)])},n=[],s=(a("14d9"),a("b7ef"),a("9769")),o=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"listing mt-2",attrs:{id:"divAttachmentsList"}},[e("div",{staticClass:"heading-border mb-2"},[e("h5",{staticClass:"h5"},[e("span",[t._v(t._s(t.$t("AttachmentList")))])])]),e("div",{staticClass:"table-responsive"},[e("table",{staticClass:"table table-bordered dt-responsive nowrap mt-0 w-100",attrs:{id:"tbllistingdata"}},[e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",{staticClass:"ui-resizable",attrs:{id:"th-FILENAME"}},[e("span",[t._v(t._s(t.$t("FileName")))])]),e("th",{staticClass:"ui-resizable",attrs:{id:"th-CREATEDAT"}},[e("span",[t._v(t._s(t.$t("CreatedAt")))])]),e("th",{staticClass:"ui-resizable",attrs:{id:"th-CREATEDBY"}},[e("span",[t._v(t._s(t.$t("CreatedBy")))])]),e("th",{staticClass:"ui-resizable",attrs:{id:"th-FILETYPE"}},[e("span",[t._v(t._s(t.$t("FileType")))])]),e("th",{staticClass:"ui-resizable",attrs:{id:"th-DESCRIPTION"}},[e("span",[t._v(t._s(t.$t("Description")))])]),e("th",{staticClass:"text-center nonresize"},[e("span",[t._v(t._s(t.$t("Download")))])]),e("th",{staticClass:"text-center nonresize"},[e("span",[t._v(t._s(t.$t("Delete")))])])])]),e("tbody",[0===t.filteredAttachmentList.length?e("tr",[e("td",{staticClass:"text-center text-danger no-record",attrs:{colspan:"7"}},[t._v(" "+t._s(t.$t("NoRecordfound"))+" ")])]):t._e(),t._l(t.filteredAttachmentList,(function(a,i){return e("tr",{key:i},[e("td",[t._v(t._s(a.file_name))]),e("td",[t._v(t._s(t.$options.filters.formatDate(a.created_at)))]),e("td",[t._v(t._s(a.created_by))]),e("td",[e("i",{class:["file-icon",t.getIconClass(a.Extension),t.getColorClass(a.Extension)]}),t._v(" "+t._s(a.Extension)+" ")]),e("td",[t._v(t._s(t.truncate(a.file_description||"No Description",30)))]),e("td",{staticClass:"text-center"},[e("a",{staticClass:"download",attrs:{title:"Download File"},on:{click:function(e){return t.downloadAttachment(a)}}},[e("i",{staticClass:"fa fa-download text-success"})])]),e("td",{staticClass:"text-center"},[e("a",{staticClass:"delete",attrs:{title:"Delete"},on:{click:function(e){return t.deleteAttachment(a.attachment_id)}}},[e("i",{staticClass:"fa fa-trash text-danger"})])])])}))],2)])])])])},l=[],r=(a("d9e2"),{props:{BillId:{type:Number}},data(){return{attachmentList:[]}},computed:{filteredAttachmentList(){return this.attachmentList}},async created(){console.log("billId",this.BillId),await this.getBillAttachMentList()},methods:{truncate(t,e){return t.length>e?t.substring(0,e)+"...":t},getIconClass(t){switch(t.toLowerCase()){case"doc":case"docx":return"fa fa-file-word";case"pdf":return"fa fa-file-pdf";case"txt":return"fa fa-file-text";case"xls":case"xlsx":return"fa fa-file-excel";default:return"fa fa-file"}},getColorClass(t){switch(t.toLowerCase()){case"doc":case"docx":return"word-color";case"pdf":return"pdf-color";case"txt":return"text-color";case"xls":case"xlsx":return"excel-color";default:return"default-color"}},async getBillAttachMentList(){this.$parent.isLoading=!0,this.attachmentList=[];try{let t="billId="+this.BillId;const e=await s["a"].GetBillAttachMentList(t);200===e.status?(this.$parent.isLoading=!1,""==e.data.result&&null==e.data.result||(this.attachmentList=JSON.parse(e.data.result).data)):this.$parent.isLoading=!1}catch(t){console.error("Error fetching attachment list:",t)}},downloadAttachment(t){try{if(!t||!t.file_path||!t.file_name)throw new Error("Invalid attachment details.");var e=document.createElement("a");e.href=t.file_path,e.setAttribute("download",t.file_name),document.body.appendChild(e),e.click(),document.body.removeChild(e)}catch(a){console.error("Error downloading attachment:",a)}},async deleteAttachment(t){try{const e=await new Promise((t,e)=>{this.confirmR(this.$t("Are you sure you want to delete this attachment?"),!0,!1,(function(e){t(e)}))});if(this.$parent.isLoading=!0,void 0==e){const e="documentId="+t,a=await s["a"].DeleteAttachment(e);200===a.status?(this.$parent.isLoading=!1,"1"==a.data.result.Result&&(this.ShowAlert(this.$t("deleteBillAttachment"),"success"),this.getBillAttachMentList())):this.ShowAlert(this.$t("UnknownError"),"failure",this.$t("Alert"))}}catch(e){console.error("Error deleting attachment:",e)}}}}),d=r,c=(a("9908"),a("2877")),m=Object(c["a"])(d,o,l,!1,null,"2273132f",null),u=m.exports,f={components:{AttachmentList:u},props:{BillId:{type:Number}},data(){return{MandatoryString:this.$t("MandatoryString"),FormSchema:[{layoutType:"double",Data:[{astype:"TextField",label:this.$t("FileName"),name:"FileName",value:"",placeholder:"",config:{},validationRules:{required:!0,max:2e3}},{astype:"FileField",showLabel:!1,label:this.$t("AttachItemImage"),name:"AttachItemImage",value:"",placeholder:"",FieldIndex:0,validationRules:{required:!0},config:{maxSize:5,accept:[{fileType:"doc",iconClass:"fa-file-word-o"},{fileType:"pdf",iconClass:"fa-file-pdf-o"},{fileType:"docx",iconClass:"fa-file-word-o"},{fileType:"txt",iconClass:"fa-file-text-o"},{fileType:"xls",iconClass:"fa-file-excel-o"},{fileType:"xlsx",iconClass:"fa-file-excel-o"}],onDeleteSelectedFiles:this.onDeleteSelectedFiles,onChange:this.GetBase64String,showSelectedFiles:[],showAddIcon:!1,onAddButtonClick:this.AddFileMore,multiple:!1}}]},{layoutType:"single",Data:[{astype:"TextAreaField",label:this.$t("Description"),name:"Description",value:"",placeholder:"",config:{rows:3},validationRules:{required:!1,max:2e3}}]}],buttons:[{type:"submit",class:"btn btn-success save",value:"Y",text:"<i class='fa fa-upload pr-2 pr-2'></i>Upload"},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Cancel",onClick:this.Close}],isLoading:!1}},created(){console.log("FormSchema",this.FormSchema)},methods:{Close(){var t=this;t.$parent.isAttachment=!1},onDeleteSelectedFiles(t){this.$delete(this.FormSchema[0].Data[1].config,"showSelectedFiles")},GetBase64String(t){try{var e=this;e.fileData=[];var a=t.target.files[0],i=new FileReader;i.onload=function(t){return function(t){var i=t.target.result,n=window.btoa(i),s=a.name;e.fileName=s;var o=s.lastIndexOf("."),l=s.substring(o+1,s.length);e.fileExt+="."+l;var r='{"ContentType":"'+a.type+'","Size":"'+a.size+'","Extension":"'+l+'"}',d=a.size;e.fileSize=d;var c={attachement_mime:r,fileName:s,base64String:n,fileSize:a.size,contentType:a.type};e.fileData.push(c)}}(),i.readAsBinaryString(a)}catch(n){}},async uploadFile(t,e){try{if(void 0==this.fileData)return;this.isLoading=!0;let e={file_Name:t.FileName,file_Description:t.Description,invoice_id:this.BillId,attachment:JSON.stringify(this.fileData)},a=new FormData;a.append("postString",JSON.stringify(e));const i=await s["a"].SaveBillAttachment(a);200===i.status?(this.isLoading=!1,"Success"==i.data.Status?(this.FormSchema[0].Data[0].value="",this.FormSchema[0].Data[1].value=[],this.FormSchema[1].Data[0].value="",this.$refs.fileForm.validateForm.reset(),this.onDeleteSelectedFiles(),this.$refs.AttachmentList.getBillAttachMentList(),this.ShowAlert(this.$t("SaveBillAttachment"),"success")):"Exceeds"==i.data.status?this.ShowAlert(this.$t("ExceedBillAttachmentLimit"),"Warning",this.$t("Alert")):this.ShowAlert(this.$t("UnknownError"),"failure",this.$t("Alert"))):(this.isLoading=!1,console.error("Upload failed:",i))}catch(a){console.error("Error uploading file:",a)}}}},h=f,p=Object(c["a"])(h,i,n,!1,null,null,null);e["a"]=p.exports},f8c5:function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h5",{staticClass:"modal-title"},[t._v(t._s(t.$t("PaySlipListing")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"d-flex justify-content-between align-items-center flex-wrap"}),e("div",{staticClass:"listing"},[e("div",{staticClass:"table-responsive"},[e("table",{staticClass:"table table-bordered dt-responsive nowrap mt-0"},[e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",[t._v(t._s(t.$t("Serial#")))]),e("th",[t._v(t._s(t.$t("Bill#")))]),e("th",[t._v(t._s(t.$t("Payment Date")))]),e("th",{staticStyle:{"text-align":"center"}},[t._v(t._s(t.$t("Amount")))]),e("th",[t._v(t._s(t.$t("Status")))]),e("th",[t._v(t._s(t.$t("Reference number")))]),e("th",[t._v(t._s(t.$t("Payment mode")))]),e("th",[t._v(t._s(t.$t("Action")))])])]),e("tbody",t._l(t.transaction_history,(function(a,i){return e("tr",{key:i},[e("td",[t._v(t._s(i+1))]),e("td",[t._v(t._s(a.bill_number))]),e("td",[t._v(" "+t._s(t.$options.filters.formatDateTime(a.payment_date)))]),e("td",{staticStyle:{"text-align":"right"}},[t._v(" "+t._s(t.$n(a.bill_record_amount,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")]),e("td",[t._v(t._s(a.PaymentStatus))]),e("td",[t._v(t._s(a.transaction_ref_id))]),e("td",[t._v(t._s(a.Payment_Mode))]),e("td",[e("a",{staticClass:"btn btn-info mr-2",attrs:{href:"javascript:;",title:t.$t("ViewSlip")},on:{click:function(e){return t.PrintPaySlip(a.bill_record_id)}}},[e("em",{staticClass:"fa fa-eye pr-2"}),t._v(t._s(t.$t("ViewSlip"))+" ")])])])})),0)])])])])])])])],1),t.IsPrint?e("PrintPaySlip",{attrs:{BillRecordData:t.BillRecordData}}):t._e()],1)},n=[],s=a("9769"),o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered",staticStyle:{width:"1140px"}},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h5",{staticClass:"modal-title"},[t._v(t._s(t.$t("Pay Slip")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"invoice-container",staticStyle:{padding:"5px"},attrs:{id:"printArea"}},[e("h2",{staticStyle:{"margin-top":"0",color:"#000","font-family":"Arial, Helvetica, sans-serif","text-align":"center","font-size":"18px",background:"#f2f2f2",padding:"7px"}},[t._v(" "+t._s(t.$t("PaymentReceipt"))+" ")]),e("div",{staticStyle:{width:"100%",display:"flex","justify-content":"space-between","align-items":"center","padding-bottom":"5px","border-bottom":"1px dashed #d9d8d8","margin-bottom":"10px"}},[e("img",{staticStyle:{"margin-right":"10px",width:"300px"},attrs:{src:t.CompanyLogo,alt:"Company Logo"}}),e("div",{staticClass:"div1",staticStyle:{color:"#000","font-family":"Arial, Helvetica, sans-serif","font-size":"1em"}},[e("p",{staticStyle:{"font-size":"20px","font-weight":"bold",color:"black",padding:"1px 0px"}},[t._v(" "+t._s(t.CompanyName)+" ")]),e("p",[t._v(t._s(t.CompanyAddress))]),e("p",[t._v(t._s(t.CompanyZipCode)+", "+t._s(t.CompanyCountry))])])]),e("div",{staticStyle:{clear:"both"}}),e("div",{staticClass:"header float-left w-100 p-2 mb-0"},[e("div",{staticClass:"div1",staticStyle:{color:"#000","font-family":"Arial, Helvetica, sans-serif","font-size":"1em"}},[e("p",[e("b",[t._v(t._s(t.$t("ClientName"))+":")]),t._v(" "),e("strong",[t._v(t._s(t.BillTo))])]),e("p",[e("b",[t._v(t._s(t.$t("Address"))+":")]),t._v(" "),e("strong",[t._v(t._s(t.address))])])]),e("div",{staticClass:"div3",staticStyle:{color:"#000","font-family":"Arial, Helvetica, sans-serif","font-size":"1em",display:"flex","flex-direction":"column",gap:"0px"}},[e("p",{staticClass:"ps",staticStyle:{display:"flex","justify-content":"end","align-items":"center","white-space":"nowrap"}},[e("b",[t._v(t._s(t.$t("InvoiceNumber"))+":")]),t._v(" "+t._s(t.Billno)+" ")]),e("p",{staticClass:"ps",staticStyle:{display:"flex","justify-content":"end","align-items":"center","white-space":"nowrap"}},[e("b",[t._v(t._s(t.$t("ReceiptNumber"))+" :")]),t._v(" "),e("span",[t._v(t._s(t.Billrecordid))])]),e("p",{staticClass:"ps",staticStyle:{display:"flex","justify-content":"end","align-items":"center","white-space":"nowrap"}},[e("b",[t._v(t._s(t.$t("PaymentDate"))+" :")]),t._v(" "),e("span",[t._v(t._s(t.paymentdate))])])])]),e("div",{staticClass:"payment-advice"},[e("table",{staticClass:"secondtable"},[e("tbody",[e("tr",[e("td",{staticStyle:{"font-weight":"600",color:"#737373","font-family":"Arial, Helvetica, sans-serif","font-size":"1em",background:"rgb(249 249 249)"}},[t._v(t._s(t.$t("ReceivedFrom")))]),e("td",{staticStyle:{"font-weight":"600",color:"#737373","font-family":"Arial, Helvetica, sans-serif","font-size":"1em",background:"rgb(249 249 249)"}},[t._v(t._s(t.$t("Status")))]),e("td",{staticStyle:{"font-weight":"600",color:"#737373","font-family":"Arial, Helvetica, sans-serif","font-size":"1em",background:"rgb(249 249 249)",width:"500px"}},[t._v(t._s(t.$t("PaymentMethod")))])]),e("tr",[e("td",{staticStyle:{color:"#000","font-family":"Arial, Helvetica, sans-serif","font-size":"1em"}},[t._v(t._s(t.BillTo))]),e("td",{staticStyle:{color:"#000","font-family":"Arial, Helvetica, sans-serif","font-size":"1em"}},[t._v(t._s(t.PaymentStatus))]),e("td",{staticStyle:{color:"#000","font-family":"Arial, Helvetica, sans-serif","font-size":"1em"}},[t._v(t._s(t.PaymentMode))])])])]),e("table",{staticClass:"secondtable float-right",staticStyle:{width:"500px"}},[e("tbody",[e("tr",[e("td",{staticStyle:{"font-weight":"600",color:"#737373","font-family":"Arial, Helvetica, sans-serif","font-size":"1em",background:"rgb(249 249 249)"}},[t._v(t._s(t.$t("PreviousPayment")))]),e("td",{staticStyle:{"text-align":"right",color:"#000","font-family":"Arial, Helvetica, sans-serif","font-size":"1em"}},[t._v(t._s(t.$n(t.PreviousPayment,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])]),e("tr",[e("td",{staticStyle:{"font-weight":"600",color:"#737373","font-family":"Arial, Helvetica, sans-serif","font-size":"1em",background:"rgb(249 249 249)"}},[t._v(t._s(t.$t("AmountReceived")))]),e("td",{staticStyle:{"text-align":"right",color:"#000","font-family":"Arial, Helvetica, sans-serif","font-size":"1em"}},[t._v(t._s(t.$n(t.BillAmount,"currency",t.$getLocaleByCurrency(t.CurrencyCode))))])]),e("tr",[e("td",{staticStyle:{"font-weight":"600",color:"#737373","font-family":"Arial, Helvetica, sans-serif","font-size":"1em",background:"rgb(249 249 249)"}},[t._v(t._s(t.$t("TransactionRefrenceNumber")))]),e("td",{staticStyle:{"text-align":"right",color:"#000","font-family":"Arial, Helvetica, sans-serif","font-size":"1em"}},[t._v(t._s(t.TransactionRefNumber))])]),e("tr",[e("td",{staticStyle:{"font-weight":"600",color:"#737373","font-family":"Arial, Helvetica, sans-serif","font-size":"1em",background:"rgb(249 249 249)"}},[t._v(t._s(t.$t("TotalAmount")))]),e("td",{staticStyle:{"text-align":"right",color:"#000","font-family":"Arial, Helvetica, sans-serif","font-size":"1.20em","font-weight":"600"}},[t._v(t._s(t.$n(t.TotalAmount,"currency",t.$getLocaleByCurrency(t.CurrencyCode))))])])])])])])]),e("div",{staticClass:"modal-footer text-right pr-0 pb-0",staticStyle:{"margin-bottom":"10px"}},[e("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 p-0"},[e("a",{class:{"btn btn-success mr-2":!0},attrs:{href:"javascript:;",title:t.$t("Print")},on:{click:function(e){return t.PrintPaySlip("printArea")}}},[e("em",{staticClass:"fa fa-print pr-2",attrs:{"aria-hidden":"true"}}),t._v(" "+t._s(t.$t("Print"))+" ")]),e("a",{staticClass:"btn btn-primary delete-btn mr-2",attrs:{title:"Close"},on:{click:function(e){return t.Close()}}},[e("i",{staticClass:"fa fa-times pr-2",attrs:{"aria-hidden":"true"}}),t._v(t._s(t.$t("Close"))+" ")])])])])])])],1)},l=[],r={components:{PrintPaySlip:u},props:{BillRecordData:{type:Object,required:!0}},data(){return{isLoading:!1,CompanyLogo:null,InvoiceDate:"",PaymentMode:"Cash",BillAmount:0,TransactionRefNumber:null,BillTo:null,Billrecordid:null,Billno:"",paymentdate:null,paymentdate:"",Notes:"",PaymentStatus:"",CurrencyCode:"PKR"}},created(){var t=this;this.FetchData(),t.CurrencyCode=t.GetUserInfo.Currency.replace(/[()]/g,"")},methods:{formatFullAddress(t){return[t.user_address_1,t.user_address_2,t.user_state,t.country_name,t.user_zipcode].filter(t=>t&&""!==t.trim()).join(", ")},FetchData:async function(){var t=this,e=t.BillRecordData;t.CompanyLogo=e.company_logo,t.InvoiceDate=t.$options.filters.formatDateTime(e.payment_date),t.PaymentMode=e.Payment_Mode,t.CompanyName=e.company_name,t.CompanyAddress=e.company_address||"No Address Provided",t.CompanyZipCode=e.company_zipcode||"No Zip Code Provided",t.CompanyCountry=e.company_country||"No Country Provided",t.BillAmount=e.TotalAmountRecived,t.TransactionRefNumber=e.Transaction_Reference_Number,t.Billrecordid=e.bill_record_id,t.BillTo=e.ClientName,t.Billno=e.Bill_number,t.address=e.user_address_1&&""!==e.user_address_1.trim()?this.formatFullAddress(e):"N/A",t.paymentdate=t.$options.filters.formatDateTime(e.payment_date),t.Notes=e.Notes,t.TotalAmount=e.TotalAmount,t.PreviousPayment=e.PreviousPayment,t.PaymentStatus=e.PaymentStatus},PrintPaySlip(t){const e=document.getElementById(t).innerHTML,a=document.createElement("iframe");a.style.position="absolute",a.style.width="0px",a.style.height="0px",a.style.border="none",document.body.appendChild(a);const i=a.contentWindow.document;i.open(),i.write("<html><head><title>Print</title>"),i.write("<style>");const n=document.querySelectorAll('style, link[rel="stylesheet"]');n.forEach(t=>{i.write(t.outerHTML)}),i.write("</style></head><body>"),i.write(e),i.write("</body></html>"),i.close(),a.contentWindow.focus(),a.contentWindow.print(),a.remove()},Close(){var t=this;t.$parent.IsPrint=!1}}},d=r,c=(a("5fb0"),a("2877")),m=Object(c["a"])(d,o,l,!1,null,"53b0216e",null),u=m.exports,f={components:{PrintPaySlip:u},props:{BillId:{type:Number,required:!0}},data(){return{isLoading:!1,InvoiceHistory:[],textCountertlength:2e3,comment:"",company_logo:"",invoicedate:"",transaction_history:[],BillNumber:"",mode:"cash",IsPrint:!1,BillRecordData:[],CurrencyCode:"PKR"}},created(){var t=this;this.FetchData(),t.CurrencyCode=t.GetUserInfo.Currency.replace(/[()]/g,"")},methods:{FetchData:async function(){var t=this,e="invoiceId="+t.BillId;await s["a"].GetInvoicePaymentDetails(e).then((function(e){""!=e.data&&null!=e.data&&e.data.length>0&&(t.transaction_history=e.data)}))},Close(){var t=this;t.$parent.isPaySlip=!1},PrintPaySlip:async function(t){var e=this,a=`invoiceId=${e.BillId}&invoiceRecordId=${t}`;await s["a"].GetInvoicePaymentRecord(a).then((function(t){""!=t.data&&null!=t.data&&t.data.length>0&&(e.BillRecordData=t.data[0],e.IsPrint=!0)}))}}},h=f,p=Object(c["a"])(h,i,n,!1,null,null,null);e["a"]=p.exports}}]);
//# sourceMappingURL=chunk-3464d8e4.js.map