(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-57105345"],{"78cd":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return t.isInvoice?e("div",{staticClass:"ClientBillListing"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("tg-list",{attrs:{IsShowAction:!0,showCheckBox:!0,ModuleName:"Billing",listType:["List"],widgets:t.widgets,RenderRowActionMethod:t.renderActions,SubModuleCode:"Billing",IdentityColumn:"BILL_ID",ListData:t.CilentBillListing,HeaderData:t.Headers,callbackfunction:t.FetchData,SearchFields:t.SearchSchema,HeaderButtons:t.listheaderbuttons,TotalRecords:t.TotalRecords,ListDataCallBackFunction:t.FetchData,LegendArray:t.LegendArray,SortExp:t.sortExp,SortBy:t.sortBy,NorecordfoundText:t.$t("NoRecordfound"),isShowHeaderText:!0,HeaderText:t.$t("Bills")},on:{LeftsearchButtonClick:t.leftCommonSearch,PagerButtonClick:t.pagerMethod,ActionButtonClick:t.actionButtonClick,HeaderButtonClick:t.commonHeaderButtonClick,SortdataButtonClick:t.sortdata},scopedSlots:t._u([{key:"slotdata",fn:function({data:a}){return["STATUS"==a.column.COLUMN_NAME?[e("span",{class:t.getStatusClass(a.row),attrs:{title:a.row.STATUS_NAME}},[t._v(" "+t._s(t.getStatusLabel(a.row))+" ")])]:t._e(),"BILL_NUMBER"==a.column.COLUMN_NAME?["Paid"!=a.row.STATUS_NAME&&"Bad Debt"!=a.row.STATUS_NAME&&"Partial Paid"!=a.row.STATUS_NAME&&"Cancelled"!=a.row.STATUS_NAME&&"Cancel"!=a.row.STATUS_NAME?e("div",[e("a",{attrs:{href:"javascript:;","data-toggle":"tooltip"},on:{click:function(e){return t.handleEdit(a.row)}}},[t._v(t._s(a.row.BILL_NUMBER))])]):e("div",[t._v(" "+t._s(a.row.BILL_NUMBER)+" ")])]:t._e(),"Company"==a.column.COLUMN_NAME?[e("span",[t._v(t._s(a.row.COMPANY_NAME))])]:t._e(),"BILL_NET_TOTAL"==a.column.COLUMN_NAME?[e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.openPaymentHistory(a.row)}}},[e("i",{attrs:{"aria-hidden":"true"}}),t._v(" "+t._s(t.$n(a.row.BILL_NET_TOTAL,"currency",t.$getLocaleByCurrency(a.row.ISO_CODE)))+" ")])]:t._e(),"CONVERT_AMOUNT"==a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(t.$n(a.row.CONVERT_AMOUNT,"currency",t.$getLocaleByCurrency(a.row.ISO_CODE)))+" ")])]:t._e(),"BILL_ISSUE_DATE"==a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(t.$options.filters.formatDate(a.row.CREATED_AT))+" ")])]:t._e(),"BILL_DUE_DATE"==a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(t.$options.filters.formatDate(a.row.BILL_DUE_DATE))+" ")])]:t._e(),"BILLING_PERIOD"==a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(t.getInvoiceBillingPeriod(a.row))+" ")])]:t._e(),"Outstanding"==a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(t.$n(a.row.BILL_NET_TOTAL,"currency",t.$getLocaleByCurrency(a.row.ISO_CODE)))+" ")])]:t._e(),"CONVERT_OUTSTANDING_AMOUNT"==a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(t.$n(a.row.CONVERT_OUTSTANDING_AMOUNT,"currency",t.$getLocaleByCurrency(a.row.ISO_CODE)))+" ")])]:t._e()]}}],null,!1,1425316164)}),t.isAttachment?e("Attachment",{attrs:{BillId:t.billId}}):t._e(),t.isPaymentHistory?e("PaymentHistroy",{attrs:{BillId:t.BillId}}):t._e(),t.isPayment?e("PayNow",{attrs:{PaymentData:t.PaymentData}}):t._e(),t.isInvoiceHistory?e("InvoiceHistory",{attrs:{BillId:t.BillId}}):t._e(),t.isSendBill?e("SendBill",{attrs:{BillId:t.BillId,InvoiceBillId:t.InvoiceBillId}}):t._e(),t.isPaySlip?e("InvoicePaySlip",{attrs:{BillId:t.billId}}):t._e(),t.isInvoiceHistoryChange?e("InvoiceHistoryChange",{attrs:{BillId:t.BillId}}):t._e()],1):e("div",[t.isTemplate?e("InvoiceTemplate",{attrs:{details:t.templatedata,hitFrom:"MainInvoice"},on:{backtoInvoiceList:t.backtoInvoiceList}}):t._e()],1)},s=[],n=(a("14d9"),a("88a7"),a("271a"),a("5494"),a("9769"));let l=[{id:"manualBillButton",title:"manual Bill",href:"/ClientBill/Create/0",iconClass:"fa fa-plus",callbackfunction:"mannualBill",additionalClass:"",isdisabled:!1,isvisible:!0},{title:"Download",iconClass:"fa-download",callbackfunction:"download",additionalClass:"",isdisabled:!1,isvisible:!0},{title:"Mark As Sent",iconClass:"fa-paper-plane",callbackfunction:"markAsSent",isEnabledOnSelectedRow:!0,additionalClass:"",isdisabled:!1,isvisible:!0},{title:"Mark As Paid",iconClass:"fa fa-money",callbackfunction:"markAsPaid",isEnabledOnSelectedRow:!0,additionalClass:"",isdisabled:!1,isvisible:!0},{title:"Mark as Disputed",iconClass:"fa fa-gavel",callbackfunction:"markAsDisputed",isEnabledOnSelectedRow:!0,additionalClass:"",isdisabled:!1,isvisible:!0},{title:"Mark as Bad Debt",iconClass:"fa fa-credit-card-alt",callbackfunction:"markAsBadDebt",isEnabledOnSelectedRow:!0,additionalClass:"",isdisabled:!1,isvisible:!0},{title:"Mark as Cancelled",iconClass:"fa fa-times",callbackfunction:"markAsCancelled",isEnabledOnSelectedRow:!0,additionalClass:"",isdisabled:!1,isvisible:!0}],o=[{fieldName:"InvoiceType",fieldType:"radio",fieldIcon:"fa fa-exclamation-circle",fieldSearchConditionName:[""],isSearch:!1,value:"",paramName:"isRecurring",listOptions:[{value:"0",name:"Bill"},{value:"1",name:"Recurring"}]},{fieldName:"BillNumber",fieldType:"text",fieldIcon:"fa fa-file",paramName:"invoiceNum",fieldSearchConditionName:[""],isSearch:!1,value:"",listOptions:[]},{fieldName:"Client",fieldType:"ddl-check",fieldIcon:"fa fa-user",paramName:"clientId",fieldSearchConditionName:[""],isSearch:!1,value:"",listOptions:[]},{fieldName:"InvoiceBillIssueDate",fieldType:"date",fieldIcon:"fa fa-calendar",fieldSearchConditionName:[""],paramName:"stringbillIssueDateFrom",isSearch:!1,value:"",datePickerConfig:{formate:"yyyy-mm-dd"}},{fieldName:"InvoiceBillIssueDateTo",fieldType:"date",fieldIcon:"fa fa-calendar",paramName:"stringbillIssueDateTo",fieldSearchConditionName:[""],isSearch:!1,value:"",datePickerConfig:{formate:"yyyy-mm-dd"}},{fieldName:"InvoiceBillingPeriod",fieldType:"date",fieldIcon:"fa fa-clock-o",fieldSearchConditionName:[""],paramName:"timePeriodFrom",isSearch:!1,value:"",datePickerConfig:{formate:"yyyy-mm-dd"}},{fieldName:"InvoiceBillingPeriodTo",fieldType:"date",fieldIcon:"fa fa-clock-o",paramName:"timePeriodTo",fieldSearchConditionName:[""],isSearch:!1,value:"",datePickerConfig:{formate:"yyyy-mm-dd"}},{fieldName:"DueDateFrom",fieldType:"date",fieldIcon:"fa fa-calendar",fieldSearchConditionName:[""],paramName:"stringbillDueDateFrom",isSearch:!1,value:"",datePickerConfig:{formate:"yyyy-mm-dd"}},{fieldName:"DueDateTo",fieldType:"date",fieldIcon:"fa fa-calendar",paramName:"stringbillDueDateTo",fieldSearchConditionName:[""],isSearch:!1,value:"",datePickerConfig:{formate:"yyyy-mm-dd"}},{fieldName:"InvoiceStatus",fieldType:"ddl-check",fieldIcon:"fa fa-circle-o-notch",paramName:"statusId",fieldSearchConditionName:[""],isSearch:!1,value:"",listOptions:[]},{fieldName:"Project",fieldType:"ddl-check",fieldIcon:"fa fa-file-text-o",paramName:"projectId",fieldSearchConditionName:[""],isSearch:!1,value:"",listOptions:[]},{fieldName:"STATE",fieldType:"radio",fieldIcon:"fa fa-database",paramName:"state",fieldSearchConditionName:[""],isSearch:!1,value:"",listOptions:[]},{fieldName:"Frequency",fieldType:"radio",fieldIcon:"fa fa-forumbee",paramName:"frequency",fieldSearchConditionName:[""],isSearch:!1,value:"",listOptions:[]}];async function r(t,e,a){var i=t;let s="reqForm=leftSearch";try{const t=await n["a"].GetleftSearchDropdownData(s);if(null!=t.data){const e={clientList:JSON.parse(t.data.clientList).data,projectList:JSON.parse(t.data.projectList).data,state:JSON.parse(t.data.state).data,statusType:JSON.parse(t.data.statusType).data,invoiceDurationList:JSON.parse(t.data.invoiceDurationList)};e.clientList.length>0&&(i.SearchSchema[2].listOptions=[],e.clientList.forEach(t=>{if(t.Name&&t.Id&&"string"===typeof t.Id&&""!==t.Id.trim())try{const e=t.Id.split("^")[0];i.SearchSchema[2].listOptions.push({name:t.Name,value:e})}catch(e){console.error("Error splitting item.Id for",t,e)}})),e.statusType.length>0&&(i.SearchSchema[9].listOptions=e.statusType.map(t=>({name:t.STATUS_NAME,value:t.STATUS_ID}))),e.projectList.length>0&&(i.SearchSchema[10].listOptions=e.projectList.map(t=>({name:t.Name,value:t.Id}))),e.state.length>0&&(i.SearchSchema[11].listOptions=e.state.map(t=>({name:t.STATE_NAME,value:t.STATE_ID}))),e.invoiceDurationList.length>0&&(i.SearchSchema[12].listOptions=e.invoiceDurationList.map(t=>({name:t.Name,value:t.Value})))}}catch(l){console.error("Error fetching dropdown data:",l)}}var c={buttons:l,SearchSchema:o,bindleftCommonSearchdropdown:r},d=a("d00a"),m=function(){var t=this,e=t._self._c;return e("transition",{attrs:{name:"modal"}},[e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block dialog"},[e("div",{staticClass:"modal-dialog"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("PaymentHistory")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.closePaymentHistroy}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"card-body float-left p-0 col-12 float-left"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-4 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("BillNumber"))+": "+t._s(t.paymentHistoryData.MainInvoiceNumber))])])]),e("div",{staticClass:"col-md-4 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("IssueDate"))+": "+t._s(t.formatDateMonth(t.paymentHistoryData.MainInvoiceIssueDate)))])])]),e("div",{staticClass:"col-md-4 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("DueDate"))+": "+t._s(t.formatDateMonth(t.paymentHistoryData.MainInvoiceDueDate)))])])]),e("div",{staticClass:"col-md-4 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Advance (PKR): "),0==t.paymentHistoryData.MainInvocieAdvacncedRecived?e("span",[t._v(t._s(t.$n(0,"currency",t.$getLocaleByCurrency(t.CurrencyCode))))]):t._e(),0!=t.paymentHistoryData.MainInvocieAdvacncedRecived?e("span",[t._v(t._s(t.$n(t.paymentHistoryData.MainInvocieAdvacncedRecived,"currency",t.$getLocaleByCurrency(t.CurrencyCode))))]):t._e()])])]),e("div",{staticClass:"col-md-4 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Discount Flat Rate (PKR): "),0==t.paymentHistoryData.MainInvoiceFlatDiscount?e("span",[t._v(t._s(t.$n(0,"currency",t.$getLocaleByCurrency(t.CurrencyCode))))]):t._e(),0!=t.paymentHistoryData.MainInvoiceFlatDiscount?e("span",[t._v(" "+t._s(t.$n(t.paymentHistoryData.MainInvoiceFlatDiscount,"currency",t.$getLocaleByCurrency(t.CurrencyCode))))]):t._e()])])]),e("div",{staticClass:"col-md-4 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Amount (PKR): "),t.paymentHistoryData&&0!=t.paymentHistoryData.MainInvocieNetAmount?e("span",[t._v(t._s(t.$n(t.formattedAmount,"currency",t.$getLocaleByCurrency(t.CurrencyCode))))]):e("span",[t._v("0.00")])])])])]),e("div",{staticClass:"listing"},[e("div",{staticClass:"table-responsive table-fix-header"},[e("table",{staticClass:"table-sorting table table-bordered my-0",attrs:{id:"maintable"}},[e("thead",{staticClass:"thead-light"},[e("tr",[e("th",{attrs:{width:"30%"}},[e("span",[t._v(t._s(t.$t("Notes")))])]),e("th",{attrs:{width:"20%"}},[e("span",[t._v(t._s(t.$t("PaymentDate")))])]),e("th",{staticClass:"text-right",attrs:{width:"20%"}},[e("span",[t._v(t._s(t.$t("Amount"))+" ("+t._s(t.paymentHistoryData.MainInvoiceCompanyIsoCode)+")")])]),e("th",{staticClass:"text-center",attrs:{width:"30%"}},[e("span",[t._v(t._s(t.$t("Action")))])])])]),e("tbody",[t.paymentList&&0!=t.paymentList.length?t.paymentList&&t.paymentList.length>0&&t.totalPayments<t.MainInvocieNetAmount?t._l(t.paymentList,(function(a,i){return e("tr",{key:i,staticClass:"myrow"},[e("td",[e("span",[t._v(t._s(a.MainNote))])]),e("td",[e("span",[t._v(t._s(t.formatDateMonth(a.PaymentDate)))])]),e("td",{staticClass:"text-right"},[e("span",[t._v(t._s(t.formatAmount(a.Amount)))])]),e("td",{staticClass:"text-center"})])})):t._e():e("tr",[e("td",{staticClass:"text-center text-danger",attrs:{colspan:"4"}},[t._v(" "+t._s(t.$t("NoPaymentFound"))+" ")])])],2),e("tfoot",[e("tr",[e("td"),e("td",{staticClass:"text-right"},[t._v(" "+t._s(t.$t("NetAmountPaid"))+": ")]),e("td",{staticClass:"text-right font-weight-bold"},[t._v(" "+t._s(t.$n(t.formatAmount(t.totalPaid),"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")]),e("td")]),e("tr",[e("td"),e("td",{staticClass:"text-right"},[t._v(" "+t._s(t.$t("OutStandingAmount"))+" ")]),e("td",{staticClass:"text-right font-weight-bold"},[e("span",{style:{color:t.outstandingAmount<0?"green":"red"}},[t._v(" "+t._s(t.$n(t.formatAmount(t.outstandingAmount),"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])]),e("td")])])])])])])]),e("div",{staticClass:"modal-footer"},[e("div",{staticClass:"col-lg-6 text-right p-0"},[e("a",{staticClass:"btn btn-danger formbtn text-white",attrs:{href:"javascript:;"},on:{click:t.closePaymentHistroy}},[e("em",{staticClass:"fa fa-close pr-2"}),t._v(t._s(t.$t("Cancel")))])])])])])])],1)])},u=[],_=(a("13d5"),{props:{BillId:{type:Number}},computed:{formattedAmount(){return this.paymentHistoryData.MainInvocieNetAmount.toFixed(2)},totalPaid(){return this.paymentList.reduce((t,e)=>t+e.Amount,0)},outstandingAmount(){return this.MainInvocieNetAmount-this.totalPaid}},data(){return{paymentHistoryData:[],paymentList:[],MainInvocieNetAmount:0,totalPayments:0,CurrencyCode:"PKR"}},created(){var t=this;this.openPaymentHistory(),t.CurrencyCode=t.GetUserInfo.Currency.replace(/[()]/g,"")},methods:{closePaymentHistroy(){this.$parent.isPaymentHistory=!1},async openPaymentHistory(){const t=this,e="invoiceId="+this.BillId;try{const a=await n["a"].GetPaymentHistoryPopUp(e);a.data?(t.paymentHistoryData=a.data,t.paymentList=a.data.PaymentLists,t.MainInvocieNetAmount=a.data.MainInvocieNetAmount,t.totalPayments=t.paymentList.reduce((t,e)=>t+e.Amount,0)):t.paymentHistoryData=[]}catch(a){console.error("Error fetching payment history:",a)}},formatDateMonth(t){if(!t)return"";const[e,a]=t.split(" "),[i,s,n]=e.split("-"),l=new Date(`${n}-${s}-${i}T00:00:00`),o=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],r=String(l.getDate()).padStart(2,"0"),c=o[l.getMonth()],d=l.getFullYear();return`${c}-${r}-${d}`},formatAmount(t){return t.toFixed(2)}}}),p=_,v=a("2877"),C=Object(v["a"])(p,m,u,!1,null,null,null),h=C.exports,f=function(){var t=this,e=t._self._c;return e("transition",{attrs:{name:"modal"}},[e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block dialog"},[e("div",{staticClass:"modal-dialog"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("Payment")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.ClosePayment}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"card-body float-left p-0 col-12 float-left"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-4 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("BillNumber"))+": "+t._s(t.paymentDetailsData[0].BILL_NUMBER))])])]),e("div",{staticClass:"col-md-4 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("IssueDate"))+": "+t._s(t.formatDateM(t.paymentDetailsData[0].BILL_ISSUE_DATE)))])])]),e("div",{staticClass:"col-md-4 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("DueDate"))+": "+t._s(t.formatDateM(t.paymentDetailsData[0].BILL_DUE_DATE)))])])]),e("div",{staticClass:"col-md-4 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Total Amount ("+t._s(t.paymentDetailsData[0].ISO_CODE)+"): "),0==t.paymentDetailsData[0].BILL_NET_TOTAL?e("span",[t._v("0.00")]):t._e(),0!=t.paymentDetailsData[0].BILL_NET_TOTAL?e("span",[t._v(" "+t._s(t.$n(t.paymentDetailsData[0].BILL_NET_TOTAL,"currency",t.$getLocaleByCurrency(t.paymentDetailsData[0].ISO_CODE))))]):t._e()])])]),e("div",{staticClass:"col-md-4 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Paid Amount Till Now ("+t._s(t.paymentDetailsData[0].ISO_CODE)+"): "),t.paymentDetailsData[0].PAID>0?e("span",[t._v(t._s(t.$n(t.paymentDetailsData[0].PAID,"currency",t.$getLocaleByCurrency(t.paymentDetailsData[0].ISO_CODE))))]):e("span",[t._v("0.00")])])])]),e("div",{staticClass:"col-md-4 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Payment Date:")]),e("span",[t._v(" "+t._s(t.paymentDate)+" ")])])]),e("div",{staticClass:"clearfix"}),t.paymentDetailsData[0].HAS_MULIPLE_TERMS?e("div",{staticClass:"listing mt-2 col-lg-12"},[e("div",{staticClass:"table-responsive table-fix-header"},[e("table",{staticClass:"table-sorting table table-bordered my-0",attrs:{id:"maintable"}},[e("thead",{staticClass:"thead-light"},[e("tr",[e("th",{attrs:{width:"25%"}},[e("span",[t._v(t._s(t.$t("Notes")))])]),e("th",{staticClass:"text-center",attrs:{width:"20%"}},[e("span",[t._v(t._s(t.$t("Due Date"))+" ")])]),e("th",{staticClass:"text-left",attrs:{width:"20%"}},[e("span",[t._v(t._s(t.$t("Due Amount"))+" ("+t._s(t.paymentTermsData[0].ISO_CODE)+")")])]),e("th",{staticClass:"text-left",attrs:{width:"20%"}},[e("span",[t._v(t._s(t.$t("Mark Payment")))])]),e("th",{staticClass:"text-center",attrs:{width:"15%"}},[e("span",[t._v(t._s(t.$t("Action")))])])])]),e("tbody",[t.paymentTermsData&&0!=t.paymentTermsData.length?t.paymentTermsData&&t.paymentTermsData.length>0?t._l(t.paymentTermsData,(function(a,i){return e("tr",{key:i,staticClass:"myrow"},[e("td",[e("span",[t._v(t._s(a.NOTES)+" ")])]),e("td",{staticClass:"text-center"},[e("span",[t._v(t._s(t.formatDateM(a.DUE_ON))+" ")])]),e("td",[e("input",{directives:[{name:"model",rawName:"v-model",value:a.DUE_AMOUNT,expression:"termsPaymentRow.DUE_AMOUNT"}],staticClass:"form-control",attrs:{id:"txtduedamount",maxlength:"12",readonly:""},domProps:{value:a.DUE_AMOUNT},on:{input:function(e){e.target.composing||t.$set(a,"DUE_AMOUNT",e.target.value)}}})]),e("td",[e("label",{staticClass:"mr-2",class:{total_disable_class_bg:0===a.DUE_AMOUNT}},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.IS_FULL_PAYMENT,expression:"termsPaymentRow.IS_FULL_PAYMENT"}],attrs:{type:"radio",value:"1"},domProps:{checked:"1"===a.IS_FULL_PAYMENT,checked:t._q(a.IS_FULL_PAYMENT,"1")},on:{change:function(e){return t.$set(a,"IS_FULL_PAYMENT","1")}}}),t._v(" Full Payment ")]),e("label",{class:{total_disable_class_bg:0===a.DUE_AMOUNT}},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.IS_FULL_PAYMENT,expression:"termsPaymentRow.IS_FULL_PAYMENT"}],attrs:{type:"radio",value:"0"},domProps:{checked:"0"===a.IS_FULL_PAYMENT,checked:t._q(a.IS_FULL_PAYMENT,"0")},on:{change:function(e){return t.$set(a,"IS_FULL_PAYMENT","0")}}}),t._v(" Partial ")]),"0"===a.IS_FULL_PAYMENT?e("div",[e("input",{directives:[{name:"model",rawName:"v-model",value:a.AMOUNT_RECEIVED,expression:"termsPaymentRow.AMOUNT_RECEIVED"}],staticClass:"form-control",class:{total_disable_class_bg:0===a.DUE_AMOUNT},attrs:{type:"number",id:"txtrecivedamount",maxlength:"12"},domProps:{value:a.AMOUNT_RECEIVED},on:{blur:function(e){return t.checkAmountReceived(a)},input:function(e){e.target.composing||t.$set(a,"AMOUNT_RECEIVED",e.target.value)}}})]):t._e()]),e("td",{staticClass:"text-center"},[e("div",{staticClass:"col-lg-12"},[t.paymentDetailsData[0].HAS_MULIPLE_TERMS?e("div",[e("span",{attrs:{id:"submitField"}},[e("a",{staticClass:"submitbtn btn btn-success",class:{total_disable_class_bg:0===a.DUE_AMOUNT},attrs:{id:"SaveMultipleTerms",title:"Save",href:"javascript:;"},on:{click:function(e){return t.SaveMultipleTerms(a)}}},[e("i",{staticClass:"fa fa-save pr-2"}),t._v("Save")])])]):t._e()])])])})):t._e():e("tr",[e("td",{staticClass:"text-center text-danger",attrs:{colspan:"5"}},[t._v(" "+t._s(t.$t("NoPaymentFound"))+" ")])])],2)])])]):t._e(),t.paymentDetailsData[0].HAS_MULIPLE_TERMS||0!=t.IsAlreadyPaid?t._e():e("div",{staticClass:"listing mt-2 col-lg-12"},[e("div",{staticClass:"table-responsive table-fix-header"},[e("table",{staticClass:"table-sorting table table-bordered my-0",attrs:{id:"maintable"}},[e("thead",{staticClass:"thead-light"},[e("tr",[e("th",{attrs:{width:"25%"}},[e("label",{staticClass:"float-left"},[t._v("Notes:")]),e("span",{staticClass:"mandatory float-left"},[t._v("*")])]),e("th",{staticClass:"text-left",attrs:{width:"15%"}},[e("label",{staticClass:"float-left"},[t._v("Amount:")]),e("span",{staticClass:"mandatory float-left"},[t._v("*")])]),e("th",{staticClass:"text-left",attrs:{width:"15%"}},[e("label",{staticClass:"float-left"},[t._v("Refrence number:")]),e("span",{staticClass:"mandatory float-left"},[t._v("*")])]),e("th",{staticClass:"text-left",attrs:{width:"15%"}},[e("label",{staticClass:"float-left"},[t._v("Bill Date:")]),e("span",{staticClass:"mandatory float-left"},[t._v("*")])]),e("th",{staticClass:"text-left",attrs:{width:"15%"}},[e("label",{staticClass:"float-left"},[t._v("Payment Mode:")]),e("span",{staticClass:"mandatory float-left"},[t._v("*")])]),e("th",{staticClass:"text-center",attrs:{width:"15%"}},[e("span",[t._v(t._s(t.$t("Action")))])])])]),e("tbody",[e("tr",[e("td",[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.Notes,expression:"Notes"}],staticClass:"form-control",attrs:{name:"Notes",id:"txtNotes",rows:"2",cols:"100"},domProps:{value:t.Notes},on:{input:function(e){e.target.composing||(t.Notes=e.target.value)}}})]),e("td",[t.paymentDetailsData.length>0&&(t.paymentDetailsData[0].BILL_NET_TOTAL||0)-(t.paymentDetailsData[0].PAID||0)<=0?e("span",{staticClass:"fullPaid"},[t._v("Paid")]):e("span",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.amount,expression:"amount"}],staticClass:"form-control",attrs:{type:"number",id:"txtamount",onkeypress:"return event.key !== '-' && this.value.length < 12"},domProps:{value:t.amount},on:{input:function(e){e.target.composing||(t.amount=e.target.value)}}})])]),e("td",[e("span",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.RefNo,expression:"RefNo"}],staticClass:"form-control",attrs:{type:"text",id:"txtamount",maxlength:"18"},domProps:{value:t.RefNo},on:{input:function(e){e.target.composing||(t.RefNo=e.target.value)}}})])]),e("td",[e("span",[t._v(t._s(t.BillDate))])]),e("td",[e("select",{directives:[{name:"model",rawName:"v-model",value:t.BillMode,expression:"BillMode"}],staticClass:"form-control",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.BillMode=e.target.multiple?a:a[0]}}},[e("option",{attrs:{value:"Cash"}},[t._v("Cash")]),e("option",{attrs:{value:"Cheque"}},[t._v("Cheque")]),e("option",{attrs:{value:"Online"}},[t._v("Online")]),e("option",{attrs:{value:"DD"}},[t._v("DD")])])]),e("td",{staticClass:"text-center"},[e("div",{staticClass:"col-lg-12"},[t.paymentDetailsData[0].HAS_MULIPLE_TERMS?t._e():e("a",{staticClass:"submitbtn btn btn-success mr-2",attrs:{id:"MakePartialPay",title:"Save",href:"javascript:;"},on:{click:t.SavePartialPayment}},[e("i",{staticClass:"fa fa-save pr-2"}),t._v("Save")])])])])])])])]),1==t.IsAlreadyPaid?e("div",{staticClass:"mt-2 col-lg-12"},[e("div",{staticClass:"alert alert-danger text-center",attrs:{role:"alert"}},[t._v(" "+t._s(t.$t("InvoiceAlreadyPaid"))+" ")])]):t._e(),e("div",{staticClass:"col-lg-12 text-right mt-3"},[e("a",{staticClass:"btn btn-danger formbtn text-white",attrs:{href:"javascript:;"},on:{click:t.ClosePayment}},[e("em",{staticClass:"fa fa-close pr-2"}),t._v(t._s(t.$t("Cancel")))])])])])])])])])],1)])},D=[],y={props:{PaymentData:{type:String}},data(){return{isSaving:!1,paymentDetailsData:[],paymentTermsData:[],amount:0,Notes:"",paymentDate:"",isPaySlip:!1,BillDate:"",BillMode:"Cash",RefNo:0,IsAlreadyPaid:!1}},created(){var t=this;this.BillPayNow(this.PaymentData),t.BillDate=t.$options.filters.formatDate(new Date)},methods:{async BillPayNow(t){var e=this;e.paymentTermsData=[];var a=t.BILL_ID,i="invoiceId="+a;await n["a"].GetInvoicePartailPaymentDetails(i).then((function(t){if(t.data){e.paymentDetailsData=t.data,$.each(e.paymentDetailsData,(function(t,a){var i={BILL_ID:a.BILL_ID,BILL_NUMBER:a.BILL_NUMBER,BILL_ISSUE_DATE:a.BILL_ISSUE_DATE,BILL_DUE_DATE:a.BILL_DUE_DATE,BILL_NET_TOTAL:a.BILL_NET_TOTAL,PAID:a.PAID,ISO_CODE:a.ISO_CODE,HAS_MULIPLE_TERMS:a.HAS_MULIPLE_TERMS,TERM_ID:a.TERM_ID,DUE_ON:a.DUE_ON,DUE_AMOUNT:a.DUE_AMOUNT,NOTES:a.NOTES,IS_FULL_PAYMENT:1==a.IS_FULL_PAYMENT?"1":"0",AMOUNT_RECEIVED:0,AMOUNT_RECEIVED_OLD:a.AMOUNT_RECIEVED};e.paymentTermsData.push(i)}));const a=new Date,i=String(a.getDate()).padStart(2,"0"),s=String(a.getMonth()+1).padStart(2,"0"),n=a.getFullYear();e.paymentDate=`${i}-${s}-${n}`,e.IsAlreadyPaid=!1;let l=parseFloat("string"===typeof e.paymentDetailsData[0].BILL_NET_TOTAL?e.paymentDetailsData[0].BILL_NET_TOTAL.replace(/,/g,""):e.paymentDetailsData[0].BILL_NET_TOTAL||0),o=parseFloat(e.paymentDetailsData[0].PAID||0);l-o==0&&(e.IsAlreadyPaid=!0)}else e.paymentDetailsData=[]}))},formatDateM(t){if(!t)return"";const e=new Date(t),a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],i=a[e.getMonth()],s=e.getDate(),n=e.getFullYear();return`${i}-${s}-${n}`},ClosePayment:function(){var t=this;t.$parent.isPayment=!1,t.paymentDetailsData=[],t.paymentTermsData=[]},SaveMultipleTerms(t){var e=this;if(console.log("IS_FULL_PAYMENT :",t.IS_FULL_PAYMENT),"1"==t.IS_FULL_PAYMENT)console.log("PaymentOption1:",t.IS_FULL_PAYMENT),parseFloat(t.DUE_AMOUNT)==parseFloat(t.AMOUNT_RECEIVED_OLD)?(console.log("AMOUNT_RECEIVED :",t.AMOUNT_RECEIVED_OLD),t.AMOUNT_RECEIVED=parseFloat(Math.abs(t.AMOUNT_RECEIVED_OLD+parseFloat(t.DUE_AMOUNT)).toFixed(2)),t.DUE_AMOUNT=0):(t.AMOUNT_RECEIVED=t.DUE_AMOUNT,t.DUE_AMOUNT=0);else if(console.log("PaymentOption2:",t.IS_FULL_PAYMENT),parseFloat(t.DUE_AMOUNT)==parseFloat(t.AMOUNT_RECEIVED))t.AMOUNT_RECEIVED=parseFloat(Math.abs(t.AMOUNT_RECEIVED_OLD+parseFloat(t.AMOUNT_RECEIVED)).toFixed(2)),t.DUE_AMOUNT=0;else{if(parseFloat(t.AMOUNT_RECEIVED)>parseFloat(t.DUE_AMOUNT))return void e.ShowAlert(e.$t("AmountNotGreaterThanDue"),"warning");if(parseFloat(t.AMOUNT_RECEIVED)<=0)return void e.ShowAlert(e.$t("AmountGreaterThenZero"),"warning");t.AMOUNT_RECEIVED=parseFloat(Math.abs(t.AMOUNT_RECEIVED_OLD+parseFloat(t.AMOUNT_RECEIVED)).toFixed(2)),t.DUE_AMOUNT=parseFloat(Math.abs(t.AMOUNT_RECEIVED-t.DUE_AMOUNT).toFixed(2))}if(""!=t.AMOUNT_RECEIVED&&"0"!=t.AMOUNT_RECEIVED&&0!=parseFloat(t.AMOUNT_RECEIVED)){const a={INVOICEID:t.BILL_ID,AMOUNT:0,DATETIME:e.paymentDate,NOTES:e.Notes,HAS_MULIPLE_TERMS:t.HAS_MULIPLE_TERMS,TERM_ID:t.TERM_ID,IS_FULL_PAYMENT:"1"==t.IS_FULL_PAYMENT,AMOUNT_RECEIVED:t.AMOUNT_RECEIVED,DUE_AMOUNT:t.DUE_AMOUNT};console.log(a),n["a"].SaveInvoicePartialPayment(a).then((function(t){"Success"==t.data.Status?(e.ShowAlert(e.$t("AddedSuccess",[e.$t("Payment")]),"success",!0,e.$t("Alert")),e.FetchData(),e.isPayment=!1):e.ShowAlert(e.$t("ErrorWhileProcessingRequest"),"warning")}))}else e.ShowAlert(e.$t("AmountNotValid"),"warning")},async validateReceiptNumber(t){const e=/^[A-Za-z0-9]{6,}$/;return!!e.test(t)},async SavePartialPayment(){var t=this;if(!t.isSaving){t.isSaving=!0;try{var e=null==t.paymentDetailsData[0].BILL_NET_TOTAL?0:parseFloat(t.paymentDetailsData[0].BILL_NET_TOTAL).toFixed(2);const l=null==t.paymentDetailsData[0].PAID?0:parseFloat(t.paymentDetailsData[0].PAID).toFixed(2);var a=parseFloat(t.amount)+parseFloat(l),i=e-a;if(i.toFixed(2)<0)return t.ShowAlert(t.$t("AmountNotMoreThanTotal"),"warning"),t.amount=0,void(t.isSaving=!1);var s=await t.validateReceiptNumber(t.RefNo);if(!s)return t.ShowAlert(t.$t("InvalidReceiptNumber"),"warning"),void(t.isSaving=!1);if(!this.Notes)return t.ShowAlert(t.$t("NotesRequired"),"warning"),void(t.isSaving=!1);if(""!=t.amount&&"0"!=t.amount&&0!=parseFloat(t.amount)){const e={INVOICEID:t.paymentDetailsData[0].BILL_ID,AMOUNT:t.amount,DATETIME:t.paymentDate,NOTES:t.Notes,HAS_MULIPLE_TERMS:t.paymentDetailsData[0].HAS_MULIPLE_TERMS,AMOUNT_RECEIVED:t.amountRecieved,ReferenceNumber:t.RefNo,PaymentMode:t.BillMode},a=await n["a"].SaveInvoicePartialPayment(e);"Success"==a.data.Status?(t.ShowAlert(t.$t("AddedSuccess",[t.$t("Payment")]),"success",!0,t.$t("Alert")),t.amount=0,t.Notes="",t.RefNo="",t.BillMode="Cash",t.FetchData(),t.isPayment=!1):t.ShowAlert(t.$t("ErrorWhileProcessingRequest"),"warning")}else t.ShowAlert(t.$t("AmountNotValid"),"warning")}finally{t.isSaving=!1}}}}},E=y,A=Object(v["a"])(E,f,D,!1,null,null,null),I=A.exports,L=a("384d"),S=a("66b5"),N=a("78fc"),T=a("f8c5"),g=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h5",{staticClass:"modal-title"},[t._v(t._s(t.$t("Invoice"))+" "+t._s(t.$t("History")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[t.isInvoice?e("div",{staticClass:"listing mt-2"},[e("div",{staticClass:"table-responsive table-fix-header",attrs:{id:"divmemb"}},[e("table",{staticClass:"table table-bordered mt-0 w-100"},[e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",[t._v(t._s(t.$t("Change"))+" "+t._s(" ")+" "+t._s(t.$t("Date")))]),e("th",[t._v(t._s(t.$t("Bill#")))]),e("th",[t._v(t._s(t.$t("Client")))]),e("th",[t._v(t._s(t.$t("Project")))]),e("th",[t._v(t._s(t.$t("IssueDate")))]),e("th",[t._v(t._s(t.$t("DueDate")))]),e("th",[t._v(t._s(t.$t("Amount")))]),e("th",[t._v(t._s(t.$t("DateFrom")))]),e("th",[t._v(t._s(t.$t("DateTo")))]),e("th",[t._v(t._s(t.$t("DueDate"))+" "+t._s(" ")+" "+t._s(t.$t("Comment")))]),e("th",[t._v(t._s(t.$t("Terms")))]),e("th",[t._v(t._s(t.$t("Template")))]),e("th",[t._v(t._s(t.$t("Action")))])])]),t.InvoiceHistoryDetails.length>0?e("tbody",t._l(t.InvoiceHistoryDetails,(function(a,i){return e("tr",{key:i},[e("td",[t._v(" "+t._s(t.formatDate(a.bill_history_changed_at))+" ")]),e("td",[t._v(" "+t._s(a.bill_number)+" ")]),e("td",[t._v(" "+t._s(a.bill_to)+" ")]),e("td",[t._v(" "+t._s(a.project_name)+" ")]),e("td",[t._v(" "+t._s(t.formatDate(a.bill_issue_date))+" ")]),e("td",[t._v(" "+t._s(t.formatDate(a.bill_due_date))+" ")]),e("td",[t._v(" "+t._s(t.$n(a.bill_net_total,"currency",t.$getLocaleByCurrency(a.Currency)))+" ")]),e("td",[t._v(" "+t._s(t.formatDate(a.bill_date_from))+" ")]),e("td",[t._v(" "+t._s(t.formatDate(a.bill_date_to))+" ")]),e("td",[t._v(" "+t._s(a.bill_due_date_comment)+" ")]),e("td",[t._v(" "+t._s(a.Terms)+" ")]),e("td",[t._v(" "+t._s(a.Template_Name)+" ")]),e("td",{staticClass:"text-center mobile-action single-action"},[e("a",{attrs:{title:"View Bill",href:"javascript:void(0)"},on:{click:function(e){return t.handleViewBill(a)}}},[e("em",{staticClass:"fa fa-eye action-icon"})])])])})),0):e("tbody",[e("tr",[e("td",{staticClass:"text-center text-danger py-3",attrs:{colspan:"13"}},[t._v(" "+t._s(t.$t("NoRecordfound"))+" ")])])])])])]):e("div",[t.isTemplate?e("InvoiceTemplate",{attrs:{details:t.templatedata,hitFrom:"MainInvoice"},on:{backtoInvoiceList:t.backtoInvoiceList}}):t._e()],1)])])])])],1)])},b=[],M=a("c1df"),B=a.n(M),P={name:"ClientBillListing",components:{InvoiceTemplate:L["a"]},props:{BillId:{type:Number}},data(){return{isLoading:!1,InvoiceHistoryDetails:[],isTemplate:!1,templatedata:{},isInvoice:!0}},created(){this.fetchData()},methods:{async fetchData(){this.isLoading=!0;try{const t=await n["a"].GetInvoiceHistoryDetails("billId="+this.BillId);this.InvoiceHistoryDetails=JSON.parse(t.data.result).data}catch(t){console.error("Error fetching invoice data",t)}finally{this.isLoading=!1}},backtoInvoiceList(){this.isInvoice=!0,this.isTemplate=!1},async handleViewBill(t){const e=`billId=${t.invoiceId_Enc}&billHistroyId=${t.invoiceHistoryId_Enc}`,a=await n["a"].getInvoiceBillHistoryDetails(e);this.templatedata=a.data.result.data,this.isInvoice=!1,this.isTemplate=!0},Close(){this.$parent.isInvoiceHistoryChange=!1},textCounter(){this.textCountertlength=2e3-this.comment.length},formatDate:function(t){return t?B()(t).format("MM/DD/YYYY"):""},getStatusClass(t){switch(t){case"CLBSND":return"bg-success";case"CLBDSPT":return"bg-info";case"CLBPAD":return"bg-primary";case"CLBRSTP":return"bg-danger";case"CLBBDBT":return"bg-dark";case"CLBDFT":return"bg-warning";default:return"bg-secondary"}}}},O=P,R=Object(v["a"])(O,g,b,!1,null,null,null),U=R.exports,k={name:"ClientBillListing",components:{Attachment:d["a"],PaymentHistroy:h,PayNow:I,InvoiceTemplate:L["a"],InvoiceHistory:S["a"],SendBill:N["a"],InvoicePaySlip:T["a"],InvoiceHistoryChange:U},data(){return{isPaymentHistory:!1,isAttachment:!1,isPaged:1,Headers:[{COLUMN_NAME:"BILL_NUMBER",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:this.$t("Bill")+"#",DISPLAY_ORDER:1},{COLUMN_NAME:"CLIENT_NAME",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:this.$t("Client"),DISPLAY_ORDER:2},{COLUMN_NAME:"Company",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:this.$t("Company"),DISPLAY_ORDER:3},{COLUMN_NAME:"PROJECT_NAME",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:this.$t("project_id"),DISPLAY_ORDER:4},{COLUMN_NAME:"PARENT_INVOICE",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("ParentInvoice"),DISPLAY_ORDER:5},{COLUMN_NAME:"BILL_NET_TOTAL",DATA_TYPE:"currency",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:this.$t("Amount"),DISPLAY_ORDER:7},{COLUMN_NAME:"STATUS",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:this.$t("STATUS_NAME"),DISPLAY_ORDER:8},{COLUMN_NAME:"BILL_ISSUE_DATE",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:this.$t("IssueDate"),DISPLAY_ORDER:6},{COLUMN_NAME:"BILL_DUE_DATE",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:this.$t("DueDate"),DISPLAY_ORDER:9},{COLUMN_NAME:"BILLING_PERIOD",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:this.$t("BillingPeriod"),DISPLAY_ORDER:5},{COLUMN_NAME:"RECURRING_FREQUENCY",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:this.$t("Frequency"),DISPLAY_ORDER:5},{COLUMN_NAME:"BILLING_DIVISION",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("Division"),DISPLAY_ORDER:5},{COLUMN_NAME:"STATE",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("STATE"),DISPLAY_ORDER:5},{COLUMN_NAME:"CONVERT_AMOUNT",DATA_TYPE:"currency",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:`${this.$t("Amount")} ${this.GetUserInfo.Currency}`,DISPLAY_ORDER:10},{COLUMN_NAME:"Outstanding",DATA_TYPE:"currency",SORTABLE:!1,VISIBLE:!1,DISPLAY_NAME:this.$t("InvoiceOutstanding"),DISPLAY_ORDER:11},{COLUMN_NAME:"CONVERT_OUTSTANDING_AMOUNT",DATA_TYPE:"currency",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:`${this.$t("InvoiceOutstanding")} ${this.GetUserInfo.Currency}`,DISPLAY_ORDER:12}],listheaderbuttons:c.buttons,SearchSchema:c.SearchSchema,listActions:[{title:"Edit",href:"javascript:void(0)",icon:"fa fa-pencil text-info action-icon",callbackfunction:"handleEdit",isDisabled:!1,additionalSpan:""},{title:"View Bill",href:"javascript:void(0)",icon:"fa fa-eye action-icon",callbackfunction:"handleViewBill",isDisabled:!1,additionalSpan:""},{title:"Send Bill",href:"javascript:void(0)",icon:"fa fa-eye text-info action-icon",callbackfunction:"handleSendBill",isDisabled:!1,additionalSpan:""},{title:"Pay Slip",callbackfunction:"clkPaySlip",icon:"fa fa-print pr-2 action-icon",additionalSpan:""},{title:"Payment",href:"javascript:void(0)",icon:"fa fa-usd text-info action-icon",callbackfunction:"handlePayment",isDisabled:!1,additionalSpan:""},{title:"Invoice History",href:"javascript:void(0)",icon:"fa fa-history action-icon",callbackfunction:"handleInvoiceHistory",isDisabled:!1,additionalSpan:""},{title:"Invoice History Change",href:"javascript:void(0)",icon:"fa fa-history text-info action-icon",callbackfunction:"handleInvoiceHistoryChange",isDisabled:!1,additionalSpan:""},{title:"Attachment",href:"javascript:void(0)",icon:"fa fa-upload text-primary action-icon",callbackfunction:"handleAttachment",isDisabled:!1,additionalSpan:""}],TotalRecords:0,pageSize:10,pageNum:1,sortBy:"",searchCondition:"",GroupStart:1,GroupEnd:3,CurrentPage:1,TotalPages:0,sortExp:"",noRecords:!1,LegendArray:[{class:"legend-upcoming colorboxsquare",text:this.$t("Bill(s) generated from milestone")},{class:"legend-Progress colorboxsquare",text:this.$t("Shared Company Invoice")}],CilentBillListing:[],widgets:[],inoviceStats:{},billId:"",isPayment:!1,PaymentData:"",isInvoice:!0,isTemplate:!1,templatedata:{},isInvoiceHistory:!1,isSendBill:!1,isPaySlip:!1,UserType:null,InvoiceBillId:"",isInvoiceHistoryChange:!1}},async created(){var t=this;t.UserType=t.GetUserInfo.UserType,await t.Widget(),await t.FetchData(),await c.bindleftCommonSearchdropdown(t,"Company","Client")},methods:{async Widget(){var t=this;t.isLoading=!0;let e="projectId=&clientId=&invoiceNum=&isRecurring=0&amountTo=&amountFrom=&stringbillDueDateTo=&stringbillDueDateFrom=&stringbillIssueDateTo=&stringbillIssueDateFrom=&stringcreatedAtTo=&stringcreatedAtFrom=&statusId";try{const a=await n["a"].GetInvoiceStatistics(e);if(a&&a.data){t.inoviceStats=a.data.result,t.widgets=[];let e={icon:"fa fa-clock-o",name:"Duration",class:"one_wid",value:null!=t.inoviceStats.period?t.inoviceStats.period:""},i={icon:"fa fa-dollar",name:"Due "+t.GetUserInfo.Currency,class:"two_wid",value:null!=t.inoviceStats.dueAmount?t.inoviceStats.dueAmount:"0.00"},s={icon:"fa fa-dollar",name:"Received "+t.GetUserInfo.Currency,class:"three_wid",value:null!=t.inoviceStats.amountRecived?t.inoviceStats.amountRecived:"0.00"};t.widgets.push(e,i,s)}}catch(a){console.error("Error fetching invoice statistics:",a)}finally{t.isLoading=!1}},async FetchData(){var t=this;t.CilentBillListing=[];let e=`sortBy=${t.sortBy}&sortExp=${t.sortExp}&pageSize=${t.pageSize}&pageNum=${t.pageNum}&bill_id=0&isPaged=${t.isPaged}&${this.searchCondition}`;try{t.isLoading=!0;const a=await n["a"].GetClientBillListing(e);if(a.data&&a.data.result){t.Headers.forEach(t=>{t.settings=null,"STATUS"!=t.COLUMN_NAME&&"BILL_NUMBER"!=t.COLUMN_NAME&&"BILL_NET_TOTAL"!=t.COLUMN_NAME&&"BILL_ISSUE_DATE"!=t.COLUMN_NAME&&"BILL_DUE_DATE"!=t.COLUMN_NAME&&"BILLING_PERIOD"!=t.COLUMN_NAME&&"BILL_NET_TOTAL"!=t.COLUMN_NAME&&"Outstanding"!=t.COLUMN_NAME&&"CONVERT_AMOUNT"!=t.COLUMN_NAME&&"CONVERT_OUTSTANDING_AMOUNT"!=t.COLUMN_NAME&&"Company"!=t.COLUMN_NAME||(t.settings={isInSlot:!0})});const e=JSON.parse(a.data.result);e.data.length>0?(t.CilentBillListing=e.data,t.TotalRecords=e.data[0].TOTAL_RECORDS,t.TotalPages=Math.ceil(t.TotalRecords/t.pageSize),t.CurrentPage=t.pageNum,t.noRecord=!1):(t.noRecord=!0,t.TotalRecords=0,t.CilentBillListing=[],t.isLoading=!1)}else t.noRecord=!0,t.TotalRecords=0,t.CilentBillListing=[]}catch(a){console.error("Error fetching client bill listing:",a),t.noRecord=!0,t.TotalRecords=0,t.CilentBillListing=[]}finally{t.isLoading=!1,console.log("Fetch operation complete")}},OpenPlanDetail(){},commonHeaderButtonClick(t){switch(t.callbackfunction){case"mannualBill":this.mannualBill(0);break;case"download":this.DownloadBillList();break;case"markAsSent":this.MarkStatus("CLBSND");break;case"markAsPaid":this.MarkStatus("CLBPAD");break;case"markAsDisputed":this.MarkStatus("CLBDSPT");break;case"markAsBadDebt":this.MarkStatus("CLBBDBT");break;case"markAsCancelled":this.MarkStatus("CLBCNCL");break;case"BackToList":this.BackToList();break}},renderActions(t){var e=this;let a=[];return e.listActions.forEach(i=>{let s={...i};switch(s.title){case"Edit":s.isVisible=!0;break;case"View Bill":s.isVisible=!0;break;case"Send Bill":s.isVisible=!0;break;case"Pay Slip":s.isVisible=!0,s.isDisabled="CLBPAD"!=t.STATUS_CODE&&"CLBPPAD"!=t.STATUS_CODE;break;case"Payment":s.isVisible="CL"!=e.UserType,s.isDisabled="CLBPAD"!=t.STATUS_CODE&&"CLBSND"!=t.STATUS_CODE&&"CLBPPAD"!=t.STATUS_CODE;break;case"Invoice History":s.isVisible=!0;break;case"Invoice History Change":s.isVisible=!0;break;case"Attachment":s.isVisible=!0;break}a.push(s)}),a},actionButtonClick(t,e){var a=this;switch(t){case"handleEdit":a.handleEdit(e);break;case"handleViewBill":a.handleViewBill(e);break;case"handleSendBill":a.handleSendBill(e);break;case"clkPaySlip":this.clickPaySlip(e);break;case"handlePayment":a.handlePayment(e);break;case"handleInvoiceHistory":a.handleInvoiceHistory(e);break;case"handleInvoiceHistoryChange":a.handleInvoiceHistoryChange(e);break;case"handleAttachment":a.handleAttachment(e);break}},BackToList(){this.$router.push("/Client/Index")},getStatusClass(t){switch(t.STATUS_CODE){case"CLBSND":return"btn btn-primary py-0 d-block font-14";case"CLBDSPT":return"btn btn-warning py-0 d-block font-14";case"CLBPAD":return"btn btn-success py-0 d-block font-14";case"CLBRSTP":return"btn btn-danger py-0 d-block font-14";case"CLBBDBT":return"btn btn-danger py-0 d-block font-14";case"CLBDFT":return"btn btn-warning py-0 d-block font-14";case"CLBCNCL":return"btn btn-danger py-0 d-block font-14";case"CNCLFAILED":return"btn btn-danger py-0 d-block font-14";case"CLBPPAD":return"btn btn-info py-0 d-block font-14";case"CLBGEN":return"btn btn-warning py-0 d-block font-14";case"RLSTOWORKDAY":return"btn btn-success py-0 d-block font-14";case"CLBERROR":return"btn btn-danger py-0 d-block font-14";case"CANPWORKDAY":return"btn btn-info py-0 d-block font-14";case"CLBUPDATED":return"btn btn-success py-0 d-block font-14";case"SYNC_FAILED":return"btn btn-danger py-0 d-block font-14";case"SYNCED":return"btn btn-success py-0 d-block font-14";case"RLS":return"btn btn-success py-0 d-block font-14";default:return"btn btn-secondary py-0 d-block font-14"}},getStatusLabel(t){switch(t.STATUS_CODE){case"CLBSND":return"Sent";case"CLBDSPT":return"Disputed";case"CLBPAD":return"Paid";case"CLBRSTP":return"Recurring Stopped";case"CLBBDBT":return"Bad Debt";case"CLBDFT":return"Draft";case"CLBCNCL":return"Cancelled";case"CNCLFAILED":return"Cancel Failed";case"CLBPPAD":return"Partial Paid";case"CLBGEN":return"Generated";case"RLSTOWORKDAY":return"Released";case"CLBERROR":return"Failed";case"CANPWORKDAY":return"Cancel Pending";case"CLBUPDATED":return"Updated";case"SYNC_FAILED":return"Update Failed";case"SYNCED":return"Updated";case"RLS":return"Release";default:return t.STATUS_CODE}},getInvoiceBillingPeriod(t){const e=t.DATE_RANGE_FROM?B()(t.DATE_RANGE_FROM).format("MM/DD/YYYY"):"",a=t.DATE_RANGE_TO?B()(t.DATE_RANGE_TO).format("MM/DD/YYYY"):"";return`${e} - ${a}`},getAmount(t){const e=t.ISO_CODE,a=t.BILL_NET_TOTAL;return e?`${a} (${e})`:""+a},getOutstanding(t){const e=t.ISO_CODE,a=t.BILL_NET_TOTAL;return e?`${a} (${e})`:""+a},pagerMethod(t){this.pageSize=t.PageSize,this.pageNum=t.PageNumber,this.FetchData()},sortdata(t){this.sortBy=t;var e="ASC";"ASC"==this.sortExp&&(e="DESC"),this.sortExp=e,this.sortBy=t,this.sortExp=e,this.pageNum=1,this.GroupStart=this.pageNum,this.GroupEnd=this.pageNum+2,this.FetchData()},leftCommonSearch(t){this.PageNumber=t.PageNumber,this.isPaged=1,"undefined"!=typeof t.searchCondition?this.searchCondition=t.searchConditionJson:this.searchCondition="",this.FetchData()},handleAttachment(t){var e=this;e.isAttachment=!0,e.billId=t.BILL_ID},openPaymentHistory(t){this.BillId=t.BILL_ID,this.isPaymentHistory=!0},mannualBill(t){this.$router.push({name:"AddInvoice",params:{action:"Create",id:t}})},async DownloadBillList(){var t=this;let e=`sortBy=${t.sortBy}&sortExp=${t.sortExp}&pageSize=${t.pageSize}&pageNum=${t.pageNum}&bill_id=0&isPaged=${t.isPaged}&${this.searchCondition}`;const a=await n["a"].GetClientBillListing(e);if(""!=a.data&&null!=a.data){let e=JSON.parse(a.data.result);e.data.length>0&&t.ConvertJSONToCSV(e.data,"Invoice",!0)}},ConvertJSONToCSV:function(t,e,a){const i=["BILL_ID","BILL_RECORD_AMOUNT","COMPANY_ID","COMPANY_NAME","IS_AUTO_SEND","ISO_CODE","IS_RECURRING","MILESTONE_ID","RECURRING_FREQUENCY","RECURRING_STATUS","ROWNUMBER","STATUS_CODE","TEMPLATE_ID","TIME_ROUNDING","TOTAL_RECORDS"],s={BILL_NUMBER:"Invoice No",CLIENT_NAME:"Contract",PROJECT_NAME:"Project Name",PARENT_INVOICE:"Parent Invoice",CREATED_AT:"Issue Date",BILL_DUE_DATE:"Due Date",PAYMENT_CREATED_AT:"Payment Date",BILL_NET_TOTAL:"Amount",STATUS_NAME:" Status"};if(t&&Array.isArray(t)&&t.length>0){const n=Object.keys(t[0]),l=n.filter(t=>!i.includes(t)),o=l.map(t=>s[t]||t),r=t.map(t=>o.map(e=>{const a=l[o.indexOf(e)];let i=void 0!==t[a]&&null!==t[a]?String(t[a]):"";return(i.includes(",")||i.includes("\n")||i.includes('"'))&&(i=`"${i.replace(/"/g,'""')}"`),i}).join(",")),c=(a?[o.join(",")]:[]).concat(r).join("\n"),d=new Blob([c],{type:"text/csv;charset=utf-8;"}),m=document.createElement("a");m.setAttribute("href",URL.createObjectURL(d)),m.setAttribute("download",e+".csv"),m.click()}else console.log("No valid data to convert.")},MarkStatus(t){var e=this,a=[],i=[],s=[];if(e.CilentBillListing.forEach(t=>{1==t.isSelected&&(a.push(t.BILL_ID),"CLBPAD"!=t.STATUS_CODE&&"CLBPPAD"!=t.STATUS_CODE&&"CLBCNCL"!=t.STATUS_CODE||(i.push(t.BILL_ID),s.push(t.BILL_NUMBER)))}),i.length>0){const t=s.length>1?"invoices are":"invoice is",a=s.length>1?"these invoices":"this invoice";e.ShowAlert(`${s.join(", ")} - ${t} already paid. Please unselect ${a} before proceeding.`,"failure")}else if(0!==a.length){var n=a.join(",");e.UpdateStatus(n,t)}else e.ShowAlert("Please select at least one invoice.","failure")},UpdateStatus(t,e){var a=this,i="",s="";"CLBSND"==e?i="MarkSent":"CLBPAD"==e?i="MarkPaid":"CLBDSPT"==e?i="MarkDisputed":"CLBBDBT"==e?i="MarkBadDebt":"CLBCNCL"==e&&(i="MarkCancel"),s="CANPWORKDAY"==e?a.$t("ConfirmCancelWorkday"):a.$t("InvoiceConfirm").replace("?"," ")+" "+a.$t(i)+"?",a.confirmR(s,!0,!1,(function(i){if(void 0===i){var s=`billIds=${t}&statusCode=${e}`;n["a"].UpdateClientInvoiceStatus(s).then(t=>{1==t.data[0].ERROR_CODE?(a.ShowAlert(a.$t("RecordUpdatedSuccessfully"),"success"),a.FetchData()):a.ShowAlert(a.$t("ErrorWhileProcessingRequest"),"failure")})}}))},async handlePayment(t){var e=this;e.isPayment=!0,e.PaymentData=t},async handleViewBill(t){const e="billId="+t.invoiceId_Enc,a=await n["a"].getInvoiceDetails(e);this.templatedata=a.data.result.data,this.isInvoice=!1,this.isTemplate=!0},backtoInvoiceList(){this.isInvoice=!0,this.isTemplate=!1,this.FetchData()},handleInvoiceHistory(t){var e=this;e.isInvoiceHistory=!0,e.BillId=t.BILL_ID},handleInvoiceHistoryChange(t){var e=this;e.isInvoiceHistoryChange=!0,e.BillId=t.BILL_ID},handleSendBill(t){var e=this;e.InvoiceBillId=t.invoiceId_Enc,e.isSendBill=!0,e.BillId=t.BILL_ID},handleEdit(t){this.$router.push({name:"AddInvoice",params:{action:"Edit",id:t.BILL_ID}})},async clickPaySlip(t){var e=this;e.isPaySlip=!0,e.billId=t.BILL_ID}}},w=k,x=Object(v["a"])(w,i,s,!1,null,null,null);e["default"]=x.exports},"78fc":function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h5",{staticClass:"modal-title"},[t._v(t._s(t.$t("SendInvoice")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"row",attrs:{id:"divSend"}},[e("div",{staticClass:"heading-border mb-2 ml-2 mr-2"},[e("h5",{staticClass:"h5"},[e("span",[t._v(t._s(t.$t("FillSendEmailForm")))])])]),e("div",{staticClass:"col-sm-12 col-lg-6"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("SendAs"))+":")]),e("br"),e("span",[t._v(t._s(t.UserName))])])]),e("div",{staticClass:"col-sm-12 col-lg-6"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("Subject"))+": "),e("span",{staticClass:"text-danger"},[t._v("*")])]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.Subject,expression:"form.Subject"}],staticClass:"form-control",class:{"is-invalid":t.subjectError},attrs:{placeholder:"Subject",maxlength:"300",required:""},domProps:{value:t.form.Subject},on:{blur:t.validateSubject,input:function(e){e.target.composing||t.$set(t.form,"Subject",e.target.value)}}}),t.subjectError?e("small",{staticClass:"text-danger"},[t._v(t._s(t.subjectError))]):t._e()])]),e("div",{staticClass:"col-sm-12 col-md-10 col-lg-10 col-xl-10 float-left p-2"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("Recipients"))+": "),e("span",{staticClass:"text-danger"},[t._v("*")])]),e("div",{staticClass:"form-group",attrs:{id:"toRecipients"}},[e("Form",{ref:"emailRecipient",staticClass:"row",scopedSlots:t._u([{key:"default",fn:function({valid:a,errors:i}){return t._l(t.emails,(function(a,i){return e("div",{key:a.id,staticClass:"col-lg-12"},[e("Field",{attrs:{rules:{required:!0},name:"email"},scopedSlots:t._u([{key:"default",fn:function({field:s,errors:n}){return[e("div",{staticClass:"col-sm-12 col-md-10 col-lg-10 col-xl-10 float-left p-2 bg-light"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.email,expression:"entry.email"}],class:{"form-control ":!0,"is-invalid":n[0],"bg-white":0==i},attrs:{type:"email",disabled:!a.isEditing,readonly:!a.isEditing,placeholder:"Enter email"},domProps:{value:a.email},on:{input:function(e){e.target.composing||t.$set(a,"email",e.target.value)}}}),n.length?e("span",{staticClass:"text-danger"},[t._v(t._s(n[0]))]):t._e()]),e("div",{staticClass:"col-sm-12 col-md-2 col-lg-2 col-xl-2 float-left single-action mt-2",attrs:{id:"basic-addon2"}},[e("a",{staticClass:"actionicons float-left mr-3",attrs:{title:"Edit",href:"javascript:;","data-toggle":"tooltip","data-original-title":"Edit"},on:{click:function(e){return t.editRecipient(i)}}},[e("i",{staticClass:"fa fa-pencil text-success font-size-icons"})]),t.UpdateEmailsArray==i+1?e("a",{staticClass:"actionicons float-left clsforAddMore",attrs:{title:" Add More",href:"javascript:;","data-toggle":"tooltip","data-original-title":"Add More"},on:{click:function(e){return t.addNewRecipient(a,i)}}},[e("i",{staticClass:"fa fa-plus-circle text-dark font-size-icons"})]):t._e(),i>0?e("a",{staticClass:"actionicons float-left mr-3",attrs:{href:"javascript:;",idfor:"ancDeleRecp"},on:{click:function(e){return t.deleteRecipient(i)}}},[e("i",{staticClass:"fa fa-trash font-size-icons text-danger"})]):t._e()])]}}],null,!0)})],1)}))}}])})],1)])]),e("div",{staticClass:"col-sm-12 col-lg-6 options"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("SendMeCopy"))+":")]),e("div",{staticClass:"custom-control custom-checkbox"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.sendMeCopy,expression:"form.sendMeCopy"}],staticClass:"custom-control-input",staticStyle:{display:"none"},attrs:{type:"checkbox",name:"SendMeCopy",id:"chk_11"},domProps:{checked:Array.isArray(t.form.sendMeCopy)?t._i(t.form.sendMeCopy,null)>-1:t.form.sendMeCopy},on:{change:function(e){var a=t.form.sendMeCopy,i=e.target,s=!!i.checked;if(Array.isArray(a)){var n=null,l=t._i(a,n);i.checked?l<0&&t.$set(t.form,"sendMeCopy",a.concat([n])):l>-1&&t.$set(t.form,"sendMeCopy",a.slice(0,l).concat(a.slice(l+1)))}else t.$set(t.form,"sendMeCopy",s)}}}),e("label",{staticClass:"custom-control-label universal-custom-control-label pt-1",attrs:{for:"chk_11"}})])])]),e("div",{staticClass:"col-sm-12 col-lg-6 options"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("IncludePDFInvoice"))+":")]),e("div",{staticClass:"custom-control custom-checkbox"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.includePdf,expression:"form.includePdf"}],staticClass:"custom-control-input",staticStyle:{display:"none"},attrs:{type:"checkbox",name:"IncludePdf",id:"chk_12"},domProps:{checked:Array.isArray(t.form.includePdf)?t._i(t.form.includePdf,null)>-1:t.form.includePdf},on:{change:function(e){var a=t.form.includePdf,i=e.target,s=!!i.checked;if(Array.isArray(a)){var n=null,l=t._i(a,n);i.checked?l<0&&t.$set(t.form,"includePdf",a.concat([n])):l>-1&&t.$set(t.form,"includePdf",a.slice(0,l).concat(a.slice(l+1)))}else t.$set(t.form,"includePdf",s)}}}),e("label",{staticClass:"custom-control-label universal-custom-control-label pt-1",attrs:{for:"chk_12"}})])])]),e("div",{staticClass:"col-sm-12 col-lg-12"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("Message"))+":")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.Message,expression:"form.Message"}],staticClass:"form-control",attrs:{placeholder:"Type your description here",maxlength:"500"},domProps:{value:t.form.Message},on:{change:t.testLength,keyup:t.testLength,paste:t.testLength,input:function(e){e.target.composing||t.$set(t.form,"Message",e.target.value)}}})])])]),e("div",{staticClass:"row flex-row-reverse"},[e("div",{staticClass:"col-lg-12 text-right"},[e("a",{staticClass:"btn btn-success text-white",staticStyle:{cursor:"pointer"},attrs:{title:"Send",id:"aSendBill"},on:{click:t.sendInvoice}},[e("i",{staticClass:"fa fa-send pr-2"}),t._v("Send")]),e("a",{staticClass:"btn btn-danger text-white",staticStyle:{cursor:"pointer","margin-left":"6px"},attrs:{title:"Cancel",id:"aCancelBill"},on:{click:t.Close}},[e("i",{staticClass:"fa fa-close pr-2"}),t._v("Cancel")])])])])])])])],1)])},s=[],n=(a("14d9"),a("9769")),l={props:{BillId:{type:Number},InvoiceBillId:{type:String}},computed:{UpdateEmailsArray(){return this.emails?this.emails.length:0}},data(){return{UserName:this.GetUserInfo.Name,form:{BillId:this.BillId,Reciepients:"",Subject:null,Message:null,SendMeCopy:!1,IncludePdf:!1,UserId:this.GetUserInfo.ID,Name:null,Email:null,ReportType:"",ReportName:"TalygenInvoice",IsDetail:null,IsSummary:null,InvoiceTo:1,CompanyName:null,SubModuleCode:null,TemplateName:null},isEditing:!1,editableRecipient:"",isLoading:!1,emails:[],nextId:2,currentEditingIndex:null,subjectError:""}},created(){this.fetchData(),this.InvoiceBillId},methods:{async fetchData(){const t=await n["a"].Send("id="+this.BillId);if(null!=t.data){let a=t.data[0];this.form.Email=a.EMAIL_ID,this.form.InvoiceTo=a.INVOICE_TO,this.form.CompanyName=a.COMPANY_NAME,this.form.UserId=a.USER_ID;var e={id:0,email:a.EMAIL_ID,isEditing:!1};this.emails.push(e)}},editRecipient(t){this.emails[t].isEditing=!this.emails[t].isEditing},updateRecipient(){2===this.form.invoiceTo?this.form.companyName=this.editableRecipient:this.form.email=this.editableRecipient,this.isEditing=!1},addNewRecipient(){this.$refs.emailRecipient.validate().then(t=>{t?this.emails.push({id:this.nextId++,email:"",isEditing:!0}):console.log("Validation failed")}).catch(t=>{console.error("Validation error: ",t)})},deleteRecipient(t){this.emails.splice(t,1)},testLength(t){t.target.value.length>500&&(t.target.value=t.target.value.substring(0,500))},Close(){var t=this;t.$parent.isSendBill=!1},validateEmail(t){const e=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/;return e.test(t)},validateSubject(){return this.form.Subject&&""!==this.form.Subject.trim()?(this.subjectError="",!0):(this.subjectError="Subject is required.",!1)},async sendInvoice(){let t=this;if(t.isLoading=!0,!this.validateSubject())return;const e=this.emails.map(t=>t.email).join(",");this.form.Reciepients=e;try{const e=await n["a"].SendInvoice(JSON.stringify(this.form));"Success"==e.data.status?(t.isLoading=!1,t.ShowAlert(t.$t("Invoice sent successfully!"),"success"),t.Close()):(t.isLoading=!1,console.error("API error:",e.data))}catch(a){console.error("Request failed",a)}}}},o=l,r=a("2877"),c=Object(r["a"])(o,i,s,!1,null,null,null);e["a"]=c.exports}}]);
//# sourceMappingURL=chunk-57105345.js.map