(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0bb1f2"],{"39b8":function(e,a,t){"use strict";t.r(a);var i=function(){var e=this,a=e._self._c;return a("div",[e.IsShow?a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12 padding-t_8"},[a("div",{staticClass:"theme-primary partition-full"},[a("span",{staticClass:"p-name text-white"},[e._v(" "+e._s(e.$t("AddClient"))+": ")]),a("span",{staticClass:"float-right"},[a("RouterLink",{staticClass:"p-action-btn text-white float-right",attrs:{to:"/Client/Index"}},[a("em",{staticClass:"fa fa-angle-double-left"}),a("br"),e._v(" "+e._s(e.$t("BacktoList"))+" ")])],1)])])]):e._e(),a("div",{staticClass:"border p-3"},[a("Form",{ref:"LeadForm"},[a("dynamic-form",{ref:"ManageClientForm",attrs:{buttons:e.buttons,schema:e.FormSchema},on:{OnSubmit:e.saveForm}})],1)],1)])},n=[],l=(t("14d9"),t("b7ef"),t("9769")),s={props:{ClientData:{type:Object,required:!0}},data(){return{IsShow:!0,FormSchema:[],fileMulitpleData:[],buttons:[{type:"submit",class:"btn btn-success AddLeadDetail_a",text:"<i class='fa fa-save pr-2'></i>Save"},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Cancel",onClick:this.onCancel,isVisible:!0}]}},created(){var e=this;e.IsShow=!(e.$route.params.id>0),e.getForm()},methods:{onCancel:function(){var e=this;e.$router.push({name:"ClientListing"})},getForm(){var e=this;e.isLoading=!0;var a=`recordId=${e.$route.params.id}&moduleName=Company&subModuleCode=Client&langCode=en`;l["a"].GetDynamicForm(a).then((function(a){null!=a&&null!=a.data&&(e.FormSchema=e.$refs.ManageClientForm.ConvertCustomFieldIntoDynamicFormObj(a.data.data),e.FormSchema.forEach((a,t)=>{a.Data.forEach(async(a,t)=>{if("is_existing_account"==a.name&&""==a.value&&(a.value="1"),"user_type_id"==a.name&&""==a.value&&(a.value=4),"email_id"==a.name&&(a.disabled=!0,a.value=""==a.value?e.$route.params.email:a.value),"status_id"==a.name&&(a.value=1001),"client_type"==a.name&&""==a.value&&(a.value="individual"),"avatar"==a.name){a.showLabel=!1,a.config={maxSize:5,accept:[{fileType:"jpg",iconClass:"fa-file-image-o"},{fileType:"jpeg",iconClass:"fa-file-image-o"},{fileType:"png",iconClass:"fa-file-image-o"},{fileType:"gif",iconClass:"fa-file-image-o"},{fileType:"bmp",iconClass:"fa-file-image-o"}],multiple:!1,showSelectedFiles:[],onDeleteSelectedFiles:e.onDeleteSelectedFiles,onClickSelectedFiles:e.onClickSelectedFiles};var i=[];if(""!=a.value){var n={attachmentId:0,attachmentName:JSON.parse(a.value)[0].AttchmentName,attachmentPath:JSON.parse(a.value)[0].AttachmentPath,attachmentDesc:JSON.parse(a.value)[0].AttachmentDesc};i.push(n),i.length>0&&a.config.showSelectedFiles.push(...i)}}a.config.onChange=e.onChangeEventForFields})}),e.isLoading=!1)}))},onDeleteSelectedFiles:function(){var e=this;e.FormSchema.forEach((a,t)=>{a.Data.forEach(async(a,t)=>{"avatar"==a.name&&(e.$delete(a.config,"showSelectedFiles"),e.fileMulitpleData=[])})})},onChangeEventForFields(e,a,t){"avatar"==a.name&&this.GetBase64String(a.value),"is_existing_account"==a.name&&("0"==a.value?(this.$refs.ManageClientForm.updateProperty("parent_id","visibility",!1),this.$refs.ManageClientForm.updateProperty("account_name","visibility",!0)):(this.$refs.ManageClientForm.updateProperty("parent_id","visibility",!0),this.$refs.ManageClientForm.updateProperty("account_name","visibility",!1)))},GetBase64String(e){try{var a=this,t=e[0],i=new FileReader;let n={};i.onload=function(e){return function(e){var i=e.target.result,l=window.btoa(i),s=t.name;a.fileName=s;var o=s.lastIndexOf("."),r=s.substring(o+1,s.length);a.fileExt+="."+r;var c='{"ContentType":"'+t.type+'","Size":"'+t.size+'","Extension":"'+r+'"}',d=t.size;a.fileSize=d,n.attachement_mime=c,n.fileName=s,n.base64String=l,n.fileSize=t.size,n.contentType=t.type,n.ModuleName="Company",n.SubModuleCode="Client",a.fileMulitpleData.push(n)}}(),i.readAsBinaryString(t)}catch(n){}},saveForm(){var e=this;e.isLoading=!0,e.$refs.ManageClientForm.validateForm.validate().then(a=>{if(a){e.isLoading=!0;var t=e.$refs.ManageClientForm.ConvertDynamicFormObjToCustomFieldObj(e.FormSchema);t.forEach(e=>{"last_name"===e.field_name&&(e.field_value&&""!==e.field_value.trim()||(e.field_value="."))});var i={data:t,moduleCode:"Company",subModuleCode:"Client",attachmentData:e.fileMulitpleData.length>0?e.fileMulitpleData:null};l["a"].SaveDynamicForm(JSON.stringify(i)).then((function(a){if(null!=a&&null!=a.data&&"Success"==a.data[0].Status)if(e.isLoading=!1,e.$route.params.id>0)e.ShowAlert(e.$t("UpdatedSuccess",[e.$t("Client")]),"success",!0,e.$t("Alert")),e.onCancel();else if("DUPLICATE"==a.data[0].Value.MSG)e.ShowAlert(e.$t("AlreadyExists",[e.$t("Email")]),"warning",!0,e.$t("Alert"));else{e.ShowAlert(e.$t("AddedSuccess",[e.$t("Client")]),"success",!0,e.$t("Alert"));var t="User_Id="+a.data[0].Value.MAIN_ID;l["a"].SendEmailClient(t).then(e=>{}),e.onCancel()}})),e.isLoading=!1}})}}},o=s,r=t("2877"),c=Object(r["a"])(o,i,n,!1,null,null,null);a["default"]=c.exports}}]);
//# sourceMappingURL=chunk-2d0bb1f2.js.map