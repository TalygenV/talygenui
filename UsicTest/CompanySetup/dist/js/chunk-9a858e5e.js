(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9a858e5e","chunk-3464d8e4","chunk-476db05c","chunk-2d0bb1f2"],{"00c5":function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,".switch.dynamic-form{width:74px}.slider.round.toggle-no .slider-no{padding-left:6px}",""]),t.exports=e},"0194":function(t,e,a){var i=a("438e");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("e66d6d36",i,!0,{sourceMap:!1,shadowMode:!1})},"0265":function(t,e,a){"use strict";a("64e7")},"04e7":function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("Comment")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("dynamic-form",{ref:"defaultStatus",attrs:{lang:"en",buttons:t.buttons,schema:t.FormSchema},on:{OnSubmit:t.onSubmit}})],1)])])])],1)},s=[],n=(a("14d9"),a("9769")),l={props:{MappingId:{type:Object,required:!0},type:{type:String,required:!0},planNamesStr:{type:String,required:!0}},data(){return{isLoading:!1,FormSchema:[{layoutType:"single",Data:[{astype:"SelectField",label:this.$t("Status"),name:"Status",value:"",placeholder:"Status",config:{options:[]},validationRules:{required:!0}},{astype:"TextAreaField",label:this.$t("Comment"),name:"Comment",value:"",placeholder:this.$t("Enter Comment"),validationRules:{required:!0},disabled:!1}]}],buttons:[{type:"submit",class:"btn btn-success",text:"<i class='fa fa-save pr-2'></i>Save",isVisible:!0},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Cancel",onClick:this.Close}],companyId:null,userId:null}},created:function(){var t=this;t.userId=t.GetUserInfo.ID,t.companyId=t.GetUserInfo.CompanyId,t.GetStatusList()},methods:{GetStatusList(){var t=this;let e="id=&moduleName=Billing&type=Subscription_Status&search=&refId=";n["a"].GetDDLData(e).then(e=>{""!=e.data&&null!=e.data&&(t.getprojectlist=e.data.DATA,t.getprojectlist.forEach(e=>{t.FormSchema[0].Data[0].config.options.push({value:e.value,name:e.name})}),t.$refs.defaultStatus.UpdateKeyValue())})},onSubmit(t,e){var a=this,i="";a.getprojectlist.forEach((function(e){e.value==t.Status&&(i=e.name)}));const s={ID:a.MappingId,StatusId:t.Status,IsFor:"TALYGEN_CLIENT_PLAN_Mapping",Module:"Billing",Submodule:"Subscription",Comment:t.Comment,StatusName:i,PlanName:a.planNamesStr};n["a"].CommonUpdateStatus(JSON.stringify(s)).then(t=>{var e;"Success"===(null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.status)?(a.ShowAlert(a.$t("RecordUpdatedSuccessfully"),"success",a.$t("Alert")),this.Close(),"Subscription"==a.type?this.$parent.fetchSubscriptions():this.$parent.FetchData()):this.ShowAlert(this.$t("UnknownErrorOccur"),"failure",!0,this.$t("Alert"))})},Close:function(){this.$parent.IsComment=!1}}},o=l,r=a("2877"),c=Object(r["a"])(o,i,s,!1,null,null,null);e["a"]=c.exports},"0699":function(t,e,a){"use strict";a("e94c")},"0e46":function(t,e,a){var i=a("da52");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("a6136b8e",i,!0,{sourceMap:!1,shadowMode:!1})},"0fb6":function(t,e,a){var i=a("3a0e");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("b9182508",i,!0,{sourceMap:!1,shadowMode:!1})},"0fef":function(t,e,a){var i=a("c39d");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("2eeb7068",i,!0,{sourceMap:!1,shadowMode:!1})},"11a4":function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,".plan-details,.plan-info{margin-bottom:20px}.plan-info p{margin:5px 0}.plan-details table{width:100%;border-collapse:collapse;margin-top:10px}.plan-details td,.plan-details th{border:1px solid #ddd;padding:8px;text-align:left}.plan-details th{background-color:#f2f2f2}.total{font-weight:700}.bg-light-custom{background:#efefef}",""]),t.exports=e},1465:function(t,e,a){var i=a("2f95");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("625bb8ca",i,!0,{sourceMap:!1,shadowMode:!1})},1673:function(t,e,a){"use strict";a("aa7f")},"1afd":function(t,e,a){var i=a("fea2");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("48b9df42",i,!0,{sourceMap:!1,shadowMode:!1})},"1ecc":function(t,e,a){var i=a("f16f");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("ff1e9088",i,!0,{sourceMap:!1,shadowMode:!1})},"248d":function(t,e,a){"use strict";a("ca61")},"2f95":function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,".multiselect--active .multiselect__tags input{display:block}",""]),t.exports=e},"32e2":function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,".table .position-relative .info-mobile-view{top:-32px;right:-8px}",""]),t.exports=e},"34e8":function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"border col-lg-12 pt-3 pb-3"},[e("dynamic-form",{ref:"refCommunication",attrs:{lang:"en",mandatorytext:t.MandatoryString,buttons:t.buttons,schema:t.FormSchema},on:{OnSubmit:t.onSubmit}})],1),e("div",{staticClass:"listing mt-3"},[e("div",{staticClass:"table-responsive"},[e("table",{staticClass:"table table-bordered dt-responsive nowrap mt-0",attrs:{id:"Addresslist"}},[e("thead",{staticClass:"thead-bg"},[e("tr",[t._m(0),t._m(1),e("th",{staticClass:"text-left"},[e("span",[t._v(t._s(t.$t("CommunicationType")))])]),e("th",{staticClass:"text-left"},[e("span",[t._v(t._s(t.$t("AddressOrScreenName")))])]),e("th",{staticClass:"text-left"},[e("span",[t._v(t._s(t.$t("NotesDescription")))])]),e("th",{staticClass:"text-center"},[e("span",[t._v(t._s(t.$t("IsinCompanyDirectory")))])]),e("th",{staticClass:"text-center"},[e("span",[t._v(t._s(t.$t("Edit")))])]),e("th",{staticClass:"text-center"},[e("span",[t._v(t._s(t.$t("Delete")))])])])]),e("tbody",[0===t.EmailData.data.length?e("tr",[e("td",{staticClass:"text-danger text-center no-record",attrs:{colspan:"8"}},[t._v("No Record Found")])]):t._e(),t._l(t.EmailData.data,(function(a,i){return e("tr",{key:a.ROWNUMBER},[t._m(2,!0),e("td",{staticClass:"text-center"},[t._v(t._s(i+1))]),e("td",{staticClass:"text-left"},[t._v(t._s(a.CARRIER_TYPE_NAME))]),e("td",{staticClass:"text-left"},[t._v(t._s(a.CARRIER_VALUE))]),e("td",{staticClass:"text-left"},[t._v(t._s(a.USER_EMAIL_DESC))]),e("td",{staticClass:"text-center"},[t._v(t._s(a.ADD_TO_DIRECTORY?"Yes":"No"))]),e("td",{staticClass:"text-center single-action"},[e("a",{staticClass:"enable",attrs:{"data-placement":"left",href:"javascript:;","data-toggle-tooltip":"tooltip","data-original-title":"Edit"},on:{click:function(e){return t.Edit(a)}}},[e("em",{staticClass:"fa fa-pencil text-success action-icon"})])]),e("td",{staticClass:"text-center single-action"},[e("a",{class:{enable:!0,disabled:t.isDiabled},attrs:{"data-placement":"left",href:"javascript:;","data-toggle-tooltip":"tooltip","data-original-title":"Delete","aria-describedby":"tooltip845041"},on:{click:function(e){return t.Delete(a)}}},[e("em",{staticClass:"fa fa-trash action-icon text-danger"})])])])}))],2)])])])])},s=[function(){var t=this,e=t._self._c;return e("th",{staticClass:"text-center",staticStyle:{width:"3% !important"}},[e("div",{staticClass:"custom-control custom-checkbox"},[e("input",{staticClass:"custom-control-input",staticStyle:{display:"none"},attrs:{type:"checkbox",id:"chkAll_5",name:"checkbox"}}),e("label",{staticClass:"custom-control-label universal-custom-control-label pt-1",attrs:{for:"chkAll_5"}})])])},function(){var t=this,e=t._self._c;return e("th",{staticClass:"text-center"},[e("span",[t._v("#")])])},function(){var t=this,e=t._self._c;return e("td",{staticClass:"text-center"},[e("div",[e("div",{staticClass:"custom-control custom-checkbox"},[e("input",{staticClass:"chkItems custom-control-input",staticStyle:{display:"none"},attrs:{type:"checkbox",value:"80720",name:"membercheckbox",id:"chk_6"}}),e("label",{staticClass:"custom-control-label universal-custom-control-label pt-1",attrs:{for:"chk_6"}})])])])}],n=(a("14d9"),a("9769")),l={components:{},props:{GetConfiguration:{type:Array},IsClient:{type:String}},data(){return{EmailData:[],MandatoryString:this.$t("MandatoryString"),FormSchema:[{layoutType:"triple",Data:[{astype:"SelectField",label:this.$t("CommunicationType"),name:"CommunicationType",value:"",placeholder:"",validationRules:{required:!0,max:250},config:{options:[]}},{astype:"TextField",label:this.$t("AddressOrScreenName"),name:"AddressScreenName",value:"",placeholder:"",validationRules:{required:!0}},{astype:"TextField",label:this.$t("NotesDescription"),name:"NoteDescription",value:"",placeholder:"",disabled:!1,validationRules:{required:!1}}]},{layoutType:"triple",Data:[{astype:"toggleField",label:this.$t("IsinCompanyDirectory"),name:"CompanyDirectory",value:"",placeholder:""},{astype:"toggleField",label:this.$t("VisibleToClient"),name:"VisibleToClient",value:"",placeholder:"",config:{onChange:this.visibleToClient}}]}],buttons:[{type:"submit",class:"btn btn-success",text:"<i class='fa fa-save pr-2'></i>Save"},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Cancel",onClick:this.onCancel}],CommunicationTypes:[],pageNo:1,pageSize:10,EmailId:0,isDiabled:!1}},created(){var t=this;t.getCommunicationTypes(),t.FetchData(),"Client"==t.IsClient?t.FormSchema[1].Data[1].visibility=!1:t.FormSchema[1].Data[1].visibility=!0},methods:{async getCommunicationTypes(){try{var t=this;await n["a"].GetCommunicationTypes().then(e=>{t.CommunicationTypes=e.data,t.CommunicationTypes.length>0&&(t.CommunicationTypes.forEach((e,a)=>{t.FormSchema[0].Data[0].config.options.push({name:e.text,value:e.value})}),t.$refs.refCommunication.UpdateKeyValue())})}catch(e){console.error("Error in getCommunicationTypes:",e)}},FetchData:function(){var t=this;t.isLoading=!0;var e=`pageNum=${t.pageNo}&pageSize=${t.pageSize}&sortBy=&sortExp=&userId=${t.GetConfiguration.user_id}`;n["a"].GetUserEmailList(e).then((function(e){t.EmailData=JSON.parse(e.data)}))},Edit:function(t){var e=this;e.EmailId=t.USER_EMAIL_ID,e.FormSchema[0].Data[0].value=t.CARRIER_TYPE_ID,e.FormSchema[0].Data[1].value=t.CARRIER_VALUE,e.FormSchema[0].Data[2].value=t.USER_EMAIL_DESC,e.FormSchema[1].Data[0].value=t.ADD_TO_DIRECTORY,e.FormSchema[1].Data[1].value=t.IS_VISIBLE,e.isDiabled=!0},Delete:function(t){var e=this;e.EmailId=t.USER_EMAIL_ID,e.EmailId>0?e.confirmR(e.$t("ConfirmDelete"),!0,e.$t("Delete")+"  "+e.$t("AddtionalEmail"),(function(){var t=`EmailId=${e.EmailId}&userId=${e.GetConfiguration.user_id}`;n["a"].DeleteAddtionalEmail(t).then((function(t){200==t.status?(e.ShowAlert(e.$t("DeletedSuccess",[e.$t("Record")]),"success",!0,e.$t("Alert")),e.FetchData()):e.ShowAlert(e.$t("DeletedError",[e.$t("Record")]),"failure",!0,e.$t("Alert"))}))})):e.ShowAlert(e.$t("Selectanyrecordtodelete")),e.isLoading=!1},visibleToClient(){var t=this;t.confirmR(t.$t("Are you sure you want to make this Visible to Client?"),!0,!1,(function(t){}),(function(){t.cancelAction()}))},cancelAction(){this.FormSchema[1].Data[1].value=1!=this.FormSchema[1].Data[1].value},async onSubmit(t){var e=this;e.isLoading=!0;let a={EmailId:e.EmailId,CommunicationType:t.CommunicationType,AddressScreenName:t.AddressScreenName,NoteDescription:t.NoteDescription,AddToDirectory:t.CompanyDirectory,VisibleTo:""!=t.VisibleToClient&&t.VisibleToClient,configUserId:e.GetConfiguration.user_id};var i=JSON.stringify(a);await n["a"].AddUpdateAdditionalEmail(i).then((function(t){null!=t&&null!=t.data&&t.data>0?(e.ShowAlert(e.$t("RecordsSavedSuccessfully"),"success"),e.Clear(),e.FetchData()):(e.ShowAlert(e.$t("UnknownErrorOccur"),"failure",!0,e.$t("Alert")),e.FetchData())})),e.isLoading=!1},onCancel:function(){this.Clear()},Clear:function(){var t=this;t.EmailId=0,t.isDiabled=!1,t.FormSchema[0].Data[0].value="",t.FormSchema[0].Data[1].value="",t.FormSchema[0].Data[2].value="",t.FormSchema[1].Data[0].value="",t.FormSchema[1].Data[1].value="",t.$refs.refCommunication.validateForm.reset()}}},o=l,r=a("2877"),c=Object(r["a"])(o,i,s,!1,null,null,null);e["a"]=c.exports},3621:function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,".discounted{text-decoration:line-through;color:#ffd580}.package-form-data p{padding:0 8px}.package-form-data p label,.package-form-data p span{font-size:14px}.package-form-data p.plantype label{font-weight:500}",""]),t.exports=e},3713:function(t,e,a){"use strict";var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),"Tax"!==t.LayoutType?e("section",[e("div",{staticClass:"col-md-12 p-0"},[e("div",{staticClass:"tab-content"},[e("div",{staticClass:"dynamiccontent_base"},[e("dynamic-form",{ref:"AddTaxCategoryForm",attrs:{lang:"en",buttons:!1,schema:t.FormSchema,mandatorytext:t.MandatoryString},on:{OnSubmit:t.OnSubmit},scopedSlots:t._u([{key:"tgslot-SlabRate",fn:function({data:a}){return[e("div",{staticClass:"container-fluid collapse show p-0",attrs:{id:"collapseOne1"}},[e("div",{staticClass:"listing"},[e("div",{staticClass:"table-responsive"},[e("table",{staticClass:"table table-bordered dt-responsive nowrap mt-0",attrs:{id:"Addresslist"}},[e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",{staticClass:"text-center",attrs:{width:"5%"}},[t._v(" # ")]),e("th",{staticClass:"text-center"},[t._v(" "+t._s(t.$t("AmountFrom"))+" ")]),e("th",{staticClass:"text-center"},[t._v(" "+t._s(t.$t("AmountTo"))+" ")]),e("th",{staticClass:"text-center"},[t._v(" "+t._s(t.$t("TaxRate"))+" ")]),e("th",{staticClass:"text-center"},[t._v(" "+t._s(t.$t("Actions"))+" ")])])]),e("tbody",[0===t.RateData.length?e("tr",[e("td",{staticClass:"text-center text-danger no-record",attrs:{colspan:"8"}},[t._v(" "+t._s(t.$t("NoRecordfound"))+" ")])]):t._l(t.RateData,(function(a,i){return e("tr",{key:i},[e("td",{staticClass:"text-center"},[t._v(t._s(i+1))]),e("td",{staticClass:"text-center"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.AmountFrom,expression:"item.AmountFrom"}],staticClass:"form-control",attrs:{type:"text",disabled:1===t.RateData.length||0===i},domProps:{value:a.AmountFrom},on:{blur:function(e){return t.validateAmounts(i)},input:function(e){e.target.composing||t.$set(a,"AmountFrom",e.target.value)}}})]),e("td",{staticClass:"text-center"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.AmountTo,expression:"item.AmountTo"}],staticClass:"form-control",attrs:{type:"text",disabled:1===t.RateData.length||i===t.RateData.length-1},domProps:{value:a.AmountTo},on:{blur:function(e){return t.validateAmounts(i)},change:function(e){return t.updateNextAmountFrom(i)},input:function(e){e.target.composing||t.$set(a,"AmountTo",e.target.value)}}})]),e("td",{staticClass:"text-center"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.TaxRate,expression:"item.TaxRate"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:a.TaxRate},on:{blur:function(e){return t.formatTaxRate(i)},input:function(e){e.target.composing||t.$set(a,"TaxRate",e.target.value)}}})]),e("td",{staticClass:"text-center"},[0==i?e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.addChild()}}},[e("em",{staticClass:"round-icon-small fa fa-plus bg-success float-none"})]):t._e(),i>0?e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.deleteItem(i)}}},[e("em",{staticClass:"round-icon-small fa fa-trash bg-danger float-none"})]):t._e()])])}))],2)])])])])]}}],null,!1,3641843924)})],1),e("div",{staticClass:"mainfooter_app"},[e("div",{staticClass:"col-lg-12 text-right mt-4"},[t.currentTabIndex>1?e("button",{staticClass:"btn btn-warning float-left",attrs:{title:"Previous"},on:{click:function(e){return t.PreviousButton()}}},[e("i",{staticClass:"fa fa-chevron-left pr-2"}),t._v(" "+t._s(t.$t("Previous"))+" ")]):t._e(),t.tabCount>t.currentTabIndex?e("button",{staticClass:"popupgreenbtn btn skip-btn-clr formbtn widthhalf px-4",attrs:{title:"Skip"},on:{click:function(e){return t.Skip()}}},[t._v(" "+t._s(t.$t("Skip"))+" ")]):t._e(),t.tabCount>t.currentTabIndex?e("button",{staticClass:"popupgreenbtn btn btn-success formbtn widthhalf pr-2",staticStyle:{"margin-left":"5px"},attrs:{type:"button",id:"aGroupTicketSave",title:"","data-toggle-tooltip":"tooltip","data-original-title":"Save"},on:{click:function(e){return t.OnSubmit("SaveAndNext")}}},[e("i",{staticClass:"fa fa-save pr-2"}),t._v(" "+t._s(t.$t("SaveAndNext"))+" ")]):t._e()])])])])]):e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("Tax"))+" "+t._s(t.$t("Category")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.CloseTaxCategory}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("dynamic-form",{ref:"AddTaxCategoryForm",attrs:{lang:"en",buttons:t.buttons,schema:t.FormSchema,mandatorytext:t.MandatoryString},on:{OnSubmit:t.OnSubmit},scopedSlots:t._u([{key:"tgslot-SlabRate",fn:function({data:a}){return[e("div",{staticClass:"container-fluid collapse show p-0",attrs:{id:"collapseOne1"}},[e("div",{staticClass:"listing"},[e("div",{staticClass:"table-responsive"},[e("table",{staticClass:"table table-bordered dt-responsive nowrap mt-0",attrs:{id:"Addresslist"}},[e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",{staticClass:"text-center",attrs:{width:"5%"}},[t._v(" # ")]),e("th",{staticClass:"text-center"},[t._v(" "+t._s(t.$t("AmountFrom"))+" ")]),e("th",{staticClass:"text-center"},[t._v(" "+t._s(t.$t("AmountTo"))+" ")]),e("th",{staticClass:"text-center"},[e("span",{directives:[{name:"show",rawName:"v-show",value:t.isTaxRate,expression:"isTaxRate"}]},[t._v(t._s(t.$t("TaxRates")))]),e("span",{directives:[{name:"show",rawName:"v-show",value:!t.isTaxRate,expression:"!isTaxRate"}]},[t._v(t._s(t.$t("TaxRates"))+"(%)")])]),e("th",{staticClass:"text-center"},[t._v(" "+t._s(t.$t("Actions"))+" ")])])]),e("tbody",[0===t.RateData.length?e("tr",[e("td",{staticClass:"text-center text-danger no-record",attrs:{colspan:"8"}},[t._v(" "+t._s(t.$t("NoRecordfound"))+" ")])]):t._l(t.RateData,(function(a,i){return e("tr",{key:i},[e("td",{staticClass:"text-center"},[t._v(t._s(i+1))]),e("td",{staticClass:"text-center"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.AmountFrom,expression:"item.AmountFrom"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:a.AmountFrom},on:{blur:function(e){return t.validateAmounts(i)},input:function(e){e.target.composing||t.$set(a,"AmountFrom",e.target.value)}}})]),e("td",{staticClass:"text-center"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.AmountTo,expression:"item.AmountTo"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:a.AmountTo},on:{blur:function(e){return t.validateAmounts(i)},change:function(e){return t.updateNextAmountFrom(i)},input:function(e){e.target.composing||t.$set(a,"AmountTo",e.target.value)}}})]),e("td",{staticClass:"text-center"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.TaxRate,expression:"item.TaxRate"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:a.TaxRate},on:{blur:function(e){return t.formatTaxRate(i)},input:function(e){e.target.composing||t.$set(a,"TaxRate",e.target.value)}}})]),e("td",{staticClass:"text-center"},[0==i?e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.addChild()}}},[e("em",{staticClass:"round-icon-small fa fa-plus bg-success float-none"})]):t._e(),i>0?e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.deleteItem(i)}}},[e("em",{staticClass:"round-icon-small fa fa-trash bg-danger float-none"})]):t._e()])])}))],2)])])])])]}}])})],1)])])])],1)},n=[],l=(a("14d9"),a("9769")),o={props:{TaxCategoryData:{type:Object,Required:!0},ClientId:{type:Number,required:!0},LayoutType:{type:String,required:!0},tabCount:0,currentTabIndex:0},data(){return{MandatoryString:"Fields marked with an asterisk (*) are mandatory.",isLoading:!1,TaxCategoryId:0,Type:"",isTaxRate:!0,RateData:[{TaxSlabId:0,AmountFrom:"1.00",AmountTo:"∞",TaxRate:"00.00"}],FormSchema:[{layoutType:"double",Data:[{astype:"TextField",label:this.$t("Tax Category Name"),name:"TaxCategoryName",value:"",disabled:!1,visibility:!0,placeholder:this.$t("Tax Category Name"),validationRules:{required:!0,max:100}},{astype:"SelectField",label:this.$t("Status"),name:"Status",value:"1001",visibility:!0,config:{options:[{name:"Active",value:1001},{name:"InActive",value:1002}]},placeholder:this.$t("Select Status"),validationRules:{required:!0,max:100}},{astype:"DateField",label:this.$t("Effective From "),name:"EffectiveFrom ",value:new Date,visibility:!0,placeholder:this.$t("Effective From"),config:{format:"M/D/YYYY",minDate:new Date,onChange:this.ChangeEffectiveFrom}},{astype:"DateField",label:this.$t("Effective To "),name:"EffectiveTo",value:"",visibility:!0,placeholder:this.$t("Effective To"),config:{format:"M/D/YYYY",minDate:""}},{astype:"SelectField",label:this.$t("Rate Type"),name:"RateType",disabled:!1,value:"",visibility:!0,config:{options:[{name:"Flat",value:"F"},{name:"Percentage",value:"P"}],onChange:this.changeRateLabel},placeholder:this.$t("Select Status"),validationRules:{required:!0,max:100}},{astype:"toggleField",label:this.$t("Tax Slab"),name:"TaxSlab",value:"",disabled:!1,placeholder:"",visibility:!0,config:{onChange:this.ChangeSlabRate}},{astype:"NumericField",label:this.$t("Rate(%)"),name:"Rate",value:"",visibility:!0,placeholder:this.$t("Enter Rate"),validationRules:{required:!0,max:100},config:{onKeyUp:this.validateRatePercentage}}]},{layoutType:"single",Data:[{astype:"SlotField",name:"SlabRate",value:"",visibility:!1,validationRules:{required:!1,max:100}}]},{layoutType:"single",Data:[{astype:"TextAreaField",label:this.$t("Description"),name:"Description",value:"",config:{rows:3},placeholder:this.$t("Enter Tax Description"),validationRules:{required:!1}}]}],buttons:[{type:"submit",class:"btn btn-success",text:"<i class='fa fa-save pr-2'></i>Save"},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Cancel",onClick:this.CloseTaxCategory}]}},created:async function(){var t=this;t.LayoutType,null!=t.TaxCategoryData&&null==t.ClientId&&(t.TaxCategoryId=this.TaxCategoryData,t.Type="Tax_Category",t.TaxCategoryDetails("Tax_Category")),null!=t.TaxCategoryData&&null!=t.ClientId&&(t.TaxCategoryId=this.TaxCategoryData,t.Type="Tax_Client",t.TaxCategoryDetails("Tax_Client"))},methods:{validateRatePercentage:function(t){var e=this,a=e.FormSchema[0].Data[4].value;if("P"==a){const e=t.target;let a=parseFloat(e.value);if(isNaN(a))return;a>100?e.value="":a<0&&(e.value="0")}},ChangeEffectiveFrom(t){var e=t;this.FormSchema[0].Data[3].config.minDate=e},ChangeSlabRate(){var t=this,e=t.FormSchema[0].Data[5].value;e?(t.FormSchema[0].Data[6].visibility=!1,t.FormSchema[1].Data[0].visibility=!0):(t.FormSchema[1].Data[0].visibility=!1,t.FormSchema[0].Data[6].visibility=!0)},addChild(){const t=this.RateData[this.RateData.length-1],e=parseFloat(t.TaxRate);if(isNaN(e)||e<=0)return this.ShowAlert(this.$t("CannotAddNew"),"warning",!0,this.$t("Alert")),!1;this.RateData.push({AmountFrom:"00.00",AmountTo:"∞",TaxRate:"00.00"})},formatTaxRate(t){var e=this,a=e.FormSchema[0].Data[4].value;if("P"==a){const t=event.target;let e=parseFloat(t.value);if(isNaN(e))return;e>100?t.value="":e<0&&(t.value="0")}},updateNextAmountFrom(t){if(t<this.RateData.length-1){const e=parseFloat(this.RateData[t].AmountTo);if(!isNaN(e)){const a=(e+.01).toFixed(2);this.$set(this.RateData[t],"AmountTo",e.toFixed(2)),this.$set(this.RateData[t+1],"AmountFrom",a)}}},validateAmounts(t){const e=this.RateData[t],a=parseFloat(e.AmountFrom),s=parseFloat(e.AmountTo);if(!isNaN(a)&&!isNaN(s)){if(a>s&&(this.ShowAlert(this.$t("AmountFromCannot"),"warning",!0,this.$t("Alert")),i<this.RateData.length-1)){const t=parseFloat(this.RateData[i].AmountTo);if(!isNaN(t)){const e=(t+.01).toFixed(2);this.$set(this.RateData[i+1],"AmountFrom",e)}}if(s<a&&(this.ShowAlert(this.$t("AmountToCannot"),"warning",!0,this.$t("Alert")),this.$set(this.RateData[t],"AmountTo","00.00")),t<this.RateData.length-1){const e=parseFloat(this.RateData[t].AmountTo);if(!isNaN(e)){const a=(e+.01).toFixed(2);this.$set(this.RateData[t],"AmountTo",e.toFixed(2)),this.$set(this.RateData[t+1],"AmountFrom",a)}}}},deleteItem(t){this.RateData.splice(t,1)},CloseTaxCategory:function(){var t=this;t.$emit("CloseTaxCategory")},ReloadTaxCategory(){var t=this;t.$emit("ReloadTaxCategory")},TaxCategoryDetails(t){var e=this;e.isLoading=!0;var a=`TaxCategoryId=${e.TaxCategoryData}&Type=${t}`;l["a"].GetTaxCategoryDetails(a).then((function(t){if(e.isLoading=!1,t.data.result.DATA.length>0){var a=t.data.result.DATA;e.FormSchema[0].Data[0].value=a[0].name,e.FormSchema[0].Data[1].value=a[0].status_id,e.FormSchema[0].Data[2].value=a[0].effective_from,e.FormSchema[0].Data[3].value=a[0].effective_to,e.FormSchema[0].Data[4].value=a[0].rate_type,e.FormSchema[0].Data[5].value=a[0].is_slab_rate,e.FormSchema[0].Data[6].value=a[0].rate,e.FormSchema[2].Data[0].value=a[0].description,a[0].is_slab_rate?(e.FormSchema[0].Data[6].visibility=!1,e.FormSchema[1].Data[0].visibility=!0):(e.FormSchema[1].Data[0].visibility=!1,e.FormSchema[0].Data[6].visibility=!0),"F"==a[0].rate_type?(e.FormSchema[0].Data[6].label=e.$t("Rate"),e.isTaxRate=!0):"P"==a[0].rate_type&&(e.FormSchema[0].Data[6].label=e.$t("Rate(%)"),e.isTaxRate=!1)}t.data.result.SLABDATA.length>0&&(e.RateData=t.data.result.SLABDATA,e.RateData.forEach(t=>{0==t.AmountTo?t.AmountTo="∞":(t.AmountFrom=t.AmountFrom.toFixed(2),t.AmountTo=t.AmountTo.toFixed(2),t.TaxRate=t.TaxRate.toFixed(2))}))}))},changeRateLabel:function(t,e,a){var i=this,s=i.FormSchema[0].Data[4].value;"P"!=s&&"F"!=s||i.RateData.forEach(t=>{t.TaxRate=""}),"F"==e.value?(i.FormSchema[0].Data[6].label=this.$t("Rate"),i.FormSchema[0].Data[6].value="",i.isTaxRate=!0):"P"==e.value&&(i.FormSchema[0].Data[6].label=this.$t("Rate(%)"),i.FormSchema[0].Data[6].value="",i.isTaxRate=!1)},OnSubmit(t){var e,a=this;a.isLoading=!0,a.FormSchema[0].Data[5].value||(a.RateData[0].AmountTo="00.00"),a.RateData.forEach(t=>{"∞"==t.AmountTo&&(t.AmountTo="00.00")});var i={Type:a.Type,TaxCategoryId:a.TaxCategoryId,TaxCategoryName:a.FormSchema[0].Data[0].value,StatusId:a.FormSchema[0].Data[1].value,EffectiveFrom:a.FormSchema[0].Data[2].value,EffectiveTo:a.FormSchema[0].Data[3].value,RateType:a.FormSchema[0].Data[4].value,TaxSlab:a.FormSchema[0].Data[5].value,TaxRate:""==a.FormSchema[0].Data[6].value?"00.00":(Number(null===(e=a.FormSchema)||void 0===e||null===(e=e[0])||void 0===e||null===(e=e.Data)||void 0===e||null===(e=e[6])||void 0===e?void 0:e.value)||0).toFixed(2),TaxSlabData:a.RateData,TaxCategoryDescription:a.FormSchema[2].Data[0].value},s=JSON.stringify(i);l["a"].SaveTaxCategory(s).then((function(e){a.isLoading=!1,e.data.result.DATA.length>0?"UPDATE"==e.data.result.DATA[0].VALUE?(a.ShowAlert(a.$t("UpdatedSuccess",[a.$t("TaxCategory")]),"success",!0,a.$t("Alert")),a.CloseTaxCategory(),a.ReloadTaxCategory(),a.$parent.FetchTaxList()):"EXISTS"==e.data.result.DATA[0].VALUE?a.ShowAlert(a.$t("AlreadyExists",[a.$t("TaxCategory")]),"warning",!0,a.$t("Alert")):(a.ShowAlert(a.$t("AddedSuccess",[a.$t("TaxCategory")]),"success",!0,a.$t("Alert")),a.CloseTaxCategory(),a.ReloadTaxCategory(),"SaveAndNext"==t&&a.$emit("nextTab",!0)):a.ShowAlert(a.$t("UnknownErrorOccur"),"failure",!0,a.$t("Alert"))}))},PreviousButton:function(){var t=this;t.$emit("previousTab")},Skip:function(){var t=this;t.$emit("nextTab",!0)}}},r=o,c=a("2877"),d=Object(c["a"])(r,s,n,!1,null,null,null);e["a"]=d.exports},"384d":function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("section",[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"col-12 p-4 border mt-2 float-left w-100",domProps:{innerHTML:t._s(t.parsedHtml)}}),e("div",{staticClass:"search-btm-btn text-right mt-4"},[e("a",{staticClass:"btn btn-success mr-2",attrs:{href:"javascript:;",title:""},on:{click:t.printInvoice}},[e("i",{staticClass:"fa fa-print pr-2"}),t._v(t._s(t.$t("Print")))]),e("a",{staticClass:"btn btn-info mr-2",attrs:{href:"javascript:;",title:""},on:{click:t.downloadInvoice}},[e("i",{staticClass:"fa fa-download pr-2"}),t._v(t._s(t.$t("DownloadInvoice")))]),"SubscriptionList"!=t.hitFrom?e("a",{staticClass:"btn btn-danger",attrs:{href:"javascript:;",title:""},on:{click:function(e){return t.InvoicebacktoPlanDetails()}}},[e("i",{staticClass:"fa fa-cancel pr-2"}),t._v(t._s(t.$t("BacktoList")))]):t._e()])],1)},s=[],n=(a("d9e2"),a("14d9"),a("8baf")),l=a("62c5"),o=a.n(l),r=a("1321"),c=a.n(r),d=a("9769"),u={components:{VueApexCharts:c.a},props:{Details:{type:Array,required:!0},hitFrom:{type:String,required:!0}},data(){return{invoiceTemplate:"",isLoading:!1,imagepath:"",accountNumber:"",series:[{data:[400,430,448,470,540,580,690,1100,1200,1380]}],chartOptions:{chart:{type:"bar",height:250,toolbar:{show:!1}},plotOptions:{bar:{borderRadius:4,borderRadiusApplication:"end",horizontal:!1}},dataLabels:{enabled:!1},xaxis:{categories:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct"]},yaxis:{title:{text:"Average Kwh/day"}}}}},mounted(){this.generateBarcode(),this.renderChart()},computed:{parsedHtml(){let t=this;return t.isLoading=!0,t.invoiceTemplate?t.invoiceTemplate.replace(/\{\{(.*?)\}\}/g,(e,a)=>{if(setTimeout(()=>{this.isLoading=!1},1e3),t.accountNumber=this.Details[0].accountnumber,"items"==a.trim()){console.log("items match found",e);let t=this.Details[0]["itemlist"],a="";if(null!=t){t.forEach((function(t){a+="<tr><td>"+t.productname+"</td><td style='text-align:center;'>"+t.consumption+"</td><td>"+t.slabrate+"</td><td>"+t.TotalBillingDays+"</td><td>"+t.PF+"</td><td>"+t.totalamount+"</td></tr>"}));const i=a;return void 0!==i?i:e}return""}if("itemsutilitybilling"==a.trim()){let t=this.Details[0]["itemlist"],a="";if(null!=t){t.forEach((function(t){a+="<tr><td>"+t.productname+"</td><td style='text-align:center;'>"+t.consumption+"</td><td>"+t.slabrate+"</td><td>"+t.totalamount+"</td></tr>"}));const i=a;return void 0!==i?i:e}return""}if("ItemBillingService"==a.trim()){let t=this.Details[0]["BillServiceData"],a="";if(null!=t){t.forEach((function(t){a+="<tr><td style='vertical-align: top; font-size: 13px; line-height: 18px;'>"+t.productname+"</td><td style='vertical-align: top; font-size: 13px; line-height: 18px; text-align: right; '>"+t.consumption+"</td><td style='vertical-align: top; font-size: 13px; line-height: 18px; text-align: right; '>"+t.slabrate+"</td><td style='vertical-align: top; font-size: 13px; line-height: 18px; text-align: right; '>"+t.totalamount+"</td></tr>"}));const i=a;return void 0!==i?i:e}return""}if("ItemBillingSubsidy"==a.trim()){let t=this.Details[0]["BillSubsidyData"],a="";if(null!=t){t.forEach((function(t){a+="<tr><td style='vertical-align: top; font-size: 13px; line-height: 18px;'>"+t.productname+"</td><td style='vertical-align: top; font-size: 13px; line-height: 18px; text-align: right;'>"+t.consumption+"</td><td style='vertical-align: top; font-size: 13px; line-height: 18px; text-align: right; '>"+t.slabrate+"</td><td style='vertical-align: top; font-size: 13px; line-height: 18px; text-align: right;'>"+t.totalamount+"</td></tr>"}));const i=a;return void 0!==i?i:e}return""}if("ItemBillingTax"==a.trim()){let t=this.Details[0]["BillTaxData"],a="";if(null!=t){t.forEach((function(t){a+="<tr><td style='vertical-align: top; font-size: 13px; line-height: 18px;'>"+t.adjustment_name+" ("+t.adjustment_percentage+")</td><td style='vertical-align: top; font-size: 13px; line-height: 18px; text-align: right;'></td><td style='vertical-align: top; font-size: 13px; line-height: 18px; text-align: right;'></td><td style='vertical-align: top; font-size: 13px; line-height: 18px; text-align: right;'>"+t.adjustment_amount+"</td></tr>"}));const i=a;return void 0!==i?i:e}return""}if("ItemLastPayment"==a.trim()){let t=this.Details[0]["SomeLastPayment"],a="";if(null!=t){t.forEach((function(t){a+="<tr><td style='vertical-align: top; font-size: 13px; line-height: 18px;'>"+t.bill_number+"</td><td style='vertical-align: top; font-size: 13px; line-height: 18px;'>"+t.payment_date+"</td><td style='vertical-align: top; font-size: 13px; line-height: 18px; text-align: right;'>"+t.Transaction_Reference_Number+"</td><td style='vertical-align: top; font-size: 13px; line-height: 18px; text-align: right;'>"+t.paymentamount+"</td></tr>"}));const i=a;return void 0!==i?i:e}return""}if("currentchargesitems"==a.trim()){let t=this.Details[0]["itemlist"];if(null!=t){let a="<div class='payment-advice'><table width='100%' border='0' cellpadding='0' cellspacing='0'><tbody>  ";t.forEach((function(t){a+="<tr><td style='padding:5px;'>"+t.productname+"</td><td style='text-align:right;'>"+t.totalamount+"</td></tr>"})),a+=" </tbody></table></div>";const i=a;return void 0!==i?i:e}return""}if("currentchargesGSTitems"==a.trim()){let t=this.Details[0]["GSTitemlist"];if(null!=t){let a=" ";t.forEach((function(t){a+="<td style='padding:10px 10px 0px 10px;font-size: 0.9em;font-weight:600;border:none;'>"+t.productname+"</td><td style='text-align:right;font-size:0.9em;font-weight:600;padding:10px 5px 0px 10px;border:none;'>"+t.totalamount+"</td>"}));const i=a;return void 0!==i?i:e}return""}if("currentTaxItems"==a.trim()){let t=this.Details[0]["GSTitemlist"];if(null!=t){let a=" ";t.forEach((function(t){a+="<td style='padding:10px 10px 0px 10px;font-size: 0.9em;font-weight:600;border:none;'>"+t.productname+"</td><td style='text-align:right;font-size:0.9em;font-weight:600;padding:10px 5px 0px 10px;border:none;'>"+t.totalamount+"</td>"}));const i=a;return void 0!==i?i:e}return""}if("currentchargesDiscountitems"==a.trim()){let t=this.Details[0]["Discountitemlist"];if(null!=t){let a=" ";t.forEach((function(t){a+="<td style='padding:10px 10px 0px 10px;font-size: 0.9em;font-weight:600;border:none; '>"+t.productname+"</td><td style='text-align:right;font-size: 0.9em;font-weight:600;padding:10px 5px 0px 10px;border:none;'>"+t.totalamount+"</td>"}));const i=a;return void 0!==i?i:e}return""}if("currentDiscountItems"==a.trim()){let t=this.Details[0]["Discountitemlist"];if(null!=t){let a=" ";t.forEach((function(t){a+="<td style='padding:10px 10px 0px 10px;font-size: 0.9em;font-weight:600;border:none; '>"+t.productname+"</td><td style='text-align:right;font-size: 0.9em;font-weight:600;padding:10px 5px 0px 10px;border:none;'>"+t.totalamount+"</td>"}));const i=a;return void 0!==i?i:e}return""}if("discountItems"==a.trim()){let t=this.Details[0]["discountitemlist"];if(null!=t){let a=" ";t.forEach((function(t){a+="<table width='100%'><tr><td style='padding:10px 10px 0px 10px;font-size: 0.9em;font-weight:600;border:none; '>"+t.productname+"</td><td style='width:200px; text-align:right;font-size: 0.9em;font-weight:400;padding:10px 5px 0px 10px;border:none;'>"+t.slabrate+"</td></tr></table>"}));const i=a;return void 0!==i?i:e}return""}if("taxItems"==a.trim()){let t=this.Details[0]["taxItems"];if(null!=t){let a=" ";t.forEach((function(t){a+="<table width='100%'><tr><td style='padding:10px 10px 0px 10px;font-size: 0.9em;font-weight:600;border:none; '>"+t.productname+"</td><td style='width:200px; text-align:right;font-size: 0.9em;font-weight:400;padding:10px 5px 0px 10px;border:none;'>"+t.slabrate+"</td></tr></table>"}));const i=a;return void 0!==i?i:e}return""}if("chart"===a.trim())return"<div id='invoiceChart'></div>";if("barcode"==a.trim()){let t="";t+="<svg id='accountNoBarCode'></svg>";const a=t;return void 0!==a?a:e}if("totalitemamount"==a.trim()){var i;const t=null===(i=this.Details[0]["totalitemsamount"])||void 0===i?void 0:i[0];if(t){const e=t[a.trim()];return void 0!==e&&null!==e?e:""}}else if("totalAmountAfterGST"==a.trim()){var s;const t=null===(s=this.Details[0]["totalAmountsAfterGST"])||void 0===s?void 0:s[0];if(t){const e=t[a.trim()];return void 0!==e&&null!==e?e:""}}else if("totalAmountAfterDiscount"==a.trim()){var n;const t=null===(n=this.Details[0]["totalAmountsAfterDiscount"])||void 0===n?void 0:n[0];if(t){const e=t[a.trim()];return void 0!==e&&null!==e?e:""}}else{if("slabs"==a.trim()){let t=this.Details[0]["slabdetails"],a="";if(null!=t){t.forEach((function(t){a+="<tr><td>"+t.srno+"</td><td>"+t.slabes+"</td><td>"+t.slabrate+"</td></tr>"}));const i=a;return void 0!==i?i:e}return" <tr><td> No Records Found  </td></tr>  "}if("paymenthistory"==a.trim()){let t=this.Details[0]["paymenthistory"],a="";if(null!=t){t.forEach((function(t){a+="<tr><td>"+t.paymentdate+"</td><td style='text-align: right;'>"+t.consumption+"</td><td style='text-align: right;'>"+t.nettotal+"</td><td style='text-align: right;'>"+t.amountdue+"</td><td style='text-align: right;'>"+t.paymentamount+"</td></tr>"}));const i=a;return void 0!==i?i:e}return" <tr><td colspan='5' align='center' style='color:#ad0101; text-align:center;'> No Records Found  </td></tr>  "}if("servicedetails"==a.trim()){let t=this.Details[0]["servicedetails"],a="";if(null!=t){t.forEach((function(t){a+="<tr><td>"+t.ServiceName+"</td><td style='text-align: right;'>"+t.Rate+"</td></tr>"}));const i=a;return void 0!==i?i:e}}else if("GST_Adjustment"==a.trim()){let t=this.Details[0]["adjustments"],a="";if(null!=t){t.forEach((function(t){a+="<tr><td>"+t.adjustment_name+" :</td><td style='text-align: right;'>"+t.adjustment_amount+"</td></td></tr>"}));const i=a;return void 0!==i?i:e}}else if("slab_Unit"==a.trim()){let t=this.Details[0]["slabdatadetails"],a="";if(null!=t){t.forEach((function(t){a+=t.slabrate}));const i=a;return void 0!==i?i:e}}else{if("transaction_history"==a.trim()){let t=this.Details[0]["transaction_history"],a="";if(null!=t){t.forEach((function(t){a+=`<tr> <td bgcolor="#fff" align="left" valign="top" style="vertical-align: top; color: #000; font-family: Arial, Helvetica, sans-serif; font-size: 0.9em;text-align:left;width:150px"> ${t.paymentdate}</td>\n                <td bgcolor="#fff" align="left" valign="top" style="vertical-align: top; color: #000; font-family: Arial, Helvetica, sans-serif; font-size: 0.9em;text-align:left;width:150px">${t.paymentamount}</td>\n                <td bgcolor="#fff" align="left" valign="top" style="vertical-align: top; color: #000; font-family: Arial, Helvetica, sans-serif; font-size: 0.9em;text-align:left;width:150px">${t.status}</td>\n              </tr>`}));const i=a;return void 0!==i?i:e}return" <tr><td colspan='5' align='center' style='color:#ad0101; text-align:center;'> No Records Found  </td></tr>  "}if("transaction_data"==a.trim()){let t=this.Details[0]["transaction_data"],a="";if(null!=t){t.forEach((function(t){a+=`<tr> <td bgcolor="#fff" align="left" valign="top" style="vertical-align: top; color: #000; font-family: Arial, Helvetica, sans-serif; font-size: 0.9em;text-align:left;width:150px"> ${t.paymentdate}</td>\n                <td bgcolor="#fff" align="left" valign="top" style="vertical-align: top; color: #000; font-family: Arial, Helvetica, sans-serif; font-size: 0.9em;text-align:left;width:150px">${t.billnumber}</td>\n                <td bgcolor="#fff" align="left" valign="top" style="vertical-align: top; color: #000; font-family: Arial, Helvetica, sans-serif; font-size: 0.9em;text-align:left;width:150px">${t.paymentamount}</td>\n              </tr>`}));const i=a;return void 0!==i?i:e}return" <tr><td colspan='5' align='center' style='color:#ad0101; text-align:center;'> No Records Found  </td></tr>  "}if("adjustments"!=a.trim()){if(["meterno","currentreading","previousreading","difference","readingdate","billdays","multiplyfactor","consumption","billedunit","sanctionedload","meterreadingstartdate","meterreadingenddate","readingdifference","metertype","meterrate","statuscode","Energisation_Date"].includes(a.trim())){var l;const t=null===(l=this.Details[0]["meterreading"])||void 0===l?void 0:l[0];if(console.log("First meter reading:",t),null!=t){const e=t[a.trim()];return void 0!==e&&null!==e?e:""}return""}if(["lastbillamount","paymentamount","additional_activity","balancebeforenewcharges","newcharges","newchargesdueby","amount_of_last_bill","payment_received","balance_before_new_charges","DueAmountNew","payment_date"].includes(a.trim())){var o;const t=null===(o=this.Details[0]["lastpaymentdetails"])||void 0===o?void 0:o[0];if(null!=t){const e=t[a.trim()];return void 0!==e&&null!==e?e:""}return""}if(["month_names","monthly_consumption","monthly_cost","year","next_year"].includes(a.trim())){var r;const t=null===(r=this.Details[0]["chartdetails"])||void 0===r?void 0:r[0];if(null!=t){const e=t[a.trim()];return void 0!==e&&null!==e?e:""}return""}if(["current_year_consumption","last_year_consumption","current_year_service_days","last_year_service_days","current_year_per_day_consumption","last_year_per_day_consumption","current_year_per_day_cost","last_year_per_day_cost","current_year","last_year"].includes(a.trim())){var c;const t=null===(c=this.Details[0]["meterreadingdetails"])||void 0===c?void 0:c[0];if(null!=t){const e=t[a.trim()];return void 0!==e&&null!==e?e:""}return""}if(["paymentamount","amountdue","nettotal","allamountdue","totalbalance","balencebeforenewchrge","totaldueafterall","RemainingDue"].includes(a.trim())){var d;const t=null===(d=this.Details[0]["PaymentDetails"])||void 0===d?void 0:d[0];if(null!=t){const e=t[a.trim()];return void 0!==e&&null!==e?e:""}return""}if("paymentterms"==a.trim()){let t=this.Details[0]["paymentterms"],a=this.Details[0]["symbol"];if(t&&Array.isArray(t)){let i="<div class='payment-advice'><h4 style='border-top: 1px #ccc dashed; padding: 20px 0 0 0;''>Payment Terms</h3> <table width='100%'><thead><tr><th style='text-align:center;'>Description</th><th style='text-align:center;'>Due Date</th><th style='text-align:right;'>Amount ("+a+" )</th></tr></thead><tbody>  ";t.forEach((function(t){i+="<tr><td style='text-align:center;'> "+t.note+"</td><td style='text-align:center;'>"+t.due_date+"</td><td>"+t.due_amount+"</td></tr>"})),i+=" </tbody></table></div>";const s=i;return void 0!==s?s:e}return console.log("No payment terms available"),""}if("itemspostpaid"==a.trim()){console.log("item match found",e);let t=this.Details[0]["itemlist"],a="";if(null!=t){t.forEach((function(t){a+="<tr><td>"+t.productname+"</td><td>"+t.consumption+"</td><td>"+t.slabrate+"</td></tr>"}));const i=a;return void 0!==i?i:e}return""}if("discounttaxadjustments"==a.trim()){let t=this.Details[0]["adjustments"],a="",i="";if(null!=t){t.forEach((function(t){i=1==t.adjustment_operation?"tax":"discount",a+="<table width='100%'><tr><td style='padding:0px;font-size: 14px;border:none; '>"+t.adjustment_name+"</td><td style='width:80px; text-align:right;font-size: 14px;font-weight:400;padding:0px;border:none;'>"+t.adjustment_amount+"</td></tr></table>"}));const s=a;return void 0!==s?s:e}return""}{const t=this.Details[0][a.trim()];return void 0!==t?t:e}}{let t=this.Details[0]["adjustments"],a="";if(null!=t){t.forEach((function(t){a+="<tr><td colspan='3' style='text-align: right; vertical-align: middle; font-size: 0.9em; font-weight: bold; font-family: Arial, Helvetica, sans-serif;'>"+t.adjustment_name+" :</td><td style='padding-right: 10px; text-align: right; vertical-align: middle; font-size: 0.9em; width: 173px; font-family: Arial, Helvetica, sans-serif;'>"+t.adjustment_amount+"</td></td></tr>"}));const i=a;return void 0!==i?i:e}}}}t.isLoading=!1}):(t.isLoading=!1,"<p>Template not available</p>")}},created(){console.log("this.Details",this.Details),console.log("meter reading",this.Details[0]["items"]),console.log("amountNo",this.Details.accountnumber),this.Details.length>0&&this.Details[0].invoice_template[0]&&(this.invoiceTemplate=this.Details[0].invoice_template[0].template_content,this.imagepath=this.Details.company_logo,this.generateBarcode())},methods:{formatAmount(t){return new Intl.NumberFormat("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t)},generateBarcode(){this.accountNumber&&o()("#accountNoBarCode",this.accountNumber,{format:"code39",height:30,width:2,displayValue:!1})},async printInvoice(){const t=document.getElementById("accountNoBarCode"),e=(document.querySelectorAll("img"),"");if(null!=t){(new XMLSerializer).serializeToString(t)}const a=document.createElement("canvas"),i=a.getContext("2d"),s=new Image;a.width=s.width,a.height=s.height,i.drawImage(s,0,0);let n="";const l=this.parsedHtml.match(/<img[^>]*src=["']([^"']+)["'][^>]*>/i);if(l){const t=l[1];t&&(n=await this.ConvertLogoBase64(t))}let o="";o=null!=t?this.parsedHtml.replace(/<svg.*?<\/svg>/s,`<img src="${e}" style="max-width: 100%;" />`).replace(/<img id="invoiceLogo".*?>/s,`<img src="${n}" style="max-width: 150px;" />`):this.parsedHtml.replace(/<img id="invoiceLogo".*?>/s,`<img src="${n}" style="max-width: 150px;" />`);const r=document.createElement("iframe");r.style.position="absolute",r.style.width="0",r.style.height="0",r.style.border="none",document.body.appendChild(r);const c=r.contentDocument||r.contentWindow.document;c.open(),c.write(`\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <title>Invoice</title>\n          <style>\n            body { font-family: Arial, sans-serif; margin: 20px; }\n            table { width: 100%; border-collapse: collapse; margin-top: 20px; }\n            th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }\n            img { display: block; margin-bottom: 10px; }\n          </style>\n        </head>\n        <body>\n          ${o}\n        </body>\n      </html>\n    `),c.close(),r.contentWindow.focus(),r.contentWindow.print(),setTimeout(()=>document.body.removeChild(r),500),s.src=svgUrl},printInvoiceOld(){const t=document.createElement("iframe");t.style.position="absolute",t.style.width="0",t.style.height="0",t.style.border="none",document.body.appendChild(t);const e=t.contentDocument||t.contentWindow.document;e.open(),e.write(`\n          <!DOCTYPE html>\n          <html>\n            <head>\n              <title>Invoice</title>\n              <style>\n                body { font-family: Arial, sans-serif; margin: 20px; }\n                table { width: 100%; border-collapse: collapse; margin-top: 20px; }\n                th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }\n              </style>\n            </head>\n            <body>\n              ${this.parsedHtml}\n            </body>\n          </html>\n        `),e.close();const a=e.getElementById("barcodeImage");a?a.onload=()=>{t.contentWindow.focus(),t.contentWindow.print(),setTimeout(()=>document.body.removeChild(t),1e3)}:(t.contentWindow.focus(),t.contentWindow.print(),setTimeout(()=>document.body.removeChild(t),1e3))},async ConvertLogoBase64(t){try{let e="imageUrl="+encodeURIComponent(t);const a=await d["a"].getConvertBase64(e);if(200===a.status&&a.data&&a.data.base64Image){const t=a.data.base64Image;return t}throw new Error("Invalid Base64 response")}catch(e){return console.error("Error converting logo:",e),this.ShowAlert(this.$t("UnknownErrorOccur"),"failure",!0,this.$t("Alert")),null}},async downloadInvoice(){var t=this;t.isLoading=!0;const e=new n["a"]({unit:"mm",format:"a4"}),a=210,i=297,s=5,l=a-2*s,o=i-2*s,r=document.createElement("div");r.innerHTML=this.parsedHtml,r.style.width=l+"mm",r.style.height="auto",r.style.boxSizing="border-box",r.style.padding="10mm",document.body.appendChild(r);const c=r.offsetWidth,d=r.offsetHeight,u=l/c,p=o/d,m=Math.min(u,p),h=r.querySelectorAll("img");document.body.removeChild(r);for(let n=0;n<h.length;n++){const t=h[n],e=await this.ConvertLogoBase64(t.src);t.src=e}console.log("pdf element : ",r.innerHTML),e.html(r,{x:s,y:s,html2canvas:{scale:m,logging:!0,useCORS:!0},callback:function(e){t.isLoading=!1,e.save("invoice.pdf")}})},downloadInvoice111111(){const t=this;t.isLoading=!0;const e=new n["a"]({unit:"mm",format:"a4"}),a=210,i=297,s=5,l=a-2*s,o=i-2*s,r=document.createElement("div");r.innerHTML=this.parsedHtml,r.style.width=l+"mm",r.style.boxSizing="border-box",r.style.padding="10mm";const c=document.createElement("div");c.innerHTML=this.parsedHtml,c.querySelectorAll("img").forEach(t=>{t.setAttribute("crossorigin","anonymous")}),r.innerHTML=c.innerHTML,document.body.appendChild(r);const d=r.offsetWidth,u=r.offsetHeight,p=l/d,m=o/u,h=Math.min(p,m),v=r.querySelectorAll("img"),_=Array.from(v).map(t=>new Promise(e=>{t.complete?e():(t.onload=()=>e(),t.onerror=()=>e())}));Promise.all(_).then(()=>{setTimeout(()=>{e.html(r,{x:s,y:s,html2canvas:{scale:h,useCORS:!0,logging:!1},callback:function(e){t.isLoading=!1,e.save("invoice.pdf"),document.body.removeChild(r)}})},200)})},InvoicebacktoPlanDetails(){"Plans"==this.hitFrom?this.$emit("backtoPlanDetails"):this.$emit("backtoInvoiceList")},renderChart(){this.$nextTick(()=>{if(document.querySelector("#invoiceChart")&&this.Details.length>0){let e=this.Details[0].BillChartData;try{let t=[],a=[];e.forEach(e=>{void 0!==e.MonthlySales&&(t.push(e.MonthlySales),a.push(e.MonthName))});let i={...this.chartOptions,xaxis:{categories:a},series:[{name:"Monthly Consumption",data:t}]},s=new ApexCharts(document.querySelector("#invoiceChart"),i);s.render()}catch(t){console.error("Error parsing chart data:",t)}}})}}},p=u,m=a("2877"),h=Object(m["a"])(p,i,s,!1,null,null,null);e["a"]=h.exports},"390a":function(t,e,a){var i=a("9a6f");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("4b9afa9f",i,!0,{sourceMap:!1,shadowMode:!1})},"39b8":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("div",[t.IsShow?e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-12 padding-t_8"},[e("div",{staticClass:"theme-primary partition-full"},[e("span",{staticClass:"p-name text-white"},[t._v(" "+t._s(t.$t("AddClient"))+": ")]),e("span",{staticClass:"float-right"},[e("RouterLink",{staticClass:"p-action-btn text-white float-right",attrs:{to:"/Client/Index"}},[e("em",{staticClass:"fa fa-angle-double-left"}),e("br"),t._v(" "+t._s(t.$t("BacktoList"))+" ")])],1)])])]):t._e(),e("div",{staticClass:"border p-3"},[e("Form",{ref:"LeadForm"},[e("dynamic-form",{ref:"ManageClientForm",attrs:{buttons:t.buttons,schema:t.FormSchema},on:{OnSubmit:t.saveForm}})],1)],1)])},s=[],n=(a("14d9"),a("b7ef"),a("9769")),l={props:{ClientData:{type:Object,required:!0}},data(){return{IsShow:!0,FormSchema:[],fileMulitpleData:[],buttons:[{type:"submit",class:"btn btn-success AddLeadDetail_a",text:"<i class='fa fa-save pr-2'></i>Save"},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Cancel",onClick:this.onCancel,isVisible:!0}]}},created(){var t=this;t.IsShow=!(t.$route.params.id>0),t.getForm()},methods:{onCancel:function(){var t=this;t.$router.push({name:"ClientListing"})},getForm(){var t=this;t.isLoading=!0;var e=`recordId=${t.$route.params.id}&moduleName=Company&subModuleCode=Client&langCode=en`;n["a"].GetDynamicForm(e).then((function(e){null!=e&&null!=e.data&&(t.FormSchema=t.$refs.ManageClientForm.ConvertCustomFieldIntoDynamicFormObj(e.data.data),t.FormSchema.forEach((e,a)=>{e.Data.forEach(async(e,a)=>{if("is_existing_account"==e.name&&""==e.value&&(e.value="1"),"user_type_id"==e.name&&""==e.value&&(e.value=4),"email_id"==e.name&&(e.disabled=!0,e.value=""==e.value?t.$route.params.email:e.value),"status_id"==e.name&&(e.value=1001),"client_type"==e.name&&""==e.value&&(e.value="individual"),"avatar"==e.name){e.showLabel=!1,e.config={maxSize:5,accept:[{fileType:"jpg",iconClass:"fa-file-image-o"},{fileType:"jpeg",iconClass:"fa-file-image-o"},{fileType:"png",iconClass:"fa-file-image-o"},{fileType:"gif",iconClass:"fa-file-image-o"},{fileType:"bmp",iconClass:"fa-file-image-o"}],multiple:!1,showSelectedFiles:[],onDeleteSelectedFiles:t.onDeleteSelectedFiles,onClickSelectedFiles:t.onClickSelectedFiles};var i=[];if(""!=e.value){var s={attachmentId:0,attachmentName:JSON.parse(e.value)[0].AttchmentName,attachmentPath:JSON.parse(e.value)[0].AttachmentPath,attachmentDesc:JSON.parse(e.value)[0].AttachmentDesc};i.push(s),i.length>0&&e.config.showSelectedFiles.push(...i)}}e.config.onChange=t.onChangeEventForFields})}),t.isLoading=!1)}))},onDeleteSelectedFiles:function(){var t=this;t.FormSchema.forEach((e,a)=>{e.Data.forEach(async(e,a)=>{"avatar"==e.name&&(t.$delete(e.config,"showSelectedFiles"),t.fileMulitpleData=[])})})},onChangeEventForFields(t,e,a){"avatar"==e.name&&this.GetBase64String(e.value),"is_existing_account"==e.name&&("0"==e.value?(this.$refs.ManageClientForm.updateProperty("parent_id","visibility",!1),this.$refs.ManageClientForm.updateProperty("account_name","visibility",!0)):(this.$refs.ManageClientForm.updateProperty("parent_id","visibility",!0),this.$refs.ManageClientForm.updateProperty("account_name","visibility",!1)))},GetBase64String(t){try{var e=this,a=t[0],i=new FileReader;let s={};i.onload=function(t){return function(t){var i=t.target.result,n=window.btoa(i),l=a.name;e.fileName=l;var o=l.lastIndexOf("."),r=l.substring(o+1,l.length);e.fileExt+="."+r;var c='{"ContentType":"'+a.type+'","Size":"'+a.size+'","Extension":"'+r+'"}',d=a.size;e.fileSize=d,s.attachement_mime=c,s.fileName=l,s.base64String=n,s.fileSize=a.size,s.contentType=a.type,s.ModuleName="Company",s.SubModuleCode="Client",e.fileMulitpleData.push(s)}}(),i.readAsBinaryString(a)}catch(s){}},saveForm(){var t=this;t.isLoading=!0,t.$refs.ManageClientForm.validateForm.validate().then(e=>{if(e){t.isLoading=!0;var a=t.$refs.ManageClientForm.ConvertDynamicFormObjToCustomFieldObj(t.FormSchema);a.forEach(t=>{"last_name"===t.field_name&&(t.field_value&&""!==t.field_value.trim()||(t.field_value="."))});var i={data:a,moduleCode:"Company",subModuleCode:"Client",attachmentData:t.fileMulitpleData.length>0?t.fileMulitpleData:null};n["a"].SaveDynamicForm(JSON.stringify(i)).then((function(e){if(null!=e&&null!=e.data&&"Success"==e.data[0].Status)if(t.isLoading=!1,t.$route.params.id>0)t.ShowAlert(t.$t("UpdatedSuccess",[t.$t("Client")]),"success",!0,t.$t("Alert")),t.onCancel();else if("DUPLICATE"==e.data[0].Value.MSG)t.ShowAlert(t.$t("AlreadyExists",[t.$t("Email")]),"warning",!0,t.$t("Alert"));else{t.ShowAlert(t.$t("AddedSuccess",[t.$t("Client")]),"success",!0,t.$t("Alert"));var a="User_Id="+e.data[0].Value.MAIN_ID;n["a"].SendEmailClient(a).then(t=>{}),t.onCancel()}})),t.isLoading=!1}})}}},o=l,r=a("2877"),c=Object(r["a"])(o,i,s,!1,null,null,null);e["default"]=c.exports},"3a0e":function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,'.mapboxgl-popup-content button.mapboxgl-popup-close-button{font-size:23px;top:3px}.mapboxgl-popup{width:340px;max-width:340px!important}.leaflet-popup-content .popupcontent{background:#fff}.leaflet-left .leaflet-control-zoom{display:none}.leaflet-marker-icon{border-radius:100%!important}.leaflet-popup-content p{margin:auto!important}.leaflet-popup-content-wrapper{padding:0!important}.leaflet-popup-content{margin:auto!important;line-height:1.4!important;width:340px!important}.leaflet-container a.leaflet-popup-close-button{color:#5c5c5c!important;padding:6px 5px 0 0!important}.gm-style-iw.gm-style-iw-c{background-color:#fff!important;padding-right:0!important;padding-bottom:0!important;max-width:648px!important;min-height:150px!important;padding:0!important;width:340px!important;border-radius:0}.gm-style-iw.gm-style-iw-c button.gm-ui-hover-effect{background:0 0!important;display:block!important;font-size:18px!important;border:0!important;margin:0!important;padding:0!important;position:absolute!important;cursor:pointer!important;-webkit-user-select:none!important;-moz-user-select:none!important;user-select:none!important;top:-6px!important;right:-6px!important;width:36px!important;height:40px!important}.gm-style-iw.gm-style-iw-c .gm-style-iw-d{overflow:hidden!important;width:100%!important}.gm-style-iw.gm-style-iw-c #content{padding:0!important;transition:all .3s;width:100%}.gm-style-iw.gm-style-iw-c .map-pop-header{color:#fff}.gm-style-iw.gm-style-iw-c .map-pop-header.Medium{background:#4cb4fb}.gm-style-iw.gm-style-iw-c .map-pop-header.Low{background:#4db567}.gm-style-iw.gm-style-iw-c .map-pop-header.High{background:#fbc648}.gm-style-iw.gm-style-iw-c .map-pop-header.Critical{background:#ef8934}.gm-style-iw.gm-style-iw-c .map-pop-header.highprofile{background:#de0303}.gm-style-iw.gm-style-iw-c .firstHeading{font-size:16px;display:flex;align-items:center;padding:5px 10px}.gm-style-iw.gm-style-iw-c .status{font-size:12px;background:#5c5c5c;font-weight:400;color:#fff;padding:4px 6px;margin-left:5px}.gm-style-iw.gm-style-iw-c p.details{display:flex;width:100%;font-weight:bolder;font-size:14px;padding:5px 10px;margin-bottom:4px}.gm-style-iw.gm-style-iw-c p.details span{font-size:12px;font-weight:400;text-transform:capitalize}.gm-style-iw.gm-style-iw-c .view-details{display:flex;width:100%;font-weight:bolder;font-size:14px;margin-bottom:0;border-top:2px solid #bfbfbf;flex-direction:row}.gm-style-iw.gm-style-iw-c .view-details a{padding:0 5px;margin-right:5px;color:#525e65}.mapboxgl-popup-content{padding:0!important}.mail-box-pop.dialog{background:rgba(0,0,0,.5)!important}.mail-box-pop .modal-dialog{max-width:570px!important;min-height:500px!important}.mail-box-pop.eta .modal-dialog{max-width:1200px!important;min-height:500px!important}.mail-box-pop.eta .modal-body{max-height:800px!important;height:800px!important}.motabod{border-right:10px solid #e5e5e5}.movedivider{background-repeat:no-repeat;background-position:0 0;width:37px;height:57px;position:absolute;z-index:999;right:-24px;top:160px;display:none}tr.bg-danger{background-color:#f7ccd0!important}.ui-resizable-handle{z-index:9999}.custom-tab-content ul.responsive-tabs.fsmtabcontrol li a{padding:10px}.tags-input-badge{font-size:12px!important;padding-top:5px!important;padding-bottom:5px!important;background-color:#3f637e!important;color:#fff!important}.tags-input-remove:after,.tags-input-remove:before{background:#fff!important}.tags-input span{margin-bottom:.3em}.circle-leaflet{width:55px!important;height:55px!important;line-height:55px;background-image:url(https://talygenv.github.io/Vue-UI-Content/images/Ticketing/m2.png)!important;text-align:center!important;font-weight:700!important;position:absolute!important;top:-22px!important;left:-19px!important}.table-heading-wb .table-head-btn{padding:.5rem}.gmnoprint{right:0!important;left:auto!important}.bg-gray-faint{position:relative;background-color:#fff!important;font-family:Open Sans,sans-serif;padding:8px 16px!important;margin-top:55px!important;border:1px solid #2196f3;margin-left:12px!important}.bg-gray-faint:after{color:#2196f3;content:"\\f0d8";position:absolute;font:normal normal normal 14px/1 FontAwesome;top:-19px;left:10%;font-size:27px}.txt-m{font-size:15px;line-height:24px;margin-top:0;margin-bottom:0}.sliderchk{cursor:pointer;top:0;left:3px;right:0;bottom:0;background-color:#ccc}.sliderchk,.sliderchk:before{position:absolute;transition:.4s}.sliderchk:before{content:"";height:24px;width:24px;left:6px;bottom:4px;background-color:#fff}input:focus+.sliderchk{box-shadow:0 0 1px #2196f3}.sliderchk.round{border-radius:34px!important}.sliderchk.round:before{border-radius:50%;top:0}.textname{top:29px;position:absolute;left:4px;font-size:13px;color:#999;font-weight:700}.timelegend{height:10px;padding:0 15px;display:inline-block}.timelegend.min10{background-color:#96d52d}.timelegend.min20{background-color:#f0c141}.timelegend.min30{background-color:#f18d76}.showduration{float:left;color:#565656!important;position:absolute;left:4px;top:0;cursor:pointer;font-size:18px;background-color:#fff;padding:7px 18px;margin:10px;margin-left:8px;font-family:Roboto,Arial,sans-serif;z-index:999}.tags-input-root .typeahead-badges{padding-top:.25rem!important}#divmapdata .map-result img{width:auto!important}.filterscrollForCardView{scrollbar-width:thin;scrollbar-color:#848484}.filterscrollForCardView::-webkit-scrollbar{width:8px;height:8px}.filterscrollForCardView::-webkit-scrollbar-track{background-clip:content-box;border:2px solid transparent}.filterscrollForCardView::-webkit-scrollbar-thumb{background-color:#848484}.filterscrollForCardView::-webkit-scrollbar-corner,.scrollbar-1::-webkit-scrollbar-track{background-color:#848484}.typeahead-badges>span{max-width:195px}[data-color_code]:after{background-color:attr(data-color_code)}.fsm-ticket,.table-bordered tr.fsm-ticket{background-color:#f5f1ef!important}.pinscreenMap{background:#17a2b8;border-left:0!important}.pinscreenMap,.unpinscreenMap{padding:15px 0!important;width:50px;cursor:pointer}.unpinscreenMap{background:#525f65}.unpinscreenMap i{transform:rotate(-45deg)}.map-actions span.esri_prof:hover{transform:none!important}.map-actions span.esri_prof a{color:#212529}.mCustomScrollBox,.mCustomScrollBox .mCS-light{max-height:inherit!important}#scrollbarreplyuserguide{max-height:350px}.theme-primary.partition{overflow:visible}',""]),t.exports=e},"3bc9":function(t,e,a){var i=a("4bbd");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("491e0b88",i,!0,{sourceMap:!1,shadowMode:!1})},"438e":function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,".Planlisting .step-1,.Planlisting .step-2{width:50px;height:50px;align-items:center;display:flex;justify-content:center;font-size:20px;font-weight:600}",""]),t.exports=e},"450c":function(t,e,a){"use strict";a("1465")},"4bbd":function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,".switch.dynamic-form{width:74px}.slider.round.toggle-no .slider-no{padding-left:6px}",""]),t.exports=e},"4ea2":function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"right-content right-content-expand"},[e("section",{staticClass:"main-content",attrs:{id:"main-content"}},[e("section",{staticClass:"main-content"},[e("div",{staticClass:"container-fluid p-0"},[e("div",{staticClass:"border p-3 col-lg-12"},[e("dynamic-form",{ref:"dynamicForm",attrs:{lang:"en",buttons:t.buttons,mandatorytext:t.$t("MandatoryString"),schema:t.FormSchema},on:{OnSubmit:t.onSubmit}})],1),e("div",{staticClass:"listing mt-2"},[e("div",{staticClass:"conversation-date heading-border"},[e("span",[t._v(t._s(t.$t("ContactNumber")))])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"d-inline-block"},[e("span",{staticClass:"legend-pending colorboxsquare"}),t._v(t._s(t.$t("Communication"))+" "+t._s(t.$t("VisibleToClient"))+" ")])])]),e("div",{staticClass:"table-responsive"},[e("table",{staticClass:"table table-bordered dt-responsive nowrap mt-0",attrs:{id:"Addresslist"}},[e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",{staticClass:"text-center"},[e("div",{staticClass:"custom-control custom-checkbox"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.selectAll,expression:"selectAll"}],staticClass:"AddressChkAll custom-control-input",attrs:{type:"checkbox",id:"chkAll_0",name:"checkbox"},domProps:{checked:Array.isArray(t.selectAll)?t._i(t.selectAll,null)>-1:t.selectAll},on:{change:[function(e){var a=t.selectAll,i=e.target,s=!!i.checked;if(Array.isArray(a)){var n=null,l=t._i(a,n);i.checked?l<0&&(t.selectAll=a.concat([n])):l>-1&&(t.selectAll=a.slice(0,l).concat(a.slice(l+1)))}else t.selectAll=s},t.toggleSelectAll]}}),e("label",{staticClass:"custom-control-label universal-custom-control-label pt-1",attrs:{for:"chkAll_0"}})])]),t._m(0),e("th",{staticClass:"text-left"},[e("span",[t._v(t._s(t.$t("ContactNumber")))])]),e("th",{staticClass:"text-left"},[e("span",[t._v(t._s(t.$t("PhoneDescription")))])]),e("th",{staticClass:"text-center"},[e("span",[t._v(t._s(t.$t("CompanyDirectory"))+" ")])]),e("th",{staticClass:"text-center"},[e("span",[t._v(t._s(t.$t("Edit")))])]),e("th",{staticClass:"text-center"},[e("span",[t._v(t._s(t.$t("Delete")))])])])]),e("tbody",[t._l(t.PhoneData.data,(function(a,i){return e("tr",{key:a.user_phone_id,class:1==a.is_visible?"text-center high-bar":"text-center"},[e("td",{staticClass:"text-center"},[e("div",{staticClass:"custom-control custom-checkbox"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.selected,expression:"phone.selected"}],staticClass:"chkItems custom-control-input",attrs:{type:"checkbox",id:"chk_"+a.user_phone_id},domProps:{checked:Array.isArray(a.selected)?t._i(a.selected,null)>-1:a.selected},on:{change:function(e){var i=a.selected,s=e.target,n=!!s.checked;if(Array.isArray(i)){var l=null,o=t._i(i,l);s.checked?o<0&&t.$set(a,"selected",i.concat([l])):o>-1&&t.$set(a,"selected",i.slice(0,o).concat(i.slice(o+1)))}else t.$set(a,"selected",n)}}}),e("label",{staticClass:"custom-control-label universal-custom-control-label pt-1",attrs:{for:"chk_"+a.user_phone_id}})])]),e("td",{staticClass:"text-center"},[t._v(t._s(a.ROWNUMBER))]),e("td",{staticClass:"text-left"},[t._v(t._s(a.user_phone))]),e("td",{staticClass:"text-left"},[t._v(t._s(a.user_phone_desc))]),e("td",{staticClass:"text-center"},[t._v(t._s(a.add_to_directory?"Yes":"No"))]),e("td",{staticClass:"text-center single-action"},[e("a",{staticClass:"enable",attrs:{"data-placement":"left",href:"javascript:;","data-toggle-tooltip":"tooltip","data-original-title":"Edit"},on:{click:function(e){return t.Edit(a)}}},[e("em",{staticClass:"fa fa-pencil text-success action-icon"})])]),e("td",{staticClass:"text-center single-action"},[e("a",{staticClass:"enable",attrs:{"data-placement":"left",href:"javascript:;","data-toggle-tooltip":"tooltip","data-original-title":"Delete","aria-describedby":"tooltip845041"},on:{click:function(e){return t.Delete(a)}}},[e("em",{staticClass:"fa fa-trash action-icon text-danger"})])])])})),0==t.PhoneData.data.length?e("tr",[e("td",{staticClass:"text-danger text-center no-record",attrs:{colspan:"7"}},[t._v(" "+t._s(t.$t("NoRecordfound")))])]):t._e()],2)])])])])])])])},s=[function(){var t=this,e=t._self._c;t._self._setupProxy;return e("th",{staticClass:"text-center"},[e("span",[t._v("#")])])}],n=a("ed09"),l=a("7bb1"),o=a("9769");Object(l["d"])("required",{validate(t){return console.log("checkk"),{required:!0,valid:-1===["",null,void 0].indexOf(t)}},message:"The {_field_} is required"});var r=Object(n["b"])({name:"Manage Contact",components:{ValidationObserver:l["b"],ValidationProvider:l["c"]},props:{UserId:{type:Number},IsClient:{type:String}},data(){return{FormSchema:[{layoutType:"double",Data:[{astype:"NumericField",label:this.$t("ContactNumber"),name:"ContactNumber",value:"",placeholder:this.$t("ContactNumber"),validationRules:{required:!0},disabled:!1},{astype:"TextField",label:this.$t("PhoneDescription"),name:"PhoneDescription",value:"",placeholder:this.$t("PhoneDescription"),validationRules:{required:!0},disabled:!1},{astype:"toggleField",label:this.$t("IsinCompanyDirectory"),name:"CompanyDirectory",value:"",placeholder:"",validationRules:{required:!1}},{astype:"toggleField",label:this.$t("VisibleToClient"),name:"VisibleToClient",value:"",placeholder:"",validationRules:{required:!1},config:{onChange:this.VisibleToClient}}]}],buttons:[{type:"submit",class:"btn btn-success",text:"<i class='fa fa-save pr-2'></i>Save",isVisible:!0},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Cancel",onClick:this.Clear}],isLoading:!1,phoneId:0,pageNo:1,pageSize:10,PhoneData:[]}},created:function(){var t=this;t.FetchData(),"Client"==t.IsClient?t.FormSchema[0].Data[3].visibility=!1:t.FormSchema[0].Data[3].visibility=!0},methods:{FetchData:function(){var t=this;t.isLoading=!0;var e=`pageNum=${t.pageNo}&pageSize=${t.pageSize}&sortBy=&sortExp=&userId=${t.UserId}`;o["a"].GetUserPhoneList(e).then((function(e){t.PhoneData=JSON.parse(e.data)}))},Edit:function(t){var e=this;e.phoneId=t.user_phone_id,e.FormSchema[0].Data[0].value=t.user_phone,e.FormSchema[0].Data[1].value=t.user_phone_desc,e.FormSchema[0].Data[2].value=t.add_to_directory,"Client"==e.IsClient?e.FormSchema[0].Data[3].visibility=!1:e.FormSchema[0].Data[3].value=t.is_visible},Delete:function(t){var e=this;e.phoneId=t.user_phone_id,e.phoneId>0?e.confirmR(e.$t("ConfirmDelete"),!0,e.$t("Delete")+"  "+e.$t("AddtionalPhone"),(function(){var t=`phoneId=${e.phoneId}&userId=${e.UserId}`;o["a"].DeleteAddtionalPhone(t).then((function(t){"Deletion successful"==t.data.Message?(e.ShowAlert(e.$t("DeletedSuccess",[e.$t("Record")]),"success",!0,e.$t("Alert")),e.FetchData()):e.ShowAlert(e.$t("DeletedError",[e.$t("Record")]),"failure",!0,e.$t("Alert"))}))})):e.ShowAlert(e.$t("Selectanyrecordtodelete")),e.isLoading=!1},onSubmit:function(t){var e=this,a={userPhoneId:e.phoneId>0?e.phoneId:0,userid:e.UserId,phone:t.ContactNumber,Description:t.PhoneDescription,isVisible:t.VisibleToClient,addToDir:t.CompanyDirectory,isVisibletoCA:!0},i=JSON.stringify(a);o["a"].AddUpdateContact(i).then(t=>{if(null!=t.data){JSON.parse(t.data);null!=t&&null!=t.data&&t.data>0?(e.ShowAlert(e.$t("RecordsSavedSuccessfully"),"success"),e.isLoading=!1,e.Clear(),e.FetchData()):(e.ShowAlert(e.$t("UnknownErrorOccur"),"failure",!0,e.$t("Alert")),e.isLoading=!1,e.FetchData())}})},Clear:function(){var t=this;t.phoneId=0,t.FormSchema[0].Data[0].value="",t.FormSchema[0].Data[1].value="",t.FormSchema[0].Data[2].value="",t.FormSchema[0].Data[3].value="",t.$refs.dynamicForm.validateForm.reset()},closePopup(){this.$emit("close")},VisibleToClient(){var t=this;t.confirmR(t.$t("Are you sure you want to make this Visible to Client?"),!0,!1,(function(t){}),(function(){t.cancelAction()}))},cancelAction(){this.FormSchema[0].Data[3].value=1!=this.FormSchema[0].Data[3].value}}}),c=r,d=(a("8f73"),a("2877")),u=Object(d["a"])(c,i,s,!1,null,null,null);e["a"]=u.exports},"4eb2":function(t,e,a){var i=a("940f");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("6745f6c8",i,!0,{sourceMap:!1,shadowMode:!1})},"50a0":function(t,e,a){"use strict";var i=a("c427");class s{async AddTicketPriority(t){return await i["a"].instanceTicketing.post("Common/AddTicketPriority?"+t)}async IsExtraMapFeature(){return await i["a"].instanceTicketing.get("/ServiceAppointment/IsExtraMapFeature")}async GetConfigNumberJsonData(t){return await i["a"].instanceCRM.get("/Form/GetConfigNumberJsonData?"+t)}async SaveConfiguringJsonData(t){return await i["a"].instanceCRM.post("/Form/SaveConfiguringJsonData",{postString:t})}async SaveConfiguringJsonData(t){return await i["a"].instanceCRM.post("/Form/SaveConfiguringJsonData",{postString:t})}async GetSkill(){return await i["a"].instanceTicketing.get("/Common/GetSkill")}async GetDepartment(){return await i["a"].instanceTicketing.get("/Common/GetDepartment")}async CheckPrivilege(t){return await i["a"].instanceCommon.get("/Common/HasPermission?"+t)}async GetResolveTicketUserListbydept(t){return await i["a"].instanceTicketing.get("/Ticketing/GetResolveTicketUserList?"+t)}async GetGroupTicketData(t){return await i["a"].instanceTicketing.get("/FSM/GetTicketGroup?"+t)}async AddTicketGroup(t){return await i["a"].instanceTicketing.post("/FSM/AddTicketGroup?"+t)}async GetTicketGroupsForDropdownList(){return await i["a"].instanceTicketing.get("/FSM/GetTicketGroupsForDropdownList")}async AddTicketServiceBoard(t){return await i["a"].instanceTicketing.post("/FSM/AddTicketServiceBoard?"+t)}GetCountryDDL(t){return i["a"].instanceCommon.get("/Common/GetDDLData?"+t)}async GetTagsByModuleId(t){return await i["a"].instanceAsset.get("/GetTagsByModuleId?"+t)}GetStateListwithIDByCountryId(t){return i["a"].instanceAsset.get("/GetStateListwithIDByCountryId?"+t)}async GetLocationByCompanyIdAsset(t){return await i["a"].instanceAsset.get("/GetLocationByCompanyId?"+t)}LocationExist(t){return i["a"].instanceAsset.post("/LocationExist?"+t)}SaveUpdateLocation(t){return i["a"].instanceAsset.post("/SaveUpdateLocation",{postString:t})}GetAllowFileType(){return i["a"].instanceAsset.get("/CheckAllowFileType")}DownloadAttachment(t){return i["a"].instanceAsset.get("/DownloadAttachment?"+t)}async GetAssetItemStatusList(){return await i["a"].instanceAsset.get("/GetAssetItemStatusList")}AddProductType(t){return i["a"].instanceAsset.post("/AddProductType/",t)}GetAssetTagsById(t){return i["a"].instanceAsset.get("/GetAssetTagsById?"+t)}AssetGetById(t){return i["a"].instanceAsset.get("/AssetGetById?"+t)}AssetCatalogueListing(t){return i["a"].instanceAsset.get("/AssetCatalogueListing?",{params:t})}IsDuplicateAssetCatalog(t){return i["a"].instanceAsset.post("/IsDuplicateAssetCatalog?",{postString:t})}async GetLocationByuserId(t){return await i["a"].instanceAsset.get("/AssetAssignment/GetLocationByuserId?"+t)}async EnableAssetManagement(t){return await i["a"].instanceAsset.get("/EnableAssetManagement?"+t)}async GetCountryData(){return await i["a"].instanceCommon.get("HelpAndGuide/GetCountryList")}async AddLead(t){return await i["a"].instanceCRM.post("/AddLead",{postString:t})}async GetDDLDataForAddGroup(t){return await i["a"].instanceCRM.get("/Form/GetDDLData?"+t)}async SaveConfigData(t){return await i["a"].instanceCRM.post("/SaveConfigData",{postString:t})}async AddApprovalChain(t){return await i["a"].instanceApproval.post("/ApprovalChain/AddApprovalChain?",{postString:t})}async GetApprovalGroupByCompanyId(){return await i["a"].instanceApproval.get("/ApprovalChain/GetApprovalGroupByCompanyId?")}async GetByChainId(t){return await i["a"].instanceApproval.get("/ApprovalChain/GetByChainId?"+t)}async CheckDuplicate(t){return await i["a"].instanceApproval.get("/ApprovalChain/CheckDuplicate?"+t)}async AddGroup(t){return await i["a"].instanceApproval.post("/ApprovalGroup/AddGroup?",{postString:t})}async LoadUsersByCompanyId(t){return await i["a"].instanceApproval.get("/ApprovalRule/LoadUsersByCompanyId?"+t)}async GetLocationByCompanyId(t){return await i["a"].instanceApproval.get("/ApprovalRule/GetLocationByCompanyId?"+t)}async AddRule(t){return await i["a"].instanceApproval.post("/ApprovalRule/AddRule?",{postString:t})}async GetRuleById(t){return await i["a"].instanceApproval.get("/ApprovalRule/GetRuleById?"+t)}async GetUsersByProjectId(t){return await i["a"].instanceApproval.get("/ApprovalRule/LoadUsersByProjectId?"+t)}async LoadClientByProjectId(t){return await i["a"].instanceApproval.get("/ApprovalRule/LoadClientByProjectId?"+t)}async GetProjectListing(t){return await i["a"].instanceApproval.get("/ApprovalRule/GetProjectList?"+t)}async GetApprovalChainsByCompanyId(){return await i["a"].instanceApproval.get("/ApprovalRule/GetApprovalChainsByCompanyId?")}async CheckDuplicateRule(t){return await i["a"].instanceApproval.get("/ApprovalRule/ApprovalRuleExist?"+t)}async SwapApproverOrder(t){return await i["a"].instanceApproval.get("/ApprovalChain/SwapApproverOrderofApprovalGroups?"+t)}async DeleteApprovalGroup(t){return await i["a"].instanceApproval.post("/ApprovalChain/DeleteApprovalGroupFromApprovalChain?"+t)}async ApprovalGroupListByApprovalCHainId(t){return await i["a"].instanceApproval.get("/ApprovalRule/GroupList?"+t)}async CheckDuplicateGroup(t){return await i["a"].instanceApproval.get("/ApprovalGroup/CheckDuplicateGroup?"+t)}GetConfigDataValue(t){return i["a"].instanceDocStorage.get("/GetConfigDataValue?"+t)}SaveDocStorageSourceConfigData(t){return i["a"].instanceDocStorage.post("/SaveDocStorageSourceConfigData?"+t)}TestCredential(t){return i["a"].instanceDocStorage.post("/TestCredential?"+t)}GetStorageSourceList(){return i["a"].instanceDocStorage.get("/GetStorageSourceList")}GetStorageRegionList(t){return i["a"].instanceDocStorage.get("/GetStorageRegionList?"+t)}GetStorageSetupStatusDetail(){return i["a"].instanceDocStorage.get("/GetStorageSetupStatusDetail")}GetStorageReport(){return i["a"].instanceDocStorage.get("/GetStorageReport")}GetCompanyStorageSourceConfig(){return i["a"].instanceDocStorage.get("/GetCompanyStorageSourceConfig")}GetCompanyContainerDetails(){return i["a"].instanceDocStorage.get("/GetCompanyContainerDetails?")}SaveContainerDetails(t){return i["a"].instanceDocStorage.post("/SaveContainerDetails?"+t)}async GetUserStorageDetail(t){return await i["a"].instanceDocStorage.get("/GetUserStorageDetail?"+t)}ManageDocUserStorageSettingData(t){return i["a"].instanceDocStorage.post("/ManageDocUserStorageSettingData",t)}GetAllowedPrivilege(){return i["a"].instanceCommon.get("/Common/GetAllowedPrivilege")}async SaveSkill(t){return await i["a"].instanceHiring.post("/Form/SaveSkill",{postString:t})}async GetIndustryIcons(t){return await i["a"].instanceHiring.get("/Candidate/GetIcons?"+t)}async SaveIndustry(t){return await i["a"].instanceHiring.post("/Form/SaveIndustry",{postString:t})}async SaveFunctionalArea(t){return await i["a"].instanceHiring.post("/Form/SaveFunctionalArea",{postString:t})}async Saveproducttype(t){return await i["a"].instanceHiring.post("/Form/Saveproducttype",{postString:t})}async UpdateUserSettingConfig(t){return await i["a"].instanceCommon.post("/Common/UpdateUserSettingConfig?"+t)}async GetDDLData(t){return await i["a"].instanceCommon.get("/Common/GetDDLData?"+t)}async AddInterviewStage(t){return await i["a"].instanceHiring.post("/Candidate/AddInterviewStage",{postString:t})}async GetStatusList(t){return await i["a"].instanceCommon.get("/Common/GetStatusList?"+t)}async GetModuleList(){return await i["a"].instanceHiring.get("/Candidate/GetModuleList")}async AddFeedback(t){return await i["a"].instanceHiring.post("/Candidate/AddFeedbackk",{postString:t})}async ManageGetIndustry(t){return await i["a"].instanceHiring.get("/Form/ManageIndustry?"+t)}async GetConfigurationValue(t){return await i["a"].instanceExpense.get("/GetConfigurationValue?"+t)}async ExpenseGetProjectListing(t){return await i["a"].instanceExpense.get("/GetProjectList/",{params:t})}async GettTripListingddl(){return await i["a"].instanceExpense.get("/GetTripName/")}async GetTaskListingddl(t){return await i["a"].instanceExpense.get("/GetTaskByProject?"+t)}async GetCurrencyNameddl(){return await i["a"].instanceExpense.get("/GetCurrencyName/")}async GetTagNameddl(){return await i["a"].instanceExpense.get("/GetTagsByModuleId/")}async SaveUpdateExpense(t){return i["a"].instanceExpense.post("/ExpenseSaveUpdateExpense",t)}async GettCategoryListingddl(){return await i["a"].instanceExpense.get("/GetCategoryName/")}async SaveUpdateTrip(t){return i["a"].instanceExpense.post("/SaveUpdateTrip/",{postString:t})}async GetDynamicForm(t){return await i["a"].instanceCommon.get("/FormLayout/GetForm?"+t)}async SaveDynamicForm(t){return i["a"].instanceCommon.post("/FormLayout/SaveDynamicForm",{postString:t})}async DepartmentAdd(t,e){return await i["a"].instanceModals.post(e,{postString:t})}async SaveAddTicketDelayReason(t){return await i["a"].instanceTicketing.post("/FSM/SaveAddTicketDelayReason",{postString:t})}async FetchGetTicketDelayReasonList(t){return await i["a"].instanceTicketing.get("/FSM/GetTicketDelayReason?"+t)}async saveCheckinCheckoutSettings(t){return await i["a"].instance.post("/Common/saveCheckinCheckoutSettings",{postString:t})}async getCheckinCheckoutSettingForEdit(t){return await i["a"].instance.get("/Common/getCheckinCheckoutSettingForEdit",t)}}e["a"]=new s},"51ca":function(t,e,a){var i=a("8af5");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("6d9939d3",i,!0,{sourceMap:!1,shadowMode:!1})},"573f":function(t,e,a){var i=a("8a39");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("6d54b84b",i,!0,{sourceMap:!1,shadowMode:!1})},5798:function(t,e,a){var i=a("8ffb");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("65efaa57",i,!0,{sourceMap:!1,shadowMode:!1})},"57db":function(t,e,a){"use strict";a("0fef")},"5a3f":function(t,e,a){"use strict";a("1afd")},"5b20":function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,".gd_mainbase .customer-headersmall.notespanel[data-v-07467c1e]{align-items:start}.gd_mainbase .msn[data-v-07467c1e]{background-color:#fff;border:1px solid #d5d5d5}.gd_mainbase .msn img[data-v-07467c1e]{width:100%}.gd_mainbase .customer-avatarname[data-v-07467c1e]{width:90px;height:80px;border-radius:50%;-o-object-fit:cover;object-fit:cover;margin-right:20px;border:3px solid var(--primary-color);font-size:32px;text-align:center;background:#f2f2f2;padding-top:14px;font-family:sans-serif}",""]),t.exports=e},"5b91":function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,".rowhighlighter div[data-v-290261da]{background:#f3f1ec!important;font-size:16px}",""]),t.exports=e},"5dbc":function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("section",[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"container-fluid mt-2"},[e("div",[e("div",{staticClass:"row mt-0.5",attrs:{id:"checkForZone"}},["Google"==t.mapType&&1==t.config.isShowSearchBox?e("div",{staticClass:"col-lg-5 col-sm-12"},[e("div",{staticClass:"form-group d-flex"},[e("div",{staticClass:"input-group customsearchbox divcityshown"},[1==t.config.isShowSearchBox?e("input",{staticClass:"form-control",attrs:{type:"text",id:"pac-input",maxlength:"50",placeholder:"Enter Your Location or Zip Code"}}):t._e()])])]):t._e(),e("div",{staticClass:"col-lg-3 col-sm-12"},[void 0!=t.config&&1==t.config.isShowCurrentLocation?e("div",{staticClass:"form-group"},[e("a",{staticClass:"btn btn-secondary",attrs:{href:"javascript:;"},on:{click:t.CurrentLocation}},[t._v("Use my location")]),t._v("    OR "),e("a",{staticClass:"btn btn-warning float-right",attrs:{href:"javascript:;"},on:{click:t.ImportFilePopup}},[e("i",{staticClass:"fa fa-upload mr-2"}),t._v("Click To import Geo JSON File.")])]):t._e()])]),e("div",{staticClass:"search"},[e("div",{staticClass:"map-result"},[e("div",{staticClass:"map-actions"},[void 0!=t.config&&1==t.config.isShowGetDirection?e("span",{staticClass:"save legends_low"},[1==t.config.isShowGetDirection?e("a",{class:{"mp-active":0==t.showSetting,"mg-success":1==t.showSetting},attrs:{href:"javascript:;",title:"GetDirection"},on:{click:t.GetDirection}},[e("em",{staticClass:"fa fa-map-marker"})]):t._e()]):t._e(),t._v("  "),void 0!=t.config&&1==t.config.isShowLocator?e("span",{staticClass:"save legends_low"},[1==t.config.isShowLocator?e("a",{class:{"mp-active":0==t.showSetting,"mg-success":1==t.showSetting},attrs:{href:"javascript:;",title:"View Locator on map"},on:{click:t.ViewLocatorOnMap}},[e("em",{staticClass:"fa fa-map-marker"})]):t._e()]):t._e(),t._v("  "),void 0!=t.config&&1==t.config.isShowEtaMap?e("span",{staticClass:"edit legends_profile"},[1==t.config.isShowEtaMap?e("a",{attrs:{href:"javascript:;",title:"ETA Map"},on:{click:function(e){return t.LoadLocatorDataonMap("locator")}}},[e("em",{staticClass:"fa fa-map"})]):t._e()]):t._e(),void 0!=t.config&&1==t.config.isShowEtaPipeLines?e("span",{staticClass:"edit legends_high esri_prof"},[t._m(0),e("div",{staticClass:"dropdown"},[t._m(1),e("div",{staticClass:"dropdown-menu esri_prof_data",staticStyle:{display:"block"}},[t._m(2),e("div",{staticClass:"w-100 mb-2"},t._l(t.UtilityMapData,(function(a,i){return e("a",{key:i,staticClass:"dropdown-item p-0",attrs:{href:"javascript:;"}},[e("div",{staticClass:"custom-control custom-checkbox custom-control-inline w-100"},[e("input",{staticClass:"custom-control-input dynamic customcheckboxUtilityMap",attrs:{type:"checkbox"}}),e("label",{staticClass:"custom-control-label pt-1",attrs:{type:"checkbox"}},[e("label",{staticClass:"font-weight-bold"},[t._v(t._s(a.LAYER_NAME))])])])])})),0),e("div",[e("a",{staticClass:"btn btn-primary d-block text-white py-2",attrs:{href:"javascript:;",title:"Go"},on:{click:t.ShowUtilityMap}},[t._v("Go"),e("i",{staticClass:"fa fa-angle-double-right pl-2"})])])])])]):t._e()]),t.showSaveZone?e("div",{staticClass:"gmnoprint",staticStyle:{position:"absolute",right:"0px","z-index":"9999999",top:"0px"},attrs:{id:"customSaveButton"},on:{click:t.OpenSaveZone}},[t._m(3)]):t._e(),t.showDeleteFeature?e("div",{staticClass:"gmnoprint",staticStyle:{position:"absolute",right:"1670px","z-index":"999999",top:"0px"},attrs:{id:"customSaveButton"},on:{click:t.DeleteFeature}},[t._m(4)]):t._e(),e("div",{staticClass:"map"},[e("div",{staticClass:"map_canvas map_ipadcontrol",style:{"min-height":void 0==t.mapHeight?"500px":t.mapHeight,"min-width":void 0==t.mapWidth?"100%":t.mapWidth},attrs:{id:t.mapContainer}}),e("div",{staticClass:"w-100 float-left",staticStyle:{position:"absolute",top:"0px"}},[0==t.showSetting?e("a",{staticClass:"showduration anchideduration",attrs:{title:"Hide"},on:{click:t.ShowTravelMode}},[t._v("Hide")]):t._e(),1==t.showSetting?e("a",{staticClass:"showduration ancshowduration",attrs:{title:"Show Setting"},on:{click:t.ShowTravelMode}},[t._v("Show Setting")]):t._e(),e("div",{staticClass:"position-absolute float-left my24 mx24 bg-gray-faint round settingPopup d-none",staticStyle:{"z-index":"999999"}},[e("div",{attrs:{id:"params"}},[t._m(5),e("h4",{staticClass:"txt-m font-weight-bold"},[t._v("Choose Travel Mode:")]),t._m(6),e("h4",{staticClass:"txt-m font-weight-bold"},[t._v("Choose Maximum Duration:")]),e("div",{staticClass:"w-100 float-left",staticStyle:{"margin-bottom":"15px"}},[e("div",{staticClass:"w-30 float-left"},[e("label",{staticClass:"switch"},[e("input",{staticClass:"dynamic",attrs:{type:"checkbox",name:"duration",checked:"checked"},domProps:{value:t.time},on:{onChange:function(e){return t.TravelMode(t.time)}}}),e("span",{staticClass:"sliderchk round"})]),e("div",{staticClass:"fs_textname"},[t._v("Minutes10")])]),e("div",{staticClass:"w-30 float-left"},[e("label",{staticClass:"switch"},[e("input",{staticClass:"dynamic",attrs:{type:"checkbox",name:"duration",checked:"checked"},domProps:{value:2*t.time},on:{onChange:function(e){return t.TravelMode(2*t.time)}}}),e("span",{staticClass:"sliderchk round"})]),e("div",{staticClass:"fs_textname"},[t._v("Minutes20")])]),e("div",{staticClass:"w-30 float-left"},[e("label",{staticClass:"switch"},[e("input",{staticClass:"dynamic",attrs:{type:"checkbox",name:"duration",checked:"checked"},domProps:{value:3*t.time},on:{onChange:function(e){return t.TravelMode(3*t.time)}}}),e("span",{staticClass:"sliderchk round"})]),e("div",{staticClass:"fs_textname"},[t._v("Minutes30")])])])])])])])])])])])],1)},s=[function(){var t=this,e=t._self._c;return e("a",{attrs:{href:"javascript:;",title:"UtilityMap"}},[e("i",{staticClass:"fa fa-map-pin",attrs:{"aria-hidden":"true"}})])},function(){var t=this,e=t._self._c;return e("a",{attrs:{href:"javascript:;",title:"UtilityMap"}},[e("i",{staticClass:"fa fa-map-pin",attrs:{"aria-hidden":"true"}})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"w-100 bg-grey"},[e("div",{staticClass:"custom-control custom-checkbox custom-control-inline w-100"},[e("input",{staticClass:"custom-control-input dynamic customcheckboxselectall",attrs:{id:"customcheckboxselectallUtilityMap",type:"checkbox",value:""}}),e("label",{staticClass:"custom-control-label pt-1",attrs:{for:"customcheckboxselectallUtilityMap",type:"checkbox",value:""}},[t._v("SelectAll")])])])},function(){var t=this,e=t._self._c;return e("div",{staticStyle:{"background-color":"rgb(40, 167, 69)",color:"rgb(255, 255, 255)","border-style":"solid","border-width":"1px","border-color":"rgb(204, 204, 204)","margin-top":"4px","margin-left":"-6px",cursor:"pointer","text-align":"center"},attrs:{title:"Save Zone"}},[e("div",{staticStyle:{"font-family":"Arial, sans-serif","font-size":"14px",padding:"0.6rem 0.8rem"}},[e("i",{staticClass:"fa fa-save pr-2"}),t._v("Save Zone")])])},function(){var t=this,e=t._self._c;return e("div",{staticStyle:{left:"-121px","background-color":"rgb(240, 4, 4)",color:"rgb(255, 255, 255)","border-style":"solid","border-width":"1px","border-color":"rgb(204, 204, 204)","margin-top":"4px","margin-right":"122px","margin-left":"-6px",cursor:"pointer","text-align":"center"},attrs:{title:"Delete Save Zone"}},[e("div",{staticStyle:{"font-family":"Arial, sans-serif","font-size":"14px",padding:"0.6rem 0.8rem"}},[e("i",{staticClass:"fa fa-trash pr-2"}),t._v("Delete Selected Shape")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"row float-left"},[e("div",{staticClass:"col float-left text-dark px-2"},[e("span",{staticClass:"timelegend min10"}),t._v(" Minutes10 ")]),e("div",{staticClass:"col float-left text-dark px-2"},[e("span",{staticClass:"timelegend min20"}),t._v(" Minutes20 ")]),e("div",{staticClass:"col float-left text-dark px-2"},[e("span",{staticClass:"timelegend min30"}),t._v(" Minutes30 ")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"mr12 toggle-group text-center"},[e("label",{staticClass:"toggle-container"},[e("input",{staticClass:"dynamic",attrs:{name:"profile",type:"radio",value:"foot-walking"}}),e("div",{staticClass:"toggle toggle--active-null toggle--null"},[t._v("Walking")])]),e("label",{staticClass:"toggle-container"},[e("input",{staticClass:"dynamic",attrs:{name:"profile",type:"radio",value:"cycling-regular"}}),e("div",{staticClass:"toggle toggle--active-null toggle--null"},[t._v("Cycling")])]),e("label",{staticClass:"toggle-container"},[e("input",{staticClass:"dynamic",attrs:{name:"profile",type:"radio",value:"driving-car",checked:"checked"}}),e("div",{staticClass:"toggle toggle--active-null toggle--null"},[t._v("Driving")])])])}],n=(a("14d9"),a("e192")),l=a.n(n),o=(a("ac6d"),a("e11e")),r=a.n(o),c=(a("6cc5"),a("cae8")),d=a.n(c),u=(a("bdd0"),a("885b")),p=a.n(u),m=(a("c307"),a("2573"),a("20d6"),a("5fbf"),a("ac00")),h=(a("1615"),a("9769")),v=(a("5bfd"),a("125d"),a("afaa")),_={components:{},props:{mapType:{required:!0},Data:{required:!0},isShowDrawButton:{required:!0,type:String},config:{required:!1},mapWidth:{required:!1},mapHeight:{required:!1},latLng:{required:!1},mapContainer:{required:!0},selectedUser:{required:!0},UtilityMapData:{required:!0},editZone:{required:!0},zoneId:{required:!0}},data:function(){return{isLoading:!1,zoneEditData:[],showDeleteFeature:!1,showSaveZonePopUp:!1,showSaveZone:!1,showAddZone:!1,time:600,colors:"",showSetting:null,address:[],UserName:null,UserEmailId:null,imageMarker:[],mapLayer:[],map:null,locations:[],locationPriority:[],locationname:[],ticketNumberList:[],LocationwithPriority:null,markers:[],mapZoom:!1,mapMarker:[],markerCluster:null,startingPoint:null,showSettingPopup:!1,lngLatData:[],fullAddress:[],leafLetReferenceNumber:[],polygonData:[],polygonNewShapeId:null,zoneData:[],drawingManager:null,currentSelectedShape:null,myPolygon:null,editableLayers:null,showHideEtaMap:!1,showImportFilePopup:!1,emailString:"",ZoneType:""}},watch:{Data:{handler:function(){setTimeout(()=>{this.ShowLocationOnGoogleMap(),"LeafLet"==this.mapType&&this.initLeafletMap(this.Data)},500)},deep:!0},config:{handler:function(){this.ShowDrawingManager()},deep:!0},selectedUser:{handler:function(){this.ViewLocatorOnMap(this.selectedUser)},deep:!0},latLng:{handler:function(){this.ViewOnMap()}}},mounted:function(){"Google"==this.mapType?setTimeout(()=>{},2e3):"MapBox"==this.mapType?this.initMapBox(this.Data,"pk.eyJ1IjoiaGFycmlzbHVtZW4iLCJhIjoiY2s2dWtrMzJ3MDk2NTNncXMxMjlxa29mcCJ9.riRtpclzr9XfExHhclre8A"):"Esri"==this.mapType?setTimeout(()=>{this.initLeafletMap(this.Data)},2e3):"LeafLet"!=this.mapType&&"Esri"!=this.mapType||setTimeout(()=>{this.initLeafletMap(this.Data)},2e3)},created:function(){this.UserName=this.GetUserInfo.Name,this.UserEmailId=this.GetUserInfo.Email,void 0!=this.myPolygon&&null!=this.myPolygon&&this.myPolygon.setMap(null);let t=document.createElement("script");t.setAttribute("src","https://maps.googleapis.com/maps/api/js?key=AIzaSyAJdx4gmhGKWjPTBBVk5riFgpbE0lGS-xM&callback=initAutocompletes&libraries=geometry,drawing,places&v=weekly"),document.head.appendChild(t);let e=document.createElement("script");e.setAttribute("src","https://unpkg.com/@google/markerclustererplus@4.0.1/dist/markerclustererplus.min.js"),document.head.appendChild(e);let a=document.createElement("script");a.setAttribute("src","~/Scripts/FsmMaps/fontawesome-markers.min.js"),document.head.appendChild(a),this.ShowLocationOnGoogleMap(),this.MapExtendLocation()},methods:{MapExtendLocation:function(){var t=this;if("Google"==t.mapType){let n=[];t.Data[0].mapExtendLatLong.forEach((function(t){n.push(new google.maps.LatLng(t[1],t[0]))}));for(var e=new google.maps.LatLngBounds,a=n,i=0,s=a.length;i<s;i++)e.extend(a[i]);t.map.fitBounds(e)}else if("MapBox"==t.mapType){let e=[];t.Data[0].mapExtendLatLong.forEach((function(t){e.push(t)})),t.map.fitBounds(e)}else{let e=[];t.Data[0].mapExtendLatLong.forEach((function(t){e.push([t[1],t[0]])}));var n=r.a.polygon(e);t.map.fitBounds(n.getBounds())}},ImportFilePopup:function(){var t=this;t.showImportFilePopup=!0},initAutocompletes:function(){var t=this;const e=document.getElementById("pac-input"),a=new google.maps.places.SearchBox(e);t.map.addListener("bounds_changed",()=>{a.setBounds(t.map.getBounds())}),google.maps.event.addListener(a,"places_changed",(function(){var e,i,s=a.getPlaces(),n=new google.maps.LatLngBounds;for(e=0;i=s[e];e++)(function(t){n.extend(t.geometry.location)})(i);t.map.fitBounds(n),a.set("map",t.map),t.map.setZoom(Math.min(t.map.getZoom(),12))}))},CurrentLocation:function(){var t=this;navigator.geolocation?navigator.geolocation.getCurrentPosition(t.GetCurrentLocation,t.geoError):alert("Geolocation is not supported by this browser.")},GetCurrentLocation:function(t){var e=this;if(t){var a=t.coords.latitude,i=t.coords.longitude,s=new google.maps.LatLng(a,i);e.map.setCenter(s),e.map.setZoom(18)}},SaveMapExtent:function(){var t=this;t.$emit("SaveMapExtent",t.fullAddress,t.mapType)},ShowUtilityMap:function(){var t=this,e=JSON.parse(localStorage.getItem("coordinates"));null==e&&(e={x:"43.133971",x1:"43.132812",y:"-76.088009",y1:"-76.087183"}),Object(v["loadModules"])(["esri/Map","esri/views/MapView","esri/layers/FeatureLayer","esri/Graphic","esri/layers/GraphicsLayer"]).then(([a,i,s,n,l])=>{var o=new a({basemap:"hybrid"});new i({container:"utilitymap",map:t.map,extent:{xmin:-13856051.7748509,ymin:2821931.08215458,xmax:-7488766.97004404,ymax:6364777.09974285,spatialReference:102100}});""!=layerUrl&&null!=layerUrl&&(Colors={},Colors.names={aqua:"#00ffff",azure:"#f0ffff",beige:"#f5f5dc",black:"#000000",blue:"#0000ff",brown:"#a52a2a",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkviolet:"#9400d3",fuchsia:"#ff00ff",gold:"#ffd700",green:"#008000",indigo:"#4b0082",khaki:"#f0e68c",lightblue:"#add8e6",lightcyan:"#e0ffff",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightyellow:"#ffffe0",lime:"#00ff00",magenta:"#ff00ff",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",pink:"#ffc0cb",purple:"#800080",violet:"#800080",red:"#ff0000",silver:"#c0c0c0",white:"#ffffff",yellow:"#ffff00"},Colors.random=function(){var t,e=0;for(var a in this.names)Math.random()<1/++e&&(t=a);return{name:t,rgb:this.names[t]}},String(layerUrl).split(",").forEach((function(t){var e=String(t).split("^")[1];""!=e&&null!=e&&"null"!=e&&"undefined"!=typeof e||(e=String(Colors.random().rgb).toUpperCase());const a={type:"simple",symbol:{color:e,type:"simple-line",style:"solid"},visualVariables:[{type:"size",field:"ELEV_GAIN",minDataValue:0,maxDataValue:2300,minSize:"3px",maxSize:"7px"}]};var i=String(t).split("^")[0];o.add(new s({url:i,renderer:a}))})));new i({container:"utilitymap",map:o,basemap:"hybrid",center:[e.y,e.x],zoom:17});var r=new l;o.add(r);var c=null;void 0!=e&&null!=e&&(c=[[e.y1,e.x1],[e.y1,e.x],[e.y,e.x],[e.y,e.x1]]);c={type:"polygon",rings:c};var d={type:"simple-fill",color:[255,0,0,.35],outline:{color:[255,0,0],width:1}},u=new n({geometry:c,symbol:d});r.add(u)}).catch(t=>{console.error(t)})},GetDirection:function(){var t=this;navigator.geolocation?navigator.geolocation.getCurrentPosition(t.showRoutePosition,t.geoError):alert("Geolocation is not supported by this browser.")},geoError:function(){},showRoutePosition:function(t){var e=this;if(t){var a=t.coords.latitude,i=t.coords.longitude,s=new google.maps.LatLng(a,i),n=new google.maps.LatLng(e.Data[0].pinLatLong.latitude.split(",")[0],e.Data[0].pinLatLong.latitude.split(",")[1]),o=localStorage.getItem("UserImage");String(o).indexOf("blob")<=0&&(o="https://app.talygen.com/Content/images/Black/user.png");var c={lat:a,lng:i};if("Google"==e.mapType){var d={url:o,scaledSize:new google.maps.Size(40,40),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(0,0)},u=new google.maps.Marker({position:c,icon:d,map:e.map}),p=new google.maps.InfoWindow({content:"<div style='padding:8px;'><img style='float:left;' src='"+o+"' class='marker' /> <div style='display:block;width: 270px;'>@loggedUserInfo.Name </br>@loggedUserInfo.Email</div></div>"});u.addListener("click",(function(){p.open(e.map,this)})),e.imageMarker.push(u);var m={path:google.maps.SymbolPath.CIRCLE,fillOpacity:1,scale:3},h={strokeColor:"#ff0000",strokeOpacity:0,fillOpacity:0,icons:[{icon:m,offset:"0",repeat:"4px"}]},v={map:e.map,suppressMarkers:!1,polylineOptions:h},_=new google.maps.DirectionsService,g=new google.maps.DirectionsRenderer(v),f=new google.maps.LatLng(a,i);function C(t,e){var a="DRIVING";t.route({origin:s,destination:n,travelMode:google.maps.TravelMode[a]},(function(t,a){if("OK"==a){e.setDirections(t);var i='<span style="font-weight:bold;">Distance: </span>'+t["routes"][0].legs[0].distance.text+'<br /><span style="font-weight:bold;">Time: </span>'+t["routes"][0].legs[0].duration.text,s=new google.maps.InfoWindow({content:i});google.maps.event.addListener(h,"click",(function(t){s.setPosition(t.latLng),s.open(map)})),google.maps.event.addListener(map,"click",(function(){s.close()}))}else window.alert("Directions request failed due to "+a+". Route exceeds maximum distance limitation.")}))}g.setMap(e.map),C(_,g)}else if("MapBox"==e.mapType){var y={lon:parseFloat(c.lng,10),lat:parseFloat(c.lat,10)},b='<img src="'+o+'" style="width:100px;height:100px;" />',S=new l.a.Popup({offset:25}).setHTML(b),A=document.createElement("div");A.className="marker",A.style.backgroundImage="url("+o+")",A.style.backgroundSize="cover",A.style.width="40px",A.style.height="40px";u=new l.a.Marker(A).setPopup(S).setLngLat(y).addTo(e.map);e.imageMarker.push(u);var D="https://api.mapbox.com/directions/v5/mapbox/driving/"+i+","+a+";"+e.Data[0].pinLatLong.latitude.split(",")[1]+","+e.Data[0].pinLatLong.latitude.split(",")[0]+"?steps=true&geometries=geojson&access_token="+l.a.accessToken;e.map.getLayer("point")||e.map.addLayer({id:"point",type:"circle",source:{type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Point",coordinates:f}}]}},paint:{"circle-radius":10,"circle-color":"#3887be"}});var I=new XMLHttpRequest;I.open("GET",D,!0),I.onload=function(){var t=JSON.parse(I.response);if(""!=typeof t.code&&"InvalidInput"!=t.code){var a=t.routes[0],i=a.geometry.coordinates,s={type:"Feature",properties:{distance:a.distance,duration:a.duration},geometry:{type:"LineString",coordinates:i}};e.map.getSource("route")?e.map.getSource("route").setData(s):(e.map.addLayer({id:"route",type:"line",source:{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:s}}},layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#3887be","line-width":5,"line-opacity":.75}}),e.map.on("click","route",(function(t){e.map.queryRenderedFeatures(t.point,{layers:["route"]});var a=t.features[0].properties,i=a.distance;i=parseFloat(.000621371192*i,10).toFixed(2);var s='<span style="font-weight:bold;">Distance: </span>'+i+' mi<br /><span style="font-weight:bold;">Time: </span>'+timeConvert(a.duration);(new l.a.Popup).setLngLat(t.lngLat).setHTML(s).addTo(e.map)})))}else try{ShowMsgWithMsg("Route exceeds maximum distance limitation.","failure")}catch(n){alert("Route exceeds maximum distance limitation.")}},I.send()}else{var T=r.a.icon({iconUrl:o,iconSize:[40,40]});S=r.a.popup().setContent("<img src="+o+" />");r.a.marker([a,i],{icon:T}).bindPopup(S).openPopup().addTo(e.map);var L=r.a.Routing.control({waypoints:[r.a.latLng(a,i),r.a.latLng(e.Data[0].pinLatLong.latitude.split(",")[0],e.Data[0].pinLatLong.latitude.split(",")[1])],routeWhileDragging:!1,createMarker:function(){return null}}).addTo(e.map);L.on("routesfound",(function(t){var e=t.routes;e[0].summary}))}}},DeleteFeature:function(){var t=this;null!=t.currentSelectedShape&&"undefined"!=typeof t.currentSelectedShape&&(t.currentSelectedShape.setMap(null),t.currentSelectedShape=null,t.showAddZone=!1,t.showDeleteFeature=!1)},ShowDrawingManager:function(){var t=this;null==t.drawingManager&&void 0!=t.config&&1==t.config.isShowDrawButton&&(t.drawingManager=new google.maps.drawing.DrawingManager({drawingControl:!0,drawingControlOptions:{position:google.maps.ControlPosition.RIGHT_CENTER,drawingModes:["polygon"],setEditable:!0},polylineOptions:{editable:!0}}),t.drawingManager.setMap(t.map),google.maps.event.addListener(t.drawingManager,"overlaycomplete",t.GetGoogleAddressToDraw))},ViewLocatorOnMap:function(t){var e,a=this;a.isLoading=!0,e=void 0!=a.selectedUser?`selectedUser=${t}&reqFrom=`:"reqFrom=ETAMAP",h["a"].TrackByUserId(e).then((function(t){if(null!=t.data.data&&t.data.data.length>0){var e=t.data.data;a.ShowUserOnMap(e,a.map),a.isLoading=!1}else a.ShowAlert(a.$t("CurrentLocationNotFound"),"warning",!0,a.$t("Alert")),a.isLoading=!1}))},ShowUserOnMap:function(t,e){var a=this,i=[];$.each(t,(function(t,e){var s=e.IMAGE_PATH,n={lat:parseFloat(e.LATITUDE,10),lng:parseFloat(e.LONGITUDE,10)};i.push([n.lat,n.lng]);new google.maps.LatLng(n.lat,n.lng);String(s).indexOf("blob")<=0&&(s="/Content/images/user_avtar.png");var o='<div class="w-100 float-left popupcontent" style="padding:0px 6px 0px 0px;">';if(o+='<img src="'+s+'" class="float-left" style="width:50px;height:50px; border-radius: 100%;border: 3px solid #f2f2f2;" />',o+='<div style="padding-left:8px; padding-top:5px;width:80%;" class="float-left">',o+="<p style='margin-bottom: 2;'><b style='font-weight:bold;'>Name: </b>"+e.NAME+" </p>",o+="<p style='margin-bottom: 2;'><b style='font-weight:bold;'>Department: </b>"+e.DEPARTMENT_NAME+" </p></div>",e.TRACK_ID>0&&(o+="<p style='margin-bottom:2px;' class='px-2 float-left'><b style='font-weight:bold;'>"+e.NAME+" </b> is going to ticket number: "+e.TICKET_NUMBER+" </p>"),o+="</div>","Google"==a.mapType){var c={url:s,scaledSize:new google.maps.Size(40,40),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(0,0)},d=new google.maps.Marker({position:n,icon:c,map:a.map});a.imageMarker.push(d);var u=new google.maps.InfoWindow({content:o});try{d.addListener("click",(function(){u.open(a.map,this)}))}catch(_){console.log(_)}}else if("MapBox"==a.mapType){var p={lon:parseFloat(n.lng,10),lat:parseFloat(n.lat,10)},m=new l.a.Popup({offset:25}).setHTML(o),h=document.createElement("div");h.className="marker",h.style.backgroundImage="url("+s+")",h.style.backgroundSize="cover",h.style.width="50px",h.style.height="50px";d=new l.a.Marker(h).setPopup(m).setLngLat(p).addTo(a.map);a.map.flyTo({center:[p.lon,p.lat],essential:!0}),a.imageMarker.push(d)}else{var v=r.a.icon({iconUrl:s,iconSize:[40,40]});m=r.a.popup().setContent(o),d=r.a.marker([n.lat,n.lng],{icon:v}).bindPopup(m).openPopup().addTo(a.map);a.imageMarker.push(d),a.map.fitBounds(i)}}))},removeMarker(){this.markers.forEach(t=>t.remove()),this.markers=[];const t=this.draw.getAll().features;t.forEach(t=>{this.draw.delete(t.id)}),this.map.flyTo({center:[78.9629,20.5937],zoom:1,essential:!0})},deleteMarker(){this.markers.forEach(t=>t.remove()),this.markers=[];const t=this.draw.getAll().features;t.forEach(t=>{this.draw.delete(t.id)})},removeAllMarkersExceptCurrent(t){this.markers.forEach(e=>{e!==t&&e.remove()}),this.markers=[]},drawLocationPointer(t){const e=new l.a.Marker({color:"red"}).setLngLat([t.location_nw.split(",")[1],t.location_nw.split(",")[0]]).addTo(this.map);return this.markers.push(e),e},ViewOnMap:function(){var t=this;"MapBox"==t.mapType&&("AddTicket"!=t.mapContainer?(1==t.markers.length&&t.removeAllMarkersExceptCurrent(t.markers),t.markers.length>0?t.markers[0].features.forEach((function(e,a){t.map.flyTo({center:[t.latLng.location_nw.split(",")[1],t.latLng.location_nw.split(",")[0]],zoom:16,essential:!0}),e.properties.ticketNumber==(t.latLng.TicketNumber||t.latLng.ticket_number)&&new l.a.Popup({closeOnClick:!0}).setLngLat([t.latLng.location_nw.split(",")[1],t.latLng.location_nw.split(",")[0]]).setHTML(e.properties.address).addTo(t.map)})):(t.map.flyTo({center:[t.latLng.location_nw.split(",")[1],t.latLng.location_nw.split(",")[0]],zoom:16,essential:!0}),t.drawLocationPointer(t.latLng))):setTimeout(()=>{t.map.flyTo({center:[t.latLng.location_nw.split(",")[1],t.latLng.location_nw.split(",")[0]],zoom:16,essential:!0});var e={lon:t.latLng.location_nw.split(",")[1],lat:t.latLng.location_nw.split(",")[0]},a="",i="https://unpkg.com/leaflet@1.3.4/dist/images/marker-icon.png",s=document.createElement("div");s.className="marker",s.style.backgroundImage="url("+i+")",s.style.backgroundPosition="top center",s.style.backgroundSize="cover",s.style.width="40px",s.style.height="40px",new l.a.Marker(s).setLngLat(e).setPopup(a).addTo(t.map)},1e3))},gpxData:function(t,e,a){var i=this;i.Data=[],i.mapType="Google",i.emailString=e,i.ZoneType=a,i.Data.push(t),i.ShowLocationOnGoogleMap()},ShowLocationOnGoogleMap:function(){if("Google"==this.mapType){var t,e=this,a=null;const o=[];var i,s=null,n=new google.maps.InfoWindow;e.map=null,e.showLoader=!0,e.map=new google.maps.Map(document.getElementById(e.mapContainer),{zoom:7,zoomControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR,position:google.maps.ControlPosition.BOTTOM_RIGHT},zoomControlOptions:{position:google.maps.ControlPosition.RIGHT_CENTER},center:new google.maps.LatLng(30.7333,76.7794),mapTypeId:google.maps.MapTypeId.ROADMAP}),void 0!=e.config&&1==e.config.isShowDrawButton&&(e.drawingManager=new google.maps.drawing.DrawingManager({drawingControl:!0,drawingControlOptions:{position:google.maps.ControlPosition.RIGHT_CENTER,drawingModes:["polygon"]},polylineOptions:{editable:!0}}),e.drawingManager.setMap(e.map),google.maps.event.addListener(e.drawingManager,"overlaycomplete",(function(t,a,i){var s=t.overlay;e.currentSelectedShape=s,e.GetGoogleAddressToDraw(t)}))),(this.mapType="Google")&&$.each(e.Data,(function(l,r){null!=r.pinLatLong.latitude&&(a=r.pinLatLong.latitude.split(",")[0],s=r.pinLatLong.latitude.split(",")[1]),i="Critical"==r.priority?"https://talygenv.github.io/Vue-UI-Content/images/Ticketing/mapicon_critical.png":"High"==r.priority?"https://talygenv.github.io/Vue-UI-Content/images/Ticketing/mapicon_high.png":"Medium"==r.priority?"https://talygenv.github.io/Vue-UI-Content/images/Ticketing/mapicon_medium.png":"https://talygenv.github.io/Vue-UI-Content/images/Ticketing/mapicon_low.png";let c='<div id="content"><div class="map-pop-header '+r.priority+'" style="background-color:'+r.color_code+'"><div id="siteNotice"></div>'+r.popupHeaderHtml+'</div><div id="bodyContent">'+r.popupBodyHtml+'<p class="view-details">'+r.popupFooterHtml+"</p></div></div>";t=new google.maps.Marker({position:new google.maps.LatLng(a,s),icon:i,title:r.refValue,map:e.map,address:c}),o.push(t),e.markers.push(t);let d=[];if(void 0!=e.Data[l]&&e.Data[l].polygons.forEach((function(t){t.latLong.forEach((function(t){d.push(new google.maps.LatLng(t.longitude,t.latitude))})),e.myPolygon=new google.maps.Polygon({paths:d,draggable:!1,editable:1==e.config.isEditable,strokeColor:"undefined"!=typeof t.strokeColor?t.strokeColor:"#FF0000",strokeOpacity:"undefined"!=typeof t.strokeOpacity?t.strokeOpacity:"#FF0000",strokeWeight:"undefined"!=typeof t.strokeWeight?t.strokeWeight:"#FF0000",fillColor:"undefined"!=typeof t.fillColor?t.fillColor:"#FF0000",fillOpacity:"undefined"!=typeof t.opacity?t.opacity:.35,Id:e.Data[l].refValue,FormName:t.FormName,Description:t.Description,ZoneType:t.ZoneType,locatorids:t.locatorids}),e.zoneEditData.push({FormName:t.FormName,Description:t.Description,Refrence:"View",ZoneType:t.ZoneType,YardEmails:t.YardEmails,locatorids:t.locatorids}),e.myPolygon.setMap(e.map),google.maps.event.addListener(e.myPolygon,"click",(function(t,a){e.currentSelectedShape=this,e.currentSelectedShape.setOptions({editable:!0,ShapeId:e.polygonNewShapeId}),e.showDeleteFeature=!0,"zoneMapDiv"==e.mapContainer&&(e.showAddZone=!0)}))})),"zoneMapDiv"==e.mapContainer||"mapExtend"==e.mapContainer){for(var u=new google.maps.LatLngBounds,p=d,m=0,h=p.length;m<h;m++)u.extend(p[m]);e.map.fitBounds(u)}google.maps.event.addListener(e.myPolygon.getPath(),"set_at",(function(t,a){let i={FullAddress:""};if(e.lngLatData=[],"zoneMapDiv"==e.mapContainer){e.polygonNewShapeId=(new Date).getTime()+"_"+Math.floor(1e3*Math.random()),e.myPolygon.setOptions({ShapeId:e.polygonNewShapeId}),e.showAddZone=!0,l=e.myPolygon.getPath().getArray(),l.forEach((function(t,a){e.lngLatData.push({latitude:t.lat(),longitude:t.lng()})})),i={FullAddress:""};var s=new google.maps.LatLng(e.lngLatData[0].Lat,e.lngLatData[0].Lng),n=new google.maps.Geocoder;n.geocode({latLng:s},(function(t,e){i.FullAddress=t[0].formatted_address})),e.polygonData.push({Id:e.polygonNewShapeId,latLong:e.lngLatData,CompleteAddress:i,strokeOpacity:e.myPolygon.strokeOpacity,strokeWeight:e.myPolygon.strokeWeight,strokeColor:e.myPolygon.strokeColor,fillColor:e.myPolygon.fillColor,locatorids:""}),e.fullAddress.push({LatLng:e.lngLatData,CompleteAddress:i})}else{var l;e.lngLatData=[],l=e.myPolygon.getPath().getArray(),l.forEach((function(t,a){e.lngLatData.push({Lat:t.lat(),Lng:t.lng()})})),i={FullAddress:""};s=new google.maps.LatLng(e.lngLatData[0].Lat,e.lngLatData[0].Lng),n=new google.maps.Geocoder;n.geocode({latLng:s},(function(t,e){i.FullAddress=t[0].formatted_address})),e.fullAddress.push({LatLng:e.lngLatData,CompleteAddress:i})}})),google.maps.event.addListener(t,"click",function(t,a){return function(){n.setContent(c),n.open(e.map,t),"WorkOrderDetail"!=e.mapContainer&&"detailMapDiv"!=e.mapContainer||n.close()}}(t));var v=new google.maps.LatLng(e.Data[0].latlong.split(",")[0],e.Data[0].latlong.split(",")[1]);e.map.panTo(v),e.map.setZoom(4)}));var l={gridSize:40,maxZoom:15,styles:[{width:30,height:30,url:"https://talygenv.github.io/Vue-UI-Content/images/Ticketing/m1.png",textColor:"white",textSize:12}]};e.markerCluster=new MarkerClusterer(e.map,o,l)}},LoadLocatorDataonMap:function(){var t=this,e=null,a=null;navigator.geolocation?navigator.geolocation.getCurrentPosition((function(t){e=t.coords.latitude,a=t.coords.longitude})):console.log("Geolocation is not supported by this browser."),t.showSetting=!0,"Google"==t.mapType?setTimeout(()=>{t.LoadGoogleHeatMap(e,a)},2e3):"MapBox"==t.mapType?setTimeout(()=>{t.LoadMapboxHeatMap(e,a)},4e3):setTimeout(()=>{t.ShowEtaMap(e,a)},4e3)},initMapBox:function(t,e,a,i){var s=this,n="";let o=3;if(t){var r=$.grep(t,(function(t,e){return""!==t.location_nw&&null!==t.location_nw&&void 0!==typeof t.location_nw&&","!==t.location_nw}));r=r[0],r&&(n=[parseFloat(String(r.location_nw).split(",")[1],10),parseFloat(String(r.location_nw).split(",")[0],10)])}s.startingPoint=n,l.a.accessToken=e,s.map=new l.a.Map({container:s.mapContainer,style:"mapbox://styles/mapbox/streets-v11",zoom:o,zoomControl:!0,scrollZoom:!0,boxZoom:!0}),void 0!==s.config&&s.config.isShowSearchBox&&(s.geocoder=new p.a({accessToken:e,mapboxgl:l.a,marker:!1,placeholder:"Search for places in Barbados"}),s.map.addControl(s.geocoder)),void 0!==s.config&&s.config.isShowDrawButton&&(s.draw=new d.a({displayControlsDefault:!1,controls:{line_string:!1,polygon:!1,point:!0,trash:!0}}),s.map.addControl(s.draw),s.map.on("draw.create",s.GetMapBoxAddressToDraw),s.map.on("draw.delete",s.deleteMarker),s.navTopLeft=new l.a.NavigationControl,s.map.addControl(s.navTopLeft,"top-left")),s.navBottomRight=new l.a.NavigationControl,s.map.addControl(s.navBottomRight,"bottom-right")},resetMap(){var t=this;t.map&&t.draw&&t.draw.deleteAll()},clearSearchField(){var t=this;if(t.geocoder){var e=document.querySelector(".mapboxgl-ctrl-geocoder input");e&&(e.value="")}},initLeafletMap:function(t,e,a){var i,s=this;if(void 0!=t){if(s.map){s.map.off();try{s.map.remove()}catch{}}let e="",a="";if(null!=t&&t.length>0){var n=$.grep(t,(function(t,e){return""!=t.location_nw&&null!=t.location_nw&&"undefined"!=typeof t.location_nw&&","!=t.location_nw}));if(null!=n&&n.length>0){var l=n[0].location_nw;a=l.split(",")[1],e=l.split(",")[0]}}var o=r.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:22,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Points &copy '+(new Date).getFullYear()+" LINZ"}),c=(r.a.tileLayer("https://{s}.tiles.mapbox.com/v3/spatial.b625e395/{z}/{x}/{y}.png",{attribution:'<a href="http://www.mapbox.com/about/maps/" target="_blank">Terms &amp; Feedback</a>'}),r.a.latLng(e,a));s.startingPoint=[e,a];var d=10;if(""==e&&""==a&&(d=2),s.map=r.a.map(s.mapContainer,{zoom:d,center:c,layers:[o],zoomControl:!1}),r.a.control.zoom({position:"topright"}).addTo(s.map),void 0!=s.config&&1==s.config.isShowDrawButton&&s.GetLeafLetAddressToDraw(),void 0!=s.config&&1==s.config.isShowSearchBox){const t=new m["b"],e=new m["a"]({provider:t});s.map.addControl(e)}s.markers=r.a.markerClusterGroup({iconCreateFunction:function(t){return r.a.divIcon({html:'<div class="circle-leaflet">'+t.getChildCount()+"</div>"})}});var u=r.a.Icon.extend({options:{shadowSize:[50,64],iconAnchor:[22,94],shadowAnchor:[4,62],popupAnchor:[-3,-76]}});1==s.Data.length&&void 0!=s.Data[0].latlong&&s.map.flyTo([s.Data[0].latlong.split(",")[0],s.Data[0].latlong.split(",")[1]],16,{animate:!0,duration:2});new u({iconUrls:"https://talygenv.github.io/Vue-UI-Content/images/Ticketing/mapicon_critical.png"}),new u({iconUrl:"https://talygenv.github.io/Vue-UI-Content/images/Ticketing/mapicon_high.png"}),new u({iconUrls:"https://talygenv.github.io/Vue-UI-Content/images/Ticketing/mapicon_low.png"}),new u({iconUrls:"https://talygenv.github.io/Vue-UI-Content/images/Ticketing/mapicon_medium.png"}),new u({iconUrls:"https://talygenv.github.io/Vue-UI-Content/images/Ticketing/mapicon_fill.png"});function p(t){var n="",l="";if($.each(t,(function(t,o){if(""!=o.pinLatLong.latitude&&null!=o.pinLatLong.latitude&&void 0!=typeof o.pinLatLong.latitude||o.polygons.length>0){n=o.pinLatLong.latitude;let _=[];l=o.priority;if("[]"!=o.attachmentCountWithExt&&""!=o.attachmentCountWithExt&&null!=o.attachmentCountWithExt){var c=JSON.parse(o.attachmentCountWithExt);$.each(c,(function(t,e){"Video"==e.TYPE?e.COUNT:"Image"==e.TYPE?e.COUNT:parseInt(e.COUNT)}))}if(s.Data[t].polygons.forEach((function(t){t.latLong.forEach((function(t){_.push([t.longitude,t.latitude])}))})),void 0!=o.polygons[t]){if(s.Data[0].polygons[0].latLong.length>1){var d=r.a.polygon(_,{fill:!0}).addTo(s.editableLayers);s.map.fitBounds(d.getBounds())}}let g='<div class="gm-style-iw gm-style-iw-c"><div class="gm-style-iw-d"><div><div id="content"><div class="map-pop-header '+o.priority+'" style="background-color:'+o.color_code+'"><div id="siteNotice"></div>'+o.popupHeaderHtml+'</div><div id="bodyContent">'+o.popupBodyHtml+'<p class="view-details">'+o.popupFooterHtml+"</p></div></div></div></div></div>";a=n.split(",")[1],e=n.split(",")[0],a=parseFloat(a,10),e=parseFloat(e,10);var u=o.ticket_number,p=".leafleticoncustom_"+l+"{background-color:"+o.color_code+" }",m=document.createElement("style");m.innerHTML=p,document.head.appendChild(m);var h=r.a.icon({iconUrl:"https://talygenv.github.io/Vue-UI-Content/images/Ticketing/mapicon_high.png",iconSize:[30,30],color:o.color_code,"icon-color":o.color_code,"background-color":o.color_code,className:"leafleticoncustom_"+l});""!=n&&(i=r.a.marker(r.a.latLng(e,a),{icon:h}),i.bindPopup(g),s.markers.addLayer(i),s.leafLetReferenceNumber.push({TicketNumber:o.refValue,Address:g}),s.mapMarker.push(s.markers));try{i.on("click",(function(t){var e=$("a.ticketnumber[data-ticketnumber='"+u+"']");if("WorkOrderDetail"!=s.mapContainer&&"detailMapDiv"!=s.mapContainer||i.getPopup().getElement().classList.add("d-none"),e.length>0&&"true"==localStorage.getItem("isMapView")){var a=e.closest(".lists");a.addClass("alert-info"),setTimeout((function(){a.removeClass("alert-info")}),5e3)}e=$("a.ticketnumberlist[data-ticketnumber='"+u+"']"),e.length>0&&"false"==localStorage.getItem("isMapView")&&(e=e.closest("tr"),e.addClass("alert-info"),setTimeout((function(){e.removeClass("alert-info")}),5e3))}))}catch(v){console.log("err")}}})),null!=t.mapdetail&&t.mapdetail.length>0)if("MapBox"==t.mapdetail[0].MAP_TYPE){if(""!=t.mapdetail[0].LONGITUDE&&""!=t.mapdetail[0].LATITUDE&&""!=t.mapdetail[0].LAT_LNG){var o=JSON.parse(t.mapdetail[0].LAT_LNG),c=[];$.each(JSON.parse(t.mapdetail[0].LAT_LNG),(function(t,e){var a=[];a.push(e[1],e[0]),c.push(a)})),map.fitBounds(c)}}else if("Google"==t.mapdetail[0].MAP_TYPE&&""!=t.mapdetail[0].LONGITUDE&&""!=t.mapdetail[0].LATITUDE&&""!=t.mapdetail[0].LAT_LNG){var d=[];$.each(JSON.parse(t.mapdetail[0].LAT_LNG),(function(t,e){var a=[];a.push(e.lat,e.lng),d.push(a)}));o=d;var u=[];u.push(o),map.fitBounds(o)}s.map.addLayer(s.markers)}null!=t&&t.length>0&&p(t)}else s.map=r.a.map(s.mapContainer,{layers:[r.a.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'Map data © <a href="https://openstreetmap.org">OpenStreetMap</a> contributors'})],center:[0,0],zoom:5});void 0!=s.latLng&&s.ViewOnMap()},ShowEtaMap:function(t,e){var a=this,i=null,s=null,n="driving-car",l=600;if(a.showHideEtaMap)return $.each(a.mapLayer,(function(t,e){a.map.removeLayer(e)})),a.showHideEtaMap=!1,!1;function o(){navigator.geolocation?navigator.geolocation.getCurrentPosition(d,c,{timeout:1e4}):alert("Geolocation is not supported by this browser")}function c(t){t.code;var e=t.message;alert(e)}o();function d(t){t=$.post("geocoordinates.php",{lat:t.coords.latitude,lng:t.coords.longitude})}function u(t,e){if(a.map){$.each(a.mapLayer,(function(t,e){a.map.removeLayer(e)})),a.showHideEtaMap=!0;var i=new r.a.latLng(t,e);a.map.panTo(i),a.map.setZoom(11)}var s=localStorage.getItem("UserImage");String(s).indexOf("blob")<=0&&(s="https://app.talygen.com/Content/images/Black/user.png");var n=r.a.icon({iconUrl:s,iconSize:[40,40]}),l=r.a.popup().setContent("<div style='padding:8px;'><img style='float:left;' src='"+s+"' class='marker' /> <div style='display:block;'>"+a.UserName+"</br>"+a.UserEmailId+"</div></div>"),o=r.a.marker([t,e],{icon:n},{layers:""}).bindPopup(l).openPopup().addTo(a.map);a.imageMarker.push(o),p(!0)}function p(t){var e=[];$("input[name=duration]:checked").each((function(){e.push($(this).val())})),$.ajax({type:"POST",dataType:"json",headers:{Authorization:"5b3ce3597851110001cf62485ecdd7b54dd545c4901722c53ac3d1d3"},url:"https://api.openrouteservice.org/v2/isochrones/"+n,data:JSON.stringify({location_type:"start",range_type:"time",range:e,interval:l,locations:[[i,s],[i,s]],intersections:!1}),async:!1,contentType:"application/json; charset=utf-8",success:function(t){r.a.geoJson(t,{onEachFeature:function(t,e){e.bindPopup("Isochrone: "+t.properties.value),a.mapLayer.push(e)},style:function(t){var e=t.properties.value;return a.SetColor(e),{fillColor:a.colors,color:a.colors,weight:1,fillOpacity:.35}}}).addTo(a.map)}})}i=parseFloat(e,10)+.02,s=parseFloat(t,10)+.004,u(s,i),document.getElementById("params").addEventListener("change",(function(t){if("profile"===t.target.name)n=t.target.value,u(s,i);else if("duration"===t.target.name){var e="";if($(params).find("input:checkbox:checked").length>0){$(params).find("input:checkbox:checked").each((function(){e.length>0&&(e+=",");var t=$(this).val();e+=t}));var a=String(e).split(",");l=a[0],a[a.length-1]}else l="600","1800";u(s,i)}}))},SetColor:function(t){var e=this;if(t=parseInt(t,10),"MapBox"!=e.mapType?t/=60:e.time=10,"MapBox"==e.mapType)switch(t){case 10:e.colors="3CEA19";break;case 20:e.colors="EFF60B";break;case 30:e.colors="F6320B";break;default:e.colors="F6320B"}else switch(t){case 10:e.colors="green";break;case 20:e.colors="yellow";break;case 30:e.colors="red";break;default:e.colors="red"}},LoadGoogleHeatMap:function(t,e){var a=this,i="driving-car",s=600;if(a.showHideEtaMap)return a.map.data.forEach((function(t){a.map.data.remove(t)})),a.showHideEtaMap=!1,!1;function n(n,l){if(a.map){$.each(a.map,(function(t,e){try{a.map.removeLayer(e)}catch(i){}})),a.showHideEtaMap=!0;var o=new r.a.latLng(n,l);a.map.panTo(o),a.map.setZoom(11)}var c={lat:t,lng:e},d=(o=new google.maps.LatLng(t,e),localStorage.getItem("UserImage"));String(d).indexOf("blob")<=0&&(d="https://app.talygen.com/Content/images/Black/user.png");var u={url:d,scaledSize:new google.maps.Size(40,40),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(0,0)},p=new google.maps.Marker({position:c,icon:u,map:a.map}),m=new google.maps.InfoWindow({content:"<div style='padding:8px;'><img style='float:left;' src='"+d+"' class='marker' /> <div style='display:block;'>"+a.UserName+"</br>"+a.UserEmailId+"</div></div>"});p.addListener("click",(function(){m.open(a.map,this)})),a.imageMarker.push(p);var h=[];$("input[name=duration]:checked").each((function(){h.push($(this).val())})),$.ajax({type:"POST",dataType:"json",headers:{Authorization:"5b3ce3597851110001cf62485ecdd7b54dd545c4901722c53ac3d1d3"},url:"https://api.openrouteservice.org/v2/isochrones/"+i,data:JSON.stringify({location_type:"start",range_type:"time",range:h,interval:s,locations:[[l,n],[l,n]],intersections:!1}),async:!1,contentType:"application/json; charset=utf-8",success:function(t){a.map.data.addGeoJson(t)}}),a.map.data.setStyle((function(t){var e=t.getProperty("value");return a.SetColor(e),{fillColor:a.colors,opacity:.35,strokeWeight:1}}))}n(t,e),document.getElementById("params").addEventListener("change",(function(a){if("profile"===a.target.name)i=a.target.value,n(t,e);else if("duration"===a.target.name){var l="";if($(params).find("input:checkbox:checked").length>0){$(params).find("input:checkbox:checked").each((function(){l.length>0&&(l+=",");var t=$(this).val();l+=t}));var o=String(l).split(",");s=o[0],o[o.length-1]}else s="600","1800";n(t,e)}}))},Close:function(){var t=this;t.showAddZone=!1,t.showSaveZonePopUp=!1,t.showImportFilePopup=!1},GetZoneManagementData:function(t){var e=this;e.currentSelectedShape.setOptions({strokeOpacity:t.strokeOpacity,strokeColor:t.strokeColor,fillOpacity:.35,strokeWeight:t.strokeWeight,fillColor:t.fillColor}),e.polygonData.forEach((function(a,i){a.Id==t.Id&&(e.polygonData[i].strokeOpacity=t.strokeOpacity,e.polygonData[i].strokeWeight=t.strokeWeight,e.polygonData[i].fillColor=t.fillColor,e.polygonData[i].locatorids=t.locatorids,e.polygonData[i].strokeColor=t.strokeColor,e.polygonData[i].locatorids=t.locatorids,e.showAddZone=!1,e.showSaveZone=!0)}))},OpenSaveZone:function(){var t=this;t.showSaveZonePopUp=!0},SaveZoneData:function(t){var e=this;let a={ZoneId:0==e.zoneId?t.ZoneId:e.zoneId,ResolverUserId:null,JsonData:{type:"FeatureCollection",features:[]},ZoneName:t.Name,description:t.Description,ZoneType:null==t.ZoneType?e.ZoneType:t.ZoneType,YardEmails:null==t.YardEmails?e.emailString:t.YardEmails};e.polygonData.forEach((function(t,e){a.JsonData.features.push({type:"Feature",geometry:{type:"Polygon",coordinates:[[]]},properties:{stroke:t.strokeWeight,"stroke-opacity":t.strokeOpacity,"stroke-width":t.strokeWeight,fillColor:t.fillColor,"fill-opacity":t.fillOpacity,locatorname:null,locatorids:t.locatorids,userids:null}}),t.latLong.forEach((function(t,i){void 0!=a.JsonData.features[e]&&a.JsonData.features[e].geometry.coordinates[0].push([t.longitude,t.latitude])})),void 0!=a.JsonData.features[e]&&a.JsonData.features[e].geometry.coordinates[0].push([a.JsonData.features[e].geometry.coordinates[0][0][0],a.JsonData.features[e].geometry.coordinates[0][0][1]])})),e.zoneData.push(a);var i=JSON.stringify(e.zoneData);h["a"].UploadGeoJSON(i).then((function(t){0==e.zoneId?e.ShowAlert("Zone Succesfully Added.","success"):e.ShowAlert("Zone Succesfully Updated.","success"),e.showSaveZonePopUp=!1,e.currentSelectedShape=null,e.$emit("FetchData")}))},GetLeafLetAddressToDraw:function(){var t=this;let e={City:{Name:"",LongName:""},Country:{Name:"",LongName:""},AdministrativeAreaLevel1:{Name:"",LongName:""},AdministrativeAreaLevel2:{Name:"",LongName:""},AdministrativeAreaLevel3:{Name:"",LongName:""},State:{Name:"",LongName:""},PinCode:"",FullAddress:""};r.a.featureGroup().addTo(t.map);t.editableLayers=(new r.a.FeatureGroup).addTo(t.map);new r.a.Control.Draw({edit:{featureGroup:t.editableLayers,poly:{allowIntersection:!0}},draw:{polygon:{allowIntersection:!1,drawError:{color:"#e1e100",message:"<strong>Oh snap!<strong> you can't draw that!"},shapeOptions:{color:"#bada55"}},polyline:!1,circle:!1,marker:!1,circlemarker:!1}}).addTo(t.map);t.map.addLayer(t.editableLayers),t.map.on("draw:editvertex",(function(a){var i=a.poly;i.getLatLngs(),i.getLatLngs()[0].forEach((function(a,i){t.lngLatData.push({Lat:a.lat,Lng:a.lng});var s=new google.maps.LatLng(t.lngLatData[0].Lat,t.lngLatData[0].Lng),n=new google.maps.Geocoder;n.geocode({latLng:s},(function(t,a){e.FullAddress=t[0].formatted_address})),t.fullAddress.push({LatLng:t.lngLatData,CompleteAddress:e})}))})),t.map.on("draw:created",(function(a){var i=a.layerType,s=a.layer;if("polygon"===i){s.on("mouseover",(function(){console.log(s.getLatLngs())})),t.editableLayers.addLayer(s),s.getLatLngs()[0].forEach((function(e,a){t.lngLatData.push({Lat:e.lat,Lng:e.lng})}));var n=new google.maps.LatLng(s.getLatLngs()[0][0].lat,s.getLatLngs()[0][0].lng),l=new google.maps.Geocoder;l.geocode({latLng:n},(function(a,i){e.FullAddress=a[0].formatted_address,a[0].address_components.forEach((function(a,i){"country"==a.types[0]?(e.Country.Name=a.short_name,e.Country.LongName=a.long_name):"postal_code"==a.types[0]?e.PinCode=a.long_name:"administrative_area_level_1"==a.types[0]?(e.AdministrativeAreaLevel1.LongName=a.long_name,e.AdministrativeAreaLevel1.Name=a.short_name,e.State.LongName=a.long_name,e.State.Name=a.short_name):"administrative_area_level_2"==a.types[0]?(e.AdministrativeAreaLevel2.LongName=a.long_name,e.AdministrativeAreaLevel2.Name=a.short_name):"administrative_area_level_3"==a.types[0]?(t.address.push({AdministrativeArea3:a.long_name}),e.AdministrativeAreaLevel3.LongName=a.long_name,e.AdministrativeAreaLevel3.Name=a.short_name):"locality"==a.types[0]&&(t.address.push({City:a.long_name}),e.City.LongName=a.long_name,e.City.Name=a.short_name)})),t.fullAddress.push({LatLng:t.lngLatData,CompleteAddress:e}),t.$emit("GetAddress",t.fullAddress)}))}else{t.lngLatData.push({Lat:a.layer._latlng.lat,Lng:a.layer._latlng.lng});n=new google.maps.LatLng(a.layer._latlng.lat,a.layer._latlng.lng),l=new google.maps.Geocoder;l.geocode({latLng:n},(function(a,i){e.FullAddress=a[0].formatted_address,a[0].address_components.forEach((function(a,i){"country"==a.types[0]?(e.Country.Name=a.short_name,e.Country.LongName=a.long_name):"postal_code"==a.types[0]?e.PinCode=a.long_name:"administrative_area_level_1"==a.types[0]?(e.AdministrativeAreaLevel1.LongName=a.long_name,e.AdministrativeAreaLevel1.Name=a.short_name,e.State.LongName=a.long_name,e.State.Name=a.short_name):"administrative_area_level_2"==a.types[0]?(e.AdministrativeAreaLevel2.LongName=a.long_name,e.AdministrativeAreaLevel2.Name=a.short_name):"administrative_area_level_3"==a.types[0]?(t.address.push({AdministrativeArea3:a.long_name}),e.AdministrativeAreaLevel3.LongName=a.long_name,e.AdministrativeAreaLevel3.Name=a.short_name):"locality"==a.types[0]&&(t.address.push({City:a.long_name}),e.City.LongName=a.long_name,e.City.Name=a.short_name)})),t.fullAddress.push({LatLng:t.lngLatData,CompleteAddress:e}),t.$emit("GetAddress",t.fullAddress)}))}}))},GetGoogleAddressToDraw:function(t){var e=this,a=t.overlay;e.currentSelectedShape=a;let i={City:{Name:"",LongName:""},Country:{Name:"",LongName:""},AdministrativeAreaLevel1:{Name:"",LongName:""},AdministrativeAreaLevel2:{Name:"",LongName:""},AdministrativeAreaLevel3:{Name:"",LongName:""},State:{Name:"",LongName:""},PinCode:"",FullAddress:""};if("polygon"==t.type){var s=t.overlay;s.type=t.type,e.lngLatData=[],"zoneMapDiv"==e.mapContainer&&(e.polygonNewShapeId=(new Date).getTime()+"_"+Math.floor(1e3*Math.random()),e.showAddZone=!0),t.overlay.getPath().getArray().map(t=>{e.lngLatData.push({latitude:t.lat(),longitude:t.lng()})}),s["ShapeId"]=e.polygonNewShapeId,google.maps.event.addListener(s,"click",(function(t,a,i){"zoneMapDiv"==e.mapContainer&&(e.polygonNewShapeId=this.ShapeId,e.showAddZone=!0,e.currentSelectedShape=this)}));var n=new google.maps.LatLng(e.lngLatData[0].latitude,e.lngLatData[0].longitude),l=new google.maps.Geocoder;l.geocode({latLng:n},(function(t,a){i.FullAddress=t[0].formatted_address,a==google.maps.GeocoderStatus.OK&&(t[0].address_components.forEach((function(t,a){"country"==t.types[0]?(i.Country.Name=t.short_name,i.Country.LongName=t.long_name):"postal_code"==t.types[0]?i.PinCode=t.long_name:"administrative_area_level_1"==t.types[0]?(i.AdministrativeAreaLevel1.LongName=t.long_name,i.AdministrativeAreaLevel1.Name=t.short_name,i.State.LongName=t.long_name,i.State.Name=t.short_name):"administrative_area_level_2"==t.types[0]?(i.AdministrativeAreaLevel2.LongName=t.long_name,i.AdministrativeAreaLevel2.Name=t.short_name):"administrative_area_level_3"==t.types[0]?(e.address.push({AdministrativeArea3:t.long_name}),i.AdministrativeAreaLevel3.LongName=t.long_name,i.AdministrativeAreaLevel3.Name=t.short_name):"locality"==t.types[0]&&(e.address.push({City:t.long_name}),i.City.LongName=t.long_name,i.City.Name=t.short_name)})),e.fullAddress.push({LatLng:e.lngLatData,CompleteAddress:i}),e.$emit("GetAddress",e.fullAddress),e.polygonData.push({Id:e.polygonNewShapeId,latLong:e.lngLatData,CompleteAddress:i,strokeOpacity:"",strokeWeight:"",strokeColor:"",fillColor:"",locatorids:""}))}))}else if("marker"==t.type){e.lngLatData.push({name:"",latLong:[{latitude:t.overlay.getPosition().lat(),longitude:t.overlay.getPosition().lng()}]});n=new google.maps.LatLng(t.overlay.getPosition().lat(),t.overlay.getPosition().lng()),l=new google.maps.Geocoder;l.geocode({latLng:n},(function(t,a){a==google.maps.GeocoderStatus.OK&&(t[0].address_components.forEach((function(t,a){"country"==t.types[0]?(i.Country.Name=t.short_name,i.Country.LongName=t.long_name):"postal_code"==t.types[0]?i.PinCode=t.long_name:"administrative_area_level_1"==t.types[0]?(i.AdministrativeAreaLevel1.LongName=t.long_name,i.AdministrativeAreaLevel1.Name=t.short_name,i.State.LongName=t.long_name,i.State.Name=t.short_name):"administrative_area_level_2"==t.types[0]?(i.AdministrativeAreaLevel2.LongName=t.long_name,i.AdministrativeAreaLevel2.Name=t.short_name):"administrative_area_level_3"==t.types[0]?(e.address.push({AdministrativeArea3:t.long_name}),i.AdministrativeAreaLevel3.LongName=t.long_name,i.AdministrativeAreaLevel3.Name=t.short_name):"locality"==t.types[0]&&(e.address.push({City:t.long_name}),i.City.LongName=t.long_name,i.City.Name=t.short_name)})),e.fullAddress.push({LatLng:e.lngLatData,CompleteAddress:i}),e.$emit("GetAddress",e.fullAddress))}))}},LoadMapboxHeatMap:function(t,e){var a=this;if("undefined"!=typeof a.map.getLayer("isoLayer")&&a.map.removeLayer("isoLayer"),"undefined"!=typeof a.map.getSource("iso"))return a.map.removeSource("iso"),!1;var i=document.getElementById("params"),s="https://api.mapbox.com/isochrone/v1/mapbox/",n=null,o=null,r=(s="https://api.mapbox.com/isochrone/v1/mapbox/",parseFloat(o,10),parseFloat(n,10),"driving"),c="10,20,30";function u(){var i=s+r+"/"+e+","+t+"?contours_minutes="+c+"&contours_colors="+a.colors+"&polygons=true&access_token="+l.a.accessToken;$.ajax({method:"GET",url:i}).done((function(t){a.map.getSource("iso").setData(t)}))}a.colors="3CEA19,EFF60B,F6320B",m(),a.map.flyTo({center:[e,t],zoom:10,essential:!0});var p=new d.a;function m(){a.map.addSource("iso",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),a.map.addLayer({id:"isoLayer",type:"fill",source:"iso",layout:{},paint:{"fill-color":["get","fillColor"],"fill-opacity":.5}},"poi-label");var i={lon:e,lat:t},s=localStorage.getItem("UserImage");String(s).indexOf("blob")<=0&&(s="https://app.talygen.com/Content/images/Black/user.png");var n=new l.a.Popup({offset:25}).setHTML("<div style='padding:8px;'><img style='float:left;' src='"+s+"' class='marker' /> <div style='display:block;'>@loggedUserInfo.Name </br>@loggedUserInfo.Email</div></div>"),o=document.createElement("div");o.className="marker",o.style.backgroundImage="url("+s+")",o.style.backgroundPosition="top center",o.style.backgroundSize="cover",o.style.width="40px",o.style.height="40px";var r=new l.a.Marker(o).setLngLat(i).setPopup(n).addTo(a.map);a.imageMarker.push(r),u()}a.map.addControl(p,"bottom-left"),i.addEventListener("change",(function(t){if("profile"===t.target.name)r=t.target.value,"foot-walking"==r?r="walking":"cycling-regular"==r?r="cycling":"driving-car"==r&&(r="driving"),u();else if("duration"===t.target.name){var e="",s="";$(i).find("input:checkbox:checked").length>0?($(i).find("input:checkbox:checked").each((function(){e.length>0&&(e+=","),s.length>0&&(s+=",");var t=$(this).val();e+=t,a.SetColor(t),s+=a.colors})),c=e,a.colors=s,u()):(c="10,20,30",a.colors="3CEA19,EFF60B,F6320B",u())}})),a.map.on("load",(function(){m()}))},TravelMode:function(t){var e=this;e.time=e.time-t,"LeafLet"==e.mapType?e.ShowEtaMap():"Google"==e.mapType?e.LoadGoogleHeatMap():"MapBox"==e.mapType&&e.LoadMapboxHeatMap()},ShowTravelMode:function(){var t=this;0==t.showSettingPopup?($(".settingPopup").removeClass("d-none"),t.showSetting=!1,t.showSettingPopup=!0):($(".settingPopup").addClass("d-none"),t.showSetting=!0,t.showSettingPopup=!1)},GetMapBoxAddressToDraw:function(t){var e=this;let a={City:{Name:"",LongName:""},Country:{Name:"",LongName:""},AdministrativeAreaLevel1:{Name:"",LongName:""},AdministrativeAreaLevel2:{Name:"",LongName:""},AdministrativeAreaLevel3:{Name:"",LongName:""},PinCode:"",State:{Name:"",LongName:""},FullAddress:""};const i=e.draw.getAll().features;if(i.length>1){const a=t.features[0].id;i.forEach((function(t){t.id!==a&&e.draw.delete(t.id)}));let s={location_nw:t.features[0].geometry.coordinates[0]+","+t.features[0].geometry.coordinates[1]};const n=e.drawLocationPointer(s);e.removeAllMarkersExceptCurrent(n)}if("Polygon"==t.features[0].geometry.type){t.features[0].geometry.coordinates[0].forEach((function(t,a){e.lngLatData.push({Lat:t[1],Lng:t[0]})}));var s=new google.maps.LatLng(t.features[0].geometry.coordinates[0][0][1],t.features[0].geometry.coordinates[0][0][0]),n=new google.maps.Geocoder;n.geocode({latLng:s},(function(t,i){a.FullAddress=t[0].formatted_address,i==google.maps.GeocoderStatus.OK&&(t[0].address_components.forEach((function(t,i){"country"==t.types[0]?(a.Country.Name=t.short_name,a.Country.LongName=t.long_name):"postal_code"==t.types[0]?a.PinCode=t.long_name:"administrative_area_level_1"==t.types[0]?(a.AdministrativeAreaLevel1.LongName=t.long_name,a.AdministrativeAreaLevel1.Name=t.short_name,a.State.LongName=t.long_name,a.State.Name=t.short_name):"administrative_area_level_2"==t.types[0]?(a.AdministrativeAreaLevel2.LongName=t.long_name,a.AdministrativeAreaLevel2.Name=t.short_name):"administrative_area_level_3"==t.types[0]?(e.address.push({AdministrativeArea3:t.long_name}),a.AdministrativeAreaLevel3.LongName=t.long_name,a.AdministrativeAreaLevel3.Name=t.short_name):"locality"==t.types[0]&&(e.address.push({City:t.long_name}),a.City.LongName=t.long_name,a.City.Name=t.short_name)})),e.fullAddress.push({LatLng:e.lngLatData,CompleteAddress:a}),e.$emit("GetAddress",e.fullAddress))}))}else{e.lngLatData.push({Lat:t.features[0].geometry.coordinates[1],Lng:t.features[0].geometry.coordinates[0]});s=new google.maps.LatLng(t.features[0].geometry.coordinates[1],t.features[0].geometry.coordinates[0]),n=new google.maps.Geocoder;n.geocode({latLng:s},(function(t,i){a.FullAddress=t[0].formatted_address,i==google.maps.GeocoderStatus.OK&&(t[0].address_components.forEach((function(t,i){"country"==t.types[0]?(a.Country.Name=t.short_name,a.Country.LongName=t.long_name):"postal_code"==t.types[0]?a.PinCode=t.long_name:"administrative_area_level_1"==t.types[0]?(a.AdministrativeAreaLevel1.LongName=t.long_name,a.AdministrativeAreaLevel1.Name=t.short_name):"administrative_area_level_2"==t.types[0]?(a.AdministrativeAreaLevel2.LongName=t.long_name,a.AdministrativeAreaLevel2.Name=t.short_name,a.State.LongName=t.long_name,a.State.Name=t.short_name):"administrative_area_level_3"==t.types[0]?(e.address.push({AdministrativeArea3:t.long_name}),a.AdministrativeAreaLevel3.LongName=t.long_name,a.AdministrativeAreaLevel3.Name=t.short_name):"locality"==t.types[0]&&(e.address.push({City:t.long_name}),a.City.LongName=t.long_name,a.City.Name=t.short_name)})),e.fullAddress.push({LatLng:e.lngLatData,CompleteAddress:a}),e.$emit("GetAddress",e.fullAddress))}))}}}},g=_,f=(a("d42b"),a("2877")),C=Object(f["a"])(g,i,s,!1,null,null,null);e["a"]=C.exports},"5fb0":function(t,e,a){"use strict";a("cba1")},"5ffb":function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,".ticketsmallfix.theme-primary .p-name{float:left}",""]),t.exports=e},"64e7":function(t,e,a){var i=a("f7f8");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("a400c4a4",i,!0,{sourceMap:!1,shadowMode:!1})},"66b5":function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h5",{staticClass:"modal-title"},[t._v(t._s(t.$t("History")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[t.InvoiceHistory.length?e("div",[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-6 col-lg-3"},[e("label",[e("b",[t._v(t._s(t.$t("InvoiceNumber"))+":")]),t._v(" "+t._s(t.InvoiceHistory[0].MainInvoiceNumber))])]),e("div",{staticClass:"col-md-6 col-lg-3"},[e("label",[e("b",[t._v(t._s(t.$t("IssueDate"))+":")]),t._v(" "+t._s(t.InvoiceHistory[0].MainInvoiceIssueDate))])]),e("div",{staticClass:"col-md-6 col-lg-3"},[e("label",[e("b",[t._v(t._s(t.$t("DueDate"))+":")]),t._v(" "+t._s(t.InvoiceHistory[0].MainInvoiceDueDate))])]),e("div",{staticClass:"col-md-6 col-lg-3"},[e("label",[e("b",[t._v(t._s(t.$t("Amount"))+":")]),t._v(" "+t._s(t.$n(t.InvoiceHistory[0].MainInvocieNetAmount,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])])]),t.InvoiceHistory[0].InvoiceListingGrid.Count>0?e("div",{staticClass:"listing mt-2"},[e("div",{staticClass:"table-responsive",attrs:{id:"divmemb"}},[e("table",{staticClass:"table table-bordered dt-responsive nowrap mt-0 w-100"},[e("thead",{staticClass:"thead-bg"},[e("tr",[t._m(0),e("th",{staticClass:"td2 tdcm"},[e("span",[t._v("Amount "+t._s(t.GetUserInfo.Currency))])]),t._m(1),t._m(2),t._m(3)])]),t.InvoiceHistory[0].InvoiceListingGrid.Count>0?e("tbody",t._l(t.InvoiceHistory[0].InvoiceListingGrid,(function(a,i){return e("tr",{key:i},[e("td",[t._v(" "+t._s(a.BillNumber)+" ")]),e("td",{staticClass:"tdcm"},[t._v(t._s(a.BillNetTotal.tofixed(2))+" ")]),e("td",{staticClass:"tdcm"},[t._v(" "+t._s(a.IssueDate)+" ")]),e("td",{staticClass:"tdcm"},[t._v(" "+t._s(a.BillDueDate)+" ")]),e("td",{staticClass:"tdcm"},[e("span",{staticClass:"px-2 py-1 text-white text-center",class:t.getStatusClass(a.StatusCode)},[t._v(" "+t._s(a.StatusName)+" ")])])])})),0):e("tbody",[e("tr",[e("td",{staticClass:"text-center text-danger py-3",attrs:{colspan:"5"}},[t._v(" "+t._s(t.$t("NoRecordfound"))+" ")])])])])])]):t._e(),e("div",{staticClass:"listing",attrs:{id:"divPostComment"}},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-12"},[e("ValidationProvider",{ref:"commentValidator",staticClass:"tt_textarea_span position-relative",attrs:{rules:"required",name:"title"},scopedSlots:t._u([{key:"default",fn:function({errors:a}){return[e("label",[t._v("Comment:"),e("span",{staticClass:"mandatory"},[t._v("*")])]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.comment,expression:"comment"}],staticClass:"form-control",class:a[0]?"is-invalid":"",attrs:{name:"title"},domProps:{value:t.comment},on:{keydown:t.textCounter,keyup:t.textCounter,mouseout:t.textCounter,input:function(e){e.target.composing||(t.comment=e.target.value)}}}),t._v(" "),e("span",{staticClass:"invalid-feedback"},[t._v(t._s(a[0]?t.$t("Comment"):""))])]}}],null,!1,414446076)}),e("br"),e("small",[e("strong",[e("span",{staticClass:"alert-warning px-2 mr-2",attrs:{id:"txtCount"}},[t._v(t._s(t.textCountertlength))])]),t._v(" "+t._s(t.$t("CharactersLeft"))+" ")])],1)]),e("div",{staticClass:"row flex-row-reverse"},[e("div",{staticClass:"col-lg-6 text-right"},[e("div",{staticClass:"search-btm-btn"},[e("a",{staticClass:"btn btn-success",attrs:{href:"javascript:;",id:"saveComment",name:"aSave",title:"PostNewComment"},on:{click:t.SaveComment}},[e("i",{staticClass:"fa fa-save pr-2"}),t._v(t._s(t.$t("PostNewComment")))]),e("a",{staticClass:"btn btn-danger ml-2",attrs:{href:"javascript:;",title:"Cancel"},on:{click:t.Close}},[e("i",{staticClass:"fa fa-close pr-2"}),t._v(t._s(t.$t("Cancel")))])])]),e("div",{staticClass:"col-lg-6"},[e("div",{staticClass:"py-2 text-danger"},[t._v(" "+t._s(t.$t("MandatoryString"))+" ")])])])]),e("div",{staticClass:"clearfix"}),e("div",{staticClass:"w-100 activity-tab mt-3",attrs:{id:"accordion"}},t._l(t.InvoiceHistory[0].CommentList,(function(a,i){return e("div",{key:i,staticClass:"card"},[e("div",{staticClass:"card-header"},[e("a",{staticClass:"card-link",attrs:{"data-toggle":"collapse",href:"#CommentAccordion"+i}},[e("div",{staticClass:"conversation-date heading-border"},[e("span",[t._v(t._s(a.DateGroup))])])])]),e("div",{staticClass:"collapse show",attrs:{id:"CommentAccordion"+i,"data-parent":"#accordion"}},t._l(a.CommentList,(function(i,s){return e("div",{staticClass:"card-body"},[e("div",{staticClass:"conversation-main"},[e("div",{staticClass:"conversation-time"},[e("span",[t._v(" "+t._s(t.FormatDateToTime(i.CommnetAt))+" ")])]),e("div",{staticClass:"conversation-box-con"},[e("div",{staticClass:"conversation-box"},[e("div",{staticClass:"name-circle light-yellow"},[null!=a.AVATAR?e("img",{staticClass:"img-circle avatar",attrs:{src:"https://cogniterblob.blob.core.windows.net/"+t.GetUserInfo.ContainerName+"/Upload/UserProfileImage/"+a.AVATAR,width:"51",height:"51",alt:"Image"}}):e("img",{staticClass:"img-circle avatar",attrs:{src:"/Content/images/DefaultImages/avatar-icon.jpg",width:"51",height:"51",alt:"Image"}})]),e("div",{staticClass:"conversation-header addednote-ticket"},[e("span",[e("span",{staticClass:"sender-name"}),e("span",{staticClass:"sender-department",attrs:{title:i.Comment}},[t._v(" "+t._s(i.Comment))])])]),e("div",{staticClass:"conversation-content"},[e("div",{staticClass:"col-12 p-0 notesdata"},[e("h6",{staticClass:"text-muted time"},[e("i",[e("b",[t._v(t._s(i.CommentByName))]),t._v(", Posted on: "),e("span",{staticClass:"text-danger"},[t._v(" "+t._s(i.CommnetAt)+" ")])])])])])])])])])})),0)])})),0)]):t._e()])])])])],1)])},s=[function(){var t=this,e=t._self._c;return e("th",{staticClass:"td1"},[e("span",[t._v("InvoiceNumber")])])},function(){var t=this,e=t._self._c;return e("th",{staticClass:"td3 tdcm"},[e("span",[t._v("DueDate")])])},function(){var t=this,e=t._self._c;return e("th",{staticClass:"td4 tdcm"},[e("span",[t._v("PaymentDate")])])},function(){var t=this,e=t._self._c;return e("th",{staticClass:"td4 tdcm"},[e("span",[t._v(" Status")])])}],n=(a("14d9"),a("9769")),l=(a("c1df"),{props:{BillId:{type:Number}},data(){return{isLoading:!1,InvoiceHistory:[],textCountertlength:2e3,comment:"",CurrencyCode:"PKR"}},created(){var t=this;this.fetchData(),t.CurrencyCode=t.GetUserInfo.Currency.replace(/[()]/g,"")},methods:{async fetchData(){this.isLoading=!0;try{const t=await n["a"].InvoiceHistory("invoiceId="+this.BillId),e=this.groupInvoiceData(t.data);this.InvoiceHistory=e}catch(t){console.error("Error fetching invoice data",t)}finally{this.isLoading=!1}},groupInvoiceData(t){const e=[];return t.forEach(t=>{let a=e.find(e=>e.MainInvoiceId===t.BILL_ID);a||(a={MainInvoiceId:t.BILL_ID,MainClientId:t.BILL_TO,MainInvoiceNumber:t.BILL_NUMBER,MainInvocieNetAmount:t.BILL_NET_TOTAL||0,MainInvoiceDueDate:new Date(t.DUE_DATE).toLocaleDateString(),MainInvoiceIssueDate:new Date(t.ISSUE_DATE).toLocaleDateString(),MainInvocieAmount:t.AMOUNT||0,CommentList:[],InvoiceListingGrid:[]},e.push(a)),this.addInvoiceDetails(a,t)}),e},addInvoiceDetails(t,e){if(t.CommentList||(t.CommentList=[]),1===e.ISPARENT&&e.COMMENT){let a=new Date(e.CREATED_AT),i=`${String(a.getDate()).padStart(2,"0")}-${a.toLocaleString("en-US",{month:"short"})}-${a.getFullYear()}`,s=t.CommentList.find(t=>t.DateGroup===i);s||(s={DateGroup:i,CommentList:[]},t.CommentList.push(s)),s.CommentList.push({CommnetAt:e.CREATED_AT?new Date(e.CREATED_AT).toLocaleString():"",Comment:e.COMMENT,CommentByName:e.CLIENT_NAME||"Unknown Client",UserTypeName:e.USER_TYPE_NAME||"Unknown Type",AVATAR:e.AVATAR})}0===e.ISPARENT&&(t.InvoiceListingGrid||(t.InvoiceListingGrid=[]),t.InvoiceListingGrid.push({BillId:e.BILL_ID,BillNumber:e.BILL_NUMBER,ClientName:e.CLIENT_NAME,ProjectName:e.PROJECT_NAME,BillDueDate:new Date(e.DUE_DATE).toLocaleDateString(),IssueDate:new Date(e.ISSUE_DATE).toLocaleDateString(),BillNetTotal:e.BILL_NET_TOTAL||0,StatusName:e.STATUS_NAME}))},Close(){this.$parent.isInvoiceHistory=!1},textCounter(){this.textCountertlength=2e3-this.comment.length},FormatDateToTime(t){const e=new Date(t.replace(/(\d{2})\/(\d{2})\/(\d{4}), (\d{2}):(\d{2}):(\d{2})/,"$2/$1/$3 $4:$5:$6"));let a=e.getHours(),i=e.getMinutes(),s=a>=12?"PM":"AM";a%=12,a=a||12,i=i<10?"0"+i:i;const n=`${a}:${i} ${s}`;return console.log(n),n},async SaveComment(){var t={invoiceId:this.BillId,comment:this.comment,invoiceNo:this.InvoiceHistory[0].MainInvoiceNumber,clientId:this.InvoiceHistory[0].MainClientId};let e=JSON.stringify(t);const a=await n["a"].CommentOnInvoice(e);if("Success"==a.data.Status){var i={message:a.data.Comment,notificationFor:a.data.NotificationFor,typeCode:"CB_INV_COMMENT",referenceId:a.data.InvoiceId,referenceId2:0};let t=JSON.stringify(i);await n["a"].InsertNotification(t);this.comment="",this.$refs.commentValidator.reset(),this.fetchData()}else this.ShowAlert(this.$t("ErrorWhileProcessingRequest"),"failure",!0,this.$t("Alert"))},getStatusClass(t){switch(t){case"CLBSND":return"bg-success";case"CLBDSPT":return"bg-info";case"CLBPAD":return"bg-primary";case"CLBRSTP":return"bg-danger";case"CLBBDBT":return"bg-dark";case"CLBDFT":return"bg-warning";default:return"bg-secondary"}}}}),o=l,r=a("2877"),c=Object(r["a"])(o,i,s,!1,null,null,null);e["a"]=c.exports},"6c3c":function(t,e,a){var i=a("e1f3");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("6abcaf44",i,!0,{sourceMap:!1,shadowMode:!1})},"6eea":function(t,e,a){var i=a("5b20");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("07c1471c",i,!0,{sourceMap:!1,shadowMode:!1})},7821:function(t,e,a){"use strict";a("e870")},"78fc":function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h5",{staticClass:"modal-title"},[t._v(t._s(t.$t("SendInvoice")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"row",attrs:{id:"divSend"}},[e("div",{staticClass:"heading-border mb-2 ml-2 mr-2"},[e("h5",{staticClass:"h5"},[e("span",[t._v(t._s(t.$t("FillSendEmailForm")))])])]),e("div",{staticClass:"col-sm-12 col-lg-6"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("SendAs"))+":")]),e("br"),e("span",[t._v(t._s(t.UserName))])])]),e("div",{staticClass:"col-sm-12 col-lg-6"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("Subject"))+": "),e("span",{staticClass:"text-danger"},[t._v("*")])]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.Subject,expression:"form.Subject"}],staticClass:"form-control",class:{"is-invalid":t.subjectError},attrs:{placeholder:"Subject",maxlength:"300",required:""},domProps:{value:t.form.Subject},on:{blur:t.validateSubject,input:function(e){e.target.composing||t.$set(t.form,"Subject",e.target.value)}}}),t.subjectError?e("small",{staticClass:"text-danger"},[t._v(t._s(t.subjectError))]):t._e()])]),e("div",{staticClass:"col-sm-12 col-md-10 col-lg-10 col-xl-10 float-left p-2"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("Recipients"))+": "),e("span",{staticClass:"text-danger"},[t._v("*")])]),e("div",{staticClass:"form-group",attrs:{id:"toRecipients"}},[e("Form",{ref:"emailRecipient",staticClass:"row",scopedSlots:t._u([{key:"default",fn:function({valid:a,errors:i}){return t._l(t.emails,(function(a,i){return e("div",{key:a.id,staticClass:"col-lg-12"},[e("Field",{attrs:{rules:{required:!0},name:"email"},scopedSlots:t._u([{key:"default",fn:function({field:s,errors:n}){return[e("div",{staticClass:"col-sm-12 col-md-10 col-lg-10 col-xl-10 float-left p-2 bg-light"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.email,expression:"entry.email"}],class:{"form-control ":!0,"is-invalid":n[0],"bg-white":0==i},attrs:{type:"email",disabled:!a.isEditing,readonly:!a.isEditing,placeholder:"Enter email"},domProps:{value:a.email},on:{input:function(e){e.target.composing||t.$set(a,"email",e.target.value)}}}),n.length?e("span",{staticClass:"text-danger"},[t._v(t._s(n[0]))]):t._e()]),e("div",{staticClass:"col-sm-12 col-md-2 col-lg-2 col-xl-2 float-left single-action mt-2",attrs:{id:"basic-addon2"}},[e("a",{staticClass:"actionicons float-left mr-3",attrs:{title:"Edit",href:"javascript:;","data-toggle":"tooltip","data-original-title":"Edit"},on:{click:function(e){return t.editRecipient(i)}}},[e("i",{staticClass:"fa fa-pencil text-success font-size-icons"})]),t.UpdateEmailsArray==i+1?e("a",{staticClass:"actionicons float-left clsforAddMore",attrs:{title:" Add More",href:"javascript:;","data-toggle":"tooltip","data-original-title":"Add More"},on:{click:function(e){return t.addNewRecipient(a,i)}}},[e("i",{staticClass:"fa fa-plus-circle text-dark font-size-icons"})]):t._e(),i>0?e("a",{staticClass:"actionicons float-left mr-3",attrs:{href:"javascript:;",idfor:"ancDeleRecp"},on:{click:function(e){return t.deleteRecipient(i)}}},[e("i",{staticClass:"fa fa-trash font-size-icons text-danger"})]):t._e()])]}}],null,!0)})],1)}))}}])})],1)])]),e("div",{staticClass:"col-sm-12 col-lg-6 options"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("SendMeCopy"))+":")]),e("div",{staticClass:"custom-control custom-checkbox"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.sendMeCopy,expression:"form.sendMeCopy"}],staticClass:"custom-control-input",staticStyle:{display:"none"},attrs:{type:"checkbox",name:"SendMeCopy",id:"chk_11"},domProps:{checked:Array.isArray(t.form.sendMeCopy)?t._i(t.form.sendMeCopy,null)>-1:t.form.sendMeCopy},on:{change:function(e){var a=t.form.sendMeCopy,i=e.target,s=!!i.checked;if(Array.isArray(a)){var n=null,l=t._i(a,n);i.checked?l<0&&t.$set(t.form,"sendMeCopy",a.concat([n])):l>-1&&t.$set(t.form,"sendMeCopy",a.slice(0,l).concat(a.slice(l+1)))}else t.$set(t.form,"sendMeCopy",s)}}}),e("label",{staticClass:"custom-control-label universal-custom-control-label pt-1",attrs:{for:"chk_11"}})])])]),e("div",{staticClass:"col-sm-12 col-lg-6 options"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("IncludePDFInvoice"))+":")]),e("div",{staticClass:"custom-control custom-checkbox"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.includePdf,expression:"form.includePdf"}],staticClass:"custom-control-input",staticStyle:{display:"none"},attrs:{type:"checkbox",name:"IncludePdf",id:"chk_12"},domProps:{checked:Array.isArray(t.form.includePdf)?t._i(t.form.includePdf,null)>-1:t.form.includePdf},on:{change:function(e){var a=t.form.includePdf,i=e.target,s=!!i.checked;if(Array.isArray(a)){var n=null,l=t._i(a,n);i.checked?l<0&&t.$set(t.form,"includePdf",a.concat([n])):l>-1&&t.$set(t.form,"includePdf",a.slice(0,l).concat(a.slice(l+1)))}else t.$set(t.form,"includePdf",s)}}}),e("label",{staticClass:"custom-control-label universal-custom-control-label pt-1",attrs:{for:"chk_12"}})])])]),e("div",{staticClass:"col-sm-12 col-lg-12"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("Message"))+":")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.Message,expression:"form.Message"}],staticClass:"form-control",attrs:{placeholder:"Type your description here",maxlength:"500"},domProps:{value:t.form.Message},on:{change:t.testLength,keyup:t.testLength,paste:t.testLength,input:function(e){e.target.composing||t.$set(t.form,"Message",e.target.value)}}})])])]),e("div",{staticClass:"row flex-row-reverse"},[e("div",{staticClass:"col-lg-12 text-right"},[e("a",{staticClass:"btn btn-success text-white",staticStyle:{cursor:"pointer"},attrs:{title:"Send",id:"aSendBill"},on:{click:t.sendInvoice}},[e("i",{staticClass:"fa fa-send pr-2"}),t._v("Send")]),e("a",{staticClass:"btn btn-danger text-white",staticStyle:{cursor:"pointer","margin-left":"6px"},attrs:{title:"Cancel",id:"aCancelBill"},on:{click:t.Close}},[e("i",{staticClass:"fa fa-close pr-2"}),t._v("Cancel")])])])])])])])],1)])},s=[],n=(a("14d9"),a("9769")),l={props:{BillId:{type:Number},InvoiceBillId:{type:String}},computed:{UpdateEmailsArray(){return this.emails?this.emails.length:0}},data(){return{UserName:this.GetUserInfo.Name,form:{BillId:this.BillId,Reciepients:"",Subject:null,Message:null,SendMeCopy:!1,IncludePdf:!1,UserId:this.GetUserInfo.ID,Name:null,Email:null,ReportType:"",ReportName:"TalygenInvoice",IsDetail:null,IsSummary:null,InvoiceTo:1,CompanyName:null,SubModuleCode:null,TemplateName:null},isEditing:!1,editableRecipient:"",isLoading:!1,emails:[],nextId:2,currentEditingIndex:null,subjectError:""}},created(){this.fetchData(),this.InvoiceBillId},methods:{async fetchData(){const t=await n["a"].Send("id="+this.BillId);if(null!=t.data){let a=t.data[0];this.form.Email=a.EMAIL_ID,this.form.InvoiceTo=a.INVOICE_TO,this.form.CompanyName=a.COMPANY_NAME,this.form.UserId=a.USER_ID;var e={id:0,email:a.EMAIL_ID,isEditing:!1};this.emails.push(e)}},editRecipient(t){this.emails[t].isEditing=!this.emails[t].isEditing},updateRecipient(){2===this.form.invoiceTo?this.form.companyName=this.editableRecipient:this.form.email=this.editableRecipient,this.isEditing=!1},addNewRecipient(){this.$refs.emailRecipient.validate().then(t=>{t?this.emails.push({id:this.nextId++,email:"",isEditing:!0}):console.log("Validation failed")}).catch(t=>{console.error("Validation error: ",t)})},deleteRecipient(t){this.emails.splice(t,1)},testLength(t){t.target.value.length>500&&(t.target.value=t.target.value.substring(0,500))},Close(){var t=this;t.$parent.isSendBill=!1},validateEmail(t){const e=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/;return e.test(t)},validateSubject(){return this.form.Subject&&""!==this.form.Subject.trim()?(this.subjectError="",!0):(this.subjectError="Subject is required.",!1)},async sendInvoice(){let t=this;if(t.isLoading=!0,!this.validateSubject())return;const e=this.emails.map(t=>t.email).join(",");this.form.Reciepients=e;try{const e=await n["a"].SendInvoice(JSON.stringify(this.form));"Success"==e.data.status?(t.isLoading=!1,t.ShowAlert(t.$t("Invoice sent successfully!"),"success"),t.Close()):(t.isLoading=!1,console.error("API error:",e.data))}catch(a){console.error("Request failed",a)}}}},o=l,r=a("2877"),c=Object(r["a"])(o,i,s,!1,null,null,null);e["a"]=c.exports},"79a3":function(t,e,a){"use strict";a("6c3c")},"7d9e":function(t,e,a){"use strict";a("ea0c")},"8a39":function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,".scrollable-container{height:385px;overflow-x:auto}",""]),t.exports=e},"8af5":function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,".custom-control-label{text-transform:capitalize}",""]),t.exports=e},"8e00":function(t,e,a){"use strict";a("0e46")},"8e2b":function(t,e,a){"use strict";a("4eb2")},"8f73":function(t,e,a){"use strict";a("ef94")},"8ffb":function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,".task-dec[data-v-06010b5f]{color:#007bff!important;text-decoration:none;background-color:transparent}",""]),t.exports=e},"922e":function(t,e,a){"use strict";a("5798")},"940f":function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,".switch[data-v-1d391c1a]{width:71px}",""]),t.exports=e},"967b":function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,".singleselectlook .multiselect__select:before{z-index:99}.singleselectlook .multiselect__tags{padding:8px 30px 0 8px!important;min-height:36px!important}.singleselectlook .multiselect__input{margin-bottom:0}",""]),t.exports=e},9904:function(t,e,a){var i=a("f2d7");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("b88d34dc",i,!0,{sourceMap:!1,shadowMode:!1})},9908:function(t,e,a){"use strict";a("390a")},"9a6f":function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,".word-color[data-v-2273132f]{color:#007bff}.pdf-color[data-v-2273132f]{color:#e2211b}.text-color[data-v-2273132f]{color:#f0ad4e}.excel-color[data-v-2273132f]{color:#28a745}.default-color[data-v-2273132f]{color:#6c757d}.file-icon[data-v-2273132f]{font-size:20px}",""]),t.exports=e},"9bdb":function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,".m-0[data-v-53b0216e],.ps[data-v-53b0216e]{margin:0}.ps[data-v-53b0216e]{padding:5px 0}.invoice-container[data-v-53b0216e]{max-width:1100px;width:1100px;min-width:1100px;margin:0 auto;background:#fff;padding:20px;border:1px solid #ddd;border-radius:5px;box-shadow:0 2px 5px rgba(0,0,0,.1);float:left}.header[data-v-53b0216e]{margin-bottom:20px}.header img[data-v-53b0216e]{max-height:50px}.invoice-details[data-v-53b0216e],.payment-advice[data-v-53b0216e]{margin-bottom:20px;width:100%;float:left}.invoice-details table.secondtable[data-v-53b0216e],.payment-advice table.secondtable[data-v-53b0216e]{width:100%;border-collapse:collapse;margin-top:10px}table.secondtable td[data-v-53b0216e],table.secondtable th[data-v-53b0216e]{border:1px solid #ddd;padding:10px;text-align:left}table.secondtable th[data-v-53b0216e]{background-color:#f4f4f4}.totals[data-v-53b0216e]{float:right;margin-top:10px;text-align:right;width:100%}.totals div[data-v-53b0216e]{margin-bottom:5px}.footer[data-v-53b0216e]{text-align:center;font-size:.9em;color:#666;margin-top:20px;width:100%;display:inline-block}@media (max-width:600px){.header[data-v-53b0216e]{flex-direction:column;align-items:flex-start}.totals[data-v-53b0216e]{float:none;text-align:left}}table.secondtable tbody td[data-v-53b0216e]{text-align:left}.header .div1[data-v-53b0216e]{width:49%;float:left!important}.header .div3[data-v-53b0216e]{width:40%;float:right!important}.header .div2[data-v-53b0216e]{width:100%;float:left!important}",""]),t.exports=e},"9dfd":function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,".plan-details,.plan-info{margin-bottom:20px}.plan-info p{margin:5px 0}.plan-details table{width:100%;border-collapse:collapse;margin-top:10px}.plan-details td,.plan-details th{border:1px solid #ddd;padding:8px;text-align:left}.plan-details th{background-color:#f2f2f2}.total{font-weight:700}.bg-light-custom{background:#efefef}",""]),t.exports=e},a015:function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("Slab"))+" "+t._s(t.$t("Details"))+" - "+t._s(t.TaxCtaegoryName))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.CloseSlabDeails}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"listing"},[e("div",{staticClass:"table-responsive"},[e("table",{staticClass:"table table-bordered dt-responsive nowrap mt-0",attrs:{id:"Addresslist"}},[e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",{staticClass:"text-center",attrs:{width:"5%"}},[t._v(" # ")]),e("th",{staticClass:"text-center"},[t._v(" "+t._s(t.$t("AmountFrom"))+" ")]),e("th",{staticClass:"text-center"},[t._v(" "+t._s(t.$t("AmountTo"))+" ")]),e("th",{staticClass:"text-center"},[e("span",{directives:[{name:"show",rawName:"v-show",value:"P"==t.rateType,expression:"rateType == 'P'"}]},[t._v(t._s(t.$t("TaxRates"))+"(%)")]),e("span",{directives:[{name:"show",rawName:"v-show",value:"F"==t.rateType,expression:"rateType == 'F'"}]},[t._v(t._s(t.$t("TaxRates")))])])])]),e("tbody",[0===t.RateData.length?e("tr",[e("td",{staticClass:"text-center text-danger no-record",attrs:{colspan:"8"}},[t._v(" "+t._s(t.$t("NoRecordfound"))+" ")])]):t._l(t.RateData,(function(a,i){return e("tr",{key:i},[e("td",{staticClass:"text-center"},[t._v(t._s(i+1))]),e("td",{staticClass:"text-center"},[t._v(" "+t._s(a.AmountFrom.toFixed(2))+" ")]),e("td",{staticClass:"text-center"},[t._v(" "+t._s(0==a.AmountTo?"∞":a.AmountTo.toFixed(2))+" ")]),e("td",{staticClass:"text-center"},[t._v(" "+t._s(a.TaxRate.toFixed(2))+" ")])])}))],2)])]),e("div",{staticClass:"row flex-row-reverse mt-3"},[e("div",{staticClass:"col-lg-6 text-right"},[e("a",{staticClass:"btn btn-danger mr-2",attrs:{href:"javascript:;",title:"Cancel"},on:{click:t.CloseSlabDeails}},[e("i",{staticClass:"fa fa-close pr-2"}),t._v(t._s(t.$t("Cancel")))])])])])])])])])],1)},s=[],n=a("9769"),l={props:{TaxCategoryData:{type:Object,Required:!0},Type:{type:String,Required:!0},rateType:{type:String,Required:!0}},data(){return{isLoading:!1,TaxCtaegoryName:"",RateData:[]}},created:async function(){null!=this.TaxCategoryData&&this.TaxCategoryDetails()},methods:{CloseSlabDeails:function(){var t=this;t.$emit("CloseSlabDeails")},TaxCategoryDetails(){var t=this;t.isLoading=!0;var e=`TaxCategoryId=${t.TaxCategoryData}&Type=${t.Type}`;n["a"].GetTaxCategoryDetails(e).then((function(e){if(t.isLoading=!1,e.data.result.SLABDATA.length>0&&(t.RateData=e.data.result.SLABDATA),e.data.result.DATA.length>0){var a=e.data.result.DATA;t.TaxCtaegoryName=a[0].name}}))}}},o=l,r=a("2877"),c=Object(r["a"])(o,i,s,!1,null,null,null);e["a"]=c.exports},a020:function(t,e,a){"use strict";a("0194")},a901:function(t,e,a){"use strict";a("e042")},aa62:function(t,e,a){"use strict";a("edf8")},aa7f:function(t,e,a){var i=a("5ffb");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("7e1bdc08",i,!0,{sourceMap:!1,shadowMode:!1})},acbf:function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"right-content right-content-expand border p-3"},[e("div",{staticClass:"container-fluid pt-2 p-0",attrs:{id:"divAddressfields"}},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-6"},[e("dynamic-form",{ref:"refAddress",attrs:{lang:"en",buttons:!1,schema:t.FormSchema}})],1),e("div",{staticClass:"col-md-6"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-12"},[e("MapComponent",{ref:"mapComponnet",staticClass:"row",attrs:{mapType:"MapBox",mapContainer:"addAddress",config:t.config,mapHeight:"355px",latLng:t.latLngValues},on:{GetAddress:t.GetAddress}}),e("div",{staticClass:"row flex-row-reverse mt-2"},[e("div",{staticClass:"col-lg-6 text-right"},[1==t.isUpdateForm?e("a",{staticClass:"btn btn-success mr-2",attrs:{href:"javascript:;",title:"",id:"addAddress","data-toggle-tooltip":"tooltip","data-original-title":"Save"},on:{click:t.onSubmit}},[e("i",{staticClass:"fa fa-refresh"}),e("span",{attrs:{id:"btnAddressText"}},[t._v(" "+t._s(t.$t("Update")))])]):e("a",{staticClass:"btn btn-success mr-2",attrs:{href:"javascript:;",title:"",id:"addAddress","data-toggle-tooltip":"tooltip","data-original-title":"Save"},on:{click:t.onSubmit}},[e("i",{staticClass:"fa fa-save mr-2"}),e("span",{attrs:{id:"btnAddressText"}},[t._v(" "+t._s(t.$t("Save")))])]),e("a",{staticClass:"btn btn-danger",attrs:{href:"javascript:;",title:"",id:"CancelAddress","data-toggle-tooltip":"tooltip","data-original-title":"Cancel"},on:{click:function(e){return t.cancelAddress()}}},[e("i",{staticClass:"fa fa-times mr-2"}),t._v(t._s(t.$t("Cancel")))])])])],1)])])]),e("div",{staticClass:"row col-lg-6"},[e("div",{staticClass:"py-2"},[e("span",{staticClass:"mandatory"},[t._v(t._s(t.$t("Mandatory")))])])]),t.AddressList.length>1?e("div",{staticClass:"mt-3 mb-2"},[e("div",{staticClass:"heading-border"},[e("h5",{staticClass:"h5"},[e("span",[t._v(t._s(t.$t("AdditionalAddresses")))]),e("small",{staticClass:"float-right"},[e("a",{class:{"table-head-btn":!0,disabled:!t.isdeleteButtonVisible},attrs:{title:"",id:"DeleteMultipleAddress","data-toggle-tooltip":"tooltip","data-original-title":"Please select one/multiple check box(s) to remove additional addresses(s)"},on:{click:function(e){return t.removeaddress("MultipleDelete")}}},[e("i",{staticClass:"fa fa-trash pr-2"}),t._v(t._s(t.$t("Delete"))+" ")])])])])]):t._e(),e("div",{staticClass:"row p-2"},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"ml-3 d-inline-block"},[e("span",{staticClass:"legend-pending colorboxsquare"}),t._v(t._s(t.$t("AddressIsVisibleToclient"))+" ")])])]),e("div",{staticClass:"listing"},[e("div",{staticClass:"table-responsive"},[e("table",{staticClass:"table table-bordered dt-responsive nowrap mt-0",attrs:{id:"Addresslist"}},[e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",{staticClass:"text-center",staticStyle:{width:"3%","min-width":"55px","max-width":"55px"},attrs:{scope:"col",width:"36px",id:"nonresize"}},[e("div",{staticClass:"custom-control custom-checkbox"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.allSelected,expression:"allSelected"}],staticClass:"AddressChkAll custom-control-input",attrs:{type:"checkbox",id:"chkAll_0",name:"checkbox"},domProps:{checked:Array.isArray(t.allSelected)?t._i(t.allSelected,null)>-1:t.allSelected},on:{click:function(e){return t.selectAll(e)},change:function(e){var a=t.allSelected,i=e.target,s=!!i.checked;if(Array.isArray(a)){var n=null,l=t._i(a,n);i.checked?l<0&&(t.allSelected=a.concat([n])):l>-1&&(t.allSelected=a.slice(0,l).concat(a.slice(l+1)))}else t.allSelected=s}}}),e("label",{staticClass:"custom-control-label universal-custom-control-label pt-1",attrs:{for:"chkAll_0"}})])]),t._m(0),e("th",{staticClass:"ui-resizable text-left",staticStyle:{width:"85px","min-width":"85px","max-width":"85px"},attrs:{id:"th-ADDRESS"}},[e("span",{staticStyle:{"min-width":"67px"}},[t._v(t._s(t.$t("Address")))]),e("div",{staticClass:"sizer",attrs:{id:"th-ADDRESS-sizer"}}),e("div",{staticClass:"ui-resizable-handle ui-resizable-e",staticStyle:{"z-index":"90"}})]),e("th",{staticClass:"text-left ui-resizable",staticStyle:{width:"192px","min-width":"192px","max-width":"192px"},attrs:{id:"th-NOTEDESCRIPTION"}},[e("span",{staticStyle:{"min-width":"174px"}},[t._v(t._s(t.$t("NotesDescription")))]),e("div",{staticClass:"sizer",attrs:{id:"th-NOTEDESCRIPTION-sizer"}}),e("div",{staticClass:"ui-resizable-handle ui-resizable-e",staticStyle:{"z-index":"90"}})]),e("th",{staticClass:"text-center ui-resizable",staticStyle:{width:"312px","min-width":"312px","max-width":"312px"},attrs:{id:"th-ITISINCOMPANYDIRECTORY"}},[e("span",{staticStyle:{"min-width":"294px"}},[t._v(t._s(t.$t("IsinCompanyDirectory")))]),e("div",{staticClass:"sizer",attrs:{id:"th-ITISINCOMPANYDIRECTORY-sizer"}}),e("div",{staticClass:"ui-resizable-handle ui-resizable-e",staticStyle:{"z-index":"90"}})]),e("th",{staticClass:"ui-resizable text-center",staticStyle:{width:"204px","min-width":"204px","max-width":"204px"},attrs:{id:"th-ISPRIMARYADDRESS"}},[e("span",{staticStyle:{"min-width":"186px"}},[t._v(t._s(t.$t("IsPrimary"))+" "+t._s(t.$t("Address")))]),e("div",{staticClass:"sizer",attrs:{id:"th-ISPRIMARYADDRESS-sizer"}}),e("div",{staticClass:"ui-resizable-handle ui-resizable-e",staticStyle:{"z-index":"90"}})]),e("th",{staticClass:"text-center ui-resizable",staticStyle:{width:"85px","min-width":"85px","max-width":"85px"},attrs:{id:"th-EDIT"}},[e("span",{staticStyle:{"min-width":"67px"}},[t._v(t._s(t.$t("Edit")))]),e("div",{staticClass:"sizer",attrs:{id:"th-EDIT-sizer"}}),e("div",{staticClass:"ui-resizable-handle ui-resizable-e",staticStyle:{"z-index":"90"}})]),e("th",{staticClass:"text-center ui-resizable",staticStyle:{width:"85px","min-width":"85px","max-width":"85px"},attrs:{id:"th-DELETE"}},[e("span",{staticStyle:{"min-width":"67px"}},[t._v(t._s(t.$t("Delete")))]),e("div",{staticClass:"sizer",attrs:{id:"th-DELETE-sizer"}}),e("div",{staticClass:"ui-resizable-handle ui-resizable-e",staticStyle:{"z-index":"90"}})])])]),e("tbody",[t._l(t.AddressList,(function(a,i){return e("tr",{class:1==a.is_client_address?"text-center high-bar":"text-center",attrs:{Key:i}},[e("td",{staticClass:"textaligncenter"},[e("div",{staticClass:"custom-control custom-checkbox"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.isSelected,expression:"item.isSelected"}],staticClass:"custom-control-input",attrs:{id:a.user_address_id,type:"checkbox",name:"checkbox"},domProps:{value:a.user_address_id,checked:Array.isArray(a.isSelected)?t._i(a.isSelected,a.user_address_id)>-1:a.isSelected},on:{change:[function(e){var i=a.isSelected,s=e.target,n=!!s.checked;if(Array.isArray(i)){var l=a.user_address_id,o=t._i(i,l);s.checked?o<0&&t.$set(a,"isSelected",i.concat([l])):o>-1&&t.$set(a,"isSelected",i.slice(0,o).concat(i.slice(o+1)))}else t.$set(a,"isSelected",n)},function(e){return t.select(e,a)}]}}),e("label",{staticClass:"custom-control-label universal-custom-control-label pt-1",attrs:{for:a.user_address_id}})])]),e("td",{staticClass:"text-center"},[e("strong",[t._v(t._s(i+1))])]),e("td",{staticClass:"text-left"},[t._v(" "+t._s((a.user_address_1||"")+" "+(a.user_address_2&&"null"==a.user_address_2.toLowerCase()?"":a.user_address_2||""))+" ")]),e("td",{staticClass:"text-left"},[t._v(" "+t._s(a.user_address_desc)+" ")]),1==a.add_to_directory?e("td",{staticClass:"text-center"},[t._v(" Yes ")]):e("td",{staticClass:"text-center"},[t._v(" NO ")]),e("td",[e("div",{staticClass:"custom-control custom-checkbox"},[e("input",{staticClass:"custom-control-input",staticStyle:{"z-index":"1",width:"19px","margin-top":"6px"},attrs:{type:"checkbox"},domProps:{checked:a.is_primary_address},on:{change:function(e){return t.setPrimaryAddress(e,a)}}}),e("label",{staticClass:"custom-control-label universal-custom-control-label pt-1"})])]),e("td",{staticClass:"text-center single-action"},[e("a",{staticClass:"enable",attrs:{"data-placement":"left",title:"",href:"javascript:;","data-toggle-tooltip":"tooltip","data-original-title":"Edit"},on:{click:function(e){return t.editAddress(a)}}},[e("em",{staticClass:"fa fa-pencil text-success action-icon"})])]),e("td",{staticClass:"text-center single-action"},[e("a",{staticClass:"enable",attrs:{"data-placement":"left",title:"",href:"javascript:;","data-toggle-tooltip":"tooltip","data-original-title":"Delete"},on:{click:function(e){return t.removeaddress("singleDelete",a)}}},[e("em",{staticClass:"fa fa-trash text-danger action-icon"})])])])})),0==t.AddressList.length?e("tr",[e("td",{staticClass:"text-danger text-center no-record",attrs:{colspan:"8"}},[t._v(t._s(t.$t("NoRecordfound")))])]):t._e()],2)])])])])])},s=[function(){var t=this,e=t._self._c;return e("th",{staticClass:"text-center ui-resizable",staticStyle:{width:"55px","min-width":"55px","max-width":"55px"},attrs:{id:"th-"}},[e("span",{staticStyle:{"min-width":"55px"}},[t._v("#")]),e("div",{staticClass:"sizer",attrs:{id:"th--sizer"}}),e("div",{staticClass:"ui-resizable-handle ui-resizable-e",staticStyle:{"z-index":"90"}})])}],n=(a("14d9"),a("5dbc")),l=a("9769"),o={name:"Address",components:{MapComponent:n["a"]},props:{UserId:{type:Number},IsClient:{type:String}},data(){return{config:{isShowDrawButton:!0,isShowSearchBox:!0},isUpdateForm:!1,userAddressId:null,countryList:[],isdeleteButtonVisible:!1,AddressList:[],Longitude:null,Latitude:null,latLngValues:"",allSelected:!1,addressIds:null,FormSchema:[{layoutType:"double",Data:[{astype:"TextField",label:this.$t("AddressLine1"),name:"Address Line 1:",value:"",placeholder:"",validationRules:{max:200,required:!0}},{astype:"TextField",label:this.$t("AddressLine2"),name:"Address Line 2:",value:"",placeholder:"",validationRules:{max:200,required:!1}},{astype:"SelectField",label:this.$t("COUNTRY"),name:"Country",value:"",placeholder:"",disabled:!0,validationRules:{required:!0,max:250},config:{options:[]}},{astype:"TextField",label:this.$t("StateProvince"),name:"State/Province",value:"",placeholder:"",disabled:!0,validationRules:{required:!1}},{astype:"TextField",label:this.$t("City"),name:"City:",value:"",placeholder:"",disabled:!0,validationRules:{required:!1},config:{options:[]}},{astype:"TextField",label:this.$t("ZIPCODE"),name:"Zip Code:",value:"",placeholder:"",disabled:!0,validationRules:{required:!1}},{astype:"TextField",label:this.$t("NotesDescriptionAbtAddress"),name:"Note/Description About Address",userGuide:"Example: office Address",value:"",placeholder:"",validationRules:{max:200,required:!1}},{astype:"toggleField",label:this.$t("AddToCompanyDirectory"),name:"Show in Company Directory",value:"",placeholder:""},{astype:"toggleField",label:this.$t("isVisibleToClient"),name:"Visible To Client",value:"",placeholder:"",config:{onChange:this.visibleToClient}}]}]}},created(){var t=this;t.GetCountryDDL(),t.getAdditionalAddressList(),"Client"==t.IsClient?t.FormSchema[0].Data[8].visibility=!1:t.FormSchema[0].Data[8].visibility=!0},methods:{visibleToClient(t,e){var a=this;1==t?(a.confirmR(a.$t("VisibleToClientValidation"),!0,!1,(function(t){if(void 0==t)return a.FormSchema[0].Data[8].value=!0})),a.FormSchema[0].Data[8].value=!1):a.FormSchema[0].Data[8].value=t},cancelAddress(){var t=this;t.clearForm(),t.isUpdateForm=!1,t.userAddressId=null,t.$refs.mapComponnet.removeMarker()},async setPrimaryAddress(t,e){var a=this;try{let s={Num:t.target.checked?1:0,userAddressID:e.user_address_id};var i="postString="+JSON.stringify(s);await l["a"].SetPrimaryAddress(i).then(t=>{"Success"==t.data.status&&(a.ShowAlert(a.$t("LeadOwnerChanged",[a.$t("PrimaryAddress")]),"success",!0,a.$t("Alert")),a.getAdditionalAddressList())})}catch(s){console.log("error message",s)}},clearForm(){var t=this;t.FormSchema[0].Data[0].value="",t.FormSchema[0].Data[1].value="",t.FormSchema[0].Data[2].value="",t.FormSchema[0].Data[3].value="",t.FormSchema[0].Data[4].value="",t.FormSchema[0].Data[5].value="",t.FormSchema[0].Data[6].value="",t.FormSchema[0].Data[7].value="",t.FormSchema[0].Data[8].value="",t.$refs.refAddress.validateForm.reset()},selectAll(){var t=this;let e=[],a="",i={};t.allSelected=!t.allSelected,t.allSelected?(t.AddressList.forEach(t=>{t.isSelected=!0}),t.isdeleteButtonVisible=!0):(t.AddressList.forEach(t=>{t.isSelected=!1}),t.isdeleteButtonVisible=!1),t.AddressList.forEach(t=>{1==t.isSelected&&(i={addressId:t.user_address_id,userId:t.user_id},e.push(i))}),a=e.map(t=>t.addressId).join(","),t.getAddressValue(a)},select(t,e){var a=this;let i=[],s="",n={};1==t.target.checked?(a.AddressList.forEach(t=>{t.user_address_id==e.user_address_id&&(t.isSelected=!0,a.allSelected=!1)}),a.isdeleteButtonVisible=!0):a.AddressList.forEach(t=>{t.user_address_id==e.user_address_id&&(t.isSelected=!1,a.allSelected=!1)}),a.AddressList.forEach(t=>{1==t.isSelected&&(n={addressId:t.user_address_id,userId:t.user_id},i.push(n))}),a.AddressList.length==i.length?a.allSelected=!0:a.allSelected=!1,s=i.map(t=>t.addressId).join(","),""==s&&(a.isdeleteButtonVisible=!1),a.getAddressValue(s)},getAddressValue(t){var e=this;e.addressIds="",e.addressIds=t},removeaddress(t,e){var a=this;e.is_primary_address?a.ShowAlert(a.$t("CheckRemovePrimaryAddress"),"warning",a.$t("Alert")):a.confirmR(a.$t("ConfirmDelete"),!0,!1,(function(i){let s="";try{s="MultipleDelete"==t?`ids=${a.addressIds}&userId=${a.UserId}`:`ids=${e.user_address_id}&userId=${a.UserId}`,l["a"].DeleteUserAddress(s).then(t=>{"Deleted"==JSON.parse(t.data).statuscode&&(a.allSelected=!1,a.$refs.mapComponnet.removeMarker(),a.clearForm(),a.isUpdateForm=!1,a.getAdditionalAddressList(),a.ShowAlert(a.$t("DeletedSuccess",[a.$t("Address")]),"Success",!0,a.$t("Alert")))})}catch(n){console.log("error message",n)}}))},editAddress(t){var e=this;e.latLngValues="",e.isUpdateForm=!0,e.FormSchema[0].Data[0].value=t.user_address_1,e.FormSchema[0].Data[1].value="null"==t.user_address_2.toLowerCase()?"":t.user_address_2||"",e.FormSchema[0].Data[2].value=t.country_id,e.FormSchema[0].Data[3].value=t.user_city,e.FormSchema[0].Data[4].value=t.user_state,e.FormSchema[0].Data[5].value=t.user_zipcode,e.FormSchema[0].Data[6].value=t.user_address_desc,e.FormSchema[0].Data[7].value=t.add_to_directory,e.FormSchema[0].Data[8].value=t.is_client_address,e.longitude=t.longitude,e.latitude=t.latitude,e.userAddressId=t.user_address_id;let a={location_nw:t.longitude.replace(",","")+t.latitude.replace(",",",")};e.latLngValues=a},async getAdditionalAddressList(){var t=this,e=`userId=${t.UserId}&userAddressId=0`;await l["a"].GetAdditionalAddressList(e).then(e=>{null!=e.data&&(t.AddressList=[],e.data.result.length>0&&(t.AddressList=e.data.result,t.AddressList.forEach(e=>{if(e.isSelected=!1,1==e.is_primary_address){let a={location_nw:e.longitude.replace(",","")+e.latitude.replace(",",",")};t.latLngValues=a}})))})},GetCountryDDL(){var t="moduleName=CRM&type=COUNTRIES",e=this;l["a"].GetCountryDDL(t).then(t=>{e.countryList=t.data.DATA,e.countryList.forEach(t=>{e.FormSchema[0].Data[2].config.options.push({name:""+t.name,value:""+t.value})}),this.$refs.refAddress.UpdateKeyValue()})},GetAddress(t){var e=this;e.Latitude="",e.Longitude="",e.$refs.mapComponnet.fullAddress=[],e.$refs.mapComponnet.lngLatData=[];var a=t.length-1;let i=e.countryList.filter(e=>e.name===t[a].CompleteAddress.Country.LongName);e.FormSchema[0].Data[0].value=t[a].CompleteAddress.FullAddress;var s=""==i?"":i[0].value;e.FormSchema[0].Data[2].value=s,e.FormSchema[0].Data[3].value=e.FormSchema[0].Data[4].value=t[a].CompleteAddress.State.LongName,e.FormSchema[0].Data[4].value=t[a].CompleteAddress.City.LongName,e.FormSchema[0].Data[5].value=t[a].CompleteAddress.PinCode;var n="",l="",o="",r="";t[a].LatLng.forEach((t,e)=>{0==e&&(n=t.Lat,l=t.Lng)}),e.Latitude=o+","+l,e.Longitude=n+","+r;let c={location_nw:e.Longitude.replace(",","")+e.Latitude.replace(",",",")};e.latLngValues=c},onSubmit(){var t=this;t.$refs.refAddress.validateForm.validate().then(async e=>{if(e){t.isLoading=!0;let e={user_id:t.UserId,user_address_id:null===t.userAddressId?0:t.userAddressId,user_address_1:t.FormSchema[0].Data[0].value,user_address_2:t.FormSchema[0].Data[1].value,country_id:parseInt(t.FormSchema[0].Data[2].value),user_city:t.FormSchema[0].Data[3].value,user_state:t.FormSchema[0].Data[4].value,user_zipcode:t.FormSchema[0].Data[5].value,user_address_desc:t.FormSchema[0].Data[6].value,is_client_address:t.FormSchema[0].Data[8].value,add_to_directory:t.FormSchema[0].Data[7].value,latitude:t.Latitude,longitude:t.Longitude};var a=new FormData;a.append("postString",JSON.stringify(e)),l["a"].AddupdateAdditionalAddress(a).then(e=>{t.isLoading=!1,null!=e.data?1==e.data?(t.ShowAlert(t.$t("AddedSuccess",[t.$t("Address")]),"success",!0,t.$t("Alert")),t.clearForm(),t.clearForm(),t.$refs.mapComponnet.removeMarker(),t.$refs.mapComponnet.clearSearchField(),t.$refs.mapComponnet.resetMap(),t.getAdditionalAddressList()):2==e.data&&(t.ShowAlert(t.$t("UpdatedSuccess",[t.$t("Address")]),"success",!0,t.$t("Alert")),t.clearForm(),t.clearForm(),t.isUpdateForm=!1,t.userAddressId=null,t.$refs.mapComponnet.removeMarker(),t.$refs.mapComponnet.clearSearchField(),t.$refs.mapComponnet.resetMap(),t.getAdditionalAddressList()):t.ShowAlert(t.$t("SomethingWentWrong"),"success",t.$t("Alert"))})}}).catch(t=>{console.error("Error validating form:",t)})},onCancel(){}}},r=o,c=(a("e109"),a("2877")),d=Object(c["a"])(r,i,s,!1,null,null,null);e["a"]=d.exports},b2e5:function(t,e,a){"use strict";a("573f")},b3a1:function(t,e,a){var i=a("5b91");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("4cd82fac",i,!0,{sourceMap:!1,shadowMode:!1})},b4f9:function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("Information")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[[e("div",{staticClass:"listing",attrs:{id:"traininglist"}},[e("div",{staticClass:"table-responsive"},[e("table",{staticClass:"table table-bordered dt-responsive nowrap mt-0 w-100",attrs:{id:"tblFollowUpList"}},[e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",{staticClass:"text-center",staticStyle:{width:"30px"}},[t._v(" "+t._s(t.$t("S.No"))+" ")]),e("th",[t._v(" "+t._s(t.$t("Message"))+" ")])])]),e("tbody",[0===t.invoiceLogs.length?e("tr",[e("td",{staticClass:"no_records no-record",attrs:{colspan:"6"}},[t._v(" "+t._s(t.$t("NoRecordfound"))+" ")])]):t._l(t.invoiceLogs,(function(a,i){return e("tr",{key:i},[e("td",{staticClass:"text-center"},[t._v(" "+t._s(i+1)+" ")]),e("td",{staticClass:"wordbreak"},[e("span",[t._v(t._s(a.message))])])])}))],2)])])])]],2)])])])],1)},s=[],n=a("9769"),l={props:{BillId:{type:Object,required:!0}},components:{},data(){return{isLoading:!1,invoiceLogs:[]}},created:function(){var t=this;t.FetchData()},methods:{FetchData:function(){var t=this;t.isLoading=!0;var e="exportId="+t.BillId;n["a"].GetExportErrorLogs(e).then(e=>{e.data?t.invoiceLogs=e.data:t.invoiceLogs=[],t.isLoading=!1})},Close:function(){var t=this;t.$parent.IsLogError=!1}}},o=l,r=a("2877"),c=Object(r["a"])(o,i,s,!1,null,null,null);e["a"]=c.exports},b750:function(t,e,a){"use strict";a("51ca")},ba15:function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,".switch[data-v-8e2971d4]{width:71px}",""]),t.exports=e},c39d:function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,".custom-control-label{text-transform:capitalize}",""]),t.exports=e},c976:function(t,e,a){"use strict";a("9904")},ca21:function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,".singleselectlook .multiselect__select:before{z-index:99}.singleselectlook .multiselect__tags{padding:8px 30px 0 8px!important;min-height:36px!important}.singleselectlook .multiselect__input{margin-bottom:0}",""]),t.exports=e},ca61:function(t,e,a){var i=a("11a4");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("49ce409c",i,!0,{sourceMap:!1,shadowMode:!1})},cba1:function(t,e,a){var i=a("9bdb");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("346f5de7",i,!0,{sourceMap:!1,shadowMode:!1})},cec3:function(t,e,a){"use strict";a("b3a1")},cf45:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("section",{staticClass:"main-content"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"padding-t_10 p-0",attrs:{id:"reportstabsdata"}},[e("div",{staticClass:"left-menu-tab pt-2"},[e("div",{staticClass:"col-md-12 p-0"},[e("div",{staticClass:"theme-primary partition"},[e("span",{staticClass:"p-name text-white"},[t._v(t._s(t.HeaderTitle))])])]),e("div",{staticClass:"left-tab-container"},[e("div",{staticClass:"mt-2 mCustomScrollbar _mCS_4"},[e("a",{staticClass:"card mobile-tab-accordian active",attrs:{href:"javascript:;","data-controllername":"billingrule","data-actionname":"ImportFormatListing"},on:{click:function(e){t.showMobileTabs=!t.showMobileTabs}}},[e("div",{staticClass:"card-header",attrs:{role:"tab"}},[e("h5",[e("span",{staticClass:"mb-0"},[e("i",{class:t.GetSelectedModuleItem.icon}),t._v(" "+t._s(t.$t(t.GetSelectedModuleItem.display_name))),e("i",{staticClass:"fa fa-angle-down rotate-icon float-right",attrs:{"aria-hidden":"true"}})])])])]),t.showMobileTabs?e("div",t._l(t.TabsList,(function(a){return t.GetSelectedModuleItem.display_name!=a.display_name?e("a",{staticClass:"card mobile-tab-accordian",attrs:{href:"javascript:;",title:a.display_name},on:{click:function(e){t.SetCurrentTab(a.display_name,a),t.showMobileTabs=!1}}},[e("div",{staticClass:"card-header",attrs:{role:"tab"}},[e("h5",[e("span",{staticClass:"mb-0"},[e("em",{class:a.icon}),t._v(t._s(t.TruncateStr(t.$t(a.display_name),25))),e("em",{staticClass:"fa fa-angle-down rotate-icon float-right",attrs:{"aria-hidden":"true"}})])])])]):t._e()})),0):t._e(),e("ul",{staticClass:"nav nav-pills flex-column left-tab mt-1 responivecustomtab nav-tabs"},t._l(t.TabsList,(function(a,i){return t.IsSubscriptionBilling||t.IsUtilityBilling?e("li",{key:i,staticClass:"nav-item"},["AdditionalInfoClient"!==a.display_name?e("a",{class:{"nav-link left-menu gen_icon":!0,"active show":t.isActiveTab(a)},attrs:{id:a.unique_id,href:"#"+a.extra_condition,"data-toggle":"tab",role:"tab",title:t.$t(a.display_name),"aria-controls":a.extra_condition},on:{click:function(e){return t.setActiveTab(a)}}},[e("em",{staticClass:"fa",class:a.icon,attrs:{"aria-hidden":"true"}}),t._v(" "+t._s(t.$t(a.display_name))+" ")]):"AdditionalInfoClient"===a.display_name?e("a",{class:{"nav-link left-menu gen_icon":!0,"active show":t.isActiveTab(a)},attrs:{id:a.unique_id,href:"#"+a.extra_condition,"data-toggle":"tab",role:"tab",title:t.$t("TalygenUtility"),"aria-controls":a.extra_condition},on:{click:function(e){return t.setActiveTab(a)}}},[e("em",{staticClass:"fa",class:a.icon,attrs:{"aria-hidden":"true"}}),t._v(" "+t._s(t.$t("TalygenUtility"))+" ")]):t._e()]):e("li",{directives:[{name:"show",rawName:"v-show",value:"Plans"!==a.display_name,expression:"item.display_name !== 'Plans'"}],staticClass:"nav-item"},[e("a",{class:{"nav-link left-menu gen_icon":!0,"active show":t.isActiveTab(a)},attrs:{id:a.unique_id,href:"#"+a.extra_condition,"data-toggle":"tab",role:"tab",title:t.$t(a.display_name),"aria-controls":a.extra_condition},on:{click:function(e){return t.setActiveTab(a)}}},[e("em",{staticClass:"fa",class:a.icon,attrs:{"aria-hidden":"true"}}),t._v(" "+t._s(t.$t(a.display_name))+" ")])])})),0)])])]),e("div",{staticClass:"right-content"},["aAdditionalNewContacts"!=t.activeTab&&"ancPlanMapping"!=t.activeTab&&"ancInvoices"!=t.activeTab&&"aContracts"!=t.activeTab&&"MeterReading"!=t.activeTab&&"aTax"!=t.activeTab&&"APro"!=t.activeTab&&"RateSchedule"!=t.activeTab||!t.IsUtilityBilling&&"RateSchedule"==t.activeTab?e("div",{staticClass:"mt-2 theme-primary partition p-actions-expand",attrs:{id:"ReturnRequestHeading"}},[e("span",{staticClass:"p-name text-white"},[t._v(t._s(t.HeaderText))]),e("span",{staticClass:"p-actions float-right"},[e("RouterLink",{staticClass:"p-action-btn text-white float-right",attrs:{to:"/Client/Index"}},[e("em",{staticClass:"fa fa-angle-double-left"}),e("br"),t._v(" "+t._s(t.$t("BacktoList"))+" ")])],1),"creditInfo"==t.activeTab?e("span",{staticClass:"p-actions float-right"},[e("a",{staticClass:"p-action-btn text-white rqst-doc",on:{click:function(e){return t.AddMore(t.activeTab)}}},[e("em",{staticClass:"fa fa-plus pr-2"}),t._v(" "),e("br"),t._v(t._s(t.$t("AddMore")))])]):t._e(),"aCompanyHoliday"==t.activeTab?e("span",{staticClass:"p-actions float-right"},[e("a",{staticClass:"p-action-btn text-white rqst-doc",on:{click:t.AddContractHoliady}},[e("em",{staticClass:"fa fa-plus pr-2"}),t._v(" "),e("br"),t._v(t._s(t.$t("Add")))])]):t._e(),"aCompanyHoliday"==t.activeTab?e("span",{staticClass:"p-actions float-right"},[e("a",{staticClass:"p-action-btn text-white rqst-doc",on:{click:t.AddBankHoliady}},[e("em",{staticClass:"fa fa-cogs pr-2"}),t._v(" "),e("br"),t._v(t._s(t.$t("HolidayBank")))])]):t._e(),"aCompanyHoliday"==t.activeTab?e("span",{staticClass:"p-actions float-right"},[e("a",{staticClass:"p-action-btn text-white rqst-doc",on:{click:t.AddContract}},[e("em",{staticClass:"fa fa-plus pr-2"}),t._v(" "),e("br"),t._v(t._s(t.$t("AddContract")))])]):t._e(),"ancDivisionMapping"==t.activeTab?e("span",{staticClass:"p-actions float-right"},[e("a",{staticClass:"p-action-btn text-white rqst-doc",on:{click:t.AddInvoice}},[e("em",{staticClass:"fa fa-plus pr-2"}),t._v(" "),e("br"),t._v(t._s(t.$t("AddMore")))])]):t._e(),"AdditionalInfo"==t.activeTab?e("span",{staticClass:"p-actions float-right"},[e("a",{staticClass:"p-action-btn text-white rqst-doc",on:{click:t.AddUtility}},[e("em",{staticClass:"fa fa-plus pr-2"}),t._v(" "),e("br"),t._v(t._s(t.$t("AddMore")))])]):t._e()]):t._e(),t.isGeneral?e("div",{class:{"tab-pane fade p-3 pb-2 border ":!0,"active show":"general"==t.activeTab},attrs:{id:t.activeTab,role:"tabpanel","aria-labelledby":t.activeTab}},[e("GeneralNewTab",{attrs:{ClientData:t.ClientData,UserId:t.ClientId,IsClient:"Client"}})],1):t._e(),t.isAddress?e("div",{class:{"tab-pane fade p-0 pb-2 border-0 mt-3":!0,"active show":"aAddresses"==t.activeTab},attrs:{id:t.activeTab,role:"tabpanel","aria-labelledby":t.activeTab}},[e("Address",{attrs:{ClientData:t.ClientData,UserId:t.ClientId,IsClient:"Client"}})],1):t._e(),t.isConfiguration?e("div",{class:{"tab-pane fade p-0 pb-2 border-0 mt-3":!0,"active show":"clientConfig"==t.activeTab},attrs:{id:t.activeTab,role:"tabpanel","aria-labelledby":t.activeTab}},[e("ConfigurationModal",{attrs:{ClientId:t.ClientId}})],1):t._e(),t.isContact?e("div",{class:{"tab-pane fade p-0 pb-2 border-0 mt-3":!0,"active show":"aContactNumbers"==t.activeTab},attrs:{id:t.activeTab,role:"tabpanel","aria-labelledby":t.activeTab}},[e("ContactNumberVue",{attrs:{isEditUser:t.isEditUser,UserId:t.ClientId,IsClient:"Client"},on:{userTypeId:t.receiveUserTypeId}})],1):t._e(),t.isCommunication?e("div",{class:{"tab-pane fade p-0 pb-2 border-0 mt-3":!0,"active show":"aAdditionalEmails"==t.activeTab},attrs:{id:t.activeTab,role:"tabpanel","aria-labelledby":t.activeTab}},[e("Communication",{attrs:{GetConfiguration:t.GetConfiguration,IsClient:"Client"}})],1):t._e(),t.isQuote?e("div",{class:{"tab-pane fade p-0 pb-2 border-0 mt-3":!0,"active show":"aQuotation"==t.activeTab},attrs:{id:t.activeTab,role:"tabpanel","aria-labelledby":t.activeTab}},[e("Quotation",{attrs:{ClientData:t.ClientData,UserId:t.ClientId}})],1):t._e(),t.isContract?e("div",{class:{"tab-pane fade p-0 pb-2 border-0 mt-3":!0,"active show":"aContracts"==t.activeTab},attrs:{id:t.activeTab,role:"tabpanel","aria-labelledby":t.activeTab}},[e("Contract",{attrs:{ClientData:t.ClientData,UserId:t.ClientId}})],1):t._e(),t.isBill?e("div",{class:{"tab-pane fade p-0 pb-2 border-0":!0,"active show":"ancInvoices"==t.activeTab},attrs:{id:t.activeTab,role:"tabpanel","aria-labelledby":t.activeTab}},[e("BillListing",{attrs:{ClientData:t.ClientData,UserId:t.ClientId}})],1):t._e(),t.isPlan?e("div",{class:{"tab-pane fade p-0 pb-2 border-0 mt-2":!0,"active show":"ancPlanMapping"==t.activeTab},attrs:{id:t.activeTab,role:"tabpanel","aria-labelledby":t.activeTab}},[e("SubscriptionListing",{attrs:{ClientData:t.ClientData,UserId:t.ClientId}})],1):t._e(),t.isCreditHistory?e("div",{class:{"tab-pane fade p-0 pb-2 border-0 mt-3":!0,"active show":"creditInfo"==t.activeTab},attrs:{id:t.activeTab,role:"tabpanel","aria-labelledby":t.activeTab}},[e("CreditHistory",{key:t.refreshKey,attrs:{ClientData:t.ClientData,UserId:t.ClientId}}),t.AddHistory?e("AddCreditHistory",{attrs:{ClientData:t.ClientData,UserId:t.ClientId}}):t._e()],1):t._e(),t.isAdditionalContact?e("div",{class:{"tab-pane fade p-0 pb-2 border-0 mt-3":!0,"active show":"aAdditionalNewContacts"==t.activeTab},attrs:{id:t.activeTab,role:"tabpanel","aria-labelledby":t.activeTab}},[e("AdditionalContact",{key:t.refreshKey,attrs:{ClientData:t.ClientData,UserId:t.ClientId}})],1):t._e(),t.isInvoiceGrouping?e("div",{class:{"tab-pane fade p-0 pb-2 border-0 mt-3":!0,"active show":"ancDivisionMapping"==t.activeTab},attrs:{id:t.activeTab,role:"tabpanel","aria-labelledby":t.activeTab}},[e("InvoiceGrouping",{key:t.refreshKey,attrs:{ClientData:t.ClientData,UserId:t.ClientId,InvoiceData:t.InvoiceData,IsInvoiceGroupingDataShow:t.IsInvoiceGroupingDataShow}})],1):t._e(),t.isAdditionalInfoClient?e("div",{class:{"tab-pane fade p-0 pb-2 border-0 mt-3":!0,"active show":"AdditionalInfo"==t.activeTab},attrs:{id:t.activeTab,role:"tabpanel","aria-labelledby":t.activeTab}},[e("UtilityTab",{key:t.refreshKey,attrs:{ClientData:t.ClientData,IsAdditionalInfoDataShow:t.IsAdditionalInfoDataShow,AdditionalInfoData:t.AdditionalInfoData,UserId:t.ClientId}})],1):t._e(),t.isContractHoliday?e("div",{class:{"tab-pane fade p-0 pb-2 border-0 mt-3":!0,"active show":"aCompanyHoliday"==t.activeTab},attrs:{id:t.activeTab,role:"tabpanel","aria-labelledby":t.activeTab}},[e("ContractHoliday",{key:t.crefreshKey,attrs:{UserId:t.ClientId}}),t.IsAddContract?e("AddContract",{attrs:{UserId:t.ClientId,IsFor:t.IsFor,ContractHolidayData:t.ContractHolidayData},on:{CloseAddContract:t.CloseAddContract}}):t._e(),t.IsAddBnakHoliday?e("AddBnakHoliday",{on:{CloseHolidayBank:t.CloseHolidayBank}}):t._e()],1):t._e(),t.isMeter?e("div",{class:{"tab-pane fade p-0 pb-2 border-0 mt-3":!0,"active show":"aMeter"==t.activeTab},attrs:{id:t.activeTab,role:"tabpanel","aria-labelledby":t.activeTab}},[e("MapMeter",{key:t.refreshKey,attrs:{ClientData:t.ClientData,UserId:t.ClientId}})],1):t._e(),t.isMeterReading?e("div",{class:{"tab-pane fade p-0 pb-2 border-0 mt-3":!0,"active show":"MeterReading"==t.activeTab},attrs:{id:t.activeTab,role:"tabpanel","aria-labelledby":t.activeTab}},[e("MeterReading",{key:t.refreshKey,attrs:{ClientData:t.ClientData,UserId:t.ClientId}})],1):t._e(),t.isAdditionalOwner?e("div",{class:{"tab-pane fade p-0 pb-2 border-0 mt-1":!0,"active show":"AdditionalOwner"==t.activeTab},attrs:{id:t.activeTab,role:"tabpanel","aria-labelledby":t.activeTab}},[e("AdditionalOwner",{attrs:{ClientData:t.ClientData,ClientId:t.ClientId,IsClient:"Client"}})],1):t._e(),t.isRateSchedule?e("div",{class:{"tab-pane fade p-0 pb-2 border-0 mt-3":!0,"active show":"RateSchedule"==t.activeTab},attrs:{id:t.activeTab,role:"tabpanel","aria-labelledby":t.activeTab}},[e("RateSchedule",{attrs:{ClientData:t.ClientData,ClientId:t.ClientId,IsClient:"Client"}})],1):t._e(),t.isTax?e("div",{class:{"tab-pane fade p-0 pb-2 border-0 mt-0":!0,"active show":"aTax"==t.activeTab},attrs:{id:t.activeTab,role:"tabpanel","aria-labelledby":t.activeTab}},[e("TaxListing",{attrs:{ClientData:t.ClientData,ClientId:t.ClientId,ChecKPrivilege:t.isTax}})],1):t._e(),t.isPro?e("div",{class:{"tab-pane fade p-0 pb-2 border-0 mt-0":!0,"active show":"APro"==t.activeTab},attrs:{id:t.activeTab,role:"tabpanel","aria-labelledby":t.activeTab}},[e("Property",{attrs:{ClientData:t.ClientData,ClientId:t.ClientId,ChecKPrivilege:t.isPro}})],1):t._e(),t.aWallet?e("div",{class:{"tab-pane fade p-0 pb-2 border-0 mt-0":!0,"active show":"aWallet"==t.activeTab},attrs:{id:t.activeTab,role:"tabpanel","aria-labelledby":t.activeTab}},[e("WalletRecharge",{attrs:{ClientId:t.ClientId,parentId:t.parentId}})],1):t._e()])])],1)},s=[],n=(a("14d9"),a("9769")),l=function(){var t=this,e=t._self._c;return e("section",[e("loader",{attrs:{"is-visible":t.isLoading}}),e("dynamic-form",{ref:"dynamicform",attrs:{lang:"en",buttons:t.buttons,schema:t.FormSchema},on:{OnSubmit:t.OnSubmit},scopedSlots:t._u([{key:"tgslot-Avatar",fn:function({data:a}){return[e("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 prof_control float-left p-0 d-flex flex-wrap"},[e("div",{staticClass:"user-detail bg-light p-2 w-100 border position-relative float-left"},[e("div",{staticClass:"user-image",attrs:{title:"Profile Image"}},[""!=t.base64String&&null!=t.base64String||""!=t.profilePicture&&null!=t.profilePicture||"M"!=t.gender&&""!=t.gender&&null!=t.gender?t._e():e("img",{attrs:{id:"maleProfile",src:"https://talygenv.github.io/Vue-UI-Content/images/avatar-icon.jpg",alt:"Profile Image",loading:"lazy"}}),""!=t.base64String&&null!=t.base64String||""!=t.profilePicture&&null!=t.profilePicture||"F"!=t.gender?t._e():e("img",{attrs:{id:"femaleProfile",src:"https://talygenv.github.io/Vue-UI-Content/images/avatar-icon-girl.jpg",alt:"Profile Image",loading:"lazy"}}),""!=t.base64String&&null!=t.base64String||""==t.profilePicture||null==t.profilePicture?t._e():e("img",{attrs:{src:"https://cogniterblob.blob.core.windows.net/"+t.containerName+"/Upload/UserProfileImage/"+t.profilePicture,alt:"Profile Image",loading:"lazy"}}),""!=t.base64String?e("img",{attrs:{src:"data:image/gif;base64,"+t.base64String,loading:"lazy"}}):t._e()]),e("div",{staticClass:"user-name ml-4 mt-3"}),e("div",{staticClass:"user-name ml-4 mt-0"},[e("div",{staticClass:"col-10 col-sm-10 col-lg-10 col-xl-10 float-left p-0"},[e("input",{key:t.fileInputKey,staticStyle:{position:"absolute",clip:"rect(0px, 0px, 0px, 0px)"},attrs:{type:"file",id:"flAvatar",size:"19",accept:".jpeg,.jpg,.jpe,.gif,.bmp,.dib,.ico,.png,.tif",name:"flAvatar",tabindex:"-1"},on:{change:function(e){return t.GetBase64String(e)}}}),e("div",{staticClass:"bootstrap-filestyle input-group"},[e("input",{staticClass:"form-control disabled",attrs:{type:"text",id:"aaaa",disabled:"disabled"},domProps:{value:t.attachmentName}}),e("div",{staticClass:"input-group-append",staticStyle:{cursor:"pointer"}},[e("span",{staticClass:"group-span-filestyle input-group-btn input-group-text bg-white",attrs:{tabindex:"0"}},[e("label",{staticClass:"mb-0 font-weight-normal",attrs:{title:"Click here to select a file.",for:"flAvatar"}},[t._v(" "+t._s(t.$t("FileControlText"))+" ")])])])])]),e("div",{staticClass:"col-2 col-sm-2 col-lg-2 col-xl-2 float-left pl-0"},[e("a",{staticClass:"actionicons float-left round-icon-small btn-danger-light ml-2",attrs:{id:"clearUserfile",href:"javascript:;",title:"Click here to clear attachment"},on:{click:function(e){return t.ResetProfileImage()}}},[e("i",{staticClass:"fa fa-undo"})])])])])])]}}])})],1)},o=[],r=(a("b7ef"),{props:{ClientData:{type:Object,required:!0}},data(){return{isLoading:!1,avatar:"avatar-icon.jpg",userId:0,ClientId:0,fileError:null,MandatoryString:"Fields marked with an asterisk (*) are mandatory.",companyId:null,userId:null,AccountName:"",AccountProfileData:[],fileData:[],fileInputKey:0,profilePicture:"",gender:"",containerName:"",attachmentName:"",base64String:"",FormSchema:[{layoutType:"four",Data:[{astype:"TextField",label:this.$t("FirstName"),name:"FirstName",value:"",validationRules:{required:!0},disabled:!1},{astype:"TextField",label:this.$t("LastName"),name:"LastName",value:"",validationRules:{required:!0},disabled:!1},{astype:"TextField",label:this.$t("Email"),name:"Email",value:"",validationRules:[{email:!0},{required:!0}],disabled:!0},{astype:"SelectField",label:this.$t("Gender"),name:"Gender",value:"",placeholder:"",validationRules:{required:!1},config:{options:[{value:"M",name:"Male"},{value:"F",name:"Female"}],onChange:this.onChangeGender},visibility:!0,disabled:!1}]},{layoutType:"four",Data:[{astype:"RadioField",label:this.$t("ACCOUNT"),name:"Account",value:1,validationRules:{required:!1,max:200},config:{options:[{name:this.$t("ExistingAccount"),value:1},{name:this.$t("CreateNewAccount"),value:2}],showAddIcon:!1,onChange:this.onChangeRadio}},{astype:"SelectField",label:this.$t("ParentAccounts"),name:"ParentAccounts",value:"",placeholder:"",validationRules:{required:!0},config:{options:[]},visibility:!0},{astype:"TextField",label:this.$t("AccountName"),name:"AccountName",value:"",validationRules:{required:!0},disabled:!1,visibility:!1},{astype:"SelectField",label:this.$t("ClientOwner"),name:"ClientOwner",value:"",placeholder:"",validationRules:{required:!0},config:{options:[]},visibility:!0},{astype:"SelectField",label:this.$t("CustomerType"),name:"CustomerType",value:"",placeholder:"",validationRules:{required:!1},config:{options:[]},visibility:!0}]},{group_name:this.$t("AdvancedSettings"),layoutType:"four",Data:[{astype:"SelectField",label:this.$t("TimeZone"),name:"TimeZone",value:"",placeholder:"",validationRules:{required:!1},config:{options:[]},visibility:!0},{astype:"SelectField",label:this.$t("DateFormat"),name:"DateFormat",value:"M/D/YYYY",placeholder:"",validationRules:{required:!1},config:{options:[{name:"M/d/yyyy",value:"M/D/YYYY"},{name:"dd/MM/yyyy",value:"DD/MM/YYYY"}]},visibility:!0},{astype:"SelectField",label:this.$t("Role"),name:"Role",value:"",placeholder:this.$t("Role"),validationRules:{required:!1},config:{options:[]},visibility:!0},{astype:"SelectField",label:this.$t("Jurisdiction"),name:"Jurisdiction",value:"",config:{options:[]},placeholder:this.$t("Select Jurisdiction"),validationRules:{required:!1,max:100}}]},{layoutType:"single",Data:[{astype:"SlotField",label:this.$t("Avatar"),name:"Avatar",value:"",visibility:!0,placeholder:"",config:{options:[],showAddIcon:!1},validationRules:""}]}],buttons:[{type:"submit",class:"btn btn-success",text:"<i class='fa fa-save pr-2'></i>Save",isVisible:!0},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Cancel",onClick:this.Close}]}},created:async function(){var t=this;t.isLoading=!0,t.userId=t.GetUserInfo.ID,t.user_type=t.GetUserInfo.UserType,t.companyId=t.GetUserInfo.CompanyId,t.CompanyName=t.GetUserInfo.CompanyName,t.GetTaxJurisdiction(),await this.GetClientParentByCompanyId(),await this.GetClientOwner(),await this.GetTimeZone(),await this.GetAllRolesDDL(),await this.getCustomertype(),await this.BindDetailData(),t.isLoading=!1},methods:{BindDetailData:async function(){var t=this,e=t.ClientData.clientdetail;t.ClientId=e.user_id,t.$refs.dynamicform.updateProperty("FirstName","value",e.first_name),t.$refs.dynamicform.updateProperty("LastName","value",e.last_name),t.$refs.dynamicform.updateProperty("Email","value",e.email_id),t.$refs.dynamicform.updateProperty("Gender","value",e.gender),t.$refs.dynamicform.updateProperty("Account","value",null==e.account_name?1:2),t.$refs.dynamicform.updateProperty("ParentAccounts","value",e.parent_id),t.$refs.dynamicform.updateProperty("AccountName","value",e.account_name),t.$refs.dynamicform.updateProperty("ClientOwner","value",e.clientOwnerId),t.$refs.dynamicform.updateProperty("TimeZone","value",e.timezone_id),t.$refs.dynamicform.updateProperty("Jurisdiction","value",t.ClientData.jurisdictionId),t.$refs.dynamicform.updateProperty("DateFormat","value","M/d/yyyy"==e.date_format?"M/D/YYYY":e.date_format),null!=e.role_id&&t.$refs.dynamicform.updateProperty("Role","value",e.role_id),null!=e.customerTypeId&&t.$refs.dynamicform.updateProperty("CustomerType","value",e.customerTypeId),t.profilePicture=e.avatar,t.containerName=e.containername,t.attachmentName=e.attachemenT_NAME},GetTaxJurisdiction(){var t=this,e="id=&moduleName=&type=TAX_JURISDICTION&search=&refId=";t.FormSchema[2].Data[3].config.options=[],n["a"].GetDDLData(e).then(e=>{200==e.status&&(void 0==e.data.DATA&&null==e.data.DATA||e.data.DATA.length>0&&(e.data.DATA.forEach(e=>{let a={value:e.value,name:e.name};t.FormSchema[2].Data[3].config.options.push(a)}),t.$refs.dynamicform.UpdateKeyValue()))})},GetClientOwner:async function(){var t=this;let e="leadId=0&type=p&moduleName=Client";await n["a"].GetClientOwner(e).then((function(e){t.ClientOwnerddl=e.data,t.ClientOwnerddl.forEach((e,a)=>{t.FormSchema[1].Data[3].config.options.push({value:e.USERID,name:e.USERNAME}),t.$refs.dynamicform.UpdateKeyValue()})}))},onChangeRadio:function(t,e){var a=this;a.Type=t.target.dataset.value,"2"==a.Type?(a.FormSchema[1].Data[1].visibility=!1,a.FormSchema[1].Data[2].visibility=!0):(a.FormSchema[1].Data[2].visibility=!1,a.FormSchema[1].Data[1].visibility=!0)},GetAllRolesDDL:async function(){var t=this;let e="userType=4";await n["a"].GetAllRoles(e).then((function(e){e.data.length>0&&(t.Rolesddl=e.data,t.Rolesddl.forEach((e,a)=>{t.FormSchema[2].Data[2].config.options.push({value:e.Value,name:e.Name}),t.$refs.dynamicform.UpdateKeyValue()}))}))},GetTimeZone:async function(){var t=this;await n["a"].GetTimeZoneList().then((function(e){t.TimeZoneddl=e.data,t.TimeZoneddl.forEach((e,a)=>{t.FormSchema[2].Data[0].config.options.push({value:e.code,name:e.value}),t.$refs.dynamicform.UpdateKeyValue()})}))},GetClientParentByCompanyId:async function(){var t=this;await n["a"].GetClientParentByCompanyId().then((function(e){t.ParentAccountddl=e.data,t.ParentAccountddl.forEach((e,a)=>{t.FormSchema[1].Data[1].config.options.push({value:e.Value,name:e.Name}),t.$refs.dynamicform.UpdateKeyValue()})}))},GetBase64String:function(t){try{var e=this;e.fileData=[];var a=t.target.files;e.attachmentName=a[0].name;for(var i=0;i<a.length;i++){var s=a[i],n=new FileReader;n.onload=function(t){return function(t){var a=t.target.result,i=window.btoa(a);e.base64String=i;var n=s.name,l=n.lastIndexOf("."),o=n.substring(l+1,n.length),r='{"ContentType":"'+s.type+'","Size":"'+s.size+'","Extension":"'+o+'"}',c=(s.size,{attachement_mime:r,fileName:n,userId:e.GetUserInfo.ID,companyId:e.GetUserInfo.CompanyId,id:0,moduleName:"",subModuleCode:"",containerName:e.GetUserInfo.ContainerName,base64String:i,attachement_path:""});e.fileData.push(c)}}(),n.readAsBinaryString(s)}}catch(l){}},ResetProfileImage(){var t=this;t.fileData=[],t.attachmentName="",t.base64String="",t.profilePicture="",t.fileInputKey+=1},async UploadProfilePicture(){var t=this,e=JSON.stringify(t.fileData);await n["a"].UploadFile(e).then((function(e){if(e.data&&e.data.length>0&&e.data[0].Name.length>0){var a=e.data[0].Name.split("/")[e.data[0].Name.split("/").length-1];t.profilePicture=a}}))},async OnSubmit(t,e){var a=this;(a.fileData.length>0||a.profilePicture)&&await a.UploadProfilePicture();var i={ClientId:a.ClientId,Account_id:""==t.ParentAccounts?0:t.ParentAccounts,first_name:t.FirstName,last_name:t.LastName,Email:t.Email,department_id:null,clientType:"",password:"",UserType:a.user_type,timezone_id:t.TimeZone,date_of_birth:"",date_format:t.DateFormat,gender:""==t.Gender?"M":t.Gender,clientOwnerId:t.ClientOwner,role_id:t.Role?t.Role:0,profile_path:a.profilePicture,associatefg:!1,account_name:t.AccountName,user_type_id:4,shift_id:null,hourly_rate:0,designation_id:null,AliasName:"",IsLeadOwner:"",user_emp_id:0,user_title_id:0,supervisor_id:0,is_virtual:"",IsProjectrequestOwner:"",is_enable_Login:1,policy_id:"",company_name:a.CompanyName,CustomerTypeId:t.CustomerType,pay_class:"",home_business_unit_id:0,minitial:"",job_type:"",start_date:"",email_id:t.Email,JurisdictionId:t.Jurisdiction},s=JSON.stringify(i);n["a"].AddClient(s).then(t=>{"success"==t.data&&(a.ShowAlert(a.$t("UpdatedSuccess",[a.$t("Client")]),"success",!0,a.$t("Alert")),a.Close())})},Close:function(){var t=this;t.$router.push({name:"ClientListing"})},async getCustomertype(){const t=this;try{const e=await n["a"].GetMeterCategories();if(null!==e&&void 0!==e&&e.data){const a=e.data;Array.isArray(a)&&a.length>0?a.map(e=>{t.FormSchema[1].Data[4].config.options.push({value:e.value,name:e.key}),t.$refs.dynamicform.UpdateKeyValue()}):console.warn("No valid data found in the response")}else console.error("Invalid response structure:",e)}catch(e){console.error("Error fetching Customer type:",e)}}}}),c=r,d=a("2877"),u=Object(d["a"])(c,l,o,!1,null,null,null),p=u.exports,m=a("acbf"),h=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"tab-content"},[e("div",{staticClass:"tab-pane call-detail fade p-0 border-0 active show",attrs:{id:"step1"}},[e("dynamic-form",{ref:"ConfigurationsForm",attrs:{schema:t.formSchema,buttons:t.buttons},on:{OnSubmit:t.FinalSaveConfigurations}})],1)])])},v=[],_={components:{},data:function(){return{modueKeys:[],currentSelectedModule:"",formSchema:[],buttons:[{type:"submit",class:"btn btn-success",text:"<i class='fa fa-save pr-2'></i> Save Settings"}],showTicketNumber:!1,ticketCoreConfigId:0,noRecordfound:!1,Message:"",AttachmentFileDetail:[],uploadUrl:"https://stagefilemedia.talygen.com/api/UploadStreamNew",token:null,CheckFileSave:!1,CompanyLogo:null,UserId:null,moduleCode:"Billing",ModuleId:0}},created:async function(){var t=this;t.UserId=this.GetUserInfo.ID,await this.GetModuleConfigurationKeys(),t.formSchema[0].Data[0].value>0&&(await this.GetTemplateListBySetupId(t.formSchema[0].Data[0].value),await this.LoadTemplateBySetupId(t.formSchema[0].Data[0].value))},methods:{Close:function(){var t=this;t.$parent.ConfigurationPopup=!1},GetModuleConfigurationKeys:async function(t){var e=this;await e.GetModuleIdByModuleName();var a="moduleId="+e.ModuleId;await n["a"].GetConfigurationkeysData(a).then((function(t){null!=t&&null!=t.data&&e.ConvertConfigurationDataIntoDynamicFormobj(t.data.StorageKeys)}))},GetTemplateListBySetupId:async function(t){var e=this,a="SetupId="+t;e.formSchema[0].Data[2].config.options=[],await n["a"].GetTemplateListBySetupId(a).then((function(t){t.data.length>0?t.data.forEach(t=>{e.formSchema[0].Data[2].config.options.push({name:t.NAME,value:""+t.INVOICE_TYPE_ID})}):e.formSchema[0].Data[2].config.options=[],e.$refs.ConfigurationsForm.UpdateKeyValue()}))},LoadTemplateBySetupId:async function(t){var e=this,a="SetupId="+t;e.formSchema[0].Data[1].config.options=[],await n["a"].LoadTemplateBySetupId(a).then((function(t){t.data.length>0?t.data.forEach(t=>{e.formSchema[0].Data[1].config.options.push({name:t.Name,value:""+t.Value})}):e.formSchema[0].Data[1].config.options=[],e.$refs.ConfigurationsForm.UpdateKeyValue()}))},async GetModuleIdByModuleName(){var t=this,e="moduleName="+t.moduleCode;await n["a"].GetModuleIdByModuleName(e).then((function(e){null!=e&&null!=e.data&&(t.ModuleId=e.data)}))},Getoption:function(t){t=null==t?"":t;var e=[];return $.each(t.split("^"),(function(t,a){e.push(a)})),e},ConvertConfigurationDataIntoDynamicFormobj:function(t){var e=this;if(e.formSchema=[],t.sort((t,a)=>{const i=e.$t(t.DISPLAY_ORDER),s=e.$t(a.DISPLAY_ORDER),n=Number(i),l=Number(s);return isNaN(n)||isNaN(l)?i>s?1:s>i?-1:0:n-l}),null!=t&&t.length>0){let a={layoutType:"double",groupId:0,group_name:"",Data:[]};t.forEach((function(t,i){var s;let n={required:!0},l=t.ASTYPE,o=[];var r=null!==(s=t.CORE_CONFIG_VALUE)&&void 0!==s?s:"";null!=t.CORE_CONFIG_OPTIONS&&(o=e.MakeArray(e.$t(t.CORE_CONFIG_OPTIONS),"radio","^")),null!=t.SELECT_OPTIONS&&""!=t.SELECT_OPTIONS&&(o=e.MakeNormalArray(t.SELECT_OPTIONS));let c="date",d="Enter "+e.$t(t.CORE_CONFIG_KEY);if("SelectField"==l||"CustomSelectField"==l||"TreeSelectField"==l)d="Select "+e.$t(t.CORE_CONFIG_KEY);else if("MultiSelectField"==l){r=[];let e=t.CORE_CONFIG_VALUE.split("^");e.forEach((function(t){r.push({label:t,value:t})}))}else"CheckBoxField"==l&&(r=t.CORE_CONFIG_VALUE.split("^"));if("DateField"==l)c="date";else if("MultiSelectField"==l)c="tag";else if("FileField"==l)var u=t.CORE_CONFIG_VALUE,p=u.split("/").pop();else"JPJobCode"==t.CORE_CONFIG_KEY?(n["alpha_num"]=!0,n["min"]=4,n["max"]=6):"TaxOverride"==t.CORE_CONFIG_KEY&&(l="toggleField",n["required"]=!1,r="true"==t.CORE_CONFIG_VALUE);let m={customFieldId:t.CORE_CONFIG_ID,astype:l,label:e.$t(t.CORE_CONFIG_KEY),name:t.CORE_CONFIG_KEY,displayOrder:t.DISPLAY_ORDER,value:r,placeholder:d,mode:c,config:{maxSize:5,showSelectedFiles:[{attachmentName:u,attachmentPath:p}],onChange:e.onChangeField,onDeleteSelectedFiles:e.onDeleteSelectedFiles,onClickSelectedFiles:e.showCompanyLogo,accept:[{fileType:"png",iconClass:"fa-file-image-o"},{fileType:"jpg",iconClass:"fa-file-image-o"},{fileType:"jpeg",iconClass:"fa-file-image-o"}],mode:c,options:o,dependentOn:null,showWhen:null,valueMapping:null,fieldCode:null,showCrossOnSelectedFiles:!1},visibility:!0,validationRules:n,dtCode:t.CORE_CONFIG_TYPE};a.Data.push(m)})),e.formSchema.push(a);const i=e.formSchema[0].Data.filter(t=>"IsTaxable"===t.name),s=i[0].value;"Exempt"==s&&e.formSchema.forEach((function(t,e){t.Data.forEach((function(t,e){"TaxOverride"==t.name&&(t.visibility=!1)}))}))}},async showCompanyLogo(t){var e=this;let a=document.createElement("a");a.target="_blank",await e.GetCompanyLogo(t.attachmentPath),a.href=e.CompanyLogo,a.click()},async GetCompanyLogo(t){var e=this,a="imagename="+t;await n["a"].GetCompanyLogo(a).then(t=>{e.CompanyLogo=t.data})},MakeArray:function(t,e,a){var i=[],s=",";"undefined"!=typeof a&&null!=a&&(s=a);var n=String(t).split(s);if("radio"==e||"checkbox"==e){if(n.length>0)for(let o of n)if(o.split("|").length>1){var l={name:o.split("|")[0].trim(),value:o.split("|")[1].trim()};i.push(l)}else{l={name:this.$t(o.trim()),value:o.trim()};i.push(l)}}else if(n.length>0)for(let o of n){l={name:o.trim(),value:o.trim()};i.push(l)}return i},onChangeField:async function(t,e){var a=this;if("FileField"==e.astype)try{a.fileData=[];for(var i=t.target.files,s=0;s<i.length;s++){var n=i[s],l=new FileReader;l.onload=function(t){return function(t){var i=t.target.result,s=window.btoa(i),l=n.name;a.fileName=l;var o=l.lastIndexOf("."),r=l.substring(o+1,l.length);a.fileExt+="."+r;var c='{"ContentType":"'+n.type+'","Size":"'+n.size+'","Extension":"'+r+'"}',d=n.size;a.fileSize=d;var u={attachement_mime:c,fileName:l,userId:a.GetUserInfo.ID,companyId:a.GetUserInfo.CompanyId,id:0,moduleName:a.currentSelectedModule.moduleName.toLowerCase(),subModuleCode:"",containerName:a.GetUserInfo.ContainerName,base64String:s,attachement_path:"",fieldName:e.name};a.AttachmentFileDetail.push(u)}}(),l.readAsBinaryString(n)}}catch(o){}"SelectSetup"==e.name&&(await a.LoadTemplateBySetupId(e.value),await a.GetTemplateListBySetupId(e.value)),"IsTaxable"==e.name&&a.formSchema.forEach((t,a)=>{t.Data.forEach((t,a)=>{"Exempt"==e.value?"TaxOverride"==t.name?(t.visibility=!1,t.value=!1):t.visibility=!0:"TaxOverride"==t.name&&(t.visibility=!0)})})},onDeleteSelectedFiles:function(t,e){var a=this;a.formSchema.forEach((function(t,e){t.Data.forEach((function(t,e){"FileField"==t.astype&&(a.$delete(t.config,"showSelectedFiles"),t.value="")}))}))},SendAttactment:async function(){this.token=this.GetUserInfo?this.GetUserInfo.Token:"";var t=this,e=JSON.stringify(t.AttachmentFileDetail);await n["a"].UploadFile(e).then((function(e){e.data&&e.data.length>0&&(t.CheckFileSave=!1,t.formSchema.forEach((function(t,a){t.Data.forEach((function(t,a){if("FileField"==t.astype)if("companylogo"==t.name.toLowerCase()){var i=e.data[0].Name.split("/")[e.data[0].Name.split("/").length-1];t.value=i}else t.value=e.data[0].Name}))})),t.SaveConfigurations())}))},FinalSaveConfigurations:function(){var t=this;t.formSchema[0].Data.forEach(e=>{e.dtCode&&"image"==e.dtCode.toLowerCase()&&t.AttachmentFileDetail.length>0&&(t.CheckFileSave=!0)}),t.CheckFileSave?t.SendAttactment():t.SaveConfigurations()},SaveConfigurations:function(){var t=this,e=[];t.formSchema.forEach((function(t,a){t.Data.forEach((function(t,a){var i=t.value;if("CheckBoxField"==t.astype&&(i=t.value.filter(t=>""!=t).join("^")),"MultiSelectField"==t.astype){let e="";if("object"==typeof t.value)try{"undefined"!=typeof t.value.length&&t.value.length>0?t.value.forEach((function(t){e=""==e?t.value:e+"^"+t.value})):e=t.value.value}catch(n){e=t.value.value}else e=t.value;i=e}var s={DataId:t.customFieldId,key:t.name,DataValue:i};e.push(s)}))}));var a={configData:e,conditionData:{refCode:"CompanySetting",moduleName:t.moduleCode}},i=JSON.stringify(a);n["a"].ManageDocUserStorageSettingData(i).then((function(e){null!=e&&null!=e.data&&1==e.data?(t.ShowAlert(t.$t("RecordsSavedSuccessfully"),"success"),t.Close()):t.ShowAlert(t.$t("UnknownErrorOccur"),"failure",!0,t.$t("Alert"))}))}}},g=_,f=(a("57db"),Object(d["a"])(g,h,v,!1,null,null,null)),C=f.exports,y=a("4ea2"),b=a("34e8"),S=function(){var t=this,e=t._self._c;return e("section",[e("div",[e("tg-list",{attrs:{IsShowAction:!0,ModuleName:"Company",SubModuleCode:"",LegendArray:[],RenderRowActionMethod:t.renderActions,widgets:[],IdentityColumn:"QUOTATION_ID",listType:["List"],ListData:t.ListingData,HeaderData:t.Headers,HeaderButtons:t.listheaderbuttons,TotalRecords:t.TotalRecords,SearchFields:t.leftSearchFields,IsSearchFieldsOnTop:"true",SearchPosition:"top",ListDataCallBackFunction:t.FetchData,showCheckBox:!1,SortExp:t.SortExp,SortBy:t.SortBy,NorecordfoundText:t.$t("NoRecordfound")},on:{ActionButtonClick:t.actionButtonClick,LeftsearchButtonClick:t.leftCommonSearch,PagerButtonClick:t.pagerMethod,HeaderButtonClick:t.commonHeaderButtonClick,SortdataButtonClick:t.sortdata},scopedSlots:t._u([{key:"slotdata",fn:function({data:a}){return["QUOTATION_NUMBER"==a.column.COLUMN_NAME?[e("div",[e("a",{attrs:{href:"#",title:a.row[a.column.COLUMN_NAME],"data-toggle-tooltip":"tooltip","data-original-title":"Click here to Update Account"},on:{click:function(e){return t.handleClick(a.row)}}},[t._v(t._s(a.row[a.column.COLUMN_NAME]))])])]:t._e(),"START_DATE"==a.column.COLUMN_NAME?[e("td",{staticClass:"text-center single-action tourguide_a"},[t._v(" "+t._s(t.$options.filters.formatDate(a.row.START_DATE))+" ")])]:t._e(),"END_DATE"==a.column.COLUMN_NAME?[e("td",{staticClass:"text-center single-action tourguide_a"},[t._v(" "+t._s(t.$options.filters.formatDate(a.row.END_DATE))+" ")])]:t._e()]}}])})],1)])},A=[];let D=[{COLUMN_NAME:"QUOTATION_NUMBER",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"QuotationNumber",DISPLAY_ORDER:1,settings:{isInSlot:!0}},{COLUMN_NAME:"QUOTATION_TITLE",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Title",DISPLAY_ORDER:2},{COLUMN_NAME:"QUOTATION_OWNER",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"OwnerName",DISPLAY_ORDER:3},{COLUMN_NAME:"START_DATE",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"StartDate",DISPLAY_ORDER:4,settings:{isInSlot:!0}},{COLUMN_NAME:"END_DATE",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"EndDate",DISPLAY_ORDER:5,settings:{isInSlot:!0}},{COLUMN_NAME:"NET_PAYABLE_AMOUNT",DATA_TYPE:"boolean",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"AmountWithParathensis",DISPLAY_ORDER:6},{COLUMN_NAME:"Client",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Client",DISPLAY_ORDER:7},{COLUMN_NAME:"Project Request",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"ProjectRequest",DISPLAY_ORDER:8,settings:{isInSlot:!0}}],I=[{title:"Edit",href:"javascript:void(0)",callbackfunction:"EditTeam",icon:"fa fa-pencil action-icon",additionalSpan:""}];var T={TableHeader:D,listActions:I},L=a("c1df"),E=a.n(L),x={components:{},props:{UserId:{type:Number},ClientData:{type:Object}},data(){return{TotalRecords:0,noRecord:!1,isLoading:!1,CompanyId:null,PageSize:10,statusId:"",PageNumber:1,isPaged:1,TotalPages:0,widgets:[],SortBy:"",SortExp:"",ProjectName:"",taskId:"",listActions:T.listActions,Headers:T.TableHeader,ListingData:[],searchCondition:"",Buttons:T.buttons,QuotesListingSchema:!1,leftSearchFields:[{fieldName:"QuotesTitle",fieldType:"text",fieldSearchConditionName:[""],paramName:"search",isSearch:!0,value:"",listOptions:[]}]}},created:async function(){this.CompanyId=this.GetUserInfo.CompanyId,this.user_Id=this.GetUserInfo.ID,this.FetchData()},methods:{FetchData:async function(){var t=this,e=`projectId=0&codeName=Client&clientId=${t.UserId}&pageSize=${t.PageSize}&pageNum=${t.PageNumber}&sortBy=${t.SortBy}&sortExp=${t.SortExp}`;t.isBlank(this.searchCondition)||(e+="&search="+this.searchCondition),await n["a"].GetQuotationListByQuotationType(e).then((function(e){e.data?e.data.length>0?(t.ListingData=e.data,t.noRecord=!1,t.TotalRecords=e.data[0].TOTAL_RECORDS):(t.ListingData=[],t.noRecord=!0,t.TotalRecords=0):(t.noRecord=!0,t.ListingData=[],t.TotalRecords=0)}))},handleClick(t){var e=this;e.$router.push({path:`/CRM/ManageQuotation/${t.QUOTATION_ID}/CRM/CRM_QUOTES/0?clientId=${e.UserId}`})},leftCommonSearch:function(t){if(this.PageNumber=t.PageNumber,this.isPaged=1,"undefined"!=typeof t.searchCondition)if(""!=t.searchCondition){let e=t.searchConditionJson,a=e.split("=")[1];this.searchCondition=a}else this.searchCondition="";else this.searchCondition="";this.FetchData()},renderActions:function(t){var e=this;let a=[];return e.listActions.forEach(t=>{let e={...t};switch(e.title){case"Edit":e.isVisible=!0;break;default:e.isVisible=!0}a.push(e)}),a},formatDate:function(t){return t?E()(t).format("MMMM Do, YYYY"):""},pagerMethod:function(t){this.PageSize=t.PageSize,this.PageNumber=t.PageNumber,this.FetchData()},actionButtonClick:function(t,e){switch(t){case"EditTeam":this.handleClick(e);break}},commonHeaderButtonClick:async function(t){var e=this;switch(t.callbackfunction){case"AddQuotes":e.AddQuotes();break;case"BackToList":this.BackToList();break;case"DeleteClientData":e.commonDeleteData();break}},sortdata:function(t){var e="sort tb_headerSortDown";this.SortBy=t,t===this.SortBy&&(""==this.SortExp?(this.SortExp="ASC",e="sort tb_headerSortDown"):"ASC"==this.SortExp?(this.SortExp="DESC",e="sort tb_headerSortUp"):(this.SortExp="ASC",e="sort tb_headerSortDown")),this.FetchData(),$("#"+t+"  span:first-child").attr("class",e)}}},N=x,P=Object(d["a"])(N,S,A,!1,null,null,null),w=P.exports,R=function(){var t=this,e=t._self._c;return e("section",[e("div",[e("div",{staticStyle:{"margin-top":"-7px"}},[e("tg-list",{attrs:{IsShowAction:!1,ModuleName:"Company",SubModuleCode:"",LegendArray:[],isShowHeaderText:!1,HeaderText:t.$t("Contract"),RenderRowActionMethod:t.renderActions,widgets:[],IdentityColumn:"CONTRACT_ID",listType:["List"],ListData:t.ListingData,HeaderData:t.Headers,HeaderButtons:t.listheaderbuttons,TotalRecords:t.TotalRecords,SearchFields:t.leftSearchFields,IsSearchFieldsOnTop:"true",SearchPosition:"top",ListDataCallBackFunction:t.FetchData,showCheckBox:!0,SortExp:t.SortExp,SortBy:t.SortBy,NorecordfoundText:t.$t("NoRecordfound")},on:{ActionButtonClick:t.actionButtonClick,LeftsearchButtonClick:t.leftCommonSearch,PagerButtonClick:t.pagerMethod,HeaderButtonClick:t.commonHeaderButtonClick,SortdataButtonClick:t.sortdata},scopedSlots:t._u([{key:"slotdata",fn:function({data:a}){return["CONTRACT_END_DATE"==a.column.COLUMN_NAME?[e("td",{staticClass:"text-center single-action tourguide_a"},[t._v(" "+t._s(t.$options.filters.formatDate(a.row.CONTRACT_END_DATE))+" ")])]:t._e(),"CONTRACT_NAME"==a.column.COLUMN_NAME?["Expired"!=a.row.STATUS_NAME?e("div",[e("a",{attrs:{href:"javascript:;",title:a.row[a.column.COLUMN_NAME],"data-toggle-tooltip":"tooltip","data-original-title":"Click here to Update Account"},on:{click:function(e){return t.handleClick(a.row)}}},[t._v(t._s(a.row[a.column.COLUMN_NAME]))])]):e("div",[t._v(" "+t._s(a.row[a.column.COLUMN_NAME]))])]:t._e(),"STATUS_NAME"==a.column.COLUMN_NAME?["STATUS_NAME"==a.column.COLUMN_NAME?[e("span",{class:t.getStatusClassList(a.row.STATUS_NAME,"status_id")},[t._v(" "+t._s(a.row.STATUS_NAME)+" ")])]:t._e()]:t._e()]}}])})],1)])])},M=[];let F=[{COLUMN_NAME:"CONTRACT_NAME",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Contract",DISPLAY_ORDER:1,settings:{isInSlot:!0}},{COLUMN_NAME:"CONTRACT_ID",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"CONTRACT_ID",DISPLAY_ORDER:2},{COLUMN_NAME:"COMPANY_NAME",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Company",DISPLAY_ORDER:3},{COLUMN_NAME:"CUSTOMER",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"ClientName",DISPLAY_ORDER:4},{COLUMN_NAME:"BILLTOCLIENTNAME",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"BillToClient",DISPLAY_ORDER:5},{COLUMN_NAME:"STATUS_NAME",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Status",DISPLAY_ORDER:5,settings:{isInSlot:!0}},{COLUMN_NAME:"CONTRACT_TEMPLATE",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"ContractTemplate",DISPLAY_ORDER:7},{COLUMN_NAME:"RESELLER",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"CRMOwner",DISPLAY_ORDER:8},{COLUMN_NAME:"CONTRACT_END_DATE",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"ExpirationDate",DISPLAY_ORDER:8,settings:{isInSlot:!0}}],k=[{id:"Delete",title:"Delete",iconClass:"fa-trash-o",callbackfunction:"openDelete",isdisabled:!0,isvisible:!0,isEnabledOnSelectedRow:!0},{title:"AddContract",iconClass:"fa-plus",callbackfunction:"openAssociate",additionalClass:"",isdisabled:!1,isvisible:!0,checkPrivilege:!1},{title:"BackToList",iconClass:"fa fa-angle-double-left",callbackfunction:"BackToList",isdisabled:!1,isvisible:!0}];var O={TableHeader:F,buttons:k},B={components:{},props:{UserId:{type:Number},ClientData:{type:Object}},data(){return{TotalRecords:0,noRecord:!1,isLoading:!1,CompanyId:null,PageSize:10,statusId:"",PageNumber:1,isPaged:1,TotalPages:0,widgets:[],SortBy:"",SortExp:"",ProjectName:"",taskId:"",listActions:O.listActions,Headers:O.TableHeader,ListingData:[],searchCondition:"",listheaderbuttons:O.buttons,QuotesListingSchema:!1,leftSearchFields:[{fieldName:this.$t("CONTRACTNAME"),fieldType:"text",fieldSearchConditionName:[""],paramName:"search",isSearch:!0,value:"",listOptions:[]}]}},created:async function(){this.CompanyId=this.GetUserInfo.CompanyId,this.user_Id=this.GetUserInfo.ID,this.FetchData()},updated(){const t=document.getElementsByClassName("theme-primary partition p-actions-expand");if(t[0]&&"p-name text-white"!=t[0].lastChild.className){const e=document.createElement("span");e.className="p-name text-white",e.textContent=this.$t("Contract"),t[0].appendChild(e)}},methods:{handleClick(t){var e=this,a=e.$route.params.parentId,i=e.$route.params.id;e.$router.push({path:`/CRM/ManageContract/${t.CONTRACT_ID}/CRM/CRM_CONTRACTS?clientId=${i}&parentId=${a}`})},FetchData:async function(){var t=this,e=`projectId=0&productIds=&resellerIds=&contractId=&contractName=${t.searchCondition}&companyName=&billtoClientName=&clientIds=${t.UserId}&pageSize=${t.PageSize}&pageNum=${t.PageNumber}&sortBy=${t.SortBy}&sortExp=${t.SortExp}`;await n["a"].GetContractListing(e).then((function(e){e.data?e.data.length>0?(t.ListingData=e.data,t.noRecord=!1,t.TotalRecords=e.data[0].TOTALRECORDS):(t.ListingData=[],t.noRecord=!0,t.TotalRecords=0):(t.noRecord=!0,t.ListingData=[],t.TotalRecords=0)}))},leftCommonSearch:function(t){if(this.PageNumber=t.PageNumber,this.isPaged=1,"undefined"!=typeof t.searchCondition)if(""!=t.searchCondition){let e=t.searchConditionJson,a=e.split("=")[1];this.searchCondition=a}else this.searchCondition="";else this.searchCondition="";this.FetchData()},getStatusClassList:function(t){var e="";switch(t){case"Active":e="px-2 text-center text-white d-block bg-success";break;case"Inactive":e="px-2 text-center text-white d-block bg-danger";break;case"Expired":e="px-2 bg-primary text-center text-white d-block";break;case"Cancelled":e="px-2 bg-danger text-center text-white d-block";break;case"Draft":e="px-2 bg-yellow text-center text-white d-block";break;case"History":e="px-2 bg-dark text-center text-white d-block";break;case"Undefined":e="px-2 bg-info text-center text-white d-block";break;default:e="px-2 bg-yellow text-center text-white d-block"}return e},formatDate:function(t){return t?E()(t).format("MMMM Do, YYYY"):""},renderActions:function(t){var e=this;let a=[];return e.listActions.forEach(t=>{let e={...t};switch(e.title){case"Edit":e.isVisible=!0;break;default:e.isVisible=!0}a.push(e)}),a},pagerMethod:function(t){this.PageSize=t.PageSize,this.PageNumber=t.PageNumber,this.FetchData()},actionButtonClick:function(t,e){switch(t){case"openDelete":this.DeleteMultiple(e);break}},DeleteMultiple:function(){var t=this,e="";$(".chkItems:checkbox:checked").not("[id^='chkAll']").each((function(){e.length>0&&(e+=","),e+=$(this).val()})),e.length>0&&t.confirmR(t.$t("ConfirmDelete"),!0,t.$t("Delete")+"  "+t.$t("ApplicationId"),(function(){let a=`ids=${e}&tableName=talygen_contracts&primaryKey=contract_id`;n["a"].Delete(a).then(e=>{e.data?($("[id^='chkAll']").prop("checked",!1).removeAttr("checked"),$(".chkItems:checkbox:checked").prop("checked",!1).removeAttr("checked"),t.listheaderbuttons[0].isdisabled=!0,t.ShowAlert(t.$t("DeletedSuccessfully"),"Success",!0,t.$t("Alert"))):t.ShowAlert(t.$t("DeletedError",[t.$t("val")]),"failure",!0,t.$t("Alert")),t.FetchData()})}))},commonHeaderButtonClick:async function(t){var e=this;switch(t.callbackfunction){case"openAssociate":e.AddContract();break;case"BackToList":e.BackToList();break;case"openDelete":e.DeleteMultiple();break}},AddContract:function(t){var e=this,a=e.$route.params.parentId,i=e.$route.params.id;e.$router.push({path:`/CRM/ManageContract/0/CRM/CRM_CONTRACTS?clientId=${i}&parentId=${a}`})},BackToList:function(){var t=this;t.$router.push({name:"ClientListing"})},sortdata:function(t){var e="sort tb_headerSortDown";this.SortBy=t,t===this.SortBy&&(""==this.SortExp?(this.SortExp="ASC",e="sort tb_headerSortDown"):"ASC"==this.SortExp?(this.SortExp="DESC",e="sort tb_headerSortUp"):(this.SortExp="ASC",e="sort tb_headerSortDown")),this.FetchData(),$("#"+t+"  span:first-child").attr("class",e)}}},U=B,G=Object(d["a"])(U,R,M,!1,null,null,null),Y=G.exports,V=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"container-fluid"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"col-lg-12 mt-3 mb-3 p-0"},[e("div",{staticClass:"heading-border"},[e("h5",{staticClass:"h5"},[e("span",[t._v(" "+t._s(t.$t("TotalAvailableCredit"))+": "),e("b",{staticClass:"text-success font-weight-medium"},[t._v(t._s(t.$n(t.totalAmount,"currency",t.$getLocaleByCurrency(t.CurrencyCode))))])])])])]),e("div",{staticClass:"py-2 d-inline-block"},[e("span",{staticClass:"legend-ovrdue colorboxsquare",staticStyle:{border:"1px solid rgb(238, 238, 238)"}}),t._v(t._s(t.$t("Expired"))+" ")]),e("div",{staticClass:"listing"},[e("div",{staticClass:"table-responsive"},[e("table",{staticClass:"table table-bordered mt-0",staticStyle:{width:"100%"},attrs:{id:"JobListingData"}},[e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",[e("span",[t._v(t._s(t.$t("TransactionHistory")))])]),e("th",[e("span",[t._v(t._s(t.$t("Remarks")))])]),e("th",[e("span",[t._v(t._s(t.$t("Plan")))])]),e("th",[e("span",[t._v(t._s(t.$t("SubscriptionStatus")))])]),e("th",[e("span",[t._v(t._s(t.$t("CreatedBy")))])]),e("th",[e("span",[t._v(t._s(t.$t("Status")))])]),e("th",[e("span",[t._v(t._s(t.$t("ExpiryDate")))])]),e("th",{staticClass:"text-right"},[e("span",[t._v(t._s(t.$t("Amount"))+" ")])]),e("th",{staticClass:"text-right"},[e("span",[t._v(t._s(t.$t("RunningBalance")))])])])]),e("tbody",[t.noRecord?e("tr",[e("td",{staticClass:"text-danger text-center no-record",attrs:{colspan:"5"}},[t._v(" "+t._s(t.$t("NoRecordfound")))])]):t._e(),t._l(t.ListingData,(function(a,i){return e("tr",{key:i,class:["odd",a.Expiry_Date&&new Date(a.Expiry_Date)<new Date?"danger-bar":""]},[e("td",[t._v(t._s(t.formatDateTime(a.TRANSACTION_HISTORY)))]),e("td",[t._v(t._s(a.REMARKS))]),e("td",[t._v(t._s(a.plan_name))]),e("td",[t._v(t._s(a.Sub_status))]),e("td",[t._v(t._s(a.CREATED_BY))]),e("td",[t._v(t._s(a.STATUS))]),e("td",[a.Expiry_Date?e("span",[t._v(t._s(t.formatDateTime(a.Expiry_Date)))]):t._e()]),e("td",{staticClass:"text-right"},[e("span",{class:{"text-success":"Credit Added in Account"===a.STATUS,"text-danger":"Credit Added in Account"!==a.STATUS}},["Credit Added in Account"===a.STATUS?e("span",[t._v("+")]):e("span",[t._v("-")]),e("span",{staticClass:"paddingright6"},[t._v(" "+t._s(t.$n(a.AMOUNT,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])])]),e("td",{staticClass:"text-right"},[e("span",{staticClass:"paddingright6"},[t._v(t._s(t.$n(a.RUNNING_BALANCE,"currency",t.$getLocaleByCurrency(t.CurrencyCode))))])])])}))],2)])])])],1)])},H=[],j={components:{},props:{UserId:{type:Number},ClientData:{type:Object}},data(){return{noRecord:!1,isLoading:!1,CompanyId:null,ListingData:[],SortBy:"",SortExp:"",totalAmount:0,currency:"USD",CurrencyCode:"USD"}},created:async function(){var t=this;this.CompanyId=this.GetUserInfo.CompanyId,this.user_Id=this.GetUserInfo.ID,this.currency=this.GetUserInfo.Currency,t.CurrencyCode=t.GetUserInfo.Currency.replace(/[()]/g,""),await this.FetchData()},methods:{async FetchData(){var t=this;t.isLoading=!0;try{const e=`clientId=${this.UserId}&sortBy=${this.SortBy}&sortExp=${this.SortExp}`,a=await n["a"].ListCreditHistory(e);a.data&&a.data.length>0?(t.ListingData=a.data,t.noRecord=!1):(t.ListingData=[],t.noRecord=!0),t.totalAmount=a.data.length>0?a.data[0].RUNNING_BALANCE:0}catch(e){console.error("Error fetching data:",e),this.noRecord=!0,this.ListingData=[]}finally{t.isLoading=!1}},formatDateTime(t){return new Date(t).toLocaleString()}}},q=j,z=Object(d["a"])(q,V,H,!1,null,null,null),W=z.exports,J=function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("AddCreditHistory")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("dynamic-form",{attrs:{lang:"en",buttons:t.buttons,schema:t.FormSchema,mandatorytext:t.MandatoryString},on:{OnSubmit:t.onSubmit}})],1)])])])],1)},K=[],Q={props:{ClientData:{type:Object,required:!0},UserId:{type:Object,required:!0}},data(){return{isLoading:!1,CreditHistoryId:0,MandatoryString:this.$t("MandatoryString"),FormSchema:[{layoutType:"double",Data:[{astype:"NumericField",label:this.$t("Amount"),name:"Amount",value:"",validationRules:{required:!0,max:100}}]},{layoutType:"single",Data:[{astype:"TextAreaField",label:this.$t("Remarks"),name:"Remarks",value:"",validationRules:{required:!0,max:100}}]}],buttons:[{type:"submit",class:"btn btn-success",text:"<i class='fa fa-save pr-2'></i>Save"},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Cancel",onClick:this.Close}]}},created:async function(){},methods:{Close:function(){this.$parent.AddHistory=!1},onSubmit(t,e){var a=this,i={CreditHistoryId:null==a.CreditHistoryId?0:a.CreditHistoryId,Amount:t.Amount,InvoiceId:null,UserId:a.UserId,Remarks:t.Remarks,StatusCode:"INV_CREDIT_ADDED"},s=JSON.stringify(i);n["a"].SaveUpdateCreditInfo(s).then(t=>{"Success"==t.data.Status?(a.Close(),a.$parent.refreshKey+=1):(a.ShowAlert(a.$t("AddedError",[a.$t("CreditInfo")]),"failure",!0,a.$t("Alert")),a.Close())})}}},Z=Q,X=Object(d["a"])(Z,J,K,!1,null,null,null),tt=X.exports,et=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticStyle:{"margin-top":"-7px"}},[e("tg-list",{attrs:{IsShowAction:!1,ModuleName:"Company",SubModuleCode:"",LegendArray:[],isShowHeaderText:!0,HeaderText:t.$t("AdditionalContact"),RenderRowActionMethod:t.renderActions,widgets:[],IdentityColumn:"CONTACT_ID",listType:["List"],ListData:t.ListingData,HeaderData:t.Headers,HeaderButtons:t.listheaderbuttons,TotalRecords:t.TotalRecords,SearchFields:t.leftSearchFields,IsSearchFieldsOnTop:"true",SearchPosition:"top",ListDataCallBackFunction:t.FetchData,showCheckBox:!0,SortExp:t.SortExp,SortBy:t.SortBy,NorecordfoundText:t.$t("NoRecordfound")},on:{ActionButtonClick:t.actionButtonClick,LeftsearchButtonClick:t.leftCommonSearch,PagerButtonClick:t.pagerMethod,HeaderButtonClick:t.commonHeaderButtonClick,SortdataButtonClick:t.sortdata}}),t.OpenAssociateContact?e("AssociateContact",{attrs:{UserId:t.UserId}}):t._e()],1)])},at=[];let it=[{COLUMN_NAME:"CONTACTNAME",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"ContactName",DISPLAY_ORDER:1},{COLUMN_NAME:"EMAIL_ID",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Email",DISPLAY_ORDER:2},{COLUMN_NAME:"MOBILE_PHONE",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Mobile",DISPLAY_ORDER:3},{COLUMN_NAME:"COUNTRYNAME",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"COUNTRY",DISPLAY_ORDER:4}],st=[{title:"Associate",iconClass:"fa-plus",callbackfunction:"openAssociate",additionalClass:"",isdisabled:!1,isvisible:!0,checkPrivilege:!1},{id:"DeAssociate",title:"De-Associate",iconClass:"fa-trash-o",isEnabledOnSelectedRow:!0,callbackfunction:"openDeAssociate",isdisabled:!0,isvisible:!0,isEnabledOnSelectedRow:!0},{title:"Back To List",iconClass:"fa fa-angle-double-left",callbackfunction:"BackToList",isdisabled:!1,isvisible:!0}];var nt={TableHeader:it,buttons:st},lt=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("AssociateContact")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"heading-border"},[e("h5",{staticClass:"h5"},[e("span",[t._v(t._s(t.$t("Manage")))]),t._v(" "),e("small",{staticClass:"float-right"},[e("a",{attrs:{href:"javascript:;",id:"aAddContact"},on:{click:t.aAddContact}},[e("em",{staticClass:"fa fa-plus",attrs:{"aria-hidden":"true"}}),t._v(" "+t._s(t.$t("AddNewContact")))])])])]),e("section",[e("tg-list",{attrs:{IsShowAction:!1,ModuleName:"Company",SubModuleCode:"",LegendArray:[],isShowHeaderText:!1,RenderRowActionMethod:t.renderActions,widgets:[],IdentityColumn:"CONTACT_ID",listType:["List"],ListData:t.ListingData,HeaderData:t.Headers,HeaderButtons:t.listheaderbuttons,TotalRecords:t.TotalRecords,SearchFields:t.leftSearchFields,IsSearchFieldsOnTop:"true",SearchPosition:"top",ListDataCallBackFunction:t.FetchData,showCheckBox:!0,SortExp:t.SortExp,SortBy:t.SortBy,NorecordfoundText:t.$t("NoRecordfound")},on:{ActionButtonClick:t.actionButtonClick,LeftsearchButtonClick:t.leftCommonSearch,PagerButtonClick:t.pagerMethod,HeaderButtonClick:t.commonHeaderButtonClick,SortdataButtonClick:t.sortdata}})],1)]),e("div",{staticClass:"d-flex justify-content-end mr-3 mb-3"},[e("a",{staticClass:"btn btn-success mr-2 mt-3",attrs:{title:"Save"},on:{click:function(e){return t.SaveAssociateContact()}}},[e("i",{staticClass:"fa fa-floppy-o pr-2",attrs:{"aria-hidden":"true"}}),t._v(t._s(t.$t("Save")))]),e("a",{staticClass:"btn btn-primary delete-btn mt-3",attrs:{title:"Close"},on:{click:function(e){return t.Close()}}},[e("i",{staticClass:"fa fa-times pr-2",attrs:{"aria-hidden":"true"}}),t._v(t._s(t.$t("Cancel"))+" ")])])])])]),t.OpenAddContact?e("AddNewContact",{attrs:{CountryId:t.CountryId}}):t._e()],1)])},ot=[];let rt=[{COLUMN_NAME:"CONTACTNAME",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"ContactName",DISPLAY_ORDER:1},{COLUMN_NAME:"EMAIL_ID",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Email",DISPLAY_ORDER:2},{COLUMN_NAME:"PHONE",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Mobile",DISPLAY_ORDER:3},{COLUMN_NAME:"COUNTRYNAME",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"COUNTRY",DISPLAY_ORDER:4},{COLUMN_NAME:"CITYSTATE",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"StateCity",DISPLAY_ORDER:5}];var ct={TableHeader:rt},dt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("AssociateContact")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("dynamic-form",{ref:"AddContact",attrs:{lang:"en",buttons:t.buttons,schema:t.FormSchema},on:{OnSubmit:t.onSubmit}})],1)])])])],1)},ut=[],pt=a("50a0"),mt={props:{TagArr:{type:Object,required:!0},CountryId:{type:Object,required:!0}},data(){return{isLoading:!1,FormSchema:[{layoutType:"double",Data:[{astype:"TextField",label:this.$t("FirstName"),name:"FirstName",value:"",validationRules:{required:!0,max:100}},{astype:"TextField",label:this.$t("LastName"),name:"LastName",value:"",validationRules:{required:!0,max:100}}]},{layoutType:"double",Data:[{astype:"TextField",label:this.$t("JobTitle"),name:"JobTitle",value:"",validationRules:{required:!1,max:100}},{astype:"TextField",label:this.$t("Email"),name:"Email",value:"",validationRules:[{email:!0}],disabled:!1}]},{layoutType:"double",Data:[{astype:"TextField",label:this.$t("BusinessPhone"),name:"BusinessPhone",value:"",validationRules:{required:!1,max:100}},{astype:"PhoneField",label:this.$t("Mobilenumber"),name:"MobileNumber",value:"",config:{dependentOn:null,fieldCode:null,mode:"date",options:[],showWhen:null,valueMapping:null},validationRules:{required:!1},visibility:!0,mode:""}]},{layoutType:"double",Data:[{astype:"TextField",label:this.$t("FAX"),name:"Fax",value:"",validationRules:{required:!1,max:100}},{astype:"SelectField",label:this.$t("PreferredContact"),name:"PreferredContactMethod",value:"",config:{options:[{value:"Any",name:"Any"},{value:"Email",name:"Email"},{value:"Phone",name:"Phone"},{value:"Fax",name:"Fax"},{value:"Mail",name:"Mail"}]},placeholder:this.$t("Select"),validationRules:{required:!1}}]},{layoutType:"double",Data:[{astype:"TextField",label:this.$t("AddressStreet1"),name:"AddressStreet1",value:"",validationRules:{required:!1,max:100}},{astype:"TextField",label:this.$t("AddressStreet2"),name:"AddressStreet2",value:"",validationRules:{required:!1,max:100}}]},{layoutType:"double",Data:[{astype:"TextField",label:this.$t("AddressStreet3"),name:"AddressStreet3",value:"",validationRules:{required:!1,max:100}},{astype:"TextField",label:this.$t("City"),name:"City",value:"",validationRules:{required:!1,max:100}}]},{layoutType:"double",Data:[{astype:"TextField",label:this.$t("STATE"),name:"State",value:"",validationRules:{required:!1,max:100}},{astype:"NumericField",label:this.$t("ZIPCODE"),name:"ZipCode",value:"",validationRules:{required:!1,max:15}}]},{layoutType:"double",Data:[{astype:"SelectField",label:this.$t("COUNTRY"),name:"Country",value:"",placeholder:"",disabled:!1,validationRules:{required:!1,max:250},config:{options:[]}},{astype:"SelectField",label:this.$t("Gender"),name:"Gender",value:"",config:{options:[{value:"M",name:"Male"},{value:"F",name:"Female"}]},placeholder:this.$t("Select"),validationRules:{required:!1}}]},{layoutType:"double",Data:[{astype:"SelectField",label:this.$t("MaritalStatus"),name:"MaritalStatus",value:"",placeholder:"",disabled:!1,validationRules:{required:!1,max:250},config:{options:[{value:"Single",name:"Single"},{value:"Married",name:"Married"},{value:"Divorced",name:"Divorced"},{value:"Widowed",name:"Widowed"}]}},{astype:"TextField",label:this.$t("SPOUSENAME"),name:"SpouseName",value:"",validationRules:{required:!1,max:100}}]},{layoutType:"single",Data:[{astype:"TextAreaField",label:this.$t("PersonalNotes"),name:"PersonalNotes",value:"",validationRules:{required:!1,max:100}}]}],buttons:[{type:"submit",class:"btn btn-success",text:"<i class='fa fa-save pr-2'></i>Save"},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Close",onClick:this.Close}]}},created:async function(){this.GetCountryData()},methods:{GetCountryData:function(){var t=this;t.FormSchema[7].Data[0].config.options=[],pt["a"].GetCountryData().then((function(e){var a=e.data;a.forEach(e=>{t.FormSchema[7].Data[0].config.options.push({name:e.countrY_FULL_NAME,value:e.id})}),t.$refs.AddContact.UpdateKeyValue()}))},Close:function(){this.$parent.OpenAddContact=!1},onSubmit(t,e){var a=this,i={CountryId:t.Country,first_name:t.FirstName,last_name:t.LastName,job_title:t.JobTitle,email_id:t.Email,business_phone:t.BusinessPhone,mobile_phone:t.MobileNumber,fax:t.Fax,preferred_contact:t.PreferredContactMethod,address_street_1:t.AddressStreet1,address_street_2:t.AddressStreet2,address_street_3:t.AddressStreet3,city:t.City,state:t.State,zipcode:t.ZipCode,gender:t.Gender,marital_status:t.MaritalStatus,spouse_name:t.SpouseName,date_of_birth:"",anniversary:"",personal_notes:t.PersonalNotes,status_id:1001},s=JSON.stringify(i);n["a"].SaveNewContacts(s).then(t=>{"Success"==t.data[0].Status?(a.ShowAlert(a.$t("AddedSuccess",[a.$t("Contacts")]),"success",!0,a.$t("Alert")),a.Close(),a.$parent.FetchData()):(a.ShowAlert(a.$t("AddedError",[a.$t("Contacts")]),"failure",!0,a.$t("Alert")),a.Close())})}}},ht=mt,vt=Object(d["a"])(ht,dt,ut,!1,null,null,null),_t=vt.exports,gt={components:{AddNewContact:_t},props:{UserId:{type:Number},ClientData:{type:Object}},data(){return{TotalRecords:0,noRecord:!1,CountryId:"",isLoading:!1,CompanyId:null,PageSize:10,statusId:"",PageNumber:1,isPaged:1,TotalPages:0,widgets:[],SortBy:"",SortExp:"",ProjectName:"",taskId:"",listActions:ct.listActions,Headers:ct.TableHeader,ListingData:[],searchCondition:"",Buttons:ct.buttons,QuotesListingSchema:!1,leftSearchFields:[{fieldName:this.$t("ContactName"),fieldType:"text",fieldSearchConditionName:[""],paramName:"search",isSearch:!0,value:"",listOptions:[]}],OpenAddContact:!1}},created:async function(){this.CompanyId=this.GetUserInfo.CompanyId,this.user_Id=this.GetUserInfo.ID,this.FetchData()},methods:{FetchData:async function(){var t=this,e=`clientId=${t.UserId}&pageSize=${t.PageSize}&pageNum=${t.PageNumber}&sortBy=${t.SortBy}&sortExp=${t.SortExp}`;t.isBlank(this.searchCondition)||(e+="&search="+this.searchCondition),await n["a"].GetAdditionalNewContactsNotWithClient(e).then((function(e){e.data?e.data.length>0?(t.ListingData=e.data,t.TotalRecords=e.data[0].TOTALRECORDS,t.noRecord=!1):(t.ListingData=[],t.noRecord=!0,t.TotalRecords=0):(t.noRecord=!0,t.ListingData=[],t.TotalRecords=0)}))},leftCommonSearch:function(t){if(this.PageNumber=t.PageNumber,this.isPaged=1,"undefined"!=typeof t.searchCondition){let e=t.searchConditionJson,a=e.split("=")[1];this.searchCondition=a}else this.searchCondition="";this.FetchData()},Close:function(){var t=this;t.$emit("CloseAssociatePopup")},formatDate:function(t){return t?E()(t).format("MMMM Do, YYYY"):""},renderActions:function(t){var e=this;let a=[];return e.listActions.forEach(t=>{let e={...t};switch(e.title){case"Edit":e.isVisible=!0;break;default:e.isVisible=!0}a.push(e)}),a},pagerMethod:function(t){this.PageSize=t.PageSize,this.PageNumber=t.PageNumber,this.FetchData()},actionButtonClick:function(t,e){},commonHeaderButtonClick:async function(t){},aAddContact:function(){var t=this;t.OpenAddContact=!t.OpenAddContact},sortdata:function(t){var e="sort tb_headerSortDown";this.SortBy=t,t===this.SortBy&&(""==this.SortExp?(this.SortExp="ASC",e="sort tb_headerSortDown"):"ASC"==this.SortExp?(this.SortExp="DESC",e="sort tb_headerSortUp"):(this.SortExp="ASC",e="sort tb_headerSortDown")),this.FetchData(),$("#"+t+"  span:first-child").attr("class",e)},SaveAssociateContact(){var t=this,e=[];if(t.ListingData.forEach(a=>{if(1==a.isSelected){var i=a.CONTACT_ID,s={id:i,userId:t.UserId,isfor:"Associate"};e.push(s)}}),e.length>0){var a=JSON.stringify(e);n["a"].SubmitAdditionalNewContacts(a).then(e=>{"Success"==e.data.Status?(t.ShowAlert(t.$t("ContactsAddedSuccessfully"),"success",!0,t.$t("Alert")),t.Close()):(t.ShowAlert(t.$t("AddedError",[t.$t("Contacts")]),"failure",!0,t.$t("Alert")),t.Close())})}else t.ShowAlert(t.$t("PleaseSelectAnyRecordsForFurther"),"warning",!0,t.$t("Alert"))}}},ft=gt,Ct=Object(d["a"])(ft,lt,ot,!1,null,null,null),yt=Ct.exports,bt={components:{AssociateContact:yt},props:{UserId:{type:Number},ClientData:{type:Object}},data(){return{TotalRecords:0,noRecord:!1,isLoading:!1,CompanyId:null,PageSize:10,statusId:"",PageNumber:1,isPaged:1,TotalPages:0,widgets:[],SortBy:"",SortExp:"",ProjectName:"",taskId:"",listActions:nt.listActions,Headers:nt.TableHeader,listheaderbuttons:nt.buttons,ListingData:[],searchCondition:"",Buttons:nt.buttons,QuotesListingSchema:!1,leftSearchFields:[{fieldName:this.$t("ContactName"),fieldType:"text",fieldSearchConditionName:[""],paramName:"search",isSearch:!0,value:"",listOptions:[]}],OpenAssociateContact:!1}},created:async function(){this.CompanyId=this.GetUserInfo.CompanyId,this.user_Id=this.GetUserInfo.ID,this.FetchData()},updated(){const t=document.getElementsByClassName("theme-primary partition p-actions-expand");if(t[0]&&"p-name text-white"!=t[0].lastChild.className){const e=document.createElement("span");e.className="p-name text-white",e.textContent=this.$t("AdditionalContact"),t[0].appendChild(e)}},methods:{FetchData:async function(){var t=this,e=`clientId=${t.UserId}&pageSize=${t.PageSize}&pageNum=${t.PageNumber}&sortBy=${t.SortBy}&sortExp=${t.SortExp}`;t.isBlank(this.searchCondition)||(e+="&search="+this.searchCondition),await n["a"].ListAdditionalNewContact(e).then((function(e){e.data?e.data.length>0?(t.ListingData=e.data,t.TotalRecords=e.data[0].TOTALRECORDS,t.noRecord=!1):(t.ListingData=[],t.noRecord=!0,t.TotalRecords=0):(t.noRecord=!0,t.ListingData=[],t.TotalRecords=0)}))},leftCommonSearch:function(t){if(this.PageNumber=t.PageNumber,this.isPaged=1,"undefined"!=typeof t.searchCondition){let e=t.searchConditionJson,a=e.split("=")[1];this.searchCondition=a}else this.searchCondition="";this.FetchData()},formatDate:function(t){return t?E()(t).format("MMMM Do, YYYY"):""},renderActions:function(t){var e=this;let a=[];return e.listActions.forEach(t=>{let e={...t};switch(e.title){case"Edit":e.isVisible=!0;break;default:e.isVisible=!0}a.push(e)}),a},pagerMethod:function(t){this.PageSize=t.PageSize,this.PageNumber=t.PageNumber,this.FetchData()},actionButtonClick:function(t,e){},commonHeaderButtonClick:async function(t){var e=this;switch(t.callbackfunction){case"openAssociate":e.AssociateContact();break;case"openDeAssociate":this.DeAssociateContact();break;case"BackToList":this.BackToList();break}},BackToList:function(){var t=this;t.$router.push({name:"ClientListing"})},AssociateContact:function(t){var e=this;e.OpenAssociateContact=!e.OpenAssociateContact},DeAssociateContact:async function(t){var e=this,a=[];e.ListingData.forEach(t=>{if(1==t.isSelected){var i=t.CONTACT_ID,s={id:i,userId:e.UserId,isfor:"DeAssociate"};a.push(s)}}),a.length>0?await e.confirmR(e.$t("ContactConfirmDelete"),!0,e.$t("Delete"),(async function(){var t=JSON.stringify(a);n["a"].SubmitAdditionalNewContacts(t).then(t=>{"Success"==t.data.Status?(e.ShowAlert(e.$t("ContactsDeletedSuccessfully"),"success",!0,e.$t("Alert")),e.$parent.refreshKey+=1,e.FetchData()):e.ShowAlert(e.$t("AddedError",[e.$t("Contacts")]),"failure",!0,e.$t("Alert"))})})):e.ShowAlert(e.$t("PleaseSelectAnyRecordsForFurther"),"warning",!0,e.$t("Alert"))},sortdata:function(t){var e="sort tb_headerSortDown";this.SortBy=t,t===this.SortBy&&(""==this.SortExp?(this.SortExp="ASC",e="sort tb_headerSortDown"):"ASC"==this.SortExp?(this.SortExp="DESC",e="sort tb_headerSortUp"):(this.SortExp="ASC",e="sort tb_headerSortDown")),this.FetchData(),$("#"+t+"  span:first-child").attr("class",e)}}},St=bt,At=Object(d["a"])(St,et,at,!1,null,null,null),Dt=At.exports,It=function(){var t=this,e=t._self._c;return e("div",{staticClass:"SubscriptionListing"},[e("section",{directives:[{name:"show",rawName:"v-show",value:t.isPlanListing,expression:"isPlanListing"}]},[e("tg-list",{attrs:{IsShowAction:!0,showCheckBox:!0,ModuleName:"Billing",listType:["List"],RenderRowActionMethod:t.renderActions,SubModuleCode:"Billing",IdentityColumn:"plan_mapping_id",ListData:t.PlanListing,HeaderData:t.Headers,callbackfunction:t.FetchData,HeaderButtons:t.listheaderbuttons,TotalRecords:t.TotalRecords,ListDataCallBackFunction:t.FetchData,LegendArray:[],SortExp:t.sortExp,SortBy:t.sortBy,NorecordfoundText:t.$t("NoRecordfound"),isShowHeaderText:!0,HeaderText:t.$t("Plans")},on:{LeftsearchButtonClick:function(t){},PagerButtonClick:t.pagerMethod,ActionButtonClick:t.actionButtonClick,HeaderButtonClick:t.commonHeaderButtonClick,SortdataButtonClick:t.sortdata},scopedSlots:t._u([{key:"slotdata",fn:function({data:a}){return["status_name"==a.column.COLUMN_NAME?[e("span",{class:t.getStatusClassList(a.row.status_name,"status_name")},[t._v(" "+t._s(a.row.status_name)+" ")])]:t._e(),"plan_image_url"==a.column.COLUMN_NAME?[null!=a.row.plan_image_url?e("div",{staticClass:"form-control p-0 border-0",attrs:{alt:"",title:""}},[e("img",{staticClass:"border p-2",attrs:{src:a.row.plan_image_url,height:"50",width:"100",title:""}})]):t._e(),null==a.row.plan_image_url?e("div",{staticClass:"form-control p-0 border-0"},[e("img",{attrs:{src:"/Content/images/imagenotavailable.jpg",alt:"No Image Available",height:"50",width:"100",title:""}})]):t._e()]:t._e(),"plan_name"==a.column.COLUMN_NAME?[e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.OpenPlanDetail(a.row)}}},[e("i",{attrs:{"aria-hidden":"true"}}),t._v(t._s(a.row.plan_name)+" ")])]:t._e(),"BasePriceTotal"==a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(t.$n(a.row.BasePriceTotal,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])]:t._e(),"one_time_charge"==a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(t.$n(a.row.one_time_charge,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])]:t._e(),"total_units"==a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(t.$n(a.row.total_units))+" ")])]:t._e(),"effective_date"==a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(t.$options.filters.formatDate(a.row.effective_date))+" ")])]:t._e(),"expiration_date"==a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(t.$options.filters.formatDate(a.row.expiration_date))+" ")])]:t._e(),"created_at"==a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(t.$options.filters.formatDate(a.row.created_at))+" ")])]:t._e(),"next_invoice_date"==a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(t.$options.filters.formatDate(a.row.next_invoice_date))+" ")])]:t._e()]}}])})],1),t.isPlanContainer?e("PlanContainer",{attrs:{ClientData:t.ClientData,UserId:t.UserId},on:{backToPlanListing:t.backToPlanListing}}):t._e(),t.isPlanDetails?e("PlanDetails",{attrs:{plandetails:t.plandetails,UserId:t.UserId,flag:t.flag,Discounts:t.selectedDiscounts,Taxes:t.selectedTaxes}}):t._e(),t.isPlanHistory?e("PlanHistory",{attrs:{PlanMappingId:t.PlanMappingId},on:{close:function(e){t.isPlanHistory=!1}}}):t._e(),t.isViewPlan?e("modalViewPlan",{attrs:{PlanId:t.PlanId,ClientId:t.UserId,PlanMappingId:t.PlanMappingId},on:{close:function(e){t.isViewPlan=!1}}}):t._e(),t.isInvoice?e("viewReceipt",{attrs:{templateDetails:t.templateDetails},on:{close:function(e){t.isInvoice=!1}}}):t._e(),t.IsComment?e("AddComment",{attrs:{MappingId:t.MappingId,type:t.type,planNamesStr:t.planNamesStr},on:{ChangeStatus:t.ChangeStatus}}):t._e(),t.isPlanRequest?e("PlanRequest",{attrs:{PlanMappingId:t.PlanMappingId},on:{close:function(e){t.isPlanRequest=!1}}}):t._e(),t.isViewPlanDetailsUtilityCase?e("ModalViewPlanDetails",{attrs:{PlanId:t.PlanId,ClientId:t.UserId,PlanMappingId:t.PlanMappingId},on:{close:function(e){t.isViewPlanDetailsUtilityCase=!1}}}):t._e()],1)},Tt=[];let Lt=[{title:"AssociatePlan",iconClass:"fa fa-handshake",callbackfunction:"AssociatePlan",additionalClass:"",isdisabled:!1,isvisible:!0,checkPrivilege:!1},{id:"ChangeStatus",title:"Change Status",iconClass:"fa fa-check",callbackfunction:"ChangeStatus",isdisabled:!0,isvisible:!0,isEnabledOnSelectedRow:!0},{title:"BacktoList",iconClass:"fa fa-angle-double-left",callbackfunction:"BackToList",additionalClass:"",isdisabled:!1,isvisible:!0,checkPrivilege:!1}];var Et={buttons:Lt},xt=function(){var t=this,e=t._self._c;return e("section",[t.isPlanSelection?e("div",{staticClass:"ticketsmallfix theme-primary partition p-actions-expand",staticStyle:{overflow:"visible"}},[e("span",{staticClass:"p-name text-white"},[t._v(t._s(t.$t("AssociatePlan")))]),e("span",{staticClass:"p-actions float-right",on:{click:function(e){return t.backtoPlanList()}}},[e("a",{staticClass:"p-action-btn text-white",attrs:{title:"Back to list",href:"javascript:;"}},[e("em",{staticClass:"fa fa fa-angle-double-left"}),t._v(" "),e("br"),e("span",[t._v(t._s(t.$t("BacktoList")))])])])]):t._e(),t.isPlanSelection?e("div",{staticClass:"btn-group mt-4 mb-2 mb-md-0 d-block text-center"},[e("button",{staticClass:"btn btn-space font-16",class:{"btn-info":"onetime"===t.planPaymentType,"btn-outline-info":"onetime"!==t.planPaymentType},staticStyle:{"border-radius":"30px 0px 0 30px !important",padding:"10px 15px 10px 25px"},attrs:{type:"button"},on:{click:function(e){return t.settype("onetime")}}},[t._v(" "+t._s(t.$t("OneTime"))+" ")]),e("button",{staticClass:"btn btn-space font-16",class:{"btn-info":"recurring"===t.planPaymentType,"btn-outline-info":"recurring"!==t.planPaymentType},staticStyle:{"border-radius":"0px 30px 30px 0px !important",padding:"10px 25px 10px 15px"},attrs:{type:"button"},on:{click:function(e){return t.settype("recurring")}}},[t._v(" "+t._s(t.$t("Recurring"))+" ")])]):t._e(),t.isPlanDetails?e("div",{staticClass:"ticketsmallfix theme-primary partition p-actions-expand",staticStyle:{overflow:"visible"}},[e("span",{staticClass:"p-name text-white"},[t._v(t._s(t.$t("PlanDetails")))]),e("span",{staticClass:"p-actions float-right",on:{click:function(e){return t.backtoPlanList()}}},[e("a",{staticClass:"p-action-btn text-white",attrs:{title:"Back to list",href:"javascript:;"}},[e("em",{staticClass:"fa fa fa-angle-double-left"}),t._v(" "),e("br"),e("span",[t._v(t._s(t.$t("BacktoList")))])])])]):t._e(),t.isAddInvoice?e("div",{staticClass:"stepwizard my-3 d-flex justify-content-center"},[e("div",{staticClass:"stepwizard-row setup-panel d-flex"},[e("div",{staticClass:"stepwizard-step col-xs-3 d-flex align-items-center",on:{click:t.switchToPlan}},[e("div",{class:["step-1","rounded-circle","text-white",t.isPlanSelection?"bg-primary":"bg-secondary"]},[t._v(" 1 ")]),e("p",{staticClass:"mb-0"},[e("small",{staticClass:"pl-3 font-18 font-weight-600"},[t._v(t._s(t.$t("Plan")))])])]),t._m(0),e("div",{staticClass:"stepwizard-step col-xs-3 d-flex align-items-center"},[e("div",{class:["step-2 ","rounded-circle","text-white",t.isPlanDetails?"bg-primary  ml-2":"bg-secondary  ml-2"]},[t._v(" 2 ")]),e("p",{staticClass:"mb-0"},[e("small",{staticClass:"pl-3 font-18"},[t._v(t._s(t.$t("Checkout")))])])])])]):t._e(),t.isPlanSelection?e("Plan",{attrs:{ClientData:t.ClientData,UserId:t.UserId,discount:t.discount,paymentType:t.planPaymentType},on:{closeCurrentPage:t.handlePlanDetails}}):t._e(),t.isPlanDetails?e("PlanDetails",{attrs:{plandetails:t.plandetails,UserId:t.UserId},on:{backtoPlanList:t.backtoPlanList}}):t._e()],1)},Nt=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"col-xs-3 stepwizard-d d-flex align-items-center"},[e("span")])}],Pt=function(){var t=this,e=t._self._c;return e("section",{staticClass:"row"},[e("loader",{attrs:{"is-visible":t.isLoading}}),0==t.PlanList.length?e("div",{staticClass:"text-center text-danger mt-4 border p-2 no-record w-100"},[t._v(" no record found")]):t._e(),t._l(t.PlanList,(function(a,i){return e("div",{key:i,staticClass:"not-related-sub-packages sub-package package-form",staticStyle:{display:"block"}},[e("div",{staticClass:"subs-package-hdr"},[e("label",{staticClass:"checkboxlbl"},[e("input",{staticClass:"chkpackage",attrs:{type:"checkbox",id:"chkpackage_"+a.Plan_id,tabindex:"0","data-packagetype":"Standard"},domProps:{value:a.Plan_id}})])]),e("div",{staticClass:"imgofpck"},[a.plan_image_url?e("img",{attrs:{src:a.plan_image_url,loading:"eager",alt:""}}):e("img",{attrs:{src:"/Content/images/imagenotavailable.jpg",loading:"eager",alt:""}})]),e("div",{staticClass:"pro-headr px-2 py-3"},[e("h2",{staticClass:"text-truncate",attrs:{title:a.plan_name}},[t._v(t._s(a.plan_name))]),e("div",{staticClass:"package-form-data"},["PlanBased"==a.is_applicable_on_plan||"Plan Based"==a.is_applicable_on_plan?e("p",{staticClass:"price-sub",staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[e("span",{class:{spnPackageCost:!0,discounted:a.discountBaseRate&&a.discountBaseRate<a.BaseRate}},[e("font",{staticStyle:{"vertical-align":"inherit"}},[t._v(" "+t._s(a.symbol)+" "+t._s(a.BaseRate)+" ")])],1),"onetime"!==t.paymentType?e("span",[t._v("/"+t._s(t.$t("User"))+"/"+t._s(t.$t("Monthly")))]):t._e(),a.discountBaseRate!=a.BaseRate?e("span",{staticClass:"w-100 float-left font-16"},[t._v(t._s(a.discountBaseRate?`${a.symbol} ${a.discountBaseRate}`:""))]):t._e()]):e("p",{staticClass:"price-sub",staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[e("span",{class:{spnPackageCost:!0,discounted:a.discountBaseRate&&a.discountBaseRate<a.recuring_charges}},[e("font",{staticStyle:{"vertical-align":"inherit"}},[t._v(" "+t._s(a.symbol)+" "+t._s(a.recuring_charges)+" ")])],1),"onetime"!==t.paymentType?e("span",[t._v("/"+t._s(t.$t("User"))+"/"+t._s(t.$t("Monthly")))]):t._e(),a.discountBaseRate!=a.recuring_charges?e("span",{staticClass:"w-40 float-right text-right font-16"},[t._v(t._s(a.discountBaseRate?`${a.symbol} ${a.discountBaseRate}`:""))]):t._e()]),"onetime"!==t.paymentType?e("p",{staticClass:"mb-2 plantype"},[e("label",{staticClass:"d-block mb-1"},[t._v(t._s(t.$t("BillingFrequency"))+" :")]),e("select",{directives:[{name:"model",rawName:"v-model",value:a.selectedFrequency,expression:"item.selectedFrequency"}],staticClass:"form-control w-100",on:{change:[function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(a,"selectedFrequency",e.target.multiple?i:i[0])},function(e){return t.onFrequencyChange(a)}]}},t._l(a.additional_frequency,(function(a,i){return e("option",{key:i,domProps:{value:a.value}},[t._v(t._s(a.name))])})),0)]):t._e(),e("p",{staticClass:"bill-type",staticStyle:{color:"#fff","line-height":"24px","font-size":"16px","font-weight":"400"}},[t._v(" "+t._s(t.$t("PlanType"))+": "),e("span",{staticClass:"annualcost",staticStyle:{float:"right"}},[t._v(" "+t._s(a.is_applicable_on_plan)+"("+t._s(a.plan_type)+") ")])]),"onetime"!==t.paymentType?e("p",{staticClass:"bill-type",staticStyle:{color:"#fff","line-height":"24px","font-size":"16px","font-weight":"400"}},[t._v(" "+t._s(t.$t("ProRate"))+": "),e("span",{staticClass:"annualcost",staticStyle:{float:"right"}},[t._v(" "+t._s(a.IsProrate)+" ")])]):t._e(),"onetime"!==t.paymentType?e("p",{staticClass:"bill-type",staticStyle:{color:"#fff","line-height":"24px","font-size":"16px","font-weight":"400"}},[t._v(" "+t._s(t.$t("Billed"))+" "),e("span",{staticClass:"spnbillingtype"},[e("font",{staticStyle:{"vertical-align":"inherit"}},[t._v(t._s(a.selectedFrequency)+":")])],1),e("span",{staticClass:"annualcost",staticStyle:{float:"right"}},[t._v(" "+t._s(a.symbol)+" "+t._s(a.calculatedRate||a.BaseRate)+" ")])]):t._e(),"ServiceBased"!=a.is_applicable_on_plan&&"Service Based"!=a.is_applicable_on_plan||0==a.ontime_charges?e("p",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[t._v(" ")]):e("p",{staticClass:"bill-type",staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},["onetime"!==t.paymentType?e("span",[t._v(t._s(t.$t("OneTimeCharges")))]):t._e(),"onetime"!==t.paymentType?e("span",{staticClass:"float-right"},[t._v(" "+t._s(a.symbol)+" "+t._s(a.ontime_charges)+" ")]):t._e()])])]),e("div",{staticClass:"pro-footer px-3 py-2 pro-footer-mt"},[e("p",[t._v(t._s(t.$t("ServiceIncludes"))+":")]),e("div",{staticClass:"pckg_desc"},[e("ul",t._l(a.services,(function(a,i){return e("li",{key:i},[t._v(" "+t._s(a.service_name)+" ")])})),0)])]),e("div",{staticClass:"pack-add-count"},[e("div",{staticClass:"buynowbtn text-center"},[e("a",{staticClass:"btn",on:{click:function(e){return t.BuyNow(a.Plan_id)}}},[t._v("Buy Now")])])])])}))],2)},wt=[],Rt=(a("7de8"),{props:{UserId:{type:Number,required:!0},ClientData:{type:Object,default:()=>({})},discount:{type:Number,required:!0},paymentType:{type:String,required:!0}},data(){return{showbillbar:!1,PlanList:[],totalLicense:0,discountValue:0,isLoading:!1,frequencyMultipliers:{Monthly:1,Quarterly:3,SemiAnnually:6,Yearly:12}}},async created(){await this.CheckExtraFeatures(),this.discountValue=this.discount},watch:{paymentType(){this.LoadPlansMappingSubscription()}},methods:{async CheckExtraFeatures(){const t="featureCode=GET_EXTRA_FEATURE_BILLING&outputType=list";try{const e=await n["a"].CheckExtraFeatures(t);if(e.data){const t=JSON.parse(e.data);t.forEach(t=>{"SUBSCRIPTION_BILLING"===t.FEATURE_CODE&&this.LoadPlansMappingSubscription()})}}catch(e){console.error("Error checking extra features:",e)}},async LoadPlansMappingSubscription(){try{this.isLoading=!0;const t=`client_id=${this.UserId}&type=${this.paymentType}`,e=await n["a"].LoadPlansMappingSubscription(t);if("Success"===e.data.status&&"1"===e.data.code){const t=e.data.result;t.forEach(t=>{t.services=t.services?JSON.parse(`[${t.services}]`):[],t.planrate=t.planrate?JSON.parse(`[${t.planrate}]`):[],t.BaseRate=t.BaseRate?t.BaseRate.toFixed(2):0,t.timebased_discount=this.discount,t.is_applicable_on_plan=1==t.is_rate_applicable_on_plan?this.$t("PlanBased"):this.$t("ServiceBased"),t.plan_type=1==t.plan_type?this.$t("Prepaid"):this.$t("Postpaid"),t.selectedFrequency="Monthly",t.calculatedRate=t.BaseRate}),this.PlanList=t,this.isLoading=!1}else this.PlanList=[],this.isLoading=!1}catch(t){console.error("Error loading plans:",t)}},async BuyNow(t){const e=[],a=this.PlanList.find(e=>e.Plan_id===t);a&&e.push(a),e.length>0?(console.log("Selected Plans:",e),this.$emit("closeCurrentPage",e)):console.log("No plans selected")},calculateSavedAmount(t,e){let a=t-e;return a*=12,a.toFixed(2)},onFrequencyChange(t){const e={Monthly:1,Quarterly:3,"Semi-Annually":6,Yearly:12,"4 Month Basis":4};var a=t.additional_frequency.find(e=>e.value===t.selectedFrequency),i=e[t.selectedFrequency]||1,s=a&&a.first_value?parseFloat(a.first_value):0,n=0,l=0,o=0;if(t.is_rate_applicable_on_plan){n=parseFloat(t.BaseRate)*i,l=n*(s/100),o=n-l,t.calculatedRate=o.toFixed(2);const e=t.BaseRate*(s/100);t.discountBaseRate=t.BaseRate-e}else{n=parseFloat(t.recuring_charges)*i,l=n*(s/100),o=n-l;const e=t.recuring_charges*(s/100);t.ontime_charges;t.discountBaseRate=t.recuring_charges-e,t.discountOnetimeRate=t.ontime_charges,t.calculatedRate=(t.discountBaseRate*i).toFixed(2)}}}}),Mt=Rt,$t=(a("d982"),Object(d["a"])(Mt,Pt,wt,!1,null,null,null)),Ft=$t.exports,kt=function(){var t=this,e=t._self._c;return 0==t.isInvoice&&0==t.isPlanSubscription?e("section",{staticClass:"listing"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"theme-primary partition d-flex justify-content-between align-items-center p-2"},[e("span",{staticClass:"p-name text-white"},[t._v("Billing Frequency: "+t._s(t.selectedBilling))]),e("div",{staticClass:"d-flex align-items-center"},[0==t.PlanMappingId||null==t.PlanMappingId?e("span",{staticClass:"p-actions"},[e("a",{staticClass:"p-action-btn text-white",attrs:{title:"Update Plan Rate",href:"javascript:;"},on:{click:function(e){return t.UpdatePlanRates()}}},[e("em",{staticClass:"fa fa-pencil"}),t._v(" "),e("br"),e("span",[t._v(t._s(t.$t("Update Plan Rate")))])])]):t._e(),"One Time"!=t.selectedBilling?e("div",{staticClass:"p-actions ml-3"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedBilling,expression:"selectedBilling"}],staticClass:"form-control",on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selectedBilling=e.target.multiple?a:a[0]},t.handleBillingChange]}},t._l(t.FrequencyOptions,(function(a){return e("option",{key:a.value,domProps:{value:a.value}},[t._v(" "+t._s(a.name)+" ")])})),0)]):t._e()])]),e("div",{staticClass:"table-responsive table-fix-header pt_maxheight700 mt-2"},[t.plandetails.length?e("table",{staticClass:"table table-bordered mt-0 planstable"},[e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",[t._v("Plan")]),e("th",{staticClass:"text-center",staticStyle:{"max-width":"150px","min-width":"150px",width:"150px"}},[t._v(t._s(t.$t("Quantity")))]),t.PlanMappingId>0?e("th",{staticClass:"text-center",staticStyle:{"max-width":"250px","min-width":"250px",width:"250px"}},[t._v(t._s(t.$t("ChangedQuantity")))]):t._e(),e("th",{staticClass:"text-center",staticStyle:{"max-width":"150px","min-width":"150px",width:"150px"}},[t._v(t._s(t.$t("UnitPrice")))]),e("th",{staticClass:"text-center",staticStyle:{"max-width":"150px","min-width":"150px",width:"150px"}},[t._v(t._s(t.$t("ItemTotal")))])])]),e("tbody",[t._l(t.plandetails,(function(a,i){return e("tr",{key:i,staticClass:"parentrows"},[e("td",{staticClass:"font-weight-medium"},[e("a",{staticClass:"parentwithchildPlan d-inline-block parent-childrow",attrs:{id:"aParentID"},on:{click:function(e){return t.toggleServices(i)}}},[e("em",{class:t.showIcon?"fa fa-chevron-right":"fa fa-chevron-down"})]),t._v(" "+t._s(a.plan_name)+" ")]),e("td",[a.is_rate_applicable_on_plan?e("div",{staticClass:"form-group mb-0",staticStyle:{float:"initial"}},[e("div",{staticClass:"input-group"},[e("div",{staticClass:"input-group-btn"},[e("button",{staticClass:"btn btn-default licdown",on:{click:function(e){return t.PlandecrementQuantity(i)}}},[e("em",{staticClass:"fa fa-minus"})])]),e("input",{directives:[{name:"model",rawName:"v-model",value:a.PlanUnit,expression:"plan.PlanUnit"}],staticClass:"form-control input-number noofpackage numberonly text-right",attrs:{type:"number",maxlength:"6",min:"1"},domProps:{value:a.PlanUnit},on:{input:[function(e){e.target.composing||t.$set(a,"PlanUnit",e.target.value)},function(e){return t.updateQuantity(i,t.serviceIndex,"plan")}]}}),e("div",{staticClass:"input-group-btn"},[e("button",{staticClass:"btn btn-default licup",on:{click:function(e){t.PlanincrementQuantity(i,t.Rate(a.planrate,a.PlanUnit))}}},[e("em",{staticClass:"fa fa-plus"})])])])]):t._e()]),t.PlanMappingId>0?e("td",{staticClass:"text-center"},[a.is_rate_applicable_on_plan?e("div",{staticClass:"form-group mb-0",staticStyle:{float:"initial"}},[e("div",{staticClass:"mb-1"},[0===t.changed_unit?e("span",[t._v("0")]):t.changed_unit>0?e("span",{staticClass:"text-success"},[t._v(" + "+t._s(t.changed_unit)+" "),e("em",{staticClass:"fa fa-arrow-up"})]):e("span",{staticClass:"text-danger"},[t._v(" "+t._s(t.changed_unit)+" "),e("em",{staticClass:"fa fa-arrow-down"})])])]):t._e()]):t._e(),a.is_rate_applicable_on_plan?e("td",{staticClass:"text-right"},[t._v(" "+t._s(t.$n(t.Rate(a.planrate,a.PlanUnit,"plan").toFixed(2),"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")]):t._e(),a.is_rate_applicable_on_plan?t._e():e("td",{staticClass:"text-right"}),a.is_rate_applicable_on_plan?t._e():e("td",{staticClass:"text-right"},[t._v(" "+t._s(t.$n(t.calculateTotalItem(i,"service"),"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")]),a.is_rate_applicable_on_plan?e("td",{staticClass:"text-right"},[t._v(" "+t._s(t.$n(t.calculateTotalItem(i,"plan"),"currency",t.$getLocaleByCurrency(t.CurrencyCode))))]):t._e()])})),t._l(t.plandetails,(function(a,i){return t._l(a.services.filter(t=>"Support"!==t.service_type_code),(function(s,n){return e("tr",{key:"service-"+s.service_id,staticClass:"childrows"},[t.isServicesVisible(i)?[e("td",{staticClass:"childtext"},[t._v(t._s(s.service_name)+" ("+t._s(s.service_type_name)+")")]),e("td",[a.is_rate_applicable_on_plan?t._e():e("div",{staticClass:"form-group mb-0",staticStyle:{float:"initial"}},[e("div",{staticClass:"input-group"},[e("div",{staticClass:"input-group-btn"},[e("button",{staticClass:"btn btn-default licdown",attrs:{disabled:"OneTime"===s.service_type_code||"Activation"===s.service_type_code},on:{click:function(e){return t.decrementQuantity(i,n)}}},[e("em",{staticClass:"fa fa-minus"})])]),e("input",{directives:[{name:"model",rawName:"v-model",value:s.Unit,expression:"service.Unit"}],staticClass:"form-control input-number noofpackage numberonly text-right",attrs:{type:"number",min:"1",maxlength:"6",disabled:"OneTime"===s.service_type_code||"Activation"===s.service_type_code},domProps:{value:s.Unit},on:{input:[function(e){e.target.composing||t.$set(s,"Unit",e.target.value)},function(e){return t.updateQuantity(i,n,"service")}]}}),e("div",{staticClass:"input-group-btn"},[e("button",{staticClass:"btn btn-default licup",attrs:{disabled:"OneTime"===s.service_type_code||"Activation"===s.service_type_code},on:{click:function(e){t.incrementQuantity(i,n,t.Rate(s.ServiceRate,s.Unit,"services"))}}},[e("em",{staticClass:"fa fa-plus"})])])])])]),t.PlanMappingId>0?e("td",{staticClass:"text-center"},[a.is_rate_applicable_on_plan?t._e():e("div",{staticClass:"form-group mb-0",staticStyle:{float:"initial"}},[e("div",{staticClass:"mb-1"},[0===s.changed_unit?e("span",[t._v("0")]):s.changed_unit>0?e("span",{staticClass:"text-success"},[t._v(" + "+t._s(s.changed_unit)+" "),e("em",{staticClass:"fa fa-arrow-up"})]):e("span",{staticClass:"text-danger"},[t._v(" "+t._s(s.changed_unit)+" "),e("em",{staticClass:"fa fa-arrow-down"})])])])]):t._e(),null!=s.ServiceRate&&"UsageBased"!=s.service_type_code?e("td",{staticClass:"text-right"},[t._v(" "+t._s(t.$n(s.ServiceRate[0].rate,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")]):e("td",{staticClass:"text-right"},[null!=t.getRateForUnit(s.Unit,s.ServiceRate)?e("span",[t._v(" "+t._s(t.$n(t.getRateForUnit(s.Unit,s.ServiceRate),"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")]):t._e()]),a.is_rate_applicable_on_plan||"UsageBased"==s.service_type_code?a.is_rate_applicable_on_plan||"UsageBased"!==s.service_type_code?t._e():e("td",{staticClass:"text-right"},[null!=t.getRateForUnit(s.Unit,s.ServiceRate)?e("span",[t._v(" "+t._s(t.formatUsageBasedRate(s))+" ")]):t._e()]):e("td",{staticClass:"text-right"},[t._v(t._s(t.$n((s.ServiceRate[0].rate*s.Unit).toFixed(2),"currency",t.$getLocaleByCurrency(t.CurrencyCode))))]),a.is_rate_applicable_on_plan?e("td",{attrs:{colspan:"2"}}):t._e()]:t._e()],2)}))})),t._l(t.supportServices,(function(a,i){return e("tr",{key:"Support-"+i},[e("td",{staticClass:"childtext"},[t._v(t._s(a.service_name)+" ("+t._s(a.service_type_name)),a.ServiceRate&&a.ServiceRate[0]&&"PERCENTAGE"===a.ServiceRate[0].billing_type?e("span",[t._v(" - "+t._s(a.ServiceRate[0].rate)+"%")]):t._e(),t._v(")")]),t.PlanMappingId>0?e("td"):t._e(),e("td"),e("td"),t.RateApplicableOnPlan?e("td"):e("td",{staticClass:"text-right"},[t._v(t._s(t.$n(t.calculateSupportTotal(a),"currency",t.$getLocaleByCurrency(t.CurrencyCode))))])])})),t.supportServices.length>0&&!t.RateApplicableOnPlan?e("tr",{staticClass:"subtotal"},[e("td",{staticClass:"font-weight-medium"},[t._v("Subtotal with Support:")]),t.PlanMappingId>0?e("td"):t._e(),e("td"),e("td"),e("td",{staticClass:"text-right font-weight-medium"},[t._v(t._s(t.$n((parseFloat(t.baseSubtotal)+parseFloat(t.supportTotal)).toFixed(2),"currency",t.$getLocaleByCurrency(t.CurrencyCode))))])]):t._e(),e("tr",{staticClass:"adddiscount"},[e("td",{staticStyle:{overflow:"visible!important"}},[e("a",{staticClass:"text-primary float-left font-weight-medium",on:{click:t.toggleDiscountDropdown}},[e("em",{staticClass:"mr-1 mt-2"}),t._v(t._s(t.$t("SelectDiscount"))+" ")]),t.discountDropdownVisible?e("div",{staticClass:"float-left ml-3"},[e("multiselect",{attrs:{options:t.discountList,multiple:!0,"close-on-select":!1,"track-by":"ADJUSTMENT_ID",label:"ADJUSTMENT_NAME",placeholder:"Select Discounts"},on:{change:function(e){return t.updateMulitpleTaxDiscount("discount")}},model:{value:t.selectedDiscounts,callback:function(e){t.selectedDiscounts=e},expression:"selectedDiscounts"}})],1):t._e()]),t.PlanMappingId>0?e("td",{attrs:{colspan:"4"}}):e("td",{attrs:{colspan:"3"}})]),t._l(t.selectedDiscounts,(function(a,i){return e("tr",{key:i},[e("td",{staticClass:"childtext"},[t._v(t._s(a.ADJUSTMENT_NAME)+" ("+t._s(a.ADJUSTMENT_PERCENTAGE)+t._s(null==a.DISCOUNT_TYPE||0==a.DISCOUNT_TYPE?"%":"")+")")]),t.PlanMappingId>0?e("td"):t._e(),e("td"),e("td"),e("td",{staticClass:"text-right"},[t._v(" - "+t._s(t.$n(a.calculatedDiscount,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])])})),e("tr",{staticClass:"subtotal"},[e("td",{staticClass:"font-weight-medium"},[t._v(t._s(t.$t("SubTotal"))+":")]),t.PlanMappingId>0?e("td"):t._e(),e("td"),e("td"),e("td",{staticClass:"text-right font-weight-medium"},[t._v(t._s(t.$n(t.subtotal,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])]),e("tr",{staticClass:"adddiscount"},[e("td",{staticStyle:{overflow:"visible!important"}},[t._v(" Tax Exclusive"),e("br"),e("a",{staticClass:"text-primary float-left font-weight-medium",on:{click:t.toggleTaxDropdown}},[e("em",{staticClass:"mr-1 mt-2"}),t._v(t._s(t.$t("SelectTax"))+" ")]),t.taxDropdownVisible?e("div",{staticClass:"float-left ml-3"},[e("multiselect",{attrs:{options:t.taxList,multiple:!0,"close-on-select":!1,"track-by":"ADJUSTMENT_ID",label:"ADJUSTMENT_NAME",placeholder:"Select Taxes"},on:{change:function(e){return t.updateMulitpleTaxDiscount("tax")}},model:{value:t.selectedTaxes,callback:function(e){t.selectedTaxes=e},expression:"selectedTaxes"}})],1):t._e()]),e("td",{attrs:{colspan:"4"}})]),t._l(t.selectedTaxes,(function(a,i){return e("tr",{key:i},[e("td",{staticClass:"childtext"},[t._v(t._s(a.ADJUSTMENT_NAME)+" ("+t._s(a.ADJUSTMENT_PERCENTAGE)+"%)")]),t.PlanMappingId>0?e("td"):t._e(),e("td"),e("td"),e("td",{staticClass:"text-right"},[t._v(" + "+t._s(t.$n(a.CalculatedTax,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])])})),e("tr",{staticClass:"grandtotal"},[e("td",{staticClass:"font-weight-medium"},[t._v(t._s(t.$t("Total")))]),t.PlanMappingId>0?e("td"):t._e(),e("td"),e("td"),e("td",{staticClass:"text-right font-weight-medium"},[t._v(t._s(t.$n(t.finalTotal,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])])],2)]):e("p",[t._v(t._s(t.$t("NoPlansAvailable")))])]),e("div",{staticClass:"row flex-row-reverse mb-2 mt-2"},[e("div",{staticClass:"col-lg-12 text-right"},[e("a",{staticClass:"btn btn-success mr-2",attrs:{href:"javascript:;"},on:{click:t.generateInvoice}},[t._v(" "+t._s(t.$t("Next"))+" "),e("em",{staticClass:"fa fa-angle-double-right ml-2"})]),e("a",{staticClass:"btn btn-danger",attrs:{href:"javascript:;",title:""},on:{click:function(e){return t.backtoPlanList()}}},[e("em",{staticClass:"fa fa-close pr-2"}),t._v(" "+t._s(t.$t("Cancel")))])])]),t.FrequencyNote?e("p",{staticStyle:{"font-size":"14px",color:"#555","margin-top":"10px"}},[e("strong",[t._v(" "+t._s(t.$t("BillingCycleNotes")))])]):t._e(),t.PlanMappingId>0&&(158446==t.CompanyId||122872==t.CompanyId||158770==t.CompanyId||125897==t.CompanyId||125948==t.CompanyId)?e("div",[e("dynamic-form",{ref:"dynamicform",attrs:{lang:"en",buttons:t.buttons,schema:t.FormSchema},on:{OnSubmit:t.onSubmit}})],1):t._e(),t.isServices?e("ServiceRatesList",{attrs:{Id:t.clientplanmappingid,PlanId:t.PlanId,ClientId:t.UserId},on:{"refresh-plans":t.refreshPlans}}):t._e()],1):e("section",[t.isTemplate?e("InvoiceTemplate",{attrs:{details:t.templateDetails,hitFrom:"Plans"},on:{backtoPlanDetails:t.backtoPlanDetails}}):t._e(),t.isPlanSubscription?e("ConfirmSubscription",{attrs:{invoiceData:t.InvoiceSavedData,descriptionData:t.descriptionData,plandetails:t.plandetails,UserId:t.UserId,EstimatedAmount:t.EstimatedAmount,EstimatePayableAmount:t.EstimatePayableAmount,EstimatedAdjustmentAmount:t.EstimatedAdjustmentAmount,PreviousCreditAmount:t.PreviousCreditAmount,IsProrate:t.IsProrate,PlanType:t.PlanType,SelectedDate:t.SelectedDate,selectedBilling:t.selectedBilling,PreselectedBilling:t.PreselectedBilling,MultiplyFrequencyFactor:t.MultiplyFrequencyFactor},on:{backtoPlanList:t.backtoPlanList}}):t._e(),t.isAddSubscription?e("ConfirmAddSubscription",{attrs:{invoiceData:t.InvoiceSavedData,descriptionData:t.descriptionData,UserId:t.UserId,estimated_total_amount:t.estimated_total_amount,EstimatePayableAmount:t.EstimatePayableAmount,IsProrate:t.IsProrate,PlanType:t.PlanType,selectedBilling:t.selectedBilling},on:{backtoPlanList:t.backtoPlanList}}):t._e()],1)},Ot=[],Bt=(a("13d5"),a("8e5f")),Ut=a.n(Bt),Gt=a("384d"),Yt=(a("e607"),function(){var t=this,e=t._self._c;return e("section",[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"theme-primary partition"},[e("span",{staticClass:"p-name text-white"},[t._v(" "+t._s(t.$t("ConfirmSubscriptionChanges"))+" "),t.selectedBilling!=t.PreselectedBilling?e("strong",[t._v(" ("+t._s(t.PreselectedBilling)+" → "+t._s(t.selectedBilling)+") ")]):t._e()]),e("span",{staticClass:"p-name text-white float-right"},[t._v(" "+t._s(t.$t("Plan"))+" → "+t._s(t.PlanName)+" ")])]),e("div",{staticClass:"listing"},[t.RateApplicableOnPlan?e("div",{staticClass:"table-responsive table-fix-header mt-2 px-0"},[e("table",{staticClass:"table table-bordered mb-0",staticStyle:{width:"100%"},attrs:{id:"example"}},[e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",{staticStyle:{"min-width":"250px"}},[e("span",{staticClass:"font-weight-500"},[t._v(t._s(t.$t("Plan"))+" ")])]),e("th",{staticStyle:{"min-width":"200px"}},[e("span",{staticClass:"font-weight-500"},[t._v(t._s(t.$t("Previous"))+" ")])]),e("th",{staticStyle:{"min-width":"200px"}},[e("span",{staticClass:"font-weight-500"},[t._v(t._s(t.$t("New"))+" ")])]),e("th",{staticStyle:{"min-width":"150px"}},[e("span",{staticClass:"font-weight-500"},[t._v(t._s(t.$t("Change"))+" ")])]),e("th",{staticClass:"text-right",staticStyle:{"min-width":"150px"}},[e("span",{staticClass:"font-weight-500"},[t._v(t._s(t.$t("PriceImpact"))+" ")])])])]),e("tbody",[e("tr",[e("td",[t._v(t._s(t.PlanName))]),e("td",[t._v(t._s(t.PlanExistingUnit))]),e("td",[t._v(t._s(t.PlanExistingUnit+t.Plan_changed_unit))]),e("td",[0===t.Plan_changed_unit?e("span",[t._v(t._s(t.$t("NoChange"))+" ")]):t.Plan_changed_unit>0?e("span",{staticClass:"text-success"},[t._v(" + "+t._s(t.Plan_changed_unit)+" "),e("em",{staticClass:"fa fa-arrow-up"})]):e("span",{staticClass:"text-danger"},[t._v(" "+t._s(t.Plan_changed_unit)+" "),e("em",{staticClass:"fa fa-arrow-down"})])]),e("td",{staticClass:"text-right"},[(t.PlanExistingUnit+t.Plan_changed_unit)*t.PlanRate-t.PlanExistingUnit*t.FrequencyRate===0?e("span",[t._v(" "+t._s(t.$n(0,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")]):t.PlanRate*t.PlanUnit>t.FrequencyRate*t.PlanExistingUnit?e("span",{staticClass:"text-success"},[t._v(" + "+t._s(t.PlanRate>0?t.$n((t.PlanExistingUnit+t.Plan_changed_unit)*t.PlanRate-t.PlanExistingUnit*t.FrequencyRate,"currency",t.$getLocaleByCurrency(t.CurrencyCode)):t.$n(0,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" "),e("em",{staticClass:"fa fa-arrow-up"})]):e("span",{staticClass:"text-danger"},[t._v(" "+t._s(t.PlanRate>0?t.$n((t.PlanExistingUnit+t.Plan_changed_unit)*t.PlanRate-t.PlanExistingUnit*t.FrequencyRate,"currency",t.$getLocaleByCurrency(t.CurrencyCode)):t.$n(0,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" "),e("em",{staticClass:"fa fa-arrow-down"})])])])])])]):e("div",{staticClass:"table-responsive col-lg-12 mt-2 px-0"},[e("table",{staticClass:"table table-bordered mb-0",staticStyle:{width:"100%"},attrs:{id:"example"}},[e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",{staticStyle:{"min-width":"250px"}},[e("span",{staticClass:"font-weight-500"},[t._v(t._s(t.$t("Service"))+" ")])]),e("th",{staticStyle:{"min-width":"200px"}},[e("span",{staticClass:"font-weight-500"},[t._v(t._s(t.$t("Previous"))+" ")])]),e("th",{staticStyle:{"min-width":"200px"}},[e("span",{staticClass:"font-weight-500"},[t._v(t._s(t.$t("New"))+" ")])]),e("th",{staticStyle:{"min-width":"150px"}},[e("span",{staticClass:"font-weight-500"},[t._v(t._s(t.$t("Change"))+" ")])]),e("th",{staticClass:"text-right",staticStyle:{"min-width":"150px"}},[e("span",{staticClass:"font-weight-500"},[t._v(t._s(t.$t("PriceImpact"))+" ")])])])]),e("tbody",t._l(t.servicesData,(function(a){return e("tr",[e("td",[t._v(t._s(a.service_name))]),e("td",[t._v(t._s(a.Existing_unit))]),e("td",[t._v(t._s(a.Existing_unit+a.Changed_unit))]),e("td",[0===a.Changed_unit?e("span",[t._v(t._s(t.$t("NoChange"))+" ")]):a.Changed_unit>0?e("span",{staticClass:"text-success"},[t._v(" + "+t._s(a.Changed_unit)+" "),e("em",{staticClass:"fa fa-arrow-up"})]):e("span",{staticClass:"text-danger"},[t._v(" "+t._s(a.Changed_unit)+" "),e("em",{staticClass:"fa fa-arrow-down"})])]),a.ServiceRate.length>1?e("td",{staticClass:"text-right"},["Support"===a.service_type_code||0===a.PriceImpact?e("span",[t._v(" "+t._s(t.$n(0,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")]):a.PriceImpact>0?e("span",{staticClass:"text-success"},[t._v(" + "+t._s(t.$n(a.PriceImpact,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" "),e("em",{staticClass:"fa fa-arrow-up"})]):e("span",{staticClass:"text-danger"},[t._v(" "+t._s(t.$n(a.PriceImpact,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" "),e("em",{staticClass:"fa fa-arrow-down"})])]):e("td",{staticClass:"text-right"},["Support"===a.service_type_code||(a.Existing_unit+a.Changed_unit)*a.ServiceRate[0].rate-a.Existing_unit*a.ServiceRate[0].Freqrate===0?e("span",[t._v(" "+t._s(t.$n(0,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")]):a.ServiceRate[0].rate*a.Unit>a.ServiceRate[0].Freqrate*a.Existing_unit?e("span",{staticClass:"text-success"},[t._v(" + "+t._s(a.ServiceRate&&a.ServiceRate.length>0?t.$n((a.Existing_unit+a.Changed_unit)*a.ServiceRate[0].rate-a.Existing_unit*a.ServiceRate[0].Freqrate,"currency",t.$getLocaleByCurrency(t.CurrencyCode)):t.$n(0,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" "),e("em",{staticClass:"fa fa-arrow-up"})]):e("span",{staticClass:"text-danger"},[t._v(" "+t._s(a.ServiceRate&&a.ServiceRate.length>0?t.$n((a.Existing_unit+a.Changed_unit)*a.ServiceRate[0].rate-a.Existing_unit*a.ServiceRate[0].Freqrate,"currency",t.$getLocaleByCurrency(t.CurrencyCode)):t.$n(0,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" "),e("em",{staticClass:"fa fa-arrow-down"})])])])})),0)])])]),e("div",{staticClass:"col-12 float-left mt-4 p-0"},[e("div",{staticClass:"heading-border"},[e("h5",{staticClass:"h5 text-capitalize"},[e("span",[t._v(t._s(t.$t("PricingSummary")))])])]),e("div",{staticClass:"d-flex justify-content-between font-16 my-2 rowhighlighter"},[e("div",{staticClass:"col-sm-6 col-md-6 col-xl-6 p-2"},[t._v(" "+t._s(t.$t("PreviousAmount"))+" :")]),e("div",{staticClass:"col-sm-6 col-md-6 col-xl-6 text-right p-2"},[t._v(" "+t._s(t.$n(t.BillingAmount,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])]),e("div",{staticClass:"d-flex justify-content-between font-16 my-2 rowhighlighter"},[e("div",{staticClass:"col-sm-6 col-md-6 col-xl-6 p-2"},[t._v(" "+t._s(t.$t("AdditionalAmount"))+" :")]),e("div",{staticClass:"col-sm-6 col-md-6 col-xl-6 text-right p-2"},[t._v(" "+t._s(t.$n(t.IncreasedAmount,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])]),t.DiscountData&&t.DiscountData.length>0?e("div",{staticStyle:{"margin-top":"12px"}},[e("div",{staticClass:"heading-border"},[e("h5",{staticClass:"h5 text-capitalize"},[e("span",[t._v(t._s(t.$t("Discounts")))])])]),t._l(t.DiscountData,(function(a){return e("div",{key:a.discountName,staticClass:"d-flex justify-content-between font-16 my-2 rowhighlighter"},[e("div",{staticClass:"col-sm-6 col-md-6 col-xl-6 p-2"},[t._v(t._s(a.discountName||"Discount")+":")]),e("div",{staticClass:"col-sm-6 col-md-6 col-xl-6 text-right p-2"},[t._v("-"+t._s(t.$n(Number(a.calculatedDiscount),"currency",t.$getLocaleByCurrency(t.CurrencyCode))))])])}))],2):t._e(),t.TaxData&&t.TaxData.length>0?e("div",{staticStyle:{"margin-top":"12px"}},[e("div",{staticClass:"heading-border"},[e("h5",{staticClass:"h5 text-capitalize"},[e("span",[t._v(t._s(t.$t("Taxes")))])])]),t._l(t.TaxData,(function(a){return e("div",{key:a.taxName,staticClass:"d-flex justify-content-between font-16 my-2 rowhighlighter"},[e("div",{staticClass:"col-sm-6 col-md-6 col-xl-6 p-2"},[t._v(t._s(a.taxName||"Tax")+":")]),e("div",{staticClass:"col-sm-6 col-md-6 col-xl-6 text-right p-2"},[t._v("+"+t._s(t.$n(Number(a.CalculatedTax),"currency",t.$getLocaleByCurrency(t.CurrencyCode))))])])}))],2):t._e(),e("div",{staticClass:"d-flex justify-content-between font-16 my-2 rowhighlighter"},[e("div",{staticClass:"col-sm-6 col-md-6 col-xl-6 p-2 font-weight-medium"},[t._v("New "+t._s(t.selectedBilling)+" Cost:")]),e("div",{staticClass:"col-sm-6 col-md-6 col-xl-6 text-right p-2 font-weight-medium"},[t._v(" "+t._s(t.$n(Number(t.BillingAmount||0)+Number(t.IncreasedAmount||0)-t.getTotalDiscount()+t.getTotalTax(),"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])]),e("div",{staticClass:"d-flex justify-content-between font-16 my-2 rowhighlighter"},[e("div",{staticClass:"col-sm-6 col-md-6 col-xl-6 p-2"},[t._v(t._s(t.$t("ProrataCalculatedAmount"))+" "),0!=t.EstimatedAmount?e("a",{attrs:{href:"javascript:;",title:"View All"},on:{click:function(e){return t.ViewProrataList()}}},[e("em",{staticClass:"fa fa-eye text-info action-icon"})]):t._e(),t._v(":")]),e("div",{staticClass:"col-sm-6 col-md-6 col-xl-6 text-right p-2"},[t._v(" "+t._s(t.$n(t.EstimatedAmount,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])]),e("div",{staticClass:"d-flex justify-content-between font-16 my-2 rowhighlighter"},[e("div",{staticClass:"col-sm-6 col-md-6 col-xl-6 p-2"},[t._v(" Previous Credit Balance: ")]),e("div",{staticClass:"col-sm-6 col-md-6 col-xl-6 text-right p-2"},[0===t.PreviousCreditAmount?e("span",[t._v(" "+t._s(t.$n(0,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")]):t.PreviousCreditAmount>0?e("span",{staticClass:"text-success"},[t._v(" +"+t._s(t.$n(Math.abs(t.PreviousCreditAmount),"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")]):e("span",{staticClass:"text-danger"},[t._v(" "+t._s(t.$n(Math.abs(t.PreviousCreditAmount),"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])])]),e("div",{staticClass:"d-flex justify-content-between font-16 my-2 rowhighlighter"},[e("div",{staticClass:"col-sm-6 col-md-6 col-xl-6 p-2 font-weight-medium"},[t.EstimatePayableAmount>0?e("div",["Postpaid"==t.PlanType||0==t.IsProrate?e("span",[t._v(t._s(t.$t("NextBillingCyclePayableAmount")))]):e("span",[t._v(t._s(t.$t("PayableAmount")))]),t._v(": ")]):t.EstimatePayableAmount<0?e("div",["Postpaid"==t.PlanType||0==t.IsProrate?e("span",[t._v(t._s(t.$t("NextBillingCycleAvailableCreditBalance")))]):e("span",[t._v(t._s(t.$t("AvailableCreditBalance")))]),t._v(": ")]):e("div",[t._v(" Payable "+t._s(t.selectedBilling)+" Cost: ")])]),e("div",{staticClass:"col-sm-6 col-md-6 col-xl-6 text-right p-2 font-weight-medium"},[0===t.EstimatePayableAmount?e("span",[t._v(" "+t._s(t.$n(0,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")]):t.EstimatePayableAmount>0?e("span",{staticClass:"text-success"},[t._v(" "+t._s(t.$n(t.EstimatePayableAmount,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")]):e("span",{staticClass:"text-danger"},[t._v(" "+t._s(t.$n(Math.abs(t.EstimatePayableAmount),"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])])]),e("p",{staticStyle:{"font-size":"13px",color:"#555","margin-top":"10px"}},[e("strong",[t._v("Note:")]),t._v(" "+t._s(t.$t("AdjustmentAccountsCurrentBillingPeriod"))+" "),e("strong",[t._v(" "+t._s(t.$n(Math.abs(t.EstimatePayableAmount),"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")]),t._v(" "+t._s(t.EstimatePayableAmount>=0?t.$t("WillBeCharged"):t.$t("Available Credited Balance"))+". ")]),t.selectedBilling!=t.PreselectedBilling?e("p",{staticStyle:{"font-size":"14px",color:"#555","margin-top":"10px"}},[e("strong",[t._v(t._s(t.$t("BillingCycleNotes")))])]):t._e(),e("div",{staticClass:"row flex-row-reverse mb-2"},[e("div",{staticClass:"col-lg-12 text-right"},[e("a",{staticClass:"submitbtn btn btn-primary formbtn widthhalf mr-2",attrs:{title:"Click here to save record",href:"javascript:;",id:"hlkSave"},on:{click:t.ClosePopUp}},[e("em",{staticClass:"fa fa-angle-double-left pr-2"}),t._v(t._s(t.$t("Back"))+" ")]),e("a",{staticClass:"submitbtn btn btn-success formbtn widthhalf mr-2",attrs:{title:"Click here to save record",href:"javascript:;",id:"hlkSave"},on:{click:t.generateInvoice}},[e("em",{staticClass:"fa fa-save pr-2 text-white"}),t._v(t._s(t.$t("ConfirmChanges"))+" ")]),e("a",{staticClass:"submitbtn btn btn-danger formbtn widthhalf",attrs:{title:"Cancel",href:"javascript:;",id:"hlkCancel"},on:{click:function(e){return t.$emit("backtoPlanList")}}},[e("em",{staticClass:"fa fa-close pr-2 text-white"}),t._v(t._s(t.$t("Cancel"))+" ")])])])]),e("transition",{attrs:{name:"modal"}},[e("div",{staticClass:"my-popups"},[t.isShowProrataData?e("div",{staticClass:"modal d-block dialog"},[e("div",{staticClass:"modal-dialog modal-lg"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("Details")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Closedetails}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[t.ProrataDescription&&t.ProrataDescription.length?e("div",{staticClass:"listing"},[e("div",{staticClass:"table-responsive table-fix-header mt-2 px-0"},[e("table",{staticClass:"table table-bordered mb-0",staticStyle:{width:"100%"},attrs:{id:"example"}},[e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",{staticStyle:{"min-width":"190px"}},[e("span",{staticClass:"font-weight-500"},[t._v(t._s(t.$t("ServiceAndPlan"))+" ")])]),e("th",{staticStyle:{"min-width":"110px"}},[e("span",{staticClass:"font-weight-500"},[t._v(t._s(t.$t("From"))+" ")])]),e("th",{staticStyle:{"min-width":"110px"}},[e("span",{staticClass:"font-weight-500"},[t._v(t._s(t.$t("To"))+" ")])]),e("th",{staticStyle:{"min-width":"90px"}},[e("span",{staticClass:"font-weight-500"},[t._v(t._s(t.$t("BillingDays"))+" ")])]),e("th",{staticStyle:{"min-width":"90px"}},[e("span",{staticClass:"font-weight-500"},[t._v(t._s(t.$t("PlanDays"))+" ")])]),e("th",{staticStyle:{"min-width":"50px"}},[e("span",{staticClass:"font-weight-500"},[t._v(t._s(t.$t("P.F"))+" ")])]),e("th",{staticStyle:{"min-width":"70px"}},[e("span",{staticClass:"font-weight-500"},[t._v(t._s(t.$t("Units"))+" ")])]),e("th",{staticStyle:{"min-width":"70px"}},[e("span",{staticClass:"font-weight-500"},[t._v(t._s(t.$t("Rate"))+" ")])]),e("th",[e("span",{staticClass:"font-weight-500"},[t._v(t._s(t.$t("Amount"))+" ")])])])]),e("tbody",t._l(t.ProrataDescription,(function(a,i){return e("tr",{key:i},[e("td",[t._v(t._s(a["service/plan"]))]),e("td",[t._v(t._s(t.$options.filters.formatDate(a.from)))]),e("td",[t._v(t._s(t.$options.filters.formatDate(a.to)))]),e("td",[t._v(t._s(a.billing_days))]),e("td",[t._v(t._s(a.plan_days))]),e("td",[t._v(t._s(Number(a.multiply_factor).toFixed(4)))]),e("td",[t._v(t._s(a.units))]),e("td",[t._v(t._s(t.$n(a.rate,"currency",t.$getLocaleByCurrency(t.CurrencyCode))))]),e("td",[t._v(t._s(t.$n(a.amount,"currency",t.$getLocaleByCurrency(t.CurrencyCode))))])])})),0)])])]):t._e(),e("p",{staticStyle:{"font-size":"14px",color:"#555","margin-top":"30px"}},[e("strong",[t._v(" "+t._s(t.$t("ProrationFactorDays")))])])])])])]):t._e()])])],1)}),Vt=[],Ht={props:{invoiceData:{type:Object},plandetails:{type:Object},UserId:{type:Number},EstimatedAmount:{type:Number},EstimatePayableAmount:{type:Number},EstimatedAdjustmentAmount:{type:Number},PreviousCreditAmount:{type:Number},SelectedDate:{type:Date},selectedBilling:{type:String},PreselectedBilling:{type:String},descriptionData:{type:String},MultiplyFrequencyFactor:{type:Number},IsProrate:{type:String},PlanType:{type:String}},data(){return{isLoading:!1,servicesData:[],PlanDetailsData:[],RateApplicableOnPlan:!1,PlanName:"",PlanUnit:"",PlanExistingUnit:"",PlanRate:"",Plan_changed_unit:"",BillingAmount:"",IncreasedAmount:"",TaxData:[],CurrencyCode:"PKR",FrequencyRate:"",isShowProrataData:!1,ProrataDescription:[]}},async created(){var t=this;t.servicesData=t.invoiceData.plans[0].services,t.servicesData.forEach((function(e){e.ServiceRate&&e.ServiceRate.length>1&&(e.PriceImpact=e.newCaluclateRate-e.calculatedRate),e.ServiceRate&&e.ServiceRate.length>1&&e.ServiceRate.forEach((function(e){e.Freqrate=e.Pre_rate*t.MultiplyFrequencyFactor,e.rate=e.Freqrate}))})),t.RateApplicableOnPlan=t.invoiceData.plans[0].is_rate_applicable_on_plan,t.PlanDetailsData=t.invoiceData.plans[0],t.PlanName=t.PlanDetailsData.Plan_name,t.PlanUnit=t.PlanDetailsData.PlanUnits,t.PlanExistingUnit=t.PlanDetailsData.plan_Existing_unit,t.PlanRate=t.PlanDetailsData.PlanRate,t.Plan_changed_unit=t.PlanDetailsData.Plan_changed_unit,t.BillingAmount=t.plandetails[0].billing_amount,t.TaxData=t.invoiceData.plans[0].tax,t.DiscountData=t.invoiceData.plans[0].discount,t.CurrencyCode=t.GetUserInfo.Currency.replace(/[()]/g,""),t.FrequencyRate=t.PlanDetailsData.Freqrate;try{"string"===typeof t.descriptionData&&(t.ProrataDescription=JSON.parse(t.descriptionData))}catch(e){console.error("Invalid descriptionData JSON",e,t.descriptionData),t.ProrataDescription=[]}if(1==t.RateApplicableOnPlan){const e=(t.PlanDetailsData.plan_Existing_unit+t.PlanDetailsData.Plan_changed_unit)*t.PlanDetailsData.PlanRate,a=t.PlanDetailsData.plan_Existing_unit*t.PlanDetailsData.Freqrate,i=e-a;t.IncreasedAmount+=i}else{let e=0;t.servicesData.forEach((function(t){if(t.ServiceRate.length>1)"Support"===t.service_type_code?e+=0:e+=parseFloat(t.PriceImpact||0);else if("Support"===t.service_type_code)e+=0;else{const a=parseFloat(t.ServiceRate[0].Freqrate||0),i=parseFloat(t.ServiceRate[0].rate||0),s=parseFloat(t.Existing_unit||0),n=parseFloat(t.Changed_unit||0),l=(s+n)*i,o=s*a,r=l-o;e+=r}})),t.IncreasedAmount=e}},methods:{getTotalDiscount(){var t;return(null===(t=this.DiscountData)||void 0===t?void 0:t.reduce((t,e)=>t+Number(e.calculatedDiscount||0),0))||0},getTotalTax(){var t;return(null===(t=this.TaxData)||void 0===t?void 0:t.reduce((t,e)=>t+Number(e.CalculatedTax||0),0))||0},ViewProrataList(){var t=this;t.isShowProrataData=!0},Closedetails(){var t=this;t.isShowProrataData=!1},ClosePopUp(){this.$parent.isPlanSubscription=!1,this.$parent.isTemplate=!1,this.$parent.isInvoice=!1,this.parent.isPlanDetails=!0},async generateInvoice(){var t=this;t.isLoading=!0;const e=t.invoiceData,a=e.plans.some(t=>t.hasAnyChangedUnit);if(a||0!=t.changed_unit||""==t.PlanMappingId){const a={json:JSON.stringify(e),clientId:this.UserId,type:"Generate",billingCycle:t.selectedBilling,isForAddOrEdit:"yes",SelectedDate:t.SelectedDate};try{const e=await n["a"].GenrateInvoice(a);if(200==e.status){const a=e.data.result.data;if("Success"==e.data.status)if(!a||1!=a[0].status_id&&11!=a[0].status_id)if(!a||6!=a[0].status_id&&61!=a[0].status_id)a&&21==a[0].status_id||a&&22==a[0].status_id?(t.ShowAlert(a[0].status_message,"success",!1,this.$t("Alert")),t.isLoading=!1,t.$parent.backtoPlanList()):a&&12==a[0].status_id?(this.ShowAlert(this.$t("QuantityUpdatedSuccessfully"),"success",!0,this.$t("Alert")),t.isLoading=!1,t.$parent.backtoPlanList()):(this.ShowAlert(a[0].status_message,"failure",!0,this.$t("Alert")),t.isLoading=!1);else{const e="clientPlanMappingId="+a[0].client_plan_mapping_id,s=await n["a"].getSubscribePlanDetails(e),l=s.data.result.data;var i;if(l&&1==l[0].status_id)"isEditingFromPlanListing"!=this.flag&&(this.$parent.isAddInvoice=!1),this.$parent.isPlanSubscription=!1,this.$parent.isInvoice=!0,this.$parent.isTemplate=!0,this.$parent.templateDetails=l,t.isLoading=!1;else this.$parent.isPlanSubscription=!0,this.$parent.isInvoice=!1,this.$parent.isTemplate=!1,t.isLoading=!1,this.ShowAlert((null===l||void 0===l||null===(i=l[0])||void 0===i?void 0:i.status_message)||this.$t("SomethingWentWrong"),"failure",!0,this.$t("Alert"))}else{const e="billId="+a[0].bill_id,i=await n["a"].getInvoiceDetails(e),l=i.data.result.data;var s;if(200==i.status&&l&&1==l[0].status_id)"isEditingFromPlanListing"!=this.flag&&(this.$parent.isAddInvoice=!1),this.$parent.isPlanSubscription=!1,this.$parent.isInvoice=!0,this.$parent.isTemplate=!0,this.$parent.templateDetails=l,t.isLoading=!1,t.ShowAlert(a[0].status_message,"success",!1,this.$t("Alert"));else this.$parent.isPlanSubscription=!0,this.$parent.isInvoice=!1,this.$parent.isTemplate=!1,t.isLoading=!1,this.ShowAlert((null===l||void 0===l||null===(s=l[0])||void 0===s?void 0:s.status_message)||this.$t("SomethingWentWrong"),"failure",!0,this.$t("Alert"))}else this.ShowAlert(this.$t("SomethingWentWrong"),"failure",!0,this.$t("Alert")),t.isLoading=!1}}catch(l){console.error("Error fetching invoice template:",l)}}else this.ShowAlert(this.$t("NoChangedQuantity"),"warning",!0,this.$t("Alert")),t.isLoading=!1}}},jt=Ht,qt=(a("cec3"),Object(d["a"])(jt,Yt,Vt,!1,null,"290261da",null)),zt=qt.exports,Wt=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"my-popups"},[e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered ui-draggable"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header ui-draggable-handle"},[e("button",{staticClass:"close",attrs:{type:"button"},on:{click:function(e){return t.closepopup()}}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})]),e("h4",{staticClass:"modal-title",attrs:{name:"header"}},[t._v(" Rate Schedule Details ")])]),e("div",{staticClass:"modal-body"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"col-md-12 p-0 border float-left plan-rate-detail"},[e("div",{staticClass:"col-md-12 mt-3"},[e("div",{staticClass:"col-md-12 mb-2 p-2 bg-light border d-flex"},[e("div",{staticClass:"form-check form-switch col-md-6 mt-0 p-0"},[e("label",{staticClass:"-check-label mr-2",attrs:{for:"peakHoursSwitch"}},[t._v(t._s(t.$t("IsRateApplicable")))]),e("label",{staticClass:"switch"},[e("input",{staticClass:"form-check-input custom-control-input dynamic",attrs:{disabled:"",type:"checkbox"},domProps:{checked:t.ApplicableOnPlanRateDetails.isCheckedApplicableForPlan}}),e("span",{staticClass:"slider round",staticStyle:{cursor:"default"}},[e("span",{staticClass:"slider-yes"},[t._v(t._s(t.$t("Yes")))]),e("span",{staticClass:"slider-no"},[t._v(t._s(t.$t("No")))])])])])])]),t.ApplicableOnPlanRateDetails.isCheckedApplicableForPlan?e("div",[e("div",{staticClass:"col-md-12"},[e("label",{staticClass:"label mr-2 font-weight-bold"},[t._v("Plan rate Type: ")]),e("div",{staticClass:"custom-control custom-radio custom-control-inline"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.ApplicableOnPlanRateDetails.planRateType,expression:"ApplicableOnPlanRateDetails.planRateType"}],staticClass:"custom-control-input dynamic customcheckboxselectall",attrs:{id:"planRateFixed",disabled:"",type:"radio",name:"PlanRateType",value:"fixed"},domProps:{checked:t._q(t.ApplicableOnPlanRateDetails.planRateType,"fixed")},on:{change:[function(e){return t.$set(t.ApplicableOnPlanRateDetails,"planRateType","fixed")},t.onChangePlanRateType]}}),e("label",{staticClass:"custom-control-label pt-1",attrs:{for:"planRateFixed",type:"radio"}},[t._v("Fixed")])]),e("div",{staticClass:"custom-control custom-radio custom-control-inline"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.ApplicableOnPlanRateDetails.planRateType,expression:"ApplicableOnPlanRateDetails.planRateType"}],staticClass:"custom-control-input dynamic customcheckboxselectall",attrs:{id:"planRateAccordingSlap",disabled:"",type:"radio",name:"PlanRateType",value:"slab"},domProps:{checked:t._q(t.ApplicableOnPlanRateDetails.planRateType,"slab")},on:{change:[function(e){return t.$set(t.ApplicableOnPlanRateDetails,"planRateType","slab")},t.onChangePlanRateType]}}),e("label",{staticClass:"custom-control-label pt-1",attrs:{for:"planRateAccordingSlap",type:"radio"}},[t._v("Slab")])])]),e("div",{staticClass:"col-md-12 listing"},[e("div",{staticClass:"heading-border mb-4 mt-2"},[e("h5",{staticClass:"h5"},[e("span",[t._v(t._s(t.$t("Rates"))+":")])])]),e("div",{staticClass:"service-list-container d-flex flex-wrap"}),t._l(t.ApplicableOnPlanRateDetails.rateList,(function(a,i){return e("div",{key:i},[e("div",{staticClass:"row"},[i>0?e("div",{staticClass:"col-md-6 text-right pt-4"},[e("a",{staticClass:"text-danger mr-2",staticStyle:{"font-size":"25px !important"},attrs:{href:"javascript:;"},on:{click:function(e){return t.deleteSubscriptionPlanRate(a,i)}}},[e("i",{staticClass:"fa fa-trash"})])]):t._e()]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-lg-12"},[e("div",{staticClass:"card service-card col-lg-12 p-0"},[e("div",{staticClass:"service-header",class:"fixed"===t.ApplicableOnPlanRateDetails.planRateType?"service-fixed-rate":"service-usage"},[e("h5",{staticClass:"mb-0"},[t._v(" "+t._s(t.$t("PlanBasedRate")))]),e("span",{staticClass:"service-type-badge badge bg-light text-dark"},[t._v(" "+t._s(t.ApplicableOnPlanRateDetails.planRateType))])]),e("div",{staticClass:"card-body"},[e("div",{staticStyle:{"max-height":"240px","overflow-y":"auto"}},t._l(t.filteredGroupedRatesPlan(a.rateDetails),(function(a,s){return e("div",{key:s,staticClass:"rate-item",class:{"current-rate":a.isCurrent}},[e("div",{staticClass:"d-flex justify-content-between"},[a.billing_type?e("strong",[t._v(t._s(t.$t("PricingType"))+": ("+t._s("PERCENTAGE"===a.billing_type?"PER":a.billing_type)+")")]):t._e(),e("div",{staticClass:"float-right"},[a.isCurrent?e("span",{staticClass:"badge bg-success text-white font-weight-medium mr-4"},[t._v(t._s(t.$t("Current")))]):t._e(),e("a",{staticClass:"mx-4",attrs:{href:"javascript:;",title:"Edit Rate"},on:{click:function(e){return t.openEditPlanRate(i,a)}}},[e("em",{staticClass:"fa fa-pencil text-success"})]),e("a",{staticClass:"ms-2",attrs:{href:"javascript:;",title:"Delete Rate"},on:{click:function(e){return t.deletePlanRateDetail(i,s)}}},[e("em",{staticClass:"fa fa-trash text-danger"})])])]),e("small",{staticClass:"text-muted"},[a.effective_start_date?e("span",[t._v(t._s(t.formatDate(a.effective_start_date)))]):e("span",[t._v("(No start date)")]),a.effective_end_date?e("span",[t._v(" to "+t._s(t.formatDate(a.effective_end_date)))]):e("span",[t._v(" (No end date)")])]),"slab"===t.ApplicableOnPlanRateDetails.planRateType?e("div",{staticClass:"slab-rate mt-2"},t._l(a.slabs,(function(a,i){return e("div",{key:i,staticClass:"d-flex justify-content-between"},[e("span",[null!==a.from&&void 0!==a.from&&null!==a.to&&void 0!==a.to?[t._v(" "+t._s(a.from)+" to "+t._s(a.to)+" ")]:null===a.from||void 0===a.from||null!==a.to&&void 0!==a.to?[t._v(" 0+ ")]:[t._v(" "+t._s(a.from)+"+ ")]],2),e("strong",[t._v(" "+t._s(t.$n((null!==a.rate&&void 0!==a.rate?a.rate:0).toFixed(2),"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])])})),0):e("div",[e("strong",[t._v(" "+t._s(t.$n((a.slabs[0].rate||0).toFixed(2),"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])])])})),0),e("button",{staticClass:"btn btn-outline-primary btn-sm mt-2",on:{click:function(e){return t.toggleCollapsePlan(i)}}},[e("i",{staticClass:"fas fa-plus me-1"}),t._v(" "+t._s(t.$t("AddNewRate"))+" ")]),t.newRateFormsPlan[i]?e("div",{directives:[{name:"show",rawName:"v-show",value:t.collapseStatesPlan[i],expression:"collapseStatesPlan[index]"}],staticClass:"mt-3"},[e("div",{staticClass:"rate-form"},[e("div",{staticClass:"row"},["slab"===t.ApplicableOnPlanRateDetails.planRateType?e("div",{staticClass:"col-md-12 mb-2"},[e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v(t._s(t.$t("PricingType"))+":"),e("span",{staticClass:"text-danger"},[t._v("*")])]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.newRateFormsPlan[i].billingType,expression:"newRateFormsPlan[index].billingType"}],class:["form-control",{"is-invalid":t.planBillingTypeError(i)}],on:{blur:function(e){return t.validatePlanField(i,"billingType")},change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.newRateFormsPlan[i],"billingType",e.target.multiple?a:a[0])}}},[e("option",{attrs:{value:""}},[t._v(t._s(t.$t("SelectBillingType")))]),e("option",{attrs:{value:"SLAB"}},[t._v("Slab Rate(SLAB)")]),e("option",{attrs:{value:"FLT"}},[t._v("Flat Rate(FLT)")]),e("option",{attrs:{value:"PRE"}},[t._v("Preceding(PRE)")]),e("option",{attrs:{value:"TIER"}},[t._v("Tier-Based(TIER)")])]),t.planBillingTypeError(i)?e("span",{staticClass:"text-danger small"},[t._v(" "+t._s(t.$t("PricingTypeRequired"))+" ")]):t._e()])]):t._e(),e("div",{staticClass:"col-md-6 mb-2"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("StartDate"))+":"),e("span",{staticClass:"text-danger"},[t._v("*")])]),e("div",{staticClass:"input-group"},[e("v-date-picker",{staticClass:"timedate input-group",attrs:{mode:"date"},on:{input:function(e){return t.clearPlanEndDate(i)}},scopedSlots:t._u([{key:"default",fn:function({inputValue:a,inputEvents:s,togglePopover:n}){return[e("input",t._g({class:["form-control",{"is-invalid":t.planStartDateError(i)}],attrs:{placeholder:"MM/DD/YYYY"},domProps:{value:a},on:{click:function(t){return n()},blur:function(e){return t.validatePlanField(i,"startDate")}}},s)),e("div",{staticClass:"input-group-append",on:{click:function(t){return n()}}},[e("span",{staticClass:"input-group-text"},[e("em",{staticClass:"fa fa-calendar"})])])]}}],null,!0),model:{value:t.newRateFormsPlan[i].effective_start_date,callback:function(e){t.$set(t.newRateFormsPlan[i],"effective_start_date",e)},expression:"newRateFormsPlan[index].effective_start_date"}})],1),t.planStartDateError(i)?e("span",{staticClass:"text-danger small"},[t._v(" "+t._s(t.$t("StartDateRequired"))+" ")]):t._e()])]),e("div",{staticClass:"col-md-6 mb-2"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("EndDate")))]),e("div",{staticClass:"input-group"},[e("v-date-picker",{staticClass:"timedate input-group",attrs:{mode:"date","min-date":t.newRateFormsPlan[i].effective_start_date?new Date(t.newRateFormsPlan[i].effective_start_date):null},scopedSlots:t._u([{key:"default",fn:function({inputValue:a,inputEvents:i,togglePopover:s}){return[e("input",t._g({staticClass:"form-control",attrs:{placeholder:"MM/DD/YYYY"},domProps:{value:a},on:{click:function(t){return s()}}},i)),e("div",{staticClass:"input-group-append",on:{click:function(t){return s()}}},[e("span",{staticClass:"input-group-text"},[e("em",{staticClass:"fa fa-calendar"})])])]}}],null,!0),model:{value:t.newRateFormsPlan[i].effective_end_date,callback:function(e){t.$set(t.newRateFormsPlan[i],"effective_end_date",e)},expression:"newRateFormsPlan[index].effective_end_date"}})],1)])])]),e("div",{staticClass:"listing"},[e("div",{staticClass:"table-responsive"},[e("table",{staticClass:"table table-bordered dt-responsive nowrap mt-0"},[e("thead",{staticClass:"thead-bg border"},[e("tr",["slab"===t.ApplicableOnPlanRateDetails.planRateType?e("th",{staticStyle:{"min-width":"95px"}},[t._v(t._s(t.$t("UnitFrom")))]):t._e(),"slab"===t.ApplicableOnPlanRateDetails.planRateType?e("th",{staticStyle:{"min-width":"95px"}},[t._v(t._s(t.$t("UnitTo")))]):t._e(),e("th",{staticStyle:{"min-width":"100px"}},[t._v(t._s(t.$t("Amount")))]),"slab"===t.ApplicableOnPlanRateDetails.planRateType?e("th",{staticClass:"text-center",staticStyle:{"min-width":"100px"}},[t._v(t._s(t.$t("Action")))]):t._e()])]),e("tbody",t._l(t.newRateFormsPlan[i].rates,(function(a,s){return e("tr",{key:s},["slab"===t.ApplicableOnPlanRateDetails.planRateType?e("td",[e("input",{directives:[{name:"model",rawName:"v-model.number",value:a.from,expression:"rate.from",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"0"},domProps:{value:a.from},on:{input:function(e){e.target.composing||t.$set(a,"from",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]):t._e(),"slab"===t.ApplicableOnPlanRateDetails.planRateType?e("td",[e("input",{staticClass:"form-control",class:{"is-invalid":t.planUnitToError(i,s)},attrs:{placeholder:"∞",type:"number"},domProps:{value:t.toDisplay(a.to)},on:{input:function(e){a.to=t.fromDisplay(e.target.value)},blur:function(e){return t.validatePlanUnitRange(i,s)}}})]):t._e(),e("td",[e("input",{directives:[{name:"model",rawName:"v-model.number",value:a.rate,expression:"rate.rate",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",step:"0.01",min:"0"},domProps:{value:a.rate},on:{input:function(e){e.target.composing||t.$set(a,"rate",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]),"slab"===t.ApplicableOnPlanRateDetails.planRateType?e("td",{staticClass:"text-center"},[e("a",{staticClass:"mr-2",attrs:{href:"javascript:;"},on:{click:function(e){0===s?t.addRowPlan(i):t.removeRowPlan(i,s)}}},[e("em",{class:0===s?"round-icon-small fa fa-plus bg-success float-none":"round-icon-small fa fa-trash bg-danger float-none"})])]):t._e()])})),0)])])]),e("div",{staticClass:"text-right mt-2"},[t.newRateFormsPlan[i].isEdit?t._e():e("button",{staticClass:"btn btn-success btn-sm mt-2 mr-2",attrs:{disabled:!t.isPlanFormValid(i)},on:{click:function(e){return t.savePlanRate(i)}}},[t._v(t._s(t.$t("SaveRate")))]),t.newRateFormsPlan[i].isEdit?e("button",{staticClass:"btn btn-success btn-sm mt-2 mr-2",attrs:{disabled:!t.isPlanFormValid(i)},on:{click:function(e){return t.savePlanRate(i)}}},[t._v(t._s(t.$t("UpdateRate")))]):t._e(),e("button",{staticClass:"btn btn-danger btn-sm ms-1 mt-2",on:{click:function(e){return t.toggleCollapsePlan(i)}}},[t._v(t._s(t.$t("Cancel")))])])])]):t._e()])])])])])})),e("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 float-left mb-2 mt-3 p-0"},[e("div",{staticClass:"row flex-row-reverse"},[e("div",{staticClass:"col-lg-6 text-right"},[e("a",{staticClass:"btn btn-success formbtn widthhalf",attrs:{href:"javascript:;",title:"","data-toggle-tooltip":"tooltip","data-original-title":"Save"},on:{click:t.SavePlanBased}},[e("i",{staticClass:"fa fa-save pr-2"}),t._v(" "+t._s(t.$t("Save")))])])])])],2)]):t._e(),t.ApplicableOnPlanRateDetails.isCheckedApplicableForPlan?t._e():e("div",[t._l(t.PlanRateListing,(function(a,i){return e("div",{key:i},t._l(a.serviceTypes,(function(a,i){return e("div",{key:i,staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 float-left mb-0"},[e("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 float-left p-0"},[e("div",{staticClass:"heading-border"},[e("h5",{staticClass:"h5"},[e("a",{class:{"card-link collapsed":i>1,"card-link":i<=1},staticStyle:{color:"#000"},attrs:{"data-toggle":"collapse",href:"#collapseOneThread"+i}},[e("div",{staticClass:"conversation-date heading-border"},[e("span",[t._v(t._s(a.serviceTypeName))])])])])])]),e("div",{staticClass:"service-list-container d-flex flex-wrap border"},t._l(a.serviceList,(function(a,i){return e("div",{key:a.planServiceId,staticClass:"col-md-6 col-lg-4 mb-4 mt-3 ratesbasecontrol"},[e("div",{staticClass:"card service-card"},[e("div",{staticClass:"service-header",class:t.getServiceTypeClass(a.service_type_name)},[e("h5",{staticClass:"mb-0"},[t._v(t._s(a.serviceName))]),e("span",{staticClass:"service-type-badge badge bg-light text-dark"},[t._v(t._s(a.service_type_name))])]),e("div",{staticClass:"card-body"},[e("p",{staticClass:"text-muted"},[t._v(t._s(a.description||""))]),"Usage Based"!==a.service_type_name?e("div",{staticStyle:{"max-height":"240px","overflow-y":"auto"}},t._l(t.filteredGroupedRates(a.rateDetails),(function(i,s){return e("div",{key:s,staticClass:"rate-item",class:{"current-rate":i.isCurrent}},[e("div",{staticClass:"d-flex flex-column"},[e("div",[i.billing_type?e("strong",[t._v(t._s(t.$t("PricingType"))+": ("+t._s("PERCENTAGE"===i.billing_type?"PER":i.billing_type)+")")]):t._e(),e("div",{staticClass:"float-right"},[i.isCurrent?e("span",{staticClass:"badge bg-success text-white font-weight-medium text-right mr-1"},[t._v(t._s(t.$t("Current")))]):t._e(),e("a",{staticClass:"mx-2",attrs:{href:"javascript:;",title:"Edit Rate"},on:{click:function(e){return t.openEditPlan(a.planServiceId,i)}}},[e("em",{staticClass:"fa fa-pencil text-success"})]),e("a",{staticClass:"ms-2",attrs:{href:"javascript:;",title:"Delete Rate"},on:{click:function(e){return t.deleteRule(a.planServiceId,i)}}},[e("em",{staticClass:"fa fa-trash text-danger"})])])]),e("div",[e("strong",["Support"==a.service_type_name&&"PERCENTAGE"===i.billing_type?[t._v(" "+t._s((i.slabs[0].rate||0).toFixed(2))+"% ")]:[t._v(" "+t._s(t.$n((i.slabs[0].rate||0).toFixed(2),"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")]],2)])]),e("small",{staticClass:"text-muted"},[i.effective_start_date?e("span",[t._v(t._s(t.formatDate(i.effective_start_date)))]):e("span",[t._v("Effective: (No start date)")]),i.effective_end_date?e("span",[t._v(" to "+t._s(t.formatDate(i.effective_end_date)))]):e("span",[t._v(" (No end date)")])])])})),0):e("div",{staticStyle:{"max-height":"240px","overflow-y":"auto"}},t._l(t.filteredGroupedRates(a.rateDetails),(function(i,s){return e("div",{key:s,staticClass:"rate-item",class:{"current-rate":i.isCurrent}},[e("div",{staticClass:"d-flex justify-content-between"},[i.billing_type?e("strong",[t._v(t._s(t.$t("PricingType"))+": ("+t._s("PERCENTAGE"===i.billing_type?"%":i.billing_type)+")")]):t._e(),e("div",{staticClass:"float-right"},[i.isCurrent?e("span",{staticClass:"badge bg-success text-white font-weight-medium mr-2"},[t._v(t._s(t.$t("Current")))]):t._e(),e("a",{staticClass:"mx-2",attrs:{href:"javascript:;",title:"Edit Rate"},on:{click:function(e){return t.openEditPlan(a.planServiceId,i)}}},[e("em",{staticClass:"fa fa-pencil text-success"})]),e("a",{staticClass:"ms-2",attrs:{href:"javascript:;",title:"Delete Rate"},on:{click:function(e){return t.deleteRule(a.planServiceId,i)}}},[e("em",{staticClass:"fa fa-trash text-danger"})])])]),e("small",{staticClass:"text-muted"},[i.effective_start_date?e("span",[t._v(t._s(t.formatDate(i.effective_start_date)))]):e("span",[t._v("(No start date)")]),i.effective_end_date?e("span",[t._v(" to "+t._s(t.formatDate(i.effective_end_date)))]):e("span",[t._v(" (No end date)")])]),e("div",{staticClass:"slab-rate mt-2"},t._l(i.slabs,(function(s,n){return e("div",{key:n,staticClass:"d-flex justify-content-between"},[e("span",[null!==s.from&&void 0!==s.from&&null!==s.to&&void 0!==s.to?[t._v(" "+t._s(s.from)+" to "+t._s(s.to)+" ")]:null===s.from||void 0===s.from||null!==s.to&&void 0!==s.to?[t._v(" 0+ ")]:[t._v(" "+t._s(s.from)+"+ ")]],2),e("strong",["Support"==a.service_type_name&&"PERCENTAGE"===i.billing_type?[t._v(" "+t._s((null!==s.rate&&void 0!==s.rate?s.rate:0).toFixed(2))+"% ")]:[t._v(" "+t._s(t.$n((null!==s.rate&&void 0!==s.rate?s.rate:0).toFixed(2),"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")]],2)])})),0)])})),0),e("button",{staticClass:"btn btn-outline-primary btn-sm mt-2",on:{click:function(e){return t.toggleCollapse(a.planServiceId)}}},[e("i",{staticClass:"fas fa-plus me-1"}),t._v(" "+t._s(t.$t("AddNewRate"))+" ")]),t.newRateForms[a.planServiceId]?e("div",{directives:[{name:"show",rawName:"v-show",value:t.collapseStates[a.planServiceId],expression:"collapseStates[service.planServiceId]"}],staticClass:"mt-3"},[e("div",{staticClass:"rate-form"},["Support"==a.service_type_name?e("div",{staticClass:"mb-2"},[e("label",{staticClass:"form-label"},[t._v(t._s(t.$t("PricingType"))+":"),e("span",{staticClass:"text-danger"},[t._v("*")])]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.newRateForms[a.planServiceId].billingType,expression:"newRateForms[service.planServiceId].billingType"}],staticClass:"form-control",class:["form-control",{"is-invalid":t.billingTypeError(a.planServiceId)}],on:{change:[function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.newRateForms[a.planServiceId],"billingType",e.target.multiple?i:i[0])},function(e){return t.onBillingTypeChange(a.planServiceId)}],blur:function(e){return t.validateField(a.planServiceId,"billingType")}}},[e("option",{attrs:{value:""}},[t._v("Select Billing Type")]),e("option",{attrs:{value:"FLAT"}},[t._v("Flat Rate")]),e("option",{attrs:{value:"PERCENTAGE"}},[t._v("Percentage Rate")])]),t.billingTypeError(a.planServiceId)?e("span",{staticClass:"text-danger small"},[t._v(" "+t._s(t.$t("PricingTypeRequired"))+" ")]):t._e()]):t._e(),"Usage Based"==a.service_type_name?e("div",{staticClass:"mb-2"},[e("label",{staticClass:"form-label"},[t._v(t._s(t.$t("PricingType"))+":"),e("span",{staticClass:"text-danger"},[t._v("*")])]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.newRateForms[a.planServiceId].billingType,expression:"newRateForms[service.planServiceId].billingType"}],staticClass:"form-control",class:["form-control",{"is-invalid":t.billingTypeError(a.planServiceId)}],attrs:{id:"billingType"},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.newRateForms[a.planServiceId],"billingType",e.target.multiple?i:i[0])}}},[e("option",{attrs:{value:""}},[t._v("Select Billing Type")]),e("option",{attrs:{value:"SLAB"}},[t._v("Slab Rate(SLAB)")]),e("option",{attrs:{value:"FLT"}},[t._v("Flat Rate(FLT)")]),e("option",{attrs:{value:"PRE"}},[t._v("Preceding(PRE)")]),e("option",{attrs:{value:"TIER"}},[t._v("Tier-Based(TIER)")])]),t.billingTypeError(a.planServiceId)?e("span",{staticClass:"text-danger small"},[t._v(" "+t._s(t.$t("PricingTypeRequired"))+" ")]):t._e()]):t._e(),e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-12"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("StartDate"))+":"),e("span",{staticClass:"text-danger"},[t._v("*")])]),e("div",{staticClass:"input-group"},[e("v-date-picker",{staticClass:"timedate input-group",attrs:{mode:"date"},on:{input:function(e){return t.clearServiceEndDate(a.planServiceId)}},scopedSlots:t._u([{key:"default",fn:function({inputValue:i,inputEvents:s,togglePopover:n}){return[e("input",t._g({class:["form-control",{"is-invalid":t.startDateError(a.planServiceId)}],attrs:{placeholder:"MM/DD/YYYY"},domProps:{value:i},on:{click:function(t){return n()},blur:function(e){return t.validateField(a.planServiceId,"startDate")}}},s)),e("div",{staticClass:"input-group-append",on:{click:function(t){return n()}}},[e("span",{staticClass:"input-group-text"},[e("em",{staticClass:"fa fa-calendar"})])])]}}],null,!0),model:{value:t.newRateForms[a.planServiceId].effective_start_date,callback:function(e){t.$set(t.newRateForms[a.planServiceId],"effective_start_date",e)},expression:"newRateForms[service.planServiceId].effective_start_date"}})],1),t.startDateError(a.planServiceId)?e("span",{staticClass:"text-danger small"},[t._v(" "+t._s(t.$t("StartDateRequired"))+" ")]):t._e()])]),e("div",{staticClass:"col-md-12"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("EndDate")))]),e("div",{staticClass:"input-group"},[e("v-date-picker",{staticClass:"timedate input-group",attrs:{mode:"date","min-date":t.newRateForms[a.planServiceId].effective_start_date?new Date(t.newRateForms[a.planServiceId].effective_start_date):null},scopedSlots:t._u([{key:"default",fn:function({inputValue:a,inputEvents:i,togglePopover:s}){return[e("input",t._g({staticClass:"form-control",attrs:{placeholder:"MM/DD/YYYY"},domProps:{value:a},on:{click:function(t){return s()}}},i)),e("div",{staticClass:"input-group-append",on:{click:function(t){return s()}}},[e("span",{staticClass:"input-group-text"},[e("em",{staticClass:"fa fa-calendar"})])])]}}],null,!0),model:{value:t.newRateForms[a.planServiceId].effective_end_date,callback:function(e){t.$set(t.newRateForms[a.planServiceId],"effective_end_date",e)},expression:"newRateForms[service.planServiceId].effective_end_date"}})],1)])])]),e("div",{staticClass:"listing"},[e("div",{staticClass:"table-responsive"},[e("table",{staticClass:"table table-bordered dt-responsive nowrap mt-0"},[e("thead",{staticClass:"thead-bg border"},[e("tr",["Usage Based"==a.service_type_name?e("th",{staticStyle:{"min-width":"95px"}},[t._v(t._s(t.$t("UnitFrom")))]):t._e(),"Usage Based"==a.service_type_name?e("th",{staticStyle:{"min-width":"95px"}},[t._v(t._s(t.$t("UnitTo")))]):t._e(),e("th",{staticStyle:{"min-width":"100px"}},["Support"==a.service_type_name&&"PERCENTAGE"===t.newRateForms[a.planServiceId].billingType?[t._v(" "+t._s(t.$t("Rate"))+" ")]:[t._v(" "+t._s(t.$t("Amount"))+" ")]],2),"Usage Based"==a.service_type_name?e("th",{staticClass:"text-center",staticStyle:{"min-width":"100px"}},[t._v(t._s(t.$t("Action")))]):t._e()])]),e("tbody",t._l(t.newRateForms[a.planServiceId].rates,(function(i,s){return e("tr",{key:s},["Usage Based"==a.service_type_name?e("td",[e("input",{directives:[{name:"model",rawName:"v-model.number",value:i.from,expression:"rate.from",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"0"},domProps:{value:i.from},on:{input:function(e){e.target.composing||t.$set(i,"from",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]):t._e(),"Usage Based"==a.service_type_name?e("td",[e("input",{staticClass:"form-control",class:{"is-invalid":t.serviceUnitToError(a.planServiceId,s)},attrs:{placeholder:"∞",type:"number"},domProps:{value:t.toDisplay(i.to)},on:{input:function(e){i.to=t.fromDisplay(e.target.value)},blur:function(e){return t.validateServiceUnitRange(a.planServiceId,s)}}})]):t._e(),e("td",[e("input",{directives:[{name:"model",rawName:"v-model.number",value:i.rate,expression:"rate.rate",modifiers:{number:!0}}],class:["form-control",{"is-invalid":t.rateError(a.planServiceId,s)}],attrs:{type:"number",step:"1",min:"0",max:"PERCENTAGE"===t.newRateForms[a.planServiceId].billingType?100:null},domProps:{value:i.rate},on:{input:[function(e){e.target.composing||t.$set(i,"rate",t._n(e.target.value))},function(e){return t.enforceRateLimit(a.planServiceId,s)}],blur:function(e){return t.$forceUpdate()}}}),t.rateError(a.planServiceId,s)?e("span",{staticClass:"text-danger small"},[t._v(" "+t._s(t.$t("RateTypeValidation"))+" ")]):t._e()]),"Usage Based"==a.service_type_name?e("td",{staticClass:"text-center"},[e("a",{staticClass:"mr-2",attrs:{href:"javascript:;"},on:{click:function(e){0===s?t.addRowData(a.planServiceId,i):t.removeRowData(a.planServiceId,s)}}},[e("em",{class:0===s?"round-icon-small fa fa-plus bg-success float-none":"round-icon-small fa fa-trash bg-danger float-none"})])]):t._e()])})),0)])])]),e("div",{staticClass:"text-right mt-2"},[t.IsSave?e("button",{staticClass:"btn btn-success btn-sm mt-2 mr-2",attrs:{disabled:!t.isFormValid(a.planServiceId)},on:{click:function(e){return t.saveRate(a.planServiceId)}}},[t._v(t._s(t.$t("SaveRate")))]):t._e(),t.IsUpdate?e("button",{staticClass:"btn btn-success btn-sm mt-2 mr-2",attrs:{disabled:!t.isFormValid(a.planServiceId)},on:{click:function(e){return t.saveRate(a.planServiceId)}}},[t._v(t._s(t.$t("UpdateRate")))]):t._e(),e("button",{staticClass:"btn btn-danger btn-sm ms-1 mt-2",on:{click:function(e){return t.toggleCollapse(a.planServiceId)}}},[t._v(t._s(t.$t("Cancel")))])])])]):t._e()])])])})),0)])})),0)})),e("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 float-left mb-2 mt-2"},[e("div",{staticClass:"row flex-row-reverse"},[e("div",{staticClass:"col-lg-6 text-right"},[e("a",{staticClass:"btn btn-success formbtn widthhalf",attrs:{href:"javascript:;",title:"","data-toggle-tooltip":"tooltip","data-original-title":"Save"},on:{click:t.SaveServiceBased}},[e("i",{staticClass:"fa fa-save pr-2"}),t._v("Save")])])])])],2)])],1)])])])])])},Jt=[],Kt={props:{Id:{type:Number,required:!0},PlanId:{type:Number,required:!0},ClientId:{type:Number,required:!0}},computed:{reactiveGroupedRates(){return this.PlanRateListing.map(t=>(t.serviceTypes.forEach(t=>{t.serviceList.forEach(t=>{t.grouped=this.groupedRates(t.rateDetails)})}),t))}},data(){return{billingInterval:"monthly",billingIntervalText:"Monthly",billingIntervalValue:1,PlanRateListing:[],editPlanRateListing:[],isAddPeakHours:!1,currentEditIndex:null,SortBy:"",SortExp:"",PageSize:"100000",isChecked:!1,rateScheduleName:"",refCode:"",refCodeRetro:"",refCodeCharge:"",PageNumber:"1",isLoading:!1,serviceTypes:[],serviceList:[],rateArray:[],planRateId:0,previousJsonPlanListing:null,isCheckedMinimiumCharge:!1,ApplicableOnPlanRateDetails:{isCheckedApplicableForPlan:!1,planRateType:"fixed",rateList:[{rateScheduleName:"Updated Plan",currencyId:"",rateDetails:[{rateLimitId:null,limitType:null,limitFrom:null,limitTo:null,customerRateType:null,startDate:null,effective_start_date:null,endDate:null,effective_end_date:null,billing_type:"FLAT",rates:[{from:0,to:1/0,rate:"0",invalidFrom:!1}],isCurrent:!0}]}]},editApplicableOnPlanRateDetails:{},MonthApplicable:[],enableLimitData:[],serviceNameList:"",collapseStates:{},collapseStatesPlan:{},newRateForms:{},newRateFormsPlan:{},CurrencyCode:"PKR",IsSave:!0,IsUpdate:!1,CurrentDate:new Date}},mounted(){this.PlanRateListing.forEach(t=>{t.serviceTypes.forEach(t=>{t.serviceList.forEach(t=>{var e;(this.$set(this.collapseStates,t.planServiceId,!1),this.newRateForms[t.planServiceId])||this.$set(this.newRateForms,t.planServiceId,{billing_type:t.billing_type,effective_start_date:null,effective_end_date:null,rates:(null===(e=t.rateDetails[0])||void 0===e?void 0:e.rates.map(t=>({...t})))||[{from:0,to:null,rate:0}]})})})})},created:async function(){var t=this;await t.FetchRecords(),t.PlanRateListing[0].serviceTypes.forEach(t=>{"Support"===t.serviceTypeName&&"FLT"===t.serviceList[0].billingType&&(t.serviceList[0].billingType="PERCENTAGE")}),t.CurrencyCode=t.GetUserInfo.Currency.replace(/[()]/g,"")},methods:{clearPlanEndDate(t){this.newRateFormsPlan[t]&&this.$set(this.newRateFormsPlan[t],"effective_end_date",null)},clearServiceEndDate(t){this.newRateForms[t]&&this.$set(this.newRateForms[t],"effective_end_date",null)},addNewSlabForSubscriptionPlanRate:function(t){const e=t.rateDetails[0].rates[t.rateDetails[0].rates.length-1];var a="";e.to===1/0?a=e.from:e.to>1?a=e.to+1:e.to>=0&&e.to<1&&(a=e.to+.01),e.to===1/0&&(e.to=0);const i={from:a,to:1/0,rate:0,invalidFrom:!1};t.rateDetails[0].rates.push(i)},deleteSubscriptionPlanRate:function(t,e){t.rateDetails[0].rates.splice(e,1)},deleteRateDetailsWithLimit:function(t,e){t.rateDetails.length>1&&t.rateDetails.splice(e,1)},toDisplay(t){return t===1/0||null===t?"∞":t},fromDisplay(t){var e="";return e=""===t?"":"∞"===t?1/0:parseFloat(t),e},FetchRecords:async function(t){var e=this;e.PlanRateListing=[],e.serviceTypes=[],e.serviceList=[],e.isLoading=!0;var a=e.Id>0?0:e.ClientId,i=`id=${e.Id}&sortBy=${e.SortBy}&sortExp=${e.SortExp}&pagesize=${e.PageSize}&pagenumber=${e.PageNumber}&PlanId=${e.PlanId}&ClientId=${a}`;await n["a"].GetRateSchedulePlanServices(i).then((function(t){if(""!=t.data&&null!=t.data){let i=t.data.result;if("1"==i.is_rate_applicable_on_plan){e.ApplicableOnPlanRateDetails.isCheckedApplicableForPlan=!0,e.ApplicableOnPlanRateDetails.planRateType=i.rate_type,e.rateId=i.subscriptionBillingData.length>0?i.subscriptionBillingData[0].plan_rate_id:null,e.ApplicableOnPlanRateDetails.rateList=[];let t=[];i.subscriptionBillingData.forEach((function(e){let a={rateScheduleName:e.rate_schedule_name,currencyId:e.currency_id,rateDetails:[{rates:[]}]},s=t.find(t=>t.currencyId==e.currency_id);if(!s){let s=i.subscriptionBillingData.filter(t=>t.currency_id==e.currency_id&&null!=t.effective_start_date&&""!==t.effective_start_date);const n="fixed"===i.rate_type;if(s.length>0){const t={};s.forEach(e=>{const a=e.effective_start_date;t[a]||(t[a]={rates:[],endDate:e.effective_end_date}),t[a].rates.push({from:e.from,to:e.to,rate:e.rate,invalidFrom:!1})});const e=Object.keys(t).map(e=>({rateLimitId:null,limitType:null,limitFrom:null,limitTo:null,customerRateType:null,startDate:null,effective_start_date:e,endDate:t[e].endDate,effective_end_date:t[e].endDate,billing_type:n?"FLAT":"FLT",rates:t[e].rates,isCurrent:!1}));e.sort((t,e)=>new Date(e.effective_start_date)-new Date(t.effective_start_date)),e.length>0&&(e[0].isCurrent=!0),a.rateDetails=e}else{const t=n?"FLAT":"";a.rateDetails=[{rateLimitId:null,limitType:null,limitFrom:null,limitTo:null,customerRateType:null,startDate:null,effective_start_date:null,endDate:null,effective_end_date:null,billing_type:t,rates:[{from:0,to:n?1/0:null,rate:0,invalidFrom:!1}],isCurrent:!0}]}t.push(a)}})),e.ApplicableOnPlanRateDetails.rateList=t,e.previousJsonApplicableOnPlanRateDetails=JSON.stringify(e.ApplicableOnPlanRateDetails.rateList)}if(i.data&&i.data.length>0){var a=i.data;e.planRateId=a[0].plan_rate_id;let t=i.RETROACTIVE_DATA&&i.RETROACTIVE_DATA.length>0?i.RETROACTIVE_DATA[0][0]:null;t&&(e.retroactiveData=t,e.isRetroActive=!0);let s=i.ENABLE_MINIMUM_CHARGE_DATA&&i.ENABLE_MINIMUM_CHARGE_DATA.length>0?i.ENABLE_MINIMUM_CHARGE_DATA[0]:null;s&&(e.MonthApplicable=s.type_value.split(","),e.serviceNameList=s.map(t=>t.service_names).join(", "),e.enableLimitData=s,e.isCheckedMinimiumCharge=!0),e.serviceTypes=e.serviceTypes||[],e.serviceList=e.serviceList||[];let n=new Map;a.forEach((function(t){const e=t.service_id;n.has(e)||n.set(e,{planRateId:t.plan_rate_id,planServiceId:t.plan_service_id,isPeakHoursEnabled:null!=t.peak_rates&&t.peak_rates.length>0,serviceInterval:t.billing_interval||"monthly",billingIntervalValue:"1",billingType:t.billing_type,billableUnit:t.billing_unit_id||"",serviceId:t.service_id,serviceName:t.service_name,service_type_name:t.service_type_name,peakRates:t.peak_rates||[],rateDetails:[]});let a=n.get(e);const i=t.effective_start_date||"",s=t.billing_type||"none";if(null!==i&&""!==i){let e=a.rateDetails.find(t=>(t.effective_start_date||"no_date")===i&&(t.billing_type||"none")===s);e||(e={rateLimitId:t.rate_limit_id,limitType:t.limit_value_type,limitFrom:t.limit_from,limitTo:t.limit_to,customerRateType:t.customer_rate_type,startDate:t.start_date,effective_start_date:t.effective_start_date,endDate:t.end_date,effective_end_date:t.effective_end_date,billing_type:t.billing_type,rates:[],isCurrent:!1},a.rateDetails.push(e)),e.rates.push({from:null!=t.from?t.from:0,to:null!=t.to?t.to:null,rate:null!=t.rate?t.rate:0})}})),n.forEach(t=>{t.rateDetails.forEach(t=>{t.isCurrent=!1}),t.rateDetails.sort((t,e)=>{const a=t.effective_start_date?new Date(t.effective_start_date):new Date(0),i=e.effective_start_date?new Date(e.effective_start_date):new Date(0);return i-a}),t.rateDetails.length>0&&(t.rateDetails[0].isCurrent=!0)}),e.PlanRateListing=[{currencyId:a.length>0?a[0].currency_id:vm.currId,rateScheduleName:a.length>0&&a[0].rate_schedule_name||e.PlanName,serviceTypes:[{serviceTypeName:"Services",serviceList:Array.from(n.values())}]}],e.previousJsonPlanListing=JSON.stringify(e.PlanRateListing),e.isLoading=!1}else e.PlanRateListing=[],e.isLoading=!1}else e.PlanRateListing=[],e.isLoading=!1}))},addRow(t,e){var a=this;a.IsUpdate=!1,a.IsSave=!0;const i=t.rates[t.rates.length-1];var s="";i.to===1/0?s=i.from:i.to>1?s=i.to+1:i.to>0&&i.to<1&&(s=i.to+.01),i.to===1/0&&(i.to=0);const n={from:s,to:1/0,rate:0};t.rates.push(n)},onChangePlanRateType:function(){const t="fixed"===this.ApplicableOnPlanRateDetails.planRateType,e=t?1/0:null;this.ApplicableOnPlanRateDetails.rateList=[{rateScheduleName:"",currencyId:this.currId,rateDetails:[{rateLimitId:null,limitType:null,limitFrom:null,limitTo:null,customerRateType:null,startDate:null,effective_start_date:null,endDate:null,effective_end_date:null,billing_type:t?"FLAT":"",rates:[{from:0,to:e,rate:0,invalidFrom:!1}],isCurrent:!0}]}]},removeRow(t,e){t.rates.length>1&&t.rates.splice(e,1)},closepopup(){this.$parent.isServices=!1},getJSONData(){var t=this;const e={PlanRateListing:t.PlanRateListing.map(e=>({currencyId:107,planId:t.PlanId,clientId:t.ClientId,rateScheduleName:e.rateScheduleName,clientPlanMappingId:0==t.Id?"":t.Id,serviceTypes:e.serviceTypes.map(t=>({serviceTypeName:t.serviceTypeName,serviceList:t.serviceList.map(t=>({...t}))}))}))};return JSON.stringify(e)},async SaveServiceBased(){var t=this;const e=t.getJSONData(),a=JSON.stringify(e),i={objData:a};await n["a"].SaveRateSchedulePlanServices(i).then((function(e){1==e.data.Result?(t.ShowAlert("Rates updated successfully","success",!0,t.$t("Alert")),t.$parent.isServices=!1,t.$emit("refresh-plans")):t.ShowAlert(t.$t("UnknownErrorOccur"),"failure",!0,t.$t("Alert"))}))},async SavePlanBased(){var t=this,e={planId:t.PlanId,ClientId:t.ClientId,clientPlanMappingId:t.Id,isCheckedApplicableForPlan:t.ApplicableOnPlanRateDetails.isCheckedApplicableForPlan,planRateType:t.ApplicableOnPlanRateDetails.planRateType,rateList:JSON.stringify(t.ApplicableOnPlanRateDetails.rateList)};await n["a"].SaveRateScheduleOnBehalfOfPlan(e).then((function(e){1==e.data.result?(t.ShowAlert("Rates updated successfully","success",!0,t.$t("Alert")),t.$parent.isServices=!1,t.$emit("refresh-plans")):t.ShowAlert(t.$t("UnknownErrorOccur"),"failure",!0,t.$t("Alert"))}))},getServiceTypeClass(t){const e={"one time":"service-one-time",recurring:"service-recurring","usage based":"service-usage",activation:"service-activation",support:"service-support","Fixed Rate":"service-fixed-rate"};return e[t.toLowerCase()]||"service-fixed-rate"},formatDate(t){if(!t)return"";const e=new Date(t);return e.toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})},groupedRates(t){if(!t)return[];const e=new Date;e.setHours(0,0,0,0);let a=t.filter(t=>null!=t.effective_start_date&&""!==t.effective_start_date).map(t=>t.rates?{effective_start_date:t.effective_start_date,effective_end_date:t.effective_end_date,billing_type:t.billing_type,isCurrent:t.isCurrent,slabs:t.rates,originalDetail:t}:t.slabs?{effective_start_date:t.effective_start_date,effective_end_date:t.effective_end_date,billing_type:t.billing_type,isCurrent:t.isCurrent,slabs:t.slabs,originalDetail:t}:{effective_start_date:null,effective_end_date:null,billing_type:null,isCurrent:!1,slabs:[],originalDetail:t});return a.forEach(t=>{const a=t.effective_start_date?new Date(t.effective_start_date):null;a&&a.setHours(0,0,0,0);const i=t.effective_end_date?new Date(t.effective_end_date):null;i&&i.setHours(0,0,0,0);let s=!1;a&&!i?s=e>=a:!a&&i?s=e<=i:a&&i?s=e>=a&&e<=i:a||i||(s=!0),t.isCurrent=s}),a.sort((t,e)=>{if(t.isCurrent&&!e.isCurrent)return-1;if(!t.isCurrent&&e.isCurrent)return 1;const a=t.effective_start_date?new Date(t.effective_start_date):new Date(0),i=e.effective_start_date?new Date(e.effective_start_date):new Date(0);return i-a}),a},filteredGroupedRates(t){return t?this.groupedRates(t).filter(t=>null!==t.effective_start_date):[]},filteredGroupedRatesPlan(t){return t?this.groupedRates(t).filter(t=>null!==t.effective_start_date):[]},toggleCollapse(t){var e=this;e.IsUpdate=!1,e.IsSave=!0,this.collapseStates[t]?(this.collapseStates[t]=!this.collapseStates[t],this.collapseStates[t]&&this.resetNewRateForm(t)):(this.$set(this.collapseStates,t,!0),this.resetNewRateForm(t))},resetNewRateForm(t){const e=this.findServiceByPlanServiceId(t);this.$set(this.newRateForms,t,{formSubmitted:!1,billingType:e&&e.billingType||"",effective_start_date:null,effective_end_date:null,rates:[{from:0,to:null,rate:0,invalidFrom:!1}]})},initializeNewRateForm(t){if(!this.newRateForms[t]){const a=this.findServiceByPlanServiceId(t);var e;if(a)this.$set(this.newRateForms,t,{formSubmitted:!1,billingType:a.billingType||"",effective_start_date:null,effective_end_date:null,rates:JSON.parse(JSON.stringify((null===(e=a.rateDetails[0])||void 0===e?void 0:e.rates)||[{from:0,to:null,rate:0}]))})}},findServiceByPlanServiceId(t){for(let e of this.PlanRateListing)for(let a of e.serviceTypes){const e=a.serviceList.find(e=>e.planServiceId===t);if(e)return e}return null},addRowData(t){const e=this.newRateForms[t].rates;if(e.length>0){const a=e[e.length-1],i=this.newRateForms[t];i.rates.push({from:a.to+1,to:null,rate:0})}},removeRowData(t,e){const a=this.newRateForms[t];a.rates.length>1&&a.rates.splice(e,1)},saveRate(t){const e=this;if(!this.validateForm(t))return;const a=this.findServiceByPlanServiceId(t);if(!a)return;const i=this.newRateForms[t],s=(new Date(i.effective_start_date),i.effective_end_date&&new Date(i.effective_end_date),a.rateDetails.some(t=>{const e=i.isEdit&&i.originalRateDetail&&t===i.originalRateDetail;if(e)return!1;const a=t.effective_start_date?new Date(t.effective_start_date):null,s=t.effective_end_date?new Date(t.effective_end_date):null,n=i.effective_start_date?new Date(i.effective_start_date):null,l=i.effective_end_date?new Date(i.effective_end_date):null;if(!a||!n)return!1;const o=a.toISOString().split("T")[0],r=s?s.toISOString().split("T")[0]:"ongoing",c=n.toISOString().split("T")[0],d=l?l.toISOString().split("T")[0]:"ongoing",u="ongoing"===d||!r||c<=r,p="ongoing"===r||!d||o<=d,m=c<=r&&o<=d;return m&&u&&p}));if(s)return void e.ShowAlert(`${e.$t("The date range for")} ${a.serviceName} ${e.$t("service overlaps for existing rate.")}`,"warning",e.$t("Alert"));a.rateDetails.forEach(t=>{const e=i.isEdit&&i.originalRateDetail&&t===i.originalRateDetail;e||null!==t.effective_end_date&&void 0!==t.effective_end_date||(t.effective_end_date=i.effective_start_date)});const n={rateLimitId:null,limitType:null,limitFrom:null,limitTo:null,customerRateType:null,startDate:null,effective_start_date:i.effective_start_date,endDate:null,effective_end_date:i.effective_end_date,billing_type:i.billingType,rates:i.rates.map(t=>({...t})),isCurrent:!0};if(a.rateDetails.forEach(t=>t.isCurrent=!1),i.isEdit&&i.originalRateDetail){const t=a.rateDetails.findIndex(t=>t===i.originalRateDetail);-1!==t&&(a.rateDetails[t]=n)}else a.rateDetails.push(n);this.resetNewRateForm(t),this.toggleCollapse(t)},deleteRule(t,e){const a=this.findServiceByPlanServiceId(t);if(!a||!e)return;const i=a.rateDetails.findIndex(t=>t===e||t.rates===e.slabs);-1!==i&&a.rateDetails.splice(i,1),this.collapseStates[t]&&(this.resetNewRateForm(t),this.collapseStates[t]=!1)},openEditPlan(t,e){var a=this;a.IsSave=!1,a.IsUpdate=!0;const i=this.findServiceByPlanServiceId(t);i&&e&&e.originalDetail&&(this.$set(this.collapseStates,t,!0),this.$set(this.newRateForms,t,{formSubmitted:!1,isEdit:!0,originalRateDetail:e.originalDetail,billingType:e.billing_type,effective_start_date:e.effective_start_date,effective_end_date:e.effective_end_date,rates:e.slabs.map(t=>({...t}))}))},findServiceByPlanServiceId(t){for(let e of this.PlanRateListing)for(let a of e.serviceTypes)for(let e of a.serviceList)if(e.planServiceId===t)return e;return null},billingTypeError(t){const e=this.findServiceByPlanServiceId(t);if(!e)return!1;if("Usage Based"!==e.service_type_name&&"Support"!==e.service_type_name)return!1;const a=this.newRateForms[t];return!(!a||!a.formSubmitted)&&!a.billingType},startDateError(t){const e=this.newRateForms[t];if(!e||!e.formSubmitted)return!1;const a=e.effective_start_date;return!a},validateForm(t,e=!0){const a=this.newRateForms[t];e&&(a.formSubmitted=!0);let i=!0;this.billingTypeError(t)&&(i=!1),this.startDateError(t)&&(i=!1),a.rates&&!a.rates.every(t=>t.rate>=0&&null!=t.rate)&&(i=!1);const s=this.findServiceByPlanServiceId(t);if(s&&"Usage Based"===s.service_type_name&&a.rates)for(let n=0;n<a.rates.length;n++)if(this.serviceUnitToError(t,n)){i=!1;break}if(s&&"Usage Based"===s.service_type_name&&a.rates)for(let n=1;n<a.rates.length;n++)if(a.rates[n].from<=a.rates[n-1].to||a.rates[n].from<0){i=!1;break}return"PERCENTAGE"===a.billingType&&a.rates.some(t=>null===t.rate||t.rate>100||t.rate<0)&&(i=!1),i},rateError(t,e){const a=this.newRateForms[t];if("PERCENTAGE"!==a.billingType)return!1;const i=a.rates[e];return null===i.rate||i.rate>100||i.rate<0},isFormValid(){return t=>this.validateForm(t,!1)},validateField(t,e){this.validateForm(t,!0)},fromDisplay(t){return""!==t?parseFloat(t):null},toggleCollapsePlan(t){this.collapseStatesPlan[t]?(this.collapseStatesPlan[t]=!this.collapseStatesPlan[t],this.collapseStatesPlan[t]&&this.resetNewRateFormPlan(t)):(this.$set(this.collapseStatesPlan,t,!0),this.resetNewRateFormPlan(t))},resetNewRateFormPlan(t){const e="fixed"===this.ApplicableOnPlanRateDetails.planRateType,a=e?1/0:null;this.$set(this.newRateFormsPlan,t,{formSubmitted:!1,isEdit:!1,originalRateDetail:null,billingType:e?"FLAT":"",effective_start_date:null,effective_end_date:null,rates:[{from:0,to:a,rate:0,invalidFrom:!1}]})},addRowPlan(t){if("slab"!==this.ApplicableOnPlanRateDetails.planRateType)return;const e=this.newRateFormsPlan[t].rates;if(e.length>0){const t=e[e.length-1];e.push({from:t.to?t.to+1:1,to:null,rate:0,invalidFrom:!1})}},removeRowPlan(t,e){if("slab"!==this.ApplicableOnPlanRateDetails.planRateType)return;const a=this.newRateFormsPlan[t].rates;a.length>1&&a.splice(e,1)},savePlanRate(t){if(!this.validatePlanForm(t))return;const e=this.ApplicableOnPlanRateDetails.rateList[t],a=this.newRateFormsPlan[t],i={rateLimitId:null,limitType:null,limitFrom:null,limitTo:null,customerRateType:null,startDate:null,effective_start_date:a.effective_start_date,endDate:null,effective_end_date:a.effective_end_date,billing_type:a.billingType,rates:a.rates.map(t=>({...t})),isCurrent:!0},s=e.rateDetails.some(t=>{const e=a.isEdit&&a.originalRateDetail===t;if(e)return!1;const i=t.effective_start_date?new Date(t.effective_start_date):null,s=t.effective_end_date?new Date(t.effective_end_date):null,n=a.effective_start_date?new Date(a.effective_start_date):null,l=a.effective_end_date?new Date(a.effective_end_date):null;if(!i||!n)return!1;const o=i.toISOString().split("T")[0],r=s?s.toISOString().split("T")[0]:"ongoing",c=n.toISOString().split("T")[0],d=l?l.toISOString().split("T")[0]:"ongoing",u=c<=r&&o<=d,p="ongoing"===d||!r||c<=r,m="ongoing"===r||!d||o<=d;return u&&p&&m});if(s)this.ShowAlert(this.$t("The date range overlaps with existing rate."),"warning",!0,this.$t("Alert"));else{if(e.rateDetails.forEach(t=>{const e=a.isEdit&&a.originalRateDetail===t;e||null!==t.effective_end_date&&void 0!==t.effective_end_date||(t.effective_end_date=a.effective_start_date),t.isCurrent=!1}),a.isEdit&&a.originalRateDetail){const t=e.rateDetails.findIndex(t=>t===a.originalRateDetail);-1!==t&&(e.rateDetails[t]=i)}else e.rateDetails.push(i);this.resetNewRateFormPlan(t),this.collapseStatesPlan[t]=!1,this.IsSave=!0,this.IsUpdate=!1}},deletePlanRateDetail(t,e){const a=this.ApplicableOnPlanRateDetails.rateList[t];if(a.rateDetails.splice(e,1),a.rateDetails.length>0)a.rateDetails.sort((t,e)=>new Date(e.effective_start_date||0)-new Date(t.effective_start_date||0)),a.rateDetails[0].isCurrent=!0;else{const t="fixed"===this.planRateType,e=t?1/0:null,i=t?"FLAT":"FLT";a.rateDetails.push({rateLimitId:null,limitType:null,limitFrom:null,limitTo:null,customerRateType:null,startDate:null,effective_start_date:null,endDate:null,effective_end_date:null,billing_type:i,rates:[{from:0,to:e,rate:0,invalidFrom:!1}],isCurrent:!0})}this.collapseStatesPlan[t]&&(this.collapseStatesPlan[t]=!1)},openEditPlanRate(t,e){this.IsSave=!1,this.IsUpdate=!0,this.$set(this.collapseStatesPlan,t,!0),this.$set(this.newRateFormsPlan,t,{formSubmitted:!1,isEdit:!0,originalRateDetail:e.originalDetail,billingType:e.billing_type,effective_start_date:e.effective_start_date,effective_end_date:e.effective_end_date,rates:e.slabs.map(t=>({...t}))})},planStartDateError(t){const e=this.newRateFormsPlan[t];return!(!e||!e.formSubmitted)&&!e.effective_start_date},planBillingTypeError(t){const e=this.newRateFormsPlan[t];return!(!e||!e.formSubmitted)&&("slab"===this.ApplicableOnPlanRateDetails.planRateType&&!e.billingType)},validatePlanForm(t,e=!0){const a=this.newRateFormsPlan[t];e&&(a.formSubmitted=!0);let i=!0;if("slab"===this.ApplicableOnPlanRateDetails.planRateType&&this.planBillingTypeError(t)&&(i=!1),this.planStartDateError(t)&&(i=!1),a.rates&&!a.rates.every(t=>t.rate>=0&&null!=t.rate)&&(i=!1),"slab"===this.ApplicableOnPlanRateDetails.planRateType&&a.rates)for(let s=0;s<a.rates.length;s++)if(this.planUnitToError(t,s)){i=!1;break}if("slab"===this.ApplicableOnPlanRateDetails.planRateType&&a.rates)for(let s=1;s<a.rates.length;s++)if(a.rates[s].from<=a.rates[s-1].to||a.rates[s].from<0){i=!1;break}return i},isPlanFormValid(t){return this.validatePlanForm(t,!1)},validatePlanField(t,e){this.validatePlanForm(t,!0)},enforceRateLimit(t,e){const a=this.newRateForms[t],i=a.rates[e];"PERCENTAGE"===a.billingType&&i.rate>100&&(i.rate=null),i.rate<0&&(i.rate=0)},onBillingTypeChange(t){const e=this.newRateForms[t];"PERCENTAGE"===e.billingType&&e.rates.forEach(t=>{t.rate=null})},planUnitToError(t,e){const a=this.newRateFormsPlan[t];if(!a||!a.formSubmitted)return!1;const i=a.rates[e];return null!==i.to&&void 0!==i.to&&i.to!==1/0&&i.to<i.from},validatePlanUnitRange(t,e){const a=this.newRateFormsPlan[t];a&&(a.formSubmitted=!0)},serviceUnitToError(t,e){const a=this.newRateForms[t];if(!a||!a.formSubmitted)return!1;const i=a.rates[e];return null!==i.to&&void 0!==i.to&&i.to!==1/0&&i.to<i.from},validateServiceUnitRange(t,e){const a=this.newRateForms[t];a&&(a.formSubmitted=!0)}}},Qt=Kt,Zt=(a("c976"),Object(d["a"])(Qt,Wt,Jt,!1,null,null,null)),Xt=Zt.exports,te=function(){var t=this,e=t._self._c;return e("section",[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"theme-primary partition"},[e("span",{staticClass:"p-name text-white"},[t._v(" "+t._s(t.$t("ConfirmSubscriptionChanges"))+" "),e("strong",[t._v(" ("+t._s(t.selectedBilling)+") ")])]),e("span",{staticClass:"p-name text-white float-right"},[t._v(" "+t._s(t.$t("Plan"))+" → "+t._s(t.PlanName)+" ")])]),t.ProrataDescription&&t.ProrataDescription.length?e("div",{staticClass:"listing"},[e("div",{staticClass:"table-responsive table-fix-header mt-2 px-0"},[e("table",{staticClass:"table table-bordered mb-0",staticStyle:{width:"100%"},attrs:{id:"example"}},[e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",{staticStyle:{"min-width":"150px"}},[e("span",{staticClass:"font-weight-500"},[t._v(t._s(t.$t("ServiceAndPlan")))])]),e("th",{staticStyle:{"min-width":"110px"}},[e("span",{staticClass:"font-weight-500"},[t._v(t._s(t.$t("From"))+" ")])]),e("th",{staticStyle:{"min-width":"60px"}},[e("span",{staticClass:"font-weight-500"},[t._v(t._s(t.$t("To"))+" ")])]),e("th",{staticClass:"text-right",staticStyle:{"min-width":"60px"}},[e("span",{staticClass:"font-weight-500"},[t._v(t._s(t.$t("BillingDays"))+" ")])]),e("th",{staticClass:"text-right",staticStyle:{"min-width":"70px"}},[e("span",{staticClass:"font-weight-500"},[t._v(t._s(t.$t("Units"))+" ")])]),e("th",{staticClass:"text-right",staticStyle:{"min-width":"70px"}},[e("span",{staticClass:"font-weight-500"},[t._v(t._s(t.$t("Rate"))+" ")])]),e("th",{staticClass:"text-right"},[e("span",{staticClass:"font-weight-500"},[t._v(t._s(t.$t("Amount"))+" ")])])])]),e("tbody",t._l(t.ProrataDescription,(function(a,i){return e("tr",{key:i},[e("td",[t._v(t._s(a["service/plan"]))]),e("td",[t._v(t._s(t.$options.filters.formatDate(a.from)))]),e("td",[t._v(t._s(t.$options.filters.formatDate(a.to)))]),e("td",{staticClass:"text-right"},[t._v(t._s(a.billing_days))]),e("td",{staticClass:"text-right"},[t._v(t._s(a.units))]),e("td",{staticClass:"text-right"},[t._v(t._s(t.$n(a.rate,"currency",t.$getLocaleByCurrency(t.CurrencyCode))))]),e("td",{staticClass:"text-right"},[t._v(t._s(t.$n(a.amount,"currency",t.$getLocaleByCurrency(t.CurrencyCode))))])])})),0)])])]):t._e(),e("div",{staticClass:"col-12 float-left mt-4 p-0"},[e("div",{staticClass:"heading-border"},[e("h5",{staticClass:"h5 text-capitalize"},[e("span",[t._v(t._s(t.$t("PricingSummary")))])])]),e("div",{staticClass:"d-flex justify-content-between font-16 my-2 rowhighlighter"},[e("div",{staticClass:"col-sm-6 col-md-6 col-xl-6 p-2"},[t._v(" "+t._s(t.$t("TotalAmount"))+" :")]),e("div",{staticClass:"col-sm-6 col-md-6 col-xl-6 text-right p-2"},[t._v(" "+t._s(t.$n(t.estimated_total_amount,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])]),t.DiscountData&&t.DiscountData.length>0?e("div",{staticStyle:{"margin-top":"12px"}},[e("div",{staticClass:"heading-border"},[e("h5",{staticClass:"h5 text-capitalize"},[e("span",[t._v(t._s(t.$t("Discounts")))])])]),t._l(t.DiscountData,(function(a){return e("div",{key:a.discountName,staticClass:"d-flex justify-content-between font-16 my-2 rowhighlighter"},[e("div",{staticClass:"col-sm-6 col-md-6 col-xl-6 p-2"},[t._v(t._s(a.discountName||"Discount")+":")]),e("div",{staticClass:"col-sm-6 col-md-6 col-xl-6 text-right p-2"},[t._v("-"+t._s(t.$n(Number(a.calculatedDiscount),"currency",t.$getLocaleByCurrency(t.CurrencyCode))))])])}))],2):t._e(),t.TaxData&&t.TaxData.length>0?e("div",{staticStyle:{"margin-top":"12px"}},[e("div",{staticClass:"heading-border"},[e("h5",{staticClass:"h5 text-capitalize"},[e("span",[t._v(t._s(t.$t("Taxes")))])])]),t._l(t.TaxData,(function(a){return e("div",{key:a.taxName,staticClass:"d-flex justify-content-between font-16 my-2 rowhighlighter"},[e("div",{staticClass:"col-sm-6 col-md-6 col-xl-6 p-2"},[t._v(t._s(a.taxName||"Tax")+":")]),e("div",{staticClass:"col-sm-6 col-md-6 col-xl-6 text-right p-2"},[t._v("+"+t._s(t.$n(Number(a.CalculatedTax),"currency",t.$getLocaleByCurrency(t.CurrencyCode))))])])}))],2):t._e(),e("div",{staticClass:"d-flex justify-content-between font-16 my-2 rowhighlighter"},[e("div",{staticClass:"col-sm-6 col-md-6 col-xl-6 p-2 font-weight-medium"},[t.EstimatePayableAmount>0?e("div",["Postpaid"==t.PlanType?e("span",[t._v(t._s(t.$t("NextBillingCyclePayableAmount")))]):e("span",[t._v(t._s(t.$t("PayableAmount")))]),t._v(": ")]):t.EstimatePayableAmount<0?e("div",["Postpaid"==t.PlanType?e("span",[t._v(t._s(t.$t("NextBillingCycleAvailableCreditBalance")))]):e("span",[t._v(t._s(t.$t("AvailableCreditBalance")))]),t._v(": ")]):e("div",[t._v(" Payable "+t._s(t.selectedBilling)+" Cost: ")])]),e("div",{staticClass:"col-sm-6 col-md-6 col-xl-6 text-right p-2 font-weight-medium"},[0===t.EstimatePayableAmount?e("span",[t._v(" "+t._s(t.$n(0,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")]):t.EstimatePayableAmount>0?e("span",{staticClass:"text-success"},[t._v(" "+t._s(t.$n(t.EstimatePayableAmount,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")]):e("span",{staticClass:"text-danger"},[t._v(" "+t._s(t.$n(Math.abs(t.EstimatePayableAmount),"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])])]),e("div",{staticClass:"row flex-row-reverse mb-2"},[e("div",{staticClass:"col-lg-12 text-right"},[e("a",{staticClass:"submitbtn btn btn-primary formbtn widthhalf mr-2",attrs:{title:"Click here to save record",href:"javascript:;",id:"hlkSave"},on:{click:t.ClosePopUp}},[e("em",{staticClass:"fa fa-angle-double-left pr-2"}),t._v(t._s(t.$t("Back"))+" ")]),e("a",{staticClass:"submitbtn btn btn-success formbtn widthhalf mr-2",attrs:{title:"Click here to save record",href:"javascript:;",id:"hlkSave"},on:{click:t.generateInvoice}},[e("em",{staticClass:"fa fa-save pr-2 text-white"}),t._v(t._s(t.$t("ConfirmChanges"))+" ")]),e("a",{staticClass:"submitbtn btn btn-danger formbtn widthhalf",attrs:{title:"Cancel",href:"javascript:;",id:"hlkCancel"},on:{click:function(e){return t.$emit("backtoPlanList")}}},[e("em",{staticClass:"fa fa-close pr-2 text-white"}),t._v(t._s(t.$t("Cancel"))+" ")])])])])],1)},ee=[],ae={props:{invoiceData:{type:Object},UserId:{type:Number},estimated_total_amount:{type:Number},EstimatePayableAmount:{type:Number},selectedBilling:{type:String},descriptionData:{type:String},IsProrate:{type:String},PlanType:{type:String}},data(){return{isLoading:!1,CurrencyCode:"PKR",ProrataDescription:[]}},async created(){var t=this;try{"string"===typeof t.descriptionData&&(t.ProrataDescription=JSON.parse(t.descriptionData))}catch(e){console.error("Invalid descriptionData JSON",e,t.descriptionData),t.ProrataDescription=[]}t.CurrencyCode=t.GetUserInfo.Currency.replace(/[()]/g,""),t.TaxData=t.invoiceData.plans[0].tax,t.DiscountData=t.invoiceData.plans[0].discount,t.PlanName=t.invoiceData.plans[0].Plan_name},methods:{getTotalDiscount(){var t;return(null===(t=this.DiscountData)||void 0===t?void 0:t.reduce((t,e)=>t+Number(e.calculatedDiscount||0),0))||0},getTotalTax(){var t;return(null===(t=this.TaxData)||void 0===t?void 0:t.reduce((t,e)=>t+Number(e.CalculatedTax||0),0))||0},ClosePopUp(){this.$parent.isPlanSubscription=!1,this.$parent.isAddSubscription=!1,this.$parent.isTemplate=!1,this.$parent.isInvoice=!1,this.$parent.isPlanDetails=!0},async generateInvoice(){var t=this;t.isLoading=!0;const e=t.invoiceData,a={json:JSON.stringify(e),clientId:this.UserId,type:"Generate",billingCycle:t.selectedBilling,isForAddOrEdit:"no",SelectedDate:""};try{const e=await n["a"].GenrateInvoice(a);if(200==e.status){const a=e.data.result.data;if("Success"==e.data.status)if(!a||1!=a[0].status_id&&11!=a[0].status_id)if(!a||6!=a[0].status_id&&61!=a[0].status_id)a&&21==a[0].status_id||a&&22==a[0].status_id?(t.ShowAlert(a[0].status_message,"success",!1,this.$t("Alert")),t.isLoading=!1,t.$parent.backtoPlanList()):a&&12==a[0].status_id?(this.ShowAlert(this.$t("QuantityUpdatedSuccessfully"),"success",!0,this.$t("Alert")),t.isLoading=!1,t.$parent.backtoPlanList()):(this.ShowAlert(a[0].status_message,"failure",!0,this.$t("Alert")),t.isLoading=!1);else{const e="clientPlanMappingId="+a[0].client_plan_mapping_id,s=await n["a"].getSubscribePlanDetails(e),l=s.data.result.data;var i;if(l&&1==l[0].status_id)"isEditingFromPlanListing"!=this.flag&&(this.$parent.isAddInvoice=!1),this.$parent.isAddSubscription=!1,this.$parent.isPlanSubscription=!1,this.$parent.isInvoice=!0,this.$parent.isTemplate=!0,this.$parent.templateDetails=l,t.isLoading=!1;else this.$parent.isAddSubscription=!0,this.$parent.isPlanSubscription=!1,this.$parent.isInvoice=!1,this.$parent.isTemplate=!1,t.isLoading=!1,this.ShowAlert((null===l||void 0===l||null===(i=l[0])||void 0===i?void 0:i.status_message)||this.$t("SomethingWentWrong"),"failure",!0,this.$t("Alert"))}else{const e="billId="+a[0].bill_id,i=await n["a"].getInvoiceDetails(e),l=i.data.result.data;var s;if(200==i.status&&l&&1==l[0].status_id)this.$parent.isAddSubscription=!1,this.$parent.isPlanSubscription=!1,this.$parent.isInvoice=!0,this.$parent.isTemplate=!0,this.$parent.templateDetails=l,t.isLoading=!1,t.ShowAlert(a[0].status_message,"success",!1,this.$t("Alert"));else this.$parent.isAddSubscription=!0,this.$parent.isPlanSubscription=!1,this.$parent.isInvoice=!1,this.$parent.isTemplate=!1,t.isLoading=!1,this.ShowAlert((null===l||void 0===l||null===(s=l[0])||void 0===s?void 0:s.status_message)||this.$t("SomethingWentWrong"),"failure",!0,this.$t("Alert"))}else this.ShowAlert(this.$t("SomethingWentWrong"),"failure",!0,this.$t("Alert")),t.isLoading=!1}}catch(l){console.error("Error fetching invoice template:",l)}}}},ie=ae,se=Object(d["a"])(ie,te,ee,!1,null,null,null),ne=se.exports,le={components:{Multiselect:Ut.a,InvoiceTemplate:Gt["a"],ConfirmSubscription:zt,ServiceRatesList:Xt,ConfirmAddSubscription:ne},props:{plandetails:{type:Array,required:!0},UserId:{type:Number},flag:{type:String,required:!1},Taxes:{type:Array,required:!1},Discounts:{type:Array,required:!1}},watch:{Taxes(t,e){this.taxDropdownVisible=!0,this.selectedTaxes=t},Discounts(t,e){this.discountDropdownVisible=!0,this.selectedDiscounts=t},plandetails(t,e){this.visibleServices=t.map((t,e)=>e)}},async created(){var t=this;t.CurrencyCode=t.GetUserInfo.Currency.replace(/[()]/g,""),t.isLoading=!0,this.visibleServices=this.plandetails.map((t,e)=>e),await this.GetddlDiscounts("Discounts"),await this.GetddlTaxes("Tax"),setTimeout(()=>{(async()=>{var e,a;(this.supportServices=[],this.plandetails.forEach(t=>{t.services.forEach(t=>{if(Array.isArray(t.ServiceRate)&&0!==t.ServiceRate.length||(t.ServiceRate=[{Freqrate:"0.00",Pre_rate:"0.00",billing_type:null,effective_end_date:null,effective_start_date:null,from:null,id:null,rate:"0.00",to:null}]),"Support"===t.service_type_code){this.supportServices.push({...t});const e=this.plandetails[0].services.some(e=>e.service_id===t.service_id);e||this.plandetails[0].services.push({...t})}})}),t.PlanMappingId=void 0===t.plandetails[0].client_plan_mapping_id?"":t.plandetails[0].client_plan_mapping_id,t.PlanId=t.plandetails[0].Plan_id,t.RateApplicableOnPlan=t.plandetails[0].is_rate_applicable_on_plan,t.PlanMappingId>0&&(158446==t.CompanyId||122872==t.CompanyId||158770==t.CompanyId||125897==t.CompanyId||158850==t.CompanyId||125948==t.CompanyId)?(t.SelectedDate=t.$options.filters.formatDateYear(t.plandetails[0].subscription_date),t.BillDate=new Date(t.plandetails[0].subscription_date),t.FormSchema[0].Data[0].config.minDate=new Date(t.plandetails[0].subscription_date),t.FormSchema[0].Data[0].value=new Date(t.plandetails[0].subscription_date)):(t.SelectedDate="",t.FormSchema[0].Data[0].value=""),t.PaymentType=t.plandetails[0].payment_type,t.PlanMappingId>0)?(t.selectedBilling=(null===(e=t.plandetails[0])||void 0===e?void 0:e.selectedBilling)||"Monthly",t.PreselectedBilling=t.selectedBilling):(t.selectedBilling=(null===(a=t.plandetails[0])||void 0===a?void 0:a.selectedFrequency)||"Monthly",t.PreselectedBilling=t.selectedBilling);"One Time"==t.PaymentType&&(t.selectedBilling="One Time",t.PreselectedBilling="One Time"),await t.GetFrequencyDDlData(),t.handleBillingChange("OnLoad"),t.plandetails.forEach(e=>{var a;null===(a=e.services)||void 0===a||a.forEach(e=>{const a=t.getRateForUnit(e.Unit,e.ServiceRate);e.calculatedRate=null!=a?(a*e.Unit).toFixed(2):null})})})()},500),t.CompanyId=t.GetUserInfo.CompanyId,t.isLoading=!1},data(){return{visibleServices:[],discountList:[],taxList:[],discountDropdownVisible:!1,selectedDiscount:null,taxDropdownVisible:!1,selectedTax:null,discountPercentage:0,taxPercentage:0,discountType:0,showIcon:!1,invoiceTemplate:null,taxPrice:0,discountPrice:0,selectedDiscounts:[],selectedTaxes:[],isTemplate:!1,templateDetails:{},isInvoice:!1,selectedBilling:null,totalAmount:0,changed_unit:0,PlanMappingId:"",isLoading:!1,isPlanSubscription:!1,InvoiceSavedData:[],EstimatedAmount:"",estimated_total_amount:"",EstimatedAdjustmentAmount:"",EstimatePayableAmount:"",CurrencyCode:"PKR",PreviousCreditAmount:"",buttons:[],SelectedDate:"",CompanyId:"",FrequencyNote:"",FormSchema:[{layoutType:"four",Data:[{astype:"DateField",label:this.$t("Selected Date"),name:"SelectedDate",value:"",placeholder:"",config:{format:"MM/DD/YYYY",onChange:this.InvoiceComponentFieldsValues},validationRules:{required:!0},disabled:!1}]}],FrequencyOptions:[],MultiplyFrequencyFactor:1,Discount:0,PreselectedBilling:"",descriptionData:[],PaymentType:"",isServices:!1,clientplanmappingid:0,PlanId:0,BillDate:"",supportServices:[],RateApplicableOnPlan:"",IsProrate:!1,PlanType:"Prepaid",isAddSubscription:!1}},computed:{baseSubtotal(){let t=0;return t=this.plandetails[0].is_rate_applicable_on_plan&&null!==this.plandetails[0].is_rate_applicable_on_plan?this.plandetails.reduce((t,e)=>t+this.calculatePlanTotal(e,"plan"),0).toFixed(2):this.plandetails.reduce((t,e)=>t+this.calculatePlanTotal(e,"service"),0).toFixed(2),parseFloat(t).toFixed(2)},subtotal(){let t=parseFloat(this.baseSubtotal);return this.supportServices.length>0&&(t+=parseFloat(this.supportTotal)),this.totalAmount=t.toFixed(2),this.selectedDiscounts&&Array.isArray(this.selectedDiscounts)&&(this.discountPrice=0,this.selectedDiscounts=this.selectedDiscounts.map(e=>{var a;let i=0;return i=0===(null!==(a=e.DISCOUNT_TYPE)&&void 0!==a?a:0)?t*e.ADJUSTMENT_PERCENTAGE/100:e.ADJUSTMENT_PERCENTAGE,t-=i,this.discountPrice+=i,{...e,calculatedDiscount:i.toFixed(2)}}),this.discountPrice=this.discountPrice.toFixed(2)),parseFloat(t).toFixed(2)},supportTotal(){return this.supportServices.reduce((t,e)=>t+parseFloat(this.calculateSupportTotal(e)),0)},finalTotal(){let t=parseFloat(this.subtotal)||0;return this.taxPrice=0,this.selectedTaxes&&Array.isArray(this.selectedTaxes)&&(this.selectedTaxes=this.selectedTaxes.map(e=>{let a=t*e.ADJUSTMENT_PERCENTAGE/100;return this.taxPrice+=a,{...e,CalculatedTax:a.toFixed(2)}}),t+=this.taxPrice),t.toFixed(2)}},methods:{toggleServices(t){this.visibleServices.includes(t)?(this.visibleServices=this.visibleServices.filter(e=>e!==t),this.showIcon=!0):(this.visibleServices.push(t),this.showIcon=!1)},isServicesVisible(t){return this.visibleServices.includes(t)},updateQuantity(t,e,a){var i=this;if("service"==a){let a=String(this.plandetails[t].services[e].Unit||"");a.length>5&&(a=a.slice(0,5),this.plandetails[t].services[e].Unit=parseInt(a,10));const i=this.plandetails[t].services[e].existing_units;!isNaN(a)&&parseInt(a,10)>0?(this.plandetails[t].services[e].Unit=parseInt(a,10),this.plandetails[t].services[e].changed_unit=parseInt(a-i)):(this.plandetails[t].services[e].Unit=0,this.plandetails[t].services[e].changed_unit=parseInt(a-i))}else{let e=String(this.plandetails[t].PlanUnit||"");e.length>5&&(e=e.slice(0,5),this.plandetails[t].PlanUnit=parseInt(e,10));const a=this.plandetails[t].existing_units;!isNaN(e)&&parseInt(e,10)>0?(this.plandetails[t].PlanUnit=parseInt(e,10),this.plandetails[t].planrate[0].Unit=parseInt(e,10),i.changed_unit=parseInt(e-a)):(this.plandetails[t].PlanUnit=0,this.plandetails[t].planrate[0].Unit=parseInt(e,10),i.changed_unit=parseInt(e-a))}},incrementQuantity(t,e,a){const i=this.plandetails[t].services[e];i.Unit=parseInt(i.Unit,10)+1,i.changed_unit=parseInt(i.changed_unit,10)+1},calculateAnnualPrice(t,e){let a;const i=this.plandetails[0].timebased_discount;if("annually"==this.selectedBilling){const s=e-e*i/100;a=t*s*12}else a=t*e;return a},decrementQuantity(t,e){const a=this.plandetails[t].services[e];a.Unit>0&&(a.Unit-=1,a.changed_unit-=1)},calculateItemTotal(t,e,a){let i=0;var s=this;if("service"===e){if(t.ServiceRate){for(const e of t.ServiceRate)if(t.Unit>=e.from&&(null===e.to||t.Unit<=e.to)){i=e.rate;break}}else i=0;var n=0;return n=t.Unit?(i*t.Unit).toFixed(2):0,n}if(t.Rates){for(const l of t.Rates)if(a>=l.from&&(null===l.to||a<=l.to)||s.PlanMappingId>0){i=l.rate;break}}else i=0;return a?(i*a).toFixed(2):0},PriceAfterSubscriptionDiscount(t){return t},calculateTotalItem(t,e){const a=this.plandetails[t];if("plan"==e){let t=a.planrate.reduce((t,e)=>t+(parseFloat(this.calculateItemTotal(e,"plan",a.PlanUnit))||0),0);return t.toFixed(2)}{let t=a.services.filter(t=>"Support"!==t.service_type_code).reduce((t,e)=>t+parseFloat(this.calculateItemTotal(e,"service")),0);return t.toFixed(2)}},calculateSupportTotal(t){if(null!=t.ServiceRate&&t.ServiceRate[0]){const e=t.ServiceRate[0];return"PERCENTAGE"===e.billing_type?(parseFloat(this.calculateTotalItem(0,"service"))*e.rate/100*t.Unit).toFixed(2):(e.rate*t.Unit).toFixed(2)}if("UsageBased"===t.service_type_code){const e=this.getRateForUnit(t.Unit,t.ServiceRate);return e?(e*t.Unit).toFixed(2):0}return 0},calculatePlanTotal(t,e){return"service"==e?t.services.filter(t=>"Support"!==t.service_type_code).reduce((t,e)=>t+(parseFloat(this.calculateItemTotal(e,"service"))||0),0):t.planrate.reduce((e,a)=>e+(parseFloat(this.calculateItemTotal(a,"plan",t.PlanUnit))||0),0)},async GetddlDiscounts(t){var e=this;const a=`type=${t}&ClientId=${e.UserId}&JurisdictionId=`,i=await n["a"].GetTaxsDiscounts(a);i.data&&(this.discountList=i.data.result.DATA)},async GetddlTaxes(t){var e=this;const a=`type=${t}&ClientId=${e.UserId}&JurisdictionId=`,i=await n["a"].GetTaxsDiscounts(a);i.data&&(this.taxList=i.data.result.DATA)},toggleDiscountDropdown(){this.discountDropdownVisible=!this.discountDropdownVisible},toggleTaxDropdown(){this.taxDropdownVisible=!this.taxDropdownVisible},updateTaxDiscount(t){if("discount"==t){const t=this.discountList.find(t=>t.ADJUSTMENT_ID===this.selectedDiscount);var e;if(t)this.discountPercentage=t.ADJUSTMENT_PERCENTAGE,this.discountType=null!==(e=t.DISCOUNT_TYPE)&&void 0!==e?e:0}else{const t=this.taxList.find(t=>t.ADJUSTMENT_ID===this.selectedTax);t&&(this.taxPercentage=t.ADJUSTMENT_PERCENTAGE)}},updateMulitpleTaxDiscount(t){"discount"===t?this.selectedDiscounts.forEach(t=>{const e=this.discountList.find(e=>e.ADJUSTMENT_ID===t);var a;e&&(this.discountPercentage+=e.ADJUSTMENT_PERCENTAGE,this.discountType=null!==(a=e.DISCOUNT_TYPE)&&void 0!==a?a:0)}):this.selectedTaxes.forEach(t=>{const e=this.taxList.find(e=>e.ADJUSTMENT_ID===t);e&&(this.taxPercentage+=e.ADJUSTMENT_PERCENTAGE)})},async generateInvoice(){var t=this,e="",a="no",i=[];if(t.PlanMappingId>0){i={plans:this.plandetails.map(e=>({Plan_id:e.Plan_id,Plan_name:e.plan_name,plan_type:e.plan_type,Freqrate:e.Freqrate,is_rate_applicable_on_plan:e.is_rate_applicable_on_plan,timebased_discount:t.Discount,total_amount:this.totalAmount,discount_amount:this.discountPrice,tax_amount:this.taxPrice,discount:this.selectedDiscounts.map(t=>({discount_id:t.ADJUSTMENT_ID,discountName:t.ADJUSTMENT_NAME,calculatedDiscount:t.calculatedDiscount})),PlanUnits:e.PlanUnit,Plan_changed_unit:t.changed_unit,plan_Existing_unit:e.existing_units,PlanRate:e.BaseRate,tax:this.selectedTaxes.map(t=>({tax_id:JSON.stringify(t.ADJUSTMENT_ID),taxName:t.ADJUSTMENT_NAME,CalculatedTax:t.CalculatedTax})),services:e.services.map(t=>({service_name:t.service_name,service_type_code:t.service_type_code,service_id:t.service_id,Unit:t.Unit,Changed_unit:t.changed_unit,ServiceRate:t.ServiceRate,Existing_unit:t.existing_units,calculatedRate:t.calculatedRate,newCaluclateRate:t.newCaluclateRate})),hasAnyChangedUnit:!(t.PlanMappingId>0)||!e.services.every(t=>0===t.changed_unit),one_time_charge:0}))};const s=i.plans.map(t=>{const e=t.services.every(t=>0===t.Unit);return!e}),n=s.includes(!0);if(0==n||0==i.plans[0].PlanUnits&&t.RateApplicableOnPlan)return this.ShowAlert(this.$t("MinimumOneQuantity"),"warning",!0,this.$t("Alert")),t.isLoading=!1,!1;t.InvoiceSavedData=i;const l=i.plans.some(t=>t.hasAnyChangedUnit);if(!l&&0==t.changed_unit&&""!=t.PlanMappingId&&t.selectedBilling==t.PreselectedBilling)return this.ShowAlert(this.$t("NoChangedQuantity"),"warning",!0,this.$t("Alert")),!1;e="Preview",a="yes"}else{t.isLoading=!0,i={plans:this.plandetails.map(e=>{const a=e.services.filter(t=>("OneTime"===t.service_type_code||"Activation"===t.service_type_code)&&t.ServiceRate&&t.ServiceRate.length>0).reduce((t,e)=>t+e.ServiceRate[0].rate*e.Unit,0);return{Plan_id:e.Plan_id,Plan_name:e.plan_name,timebased_discount:t.Discount,total_amount:this.totalAmount,discount_amount:this.discountPrice,tax_amount:this.taxPrice,discount:this.selectedDiscounts.map(t=>({discount_id:t.ADJUSTMENT_ID,discountName:t.ADJUSTMENT_NAME,calculatedDiscount:t.calculatedDiscount})),PlanUnits:e.PlanUnit,tax:this.selectedTaxes.map(t=>({tax_id:JSON.stringify(t.ADJUSTMENT_ID),taxName:t.ADJUSTMENT_NAME,CalculatedTax:t.CalculatedTax})),services:e.services.map(t=>({service_id:t.service_id,Unit:t.Unit})),hasAnyChangedUnit:!(t.PlanMappingId>0)||!e.services.every(t=>0===t.changed_unit),one_time_charge:a}})};const s=i.plans.map(t=>{const e=t.services.every(t=>0===t.Unit);return!e}),n=s.includes(!0);if(0==n||0==i.plans[0].PlanUnits&&t.RateApplicableOnPlan)return this.ShowAlert(this.$t("MinimumOneQuantity"),"warning",!0,this.$t("Alert")),t.isLoading=!1,!1;t.InvoiceSavedData=i,e="Preview",a="no"}const s=i.plans.some(t=>t.hasAnyChangedUnit);if(s||0!=t.changed_unit||""==t.PlanMappingId||t.selectedBilling!=t.PreselectedBilling){const s={json:JSON.stringify(i),clientId:this.UserId,type:e,billingCycle:t.selectedBilling,isForAddOrEdit:a,SelectedDate:t.SelectedDate};try{const e=await n["a"].GenrateInvoice(s);if(200==e.status){const a=e.data.result.data;if("Success"==e.data.status)if(a&&1==a[0].status_id){const e="billId="+a[0].bill_id,i=await n["a"].getInvoiceDetails(e),s=i.data.result.data;var l;if(200==i.status&&s&&1==s[0].status_id)"isEditingFromPlanListing"!=this.flag&&(this.$parent.isAddInvoice=!1),this.isInvoice=!0,this.isTemplate=!0,this.templateDetails=s,t.isLoading=!1,t.ShowAlert(a[0].status_message,"success",!1,this.$t("Alert"));else this.isInvoice=!1,this.isTemplate=!1,t.isLoading=!1,this.ShowAlert((null===s||void 0===s||null===(l=s[0])||void 0===l?void 0:l.status_message)||this.$t("SomethingWentWrong"),"failure",!0,this.$t("Alert"))}else if(a&&6==a[0].status_id){const e="clientPlanMappingId="+a[0].client_plan_mapping_id,i=await n["a"].getSubscribePlanDetails(e),s=i.data.result.data;var o;if(s&&1==s[0].status_id)"isEditingFromPlanListing"!=this.flag&&(this.$parent.isAddInvoice=!1),this.isInvoice=!0,this.isTemplate=!0,this.templateDetails=s,t.isLoading=!1;else this.isInvoice=!1,this.isTemplate=!1,t.isLoading=!1,this.ShowAlert((null===s||void 0===s||null===(o=s[0])||void 0===o?void 0:o.status_message)||this.$t("SomethingWentWrong"),"failure",!0,this.$t("Alert"))}else a&&22==a[0].status_id?(t.isLoading=!1,t.ShowAlert(a[0].status_message,"success",!1,this.$t("Alert")),t.backtoPlanList()):a&&12==a[0].status_id?(t.isLoading=!1,this.ShowAlert(this.$t("QuantityUpdatedSuccessfully"),"success",!0,this.$t("Alert")),t.backtoPlanList()):a&&21==a[0].status_id&&t.PlanMappingId>0?(t.EstimatedAmount=a[0].estimated_amount,t.PreviousCreditAmount=a[0].previous_credit_amount,t.EstimatePayableAmount=a[0].estimated_payable_amount,t.descriptionData=a[0].description,t.IsProrate=a[0].is_pro_rate,t.PlanType=2==a[0].plan_type?"Postpaid":"Prepaid",t.isInvoice=!0,t.isLoading=!1,t.isTemplate=!1,t.isAddSubscription=!1,t.isPlanSubscription=!0):a&&21==a[0].status_id?(t.EstimatedAmount=a[0].estimated_amount,t.estimated_total_amount=a[0].estimated_total_amount,t.PreviousCreditAmount=a[0].previous_credit_amount,t.EstimatePayableAmount=a[0].estimated_payable_amount,t.descriptionData=a[0].description,t.IsProrate=a[0].is_pro_rate,t.PlanType=2==a[0].plan_type?"Postpaid":"Prepaid",t.isInvoice=!0,t.isLoading=!1,t.isTemplate=!1,t.isPlanSubscription=!1,t.isAddSubscription=!0):(t.isLoading=!1,this.ShowAlert(a[0].status_message,"failure",!0,this.$t("Alert")));else t.isLoading=!1,this.ShowAlert(this.$t("SomethingWentWrong"),"failure",!0,this.$t("Alert"))}}catch(r){console.error("Error fetching invoice template:",r)}}else this.ShowAlert(this.$t("NoChangedQuantity"),"warning",!0,this.$t("Alert")),t.isLoading=!1},formatUsageBasedRate(t){const e=this.getRateForUnit(t.Unit,t.ServiceRate);return null!=e?(t.newCaluclateRate=e*t.Unit,this.$n(t.newCaluclateRate.toFixed(2),"currency",this.$getLocaleByCurrency(this.CurrencyCode))):null},getRateForUnit(t,e){var a=this;if(!e||!Array.isArray(e))return null;const i=e.find(e=>t>=e.from&&(null===e.to||t<=e.to));return i?(i.Pre_rate-i.Pre_rate*a.Discount/100)*a.MultiplyFrequencyFactor:null},Rate(t,e,a){var i=this;let s=0;if(null!=t){const i=Math.abs(e);if("services"===a){for(const e of t)if(i>=e.from&&(null===e.to||i<=e.to)){s=e.Pre_rate;break}}else if(t[0].Rates)for(const e of t[0].Rates)if(i>=e.from&&(null===e.to||i<=e.to)){s=e.Pre_rate;break}}const n=(s-s*i.Discount/100)*i.MultiplyFrequencyFactor;return n},PlanincrementQuantity(t){var e=this;const a=this.plandetails[t];a.PlanUnit=parseInt(a.PlanUnit,10)+1,a.planrate[0].Unit=parseInt(a.planrate[0].Unit,10)+1,e.changed_unit=parseInt(e.changed_unit,10)+1},PlandecrementQuantity(t){var e=this;const a=this.plandetails[t];a.PlanUnit>0&&(a.PlanUnit-=1,a.planrate[0].Unit-=1,e.changed_unit-=1)},async previewInvoice(){const t={plans:this.plandetails.map(t=>({Plan_id:t.Plan_id,timebased_discount:t.timebased_discount,discount_id:this.selectedDiscount,tax_id:this.selectedTax,services:t.services.map(t=>({service_id:t.service_id,Unit:t.Unit}))}))},e=JSON.stringify(t),a=`json=${e}&clientId=${this.UserId}&type=Preview&billingCycle=${this.selectedBilling}`;try{const t=await n["a"].GenrateInvoice(a),e=t.data.result.data;this.$emit("invoiceTemplatedata",e)}catch(i){console.error("Error fetching invoice template:",i)}},backtoPlanList(){"isEditingFromPlanListing"==this.flag?(this.$parent.isPlanListing=!0,this.$parent.isPlanDetails=!1,this.taxDropdownVisible=!1,this.discountDropdownVisible=!1,this.$parent.FetchData()):this.$emit("backtoPlanList")},async GetFrequencyDDlData(){var t=this;let e="moduleName=Company&type=Plan_Frequency&refId="+t.plandetails[0].Plan_id;await n["a"].GetDDLData(e).then(e=>{null!=e.data&&e.data.DATA.length>0&&(t.FrequencyOptions=e.data.DATA)})},handleBillingChange(t){const e=this,a=e.selectedBilling.toLowerCase(),i=e.FrequencyOptions.find(t=>t.value&&t.value.toLowerCase()===a);e.Discount=i&&parseFloat(i.first_value)||0;let s=1;switch(a){case"monthly":s=1;break;case"weekly":s=1/4;break;case"bi-weekly":s=.5;break;case"quarterly":s=3;break;case"semi-annually":s=6;break;case"annualy":s=12;break;case"yearly":s=12;break;case"4 month basis":s=4;break;default:s=1}e.MultiplyFrequencyFactor=s,this.plandetails[0].is_rate_applicable_on_plan&&null!==this.plandetails[0].is_rate_applicable_on_plan?e.plandetails.forEach(a=>{if(a.is_rate_applicable_on_plan&&Array.isArray(a.planrate)&&a.planrate.length>0&&Array.isArray(a.planrate[0].Rates)){const i=a.planrate,s=e.Rate(i,a.PlanUnit,"plan");a.BaseRate=Number(s.toFixed(2)),a.planrate[0].Rates[0].rate=Number(s.toFixed(2)),"OnLoad"==t&&(a.Freqrate=Number(s.toFixed(2)))}}):e.plandetails.forEach(a=>{a.services.forEach((a,i)=>{const s=Array.isArray(a.ServiceRate)?a.ServiceRate:a.RateSlabs||[];s.forEach((function(i,n){if("Activation"===a.service_type_code||"OneTime"===a.service_type_code?i.rate=parseFloat(a.ServiceRate[n].Pre_rate).toFixed(2):"Support"===a.service_type_code&&"FLAT"!=i.billing_type&&""!=i.billing_type||(a.Unit>=i.from&&(null===i.to||a.Unit<=i.to)||e.PlanMappingId>0)&&(i.rate=parseFloat(e.Rate(s,a.Unit,"services")).toFixed(2)),("Support"!==a.service_type_code||"FLAT"==i.billing_type||""==i.billing_type)&&"OnLoad"===t)if(e.PlanMappingId>0){let t=i.Pre_rate-i.Pre_rate*e.Discount/100;i.Freqrate=(t*e.MultiplyFrequencyFactor).toFixed(2),i.rate=i.Freqrate}else i.Freqrate=parseFloat(e.Rate(s,a.Unit,"services")).toFixed(2)}))})}),e.PlanMappingId&&e.PreselectedBilling!=e.selectedBilling?e.FrequencyNote=!0:(e.FrequencyNote=!1,this.supportServices=[],this.plandetails.forEach(t=>{t.services.forEach(t=>{if("Support"===t.service_type_code){this.supportServices.push({...t});const e=this.plandetails[0].services.some(e=>e.service_id===t.service_id);e||this.plandetails[0].services.push({...t})}})}))},backtoPlanDetails(){this.backtoPlanList()},async refreshPlans(){try{var t=this;this.isLoading=!0;const a=[];var e="recurring";e="One Time"==t.selectedBilling?"One Time":"recurring";const i=`client_id=${this.UserId}&type=${e}`,s=await n["a"].LoadPlansMappingSubscription(i);if("Success"===s.data.status&&"1"===s.data.code){t.plandetails.splice(0,t.plandetails.length);const e=s.data.result;e.forEach(t=>{t.services=t.services?JSON.parse(`[${t.services}]`):[],t.planrate=t.planrate?JSON.parse(`[${t.planrate}]`):[],t.BaseRate=t.BaseRate?t.BaseRate.toFixed(2):0,t.timebased_discount=this.discount,t.is_applicable_on_plan=1==t.is_rate_applicable_on_plan?this.$t("PlanBased"):this.$t("ServiceBased"),t.plan_type=1==t.plan_type?this.$t("Prepaid"):this.$t("Postpaid"),t.selectedFrequency="Monthly",t.calculatedRate=t.BaseRate}),this.PlanList=e;const i=this.PlanList.find(e=>e.Plan_id===t.PlanId);i&&(a.push(i),t.plandetails.splice(0,t.plandetails.length,...a),this.plandetails.forEach(t=>{t.services.forEach(t=>{Array.isArray(t.ServiceRate)&&0!==t.ServiceRate.length||(t.ServiceRate=[{Freqrate:"0.00",Pre_rate:"0.00",billing_type:null,effective_end_date:null,effective_start_date:null,from:null,id:null,rate:"0.00",to:null}])})}),t.handleBillingChange("OnLoad"),this.$emit("update-plandetails",t.plandetails)),this.isLoading=!1}else this.PlanList=[],this.isLoading=!1}catch(a){console.error("Error loading plans:",a)}},onSubmit(){},InvoiceComponentFieldsValues(t,e,a){var i=this;i.SelectedDate=i.$options.filters.formatDateYear(t)},UpdatePlanRates(){this.isTemplate=!1,this.isPlanSubscription=!1,this.isAddSubscription=!1,this.isInvoice=!1,this.isServices=!0}}},oe=le,re=(a("a020"),a("79a3"),Object(d["a"])(oe,kt,Ot,!1,null,null,null)),ce=re.exports,de={components:{Plan:Ft,PlanDetails:ce},props:["ClientData","UserId"],data(){return{isPlanSelection:!0,isPlanDetails:!1,plandetails:{},discount:0,isAddInvoice:!1,planPaymentType:"onetime",isShowbillingCycle:!1}},async created(){},methods:{handlePlanDetails(t){this.isPlanSelection=!1,this.isPlanDetails=!0,this.isAddInvoice=!0,this.plandetails=t},setBilling(t){this.selectedBilling=t,this.GetsubscriptionDiscount()},settype(t){"recurring"==t?(this.selectedBilling="annually",this.isShowbillingCycle=!0):(this.selectedBilling=t,this.isShowbillingCycle=!1),this.planPaymentType=t},handleInvoiceTemplate(t){console.log("Received invoice template data:",t),this.template(t)},template(t){this.isPlanDetails=!1,this.isTemplate=!0,this.templateDetails=t,console.log(" invoice templateDetails data:",t)},async GetsubscriptionDiscount(){const t="ruleType=4&externalAppCode=TALYGEN",e=await n["a"].GetAllSubscriptionDiscount(t);e.data[0].DiscountAmount?this.discount=e.data[0].DiscountAmount:this.discount=0},switchToPlan(){this.isPlanSelection=!0,this.isPlanDetails=!1,this.isAddInvoice=!1},backtoPlanList(){this.$emit("backToPlanListing")}}},ue=de,pe=Object(d["a"])(ue,xt,Nt,!1,null,null,null),me=pe.exports,he=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("View Plan History")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:function(e){return t.$emit("close")}}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("tg-list",{attrs:{IsShowAction:!1,showCheckBox:!1,ModuleName:"Billing",listType:["List"],RenderRowActionMethod:t.renderActions,SubModuleCode:"Billing",IdentityColumn:"id",ListData:t.PlanHistory,HeaderData:t.Headers,callbackfunction:t.FetchData,HeaderButtons:"",TotalRecords:t.TotalRecords,ListDataCallBackFunction:t.FetchData,SortExp:t.sortExp,SortBy:t.sortBy,NorecordfoundText:t.$t("NoRecordfound"),isShowHeaderText:!1,HeaderText:t.$t("ViewPlanHistory")},on:{LeftsearchButtonClick:function(t){},PagerButtonClick:t.pagerMethod,ActionButtonClick:t.actionButtonClick,HeaderButtonClick:t.commonHeaderButtonClick,SortdataButtonClick:t.sortdata},scopedSlots:t._u([{key:"slotdata",fn:function({data:a}){return["Variation"===a.column.COLUMN_NAME?["UP"===a.row.VariationStatus?e("span",[t._v(" "+t._s(a.row.Variation)+" "),e("i",{staticClass:"fa fa-arrow-up text-success"})]):t._e(),"DOWN"===a.row.VariationStatus?e("span",[t._v(" "+t._s(a.row.Variation)+" "),e("i",{staticClass:"fa fa-arrow-down text-danger"})]):t._e()]:t._e()]}}])})],1)])])])],1)])},ve=[],_e={props:{PlanMappingId:{type:Number,required:!0}},data(){return{isLoading:!1,PlanHistory:[],TotalRecords:0,sortBy:"",sortExp:"",Headers:[{COLUMN_NAME:"Change_Date",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Change Date",DISPLAY_ORDER:2},{COLUMN_NAME:"Previous_Quantity",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Previous Quantity",DISPLAY_ORDER:3},{COLUMN_NAME:"Updated_Quantity",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Updated Quantity",DISPLAY_ORDER:4},{COLUMN_NAME:"Variation",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Variation",DISPLAY_ORDER:5,settings:{isInSlot:!0}},{COLUMN_NAME:"Updated_By",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Updated By",DISPLAY_ORDER:6}]}},async created(){var t=this;await t.FetchData()},methods:{async FetchData(){var t=this;try{var e="planMappingId="+t.PlanMappingId;const s=await n["a"].GetPlanUnitHistoryForSubscription(e);if("Success"===s.data.status&&"1"===s.data.code){var a,i;if(s.data.result.data.length>0)if(t.TotalRecords=null===(a=s.data.result.data[0])||void 0===a?void 0:a.TotalRecords,t.isRateApplicableOnPlan=null===(i=s.data.result.data[0])||void 0===i?void 0:i.is_rate_applicable_on_plan,null==t.isRateApplicableOnPlan){let e={COLUMN_NAME:"Service_name",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Service name",DISPLAY_ORDER:1};t.Headers.unshift(e)}t.PlanHistory=s.data.result.data,t.PlanHistory.forEach(t=>{t.additionalClass="",1001==t.unit_status&&(t.additionalClass="low-bar odd")})}else t.PlanHistory=[],t.TotalRecords=0}catch(s){console.log("Error loading plan history:",s)}},renderActions(){},pagerMethod(){},actionButtonClick(){},commonHeaderButtonClick(){},sortdata(){}}},ge=_e,fe=Object(d["a"])(ge,he,ve,!1,null,null,null),Ce=fe.exports,ye=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{directives:[{name:"show",rawName:"v-show",value:t.PlanData.length>0,expression:"PlanData.length > 0"}],staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("associateplandetails")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:function(e){return t.$emit("close")}}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[t.PlanData.length>0?e("div",{staticClass:"fluid-container p-0 m-0"},[e("div",{staticClass:"plan-info row"},[e("div",{staticClass:"col-md-4 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v("Plan Name:")]),t._v(" "+t._s(t.PlanData[0].plan_name))])])]),e("div",{staticClass:"col-md-4 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v("Plan Type:")]),t._v(" "+t._s(t.PlanData[0].plan_type))])])]),e("div",{staticClass:"col-md-4 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v("Effective Date:")]),t._v(" "+t._s(t.$options.filters.formatDate(t.PlanData[0].effective_date)))])])]),e("div",{staticClass:"col-md-4 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v("Status:")]),t._v(" "),e("span",{staticClass:"px-2",class:{"bg-success text-center text-white":"Active"==t.PlanData[0].status_name,"bg-danger text-center text-white":"Inactive"==t.PlanData[0].status_name,"bg-danger text-center text-white":"Cancelled"==t.PlanData[0].status_name}},[t._v(t._s(t.PlanData[0].status_name))])])])]),e("div",{staticClass:"col-md-4 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v("Next Bill date:")]),t._v(" "+t._s(t.$options.filters.formatDate(t.PlanData[0].next_bill_date)))])])]),e("div",{staticClass:"col-md-4 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v("Last Update date:")]),t._v(" "+t._s(t.$options.filters.formatDate(t.PlanData[0].last_update_date)))])])]),e("div",{staticClass:"col-md-4 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v("Last Bill date:")]),t._v(" "+t._s(t.$options.filters.formatDate(t.PlanData[0].Last_bill_date)))])])]),e("div",{staticClass:"col-md-4 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v("Billing Frequency:")]),t._v(" "+t._s(t.PlanData[0].frequency))])])]),e("div",{staticClass:"col-md-12 col-lg-12"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v("Description:")]),t._v(" "+t._s(t.PlanData[0].plan_description))])])])]),e("div",{staticClass:"plan-details"},[t._m(0),e("div",{staticClass:"lisitng"},[e("div",{staticClass:"table-responsive table-fix-header"},[null!=t.PlanData[0].is_rate_applicable_on_plan?e("table",{staticClass:"table table-bordered mt-0"},[t._m(1),e("tbody",[e("tr",[e("td",[t._v(t._s(t.PlanData[0].plan_name))]),e("td",{staticClass:"text-center"},[t._v(t._s(t.PlanData[0].total_units))]),e("td",{staticClass:"text-center"},[t._v(t._s(t.PlanData[0].symbol)+" "+t._s(t.PlanData[0].rate))]),e("td",{staticClass:"text-right pr-4"},[t._v(t._s(t.PlanData[0].symbol)+" "+t._s((t.PlanData[0].total_units*t.PlanData[0].rate).toFixed(2)))])])])]):e("table",{staticClass:"table table-bordered mt-0"},[t._m(2),e("tbody",t._l(t.PlanData,(function(a,i){return e("tr",{key:i},[e("td",[t._v(t._s(a.service_name))]),e("td",{staticClass:"text-center"},[t._v(t._s(a.total_units))]),e("td",{staticClass:"text-center"},[t._v(t._s(t.$n(a.rate,"currency",t.$getLocaleByCurrency(t.CurrencyCode))))]),e("td",{staticClass:"text-right pr-4 font-weight-medium"},[t._v(t._s(t.$n((a.total_units*a.rate).toFixed(2),"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])])})),0)]),e("table",{staticClass:"table table-bordered mt-0 float-right w-50 border"},[e("tbody",[e("tr",[e("td",{staticClass:"font-weight-medium bg-light"},[t._v("Sub Total")]),e("td",{staticClass:"font-weight-medium bg-light text-right pr-4"},[t._v(t._s(t.$n(t.SubTolal.toFixed(2),"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])]),t._l(t.DiscountData,(function(a,i){return e("tr",{key:i},[e("td",{staticClass:"font-14"},[t._v(t._s(a.name)),"percentage"==a.discount_type.toLowerCase()?e("span",[t._v("("+t._s(t.$n(a.discount_amount,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+"%)")]):t._e()]),e("td",{staticClass:"text-right pr-4 font-14"},[t._v("- "+t._s(t.$n(a.total_discount_amount,"currency",t.$getLocaleByCurrency(t.CurrencyCode))))])])})),e("tr",[e("td",{staticClass:"font-weight-medium bg-light"},[t._v("Total Discount")]),e("td",{staticClass:"font-weight-medium bg-light text-right pr-4"},[t._v("- "+t._s(t.$n(t.TotalDiscount,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])]),e("tr",[e("td",{staticClass:"font-weight-medium bg-light-custom"},[t._v("After Discount Total")]),e("td",{staticClass:"font-weight-medium bg-light-custom text-right pr-4"},[t._v(" "+t._s(t.$n(t.AfterDiscountAmount.toFixed(2),"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])]),t._l(t.TaxData,(function(a,i){return e("tr",{key:i},[e("td",{staticClass:"font-14"},[t._v(t._s(a.name)),"percentage"==a.discount_type.toLowerCase()?e("span",[t._v("("+t._s(t.$n(a.discount_amount,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+"%)")]):t._e()]),e("td",{staticClass:"text-right pr-4 font-14"},[t._v("+ "+t._s(t.$n(a.total_discount_amount,"currency",t.$getLocaleByCurrency(t.CurrencyCode))))])])})),e("tr",[e("td",{staticClass:"font-weight-medium bg-light"},[t._v("Total Tax")]),e("td",{staticClass:"font-weight-medium bg-light text-right pr-4"},[t._v(" +"+t._s(t.$n(t.TotalTax,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])]),e("tr",[e("td",{staticClass:"font-weight-medium bg-light-custom"},[t._v("Grand Total")]),e("td",{staticClass:"font-weight-medium bg-light-custom text-right pr-4"},[t._v(" "+t._s(t.$n(t.Total.toFixed(2),"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])])],2)])])])])]):e("div",[e("p",{staticClass:"text-danger text-center"},[t._v("No record(s) found")])]),e("div",{staticClass:"row flex-row-reverse mt-2"},[e("div",{staticClass:"col-lg-6 text-right"},[e("div",{staticClass:"search-btm-btn"},[e("a",{staticClass:"btn btn-danger",attrs:{type:"button"},on:{click:function(e){return t.$emit("close")}}},[e("em",{staticClass:"fa fa-close pr-2"}),t._v(t._s(t.$t("Close")))])])])])])])])])],1)])},be=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 float-left mb-2 p-0"},[e("div",{staticClass:"heading-border"},[e("h5",{staticClass:"h5"},[e("span",{attrs:{id:"SProjectDetailTitleSpan"}},[t._v("Plan Detail")])])])])},function(){var t=this,e=t._self._c;return e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",[t._v("Plan")]),e("th",{staticClass:"text-center"},[t._v("Quantity")]),e("th",{staticClass:"text-center"},[t._v("Unit Price")]),e("th",{staticClass:"text-right pr-4"},[e("strong",[t._v("Total Price")])])])])},function(){var t=this,e=t._self._c;return e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",[t._v("Services")]),e("th",{staticClass:"text-center"},[t._v("Quantity")]),e("th",{staticClass:"text-center"},[t._v("Unit Price")]),e("th",{staticClass:"text-right pr-4"},[t._v("Total Price")])])])}],Se={props:{PlanId:{type:Number,required:!0},ClientId:{type:Number,required:!0},PlanMappingId:{type:Number,required:!0}},data(){return{isLoading:!1,PlanData:[],TaxData:[],DiscountData:[],SubTolal:0,AfterDiscountAmount:0,TotalDiscount:0,TotalTax:0,Total:0,CurrencyCode:"PKR"}},async created(){var t=this;await t.FetchData(),t.CurrencyCode=t.GetUserInfo.Currency.replace(/[()]/g,"")},methods:{async FetchData(){var t=this;t.isLoading=!0;var e=`planId=${t.PlanId}&clientId=${t.ClientId}&planMappingId=${t.PlanMappingId}`;await n["a"].GetSubscribedPlanDetails(e).then(e=>{if("Success"===e.data.status&&"1"===e.data.code){if(e.data.result.plan_data.length>0?(t.PlanData=e.data.result.plan_data,t.PlanData.forEach(e=>{e&&(t.SubTolal=t.SubTolal+e.total_units*e.rate)})):t.PlanData=[],e.data.result.discount_data.length>0){t.DiscountData=e.data.result.discount_data;var a=0,i=0;t.DiscountData.forEach(e=>{"percentage"==e.discount_type.toLowerCase()?(e.total_discount_amount=t.SubTolal*e.discount_amount/100,i+=t.SubTolal*e.discount_amount/100,t.AfterDiscountAmount=t.SubTolal-e.total_discount_amount):(a+=e.discount_amount,t.AfterDiscountAmount=t.AfterDiscountAmount-a)}),t.TotalDiscount=i+a}else t.DiscountData=[],t.AfterDiscountAmount=t.SubTolal;if(e.data.result.tax_data.length>0){t.TaxData=e.data.result.tax_data;a=0,i=0;t.TaxData.forEach(e=>{"percentage"==e.discount_type.toLowerCase()?(e.total_discount_amount=t.AfterDiscountAmount*e.discount_amount/100,i+=t.AfterDiscountAmount*e.discount_amount/100):a+=e.discount_amount,t.TotalTax=i+a})}else t.TaxData=[];t.Total=t.SubTolal+t.TotalTax-t.TotalDiscount}t.isLoading=!1}).catch(e=>{console.log(e),t.isLoading=!1})}}},Ae=Se,De=(a("7821"),Object(d["a"])(Ae,ye,be,!1,null,null,null)),Ie=De.exports,Te=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("Receipt")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:function(e){return t.$emit("close")}}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("InvoiceTemplate",{attrs:{details:t.templateDetails,hitFrom:"SubscriptionList"},on:{backtoSubscriptionList:t.backtoSubscriptionList}})],1)])])])],1)])},Le=[],Ee={components:{InvoiceTemplate:Gt["a"]},props:{templateDetails:{type:Array,required:!0}},created(){console.log(this.templateDetails)},methods:{backtoSubscriptionList(){this.$emit("FetchData")}}},xe=Ee,Ne=Object(d["a"])(xe,Te,Le,!1,null,null,null),Pe=Ne.exports,we=a("04e7"),Re=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("ViewPlanRequestedHistory")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:function(e){return t.$emit("close")}}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("tg-list",{attrs:{IsShowAction:!1,showCheckBox:!1,ModuleName:"Billing",listType:["List"],RenderRowActionMethod:t.renderActions,SubModuleCode:"Billing",IdentityColumn:"id",ListData:t.PlanHistory,HeaderData:t.Headers,callbackfunction:t.FetchData,HeaderButtons:"",TotalRecords:t.TotalRecords,ListDataCallBackFunction:t.FetchData,SortExp:t.sortExp,SortBy:t.sortBy,NorecordfoundText:t.$t("NoRecordfound"),isShowHeaderText:!1,HeaderText:t.$t("ViewPlanRequestedHistory")},on:{LeftsearchButtonClick:function(t){},PagerButtonClick:t.pagerMethod,ActionButtonClick:t.actionButtonClick,HeaderButtonClick:t.commonHeaderButtonClick,SortdataButtonClick:t.sortdata},scopedSlots:t._u([{key:"slotdata",fn:function({data:a}){return["request_date"===a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(t.$options.filters.formatDate(a.row.request_date))+" ")])]:t._e(),"applicable_from"===a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(t.$options.filters.formatDate(a.row.applicable_from))+" ")])]:t._e()]}}])})],1)])])])],1)])},Me=[],$e={props:{PlanMappingId:{type:Number,required:!0}},data(){return{isLoading:!1,PlanHistory:[],TotalRecords:0,sortBy:"",sortExp:"",Headers:[{COLUMN_NAME:"request_date",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Request Date",DISPLAY_ORDER:2,settings:{isInSlot:!0}},{COLUMN_NAME:"upcoming_frequency",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Upcoming Frequency",DISPLAY_ORDER:3},{COLUMN_NAME:"billing_amount",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Billing Amount",DISPLAY_ORDER:4},{COLUMN_NAME:"applicable_from",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Applicable From",DISPLAY_ORDER:5,settings:{isInSlot:!0}},{COLUMN_NAME:"requested_by",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Requested By",DISPLAY_ORDER:6}]}},async created(){var t=this;await t.FetchData()},methods:{async FetchData(){var t=this;try{var e="planMappingId="+t.PlanMappingId;const s=await n["a"].GetPlanReuestedSubscription(e);if("Success"===s.data.status&&"1"===s.data.code){var a,i;if(s.data.result.length>0)t.TotalRecords=null===(a=s.data.result)||void 0===a?void 0:a.TotalRecords,t.isRateApplicableOnPlan=null===(i=s.data.result)||void 0===i?void 0:i.is_rate_applicable_on_plan;t.PlanHistory=s.data.result}else t.PlanHistory=[],t.TotalRecords=0}catch(s){console.log("Error loading plan history:",s)}},renderActions(){},pagerMethod(){},actionButtonClick(){},commonHeaderButtonClick(){},sortdata(){}}},Fe=$e,ke=Object(d["a"])(Fe,Re,Me,!1,null,null,null),Oe=ke.exports,Be=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h4",{staticClass:"modal-title"},[t._v("Plan Details")]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:function(e){return t.$emit("close")}}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("div",[e("div",{staticClass:"col-md-12 p-0"},[e("div",{staticClass:"tab-content"},[e("div",{staticClass:"tab-pane call-detail fade p-0 active show border pb-3"},[e("div",{staticClass:"container-fluid"},[e("div",{staticClass:"w-100 float-left mt-2"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col"},[t._m(0),e("div",{staticClass:"row d-none"},[e("div",{staticClass:"col-md-12"},[e("div",{staticClass:"border text-center text-danger no-record mt-4 p-2"},[t._v(" "+t._s(t.$t("No_Record_Found"))+" ")])])])])]),e("div",{staticClass:"card mb-3 probx"},[e("div",{staticClass:"card-body"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-4 col-lg-3"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v(t._s(t.$t("UtilityType"))+": ")]),"UTILITY_BILLING"==t.planDetail[0].PLAN_CODE?e("span",[t._v("Utility Billing")]):"SUBSCRIPTION_BILLING"==t.planDetail[0].PLAN_CODE?e("span",[t._v("Subscription Billing")]):t._e()])])]),"SUBSCRIPTION_BILLING"!=t.planDetail[0].PLAN_CODE?e("div",{staticClass:"col-md-4 col-lg-3"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v(t._s(t.$t("MeterType"))+": ")]),t._v(" "+t._s(t.planDetail[0].METER_TYPE))])])]):t._e(),"SUBSCRIPTION_BILLING"!=t.planDetail[0].PLAN_CODE?e("div",{staticClass:"col-md-4 col-lg-3"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v(t._s(t.$t("CustomerType"))+": ")]),t._v(" "+t._s(t.planDetail[0].CUSTOMER_SEGMENT))])])]):t._e(),e("div",{staticClass:"col-md-4 col-lg-3"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v(t._s(t.$t("PlanType"))+": ")]),"1"==t.planDetail[0].IS_FOR_PLAN?e("span",[t._v(" Prepaid ")]):t._e(),"2"==t.planDetail[0].IS_FOR_PLAN?e("span",[t._v(" Postpaid ")]):t._e()])])]),e("div",{staticClass:"col-md-4 col-lg-3"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v(t._s(t.$t("Status"))+": ")]),e("span",{class:t.getStatusClassList(t.planDetail[0].STATUS_NAME,"STATUS_NAME"),staticStyle:{float:"right"}},[t._v(" "+t._s(t.planDetail[0].STATUS_NAME)+" ")])])])]),e("div",{staticClass:"col-md-4 col-lg-3"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v(t._s(t.$t("PlanName"))+": ")]),t._v(" "+t._s(t.planDetail[0].PLAN_NAME)+" ")])])]),e("div",{staticClass:"col-md-4 col-lg-3"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v(t._s(t.$t("BillingFrequency"))+": ")]),t._v(" "),"One Time"==t.planDetail[0].PAYMENT_TYPE?e("span",[t._v("One Time")]):e("span",[t._v(t._s(t.planDetail[0].PAYMENT_TYPE))])])])]),t.parsedFrequencies.length?e("div",{staticClass:"col-md-4 col-lg-3"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v(t._s(t.$t("Additional Frequency with Discount"))+":")])]),e("span",[t._v(" "+t._s(t.frequencyLabels.join(", "))+" ")])])]):t._e(),e("div",{staticClass:"col-md-4 col-lg-3"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v(t._s(t.$t("InvoiceTemplate"))+": ")]),t._v(" "+t._s(t.planDetail[0].INVOICE_TEMPLATE))])])]),e("div",{staticClass:"col-md-4 col-lg-3"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v(t._s(t.$t("EffectiveDate"))+":")]),t._v(" "+t._s(null!=t.planDetail[0].EFFECTIVE_DATE?t.$d(t.planDetail[0].EFFECTIVE_DATE):""))])])]),e("div",{staticClass:"col-md-4 col-lg-3"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v(t._s(t.$t("ExpirationDate"))+":")]),t._v(" "+t._s(null!=t.planDetail[0].EXPIRATION_DATE?t.$d(t.planDetail[0].EXPIRATION_DATE):""))])])]),e("div",{staticClass:"col-md-4 col-lg-3"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v(t._s(t.$t("DESCRIPTION"))+":")]),t._v(" "+t._s(t.planDetail[0].PLAN_DESCRIPTION))])])]),t.planDetail[0].no_of_plan?e("div",{staticClass:"col-md-4 col-lg-3"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v(t._s(t.$t("Days"))+":")]),t._v(" "+t._s(t.planDetail[0].no_of_plan))])])]):t._e()])])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col"},[e("div",{staticClass:"col-lg-12 float-left mt-3 mb-3 p-0"},[e("div",{staticClass:"float-left col-12 p-0"},[e("h5",{staticClass:"h5 heading-border"},[e("span",[t._v(t._s(t.$t("Service")))])])])]),e("div",{staticClass:"row d-none"},[e("div",{staticClass:"col-md-12"},[e("div",{staticClass:"border text-center text-danger no-record mt-4 p-2"},[t._v(" "+t._s(t.$t("No_Record_Found"))+" ")])])])])]),e("div",{staticClass:"listing mt-2"},[e("div",{staticClass:"table-responsive table-fix-header"},[e("table",{staticClass:"table table-bordered mt-0"},[e("thead",{staticClass:"thead-bg"},[e("tr",t._l(t.Headers,(function(a){return t.shouldHideColumn(a)?t._e():e("th",{key:a.COLUMN_NAME},[t._v(" "+t._s(a.DISPLAY_NAME)+" ")])})),0)]),e("tbody",[t._l(t.ServicePlanListing,(function(a){return[e("tr",[e("td",[t._v(t._s(a.service_name))]),e("td",[t._v(t._s(a.service_code))]),"SUBSCRIPTION_BILLING"!=t.planCode?e("td",[t._v(" "+t._s(a.usage_measurement)+" ")]):t._e(),"SUBSCRIPTION_BILLING"!=t.planCode?e("td",[t._v(" "+t._s(a.payment_type))]):t._e(),"SUBSCRIPTION_BILLING"!=t.planCode?e("td",[null!=a.RuleDetails?e("span",[t._v(t._s(a.RuleDetails[0].billing_config_name)+" ")]):e("span",[t._v(" --")])]):t._e(),"SUBSCRIPTION_BILLING"!=t.planCode?e("td",[t._v(" "+t._s(t.formatCondition(a.Condition)))]):t._e()]),1==a.isRuleView?e("tr",[e("td",{attrs:{colspan:t.Headers.length+2}},[e("div",{staticClass:"listing"},[e("div",{staticClass:"table-responsive table-fix-header"},[e("table",{staticClass:"table table-bordered mt-0"},[e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",[t._v(t._s(t.$t("Rule_Name")))]),e("th",[t._v(t._s(t.$t("PRODUCT_TYPE_DESC")))]),e("th",[t._v(t._s(t.$t("EfficativeDateFrom")))]),e("th",[t._v(t._s(t.$t("EfficativeDateTo")))]),e("th",[t._v(t._s(t.$t("ServiceName")))]),e("th",[t._v(t._s(t.$t("payment_type")))]),e("th",[t._v(t._s(t.$t("Created_by_Id")))]),e("th",[t._v(t._s(t.$t("CREATED_ON")))]),e("th",[t._v(t._s(t.$t("Action")))])])]),e("tbody",[t._l(a.RuleDetails,(function(a,i){return e("tr",{key:i},[e("td",[t._v(t._s(a.billing_config_name))]),e("td",[t._v(t._s(a.description))]),e("td",[t._v(t._s(t.$options.filters.formatDate(a.efficative_date_from))+" ")]),e("td",[t._v(t._s(t.$options.filters.formatDate(a.efficative_date_to))+" ")]),e("td",[t._v(t._s(a.service_name))]),e("td",[t._v(t._s(a.payment_type))]),e("td",[t._v(t._s(a.created_by))]),e("td",[t._v(t._s(t.$options.filters.formatDate(a.created_at)))]),e("td",{staticClass:"single-action text-center",staticStyle:{width:"150px"}},[e("a",{staticClass:"actions-onclick",attrs:{href:"javascript:;"},on:{click:function(e){return t.ViewRuleData(a)}}},[e("em",{staticClass:"fa fa-eye text-info action-icon"})]),e("a",{staticClass:"actions-onclick",attrs:{href:"javascript:;"},on:{click:function(e){return t.DeleteRuleData(a.id)}}},[e("em",{staticClass:"fa fa-trash-o text-danger action-icon"})])])])})),0==a.RuleDetails.length?e("tr",[e("td",{staticClass:"text-center text-danger",attrs:{colspan:"9"}},[t._v(" "+t._s(t.$t("NorecordfoundText")))])]):t._e()],2)])])])])]):t._e()]})),0==t.ServicePlanListing.length?e("tr",[e("td",{staticClass:"text-center text-danger",attrs:{colspan:t.Headers.length+2}},[t._v(" "+t._s(t.$t("NorecordfoundText")))])]):t._e()],2)])])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col"},[t._m(1),e("div",{staticClass:"row d-none"},[e("div",{staticClass:"col-md-12"},[e("div",{staticClass:"border text-center text-danger no-record mt-4 p-2"},[t._v(" "+t._s(t.$t("No_Record_Found"))+" ")])])])])]),e("tg-list",{ref:"tgList",attrs:{listType:["List"],IsShowAction:!1,showCheckBox:!1,ModuleName:"Plan",SubModuleCode:"Plan",IdentityColumn:"rate_schedule_id",HeaderText:"",ListData:t.ListingData,HeaderData:t.RHeaders,widgets:t.widgets,HeaderButtons:t.Buttons,TotalRecords:t.RTotalRecords,RenderRowActionMethod:!1,ListDataCallBackFunction:t.GetWorkCodeMappingList,SortExp:t.SortExp,SortBy:t.RSortBy,NorecordfoundText:t.$t("NoRecordfound"),SearchFields:t.leftSearchFields,LegendArray:t.LegendArray},on:{PagerButtonClick:t.pagerMethod,HeaderButtonClick:t.commonHeaderButtonClick,SortdataButtonClick:t.sortdata,LeftsearchButtonClick:t.leftCommonSearch,ActionButtonClick:t.actionButtonClick},scopedSlots:t._u([{key:"slotdata",fn:function({data:a}){return["status_name"==a.column.COLUMN_NAME?[e("a",{staticClass:"inactive-disabled"},[e("span",{staticClass:"text-center text-white d-block",style:{backgroundColor:a.row.status_bg_color}},[t._v(" "+t._s(t.$t(a.row.status_name))+" ")])])]:t._e(),"rate"==a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(null!=a.row.rate?parseFloat(a.row.rate).toFixed(2):"--")+" ")])]:t._e(),"created_at"==a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(t.$d(a.row.created_at))+" ")])]:t._e(),"start_date"==a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(null!=a.row.start_date?t.$d(a.row.start_date):"--")+" ")])]:t._e(),"end_date"==a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(null!=a.row.end_date?t.$d(a.row.end_date):"--")+" ")])]:t._e(),"modified_at"==a.column.COLUMN_NAME?[e("span",{staticClass:"text-center"},[t._v(" "+t._s(null!=a.row.modified_at?t.$d(a.row.modified_at):"--")+" ")])]:t._e(),"modified_by"==a.column.COLUMN_NAME?[e("span",{staticClass:"text-center"},[t._v(" "+t._s(null!=a.row.modified_by?a.row.modified_by:"--")+" ")])]:t._e(),"billing_code"==a.column.COLUMN_NAME?[e("span",{staticClass:"text-center"},[t._v(" "+t._s(""!=a.row.billing_code?a.row.billing_code:"--")+" ")])]:t._e()]}}])})],1)])])])])]),e("div",{staticClass:"row flex-row-reverse mt-2"},[e("div",{staticClass:"col-lg-6 text-right mt-3"},[e("div",{staticClass:"search-btm-btn"},[e("a",{staticClass:"btn btn-danger",attrs:{type:"button"},on:{click:function(e){return t.$emit("close")}}},[e("em",{staticClass:"fa fa-close pr-2"}),t._v(t._s(t.$t("Close"))+" ")])])])])])])])])],1)])},Ue=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"col-lg-12 float-left mt-3 mb-3 p-0"},[e("div",{staticClass:"float-left col-12 p-0"},[e("h5",{staticClass:"h5 heading-border"},[e("span",[t._v("Plan")])])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"col-lg-12 float-left mt-3 mb-3 p-0"},[e("div",{staticClass:"float-left col-12 p-0"},[e("h5",{staticClass:"h5 heading-border"},[e("span",[t._v("Rate")])])])])}],Ge={props:{PlanId:{type:Number,required:!0},ClientId:{type:Number,required:!0},PlanMappingId:{type:Number,required:!0}},data(){return{planDetail:[],noRecords:!1,IsRuleListing:!1,TotalRecords:0,serviceId:0,CurrentPage:1,PlanId:0,paymentType:"",isForService:!0,TotalPages:0,StatusListForListing:[{STATUS:"Active",STATUS_ID:1001,STATUS_COLOR:"#ffffff",STATUS_BG_COLOR:"#28a745"},{STATUS:"Inactive",STATUS_ID:1002,STATUS_COLOR:"#ffffff",STATUS_BG_COLOR:"#d72435"}],SortBy:"",SortExp:"",PageSize:"10",PageNumber:"1",GroupStart:1,GroupEnd:3,Headers:[{COLUMN_NAME:"service_name",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("ServiceName"),DISPLAY_ORDER:1},{COLUMN_NAME:"service_code",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("ServiceType"),DISPLAY_ORDER:2},{COLUMN_NAME:"usage_measurement",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("UsageMeasurement"),DISPLAY_ORDER:3},{COLUMN_NAME:"payment_type",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("BillingFrequency"),DISPLAY_ORDER:3},{COLUMN_NAME:"RuleDetails",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("BillingRuleName"),DISPLAY_ORDER:3},{COLUMN_NAME:"Condition",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("Condition"),DISPLAY_ORDER:4}],HeaderButtons:[{title:"Select Service",iconClass:"fa fa-plus",callbackfunction:"openExistingService",additionalClass:"",isdisabled:!1,isvisible:!0,checkPrivilege:!0,id:"ExistingService"},{title:"Create New",iconClass:"fa fa-plus",callbackfunction:"openCreateService",additionalClass:"",isdisabled:!1,isvisible:!0,checkPrivilege:!0,id:"CreateNew"},{title:"BacktoList",iconClass:"fa fa-angle-double-left",href:"/Plan/PlanListing",additionalClass:"",isdisabled:!1,isvisible:!0,checkPrivilege:!0,id:"BackToList"}],listActions:[{title:"View Rule",href:"javascript:void(0)",icon:"fa fa-eye text-success",callbackfunction:"ViewBillingRule",additionalSpan:""},{title:"Delete",href:"javascript:void(0)",icon:"fa fa-trash",isDisabled:!1,callbackfunction:"DeleteService",additionalSpan:""}],ServicePlanListing:[],isExistingService:!1,isCreateService:!1,planCode:"",serviceDetailForBillingRule:[],serviceDetailConditions:!1,serviceRuleItem:null,servicePlanId:null,isLoading:!1,isPaged:1,RTotalPages:0,widgets:[],LegendArray:[],ListingData:[],RTotalRecords:0,RSortBy:"",RlistActions:[{title:"Edit",href:"javascript:void(0)",callbackfunction:"EditRateCode",icon:"fa fa-pencil action-icon text-success",additionalSpan:""},{title:"Delete",href:"javascript:void(0)",callbackfunction:"DeleteRateCode",icon:"fa fa-trash-o action-icon text-danger",additionalSpan:""}],RHeaders:[{COLUMN_NAME:"work_code",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("RateCode"),DISPLAY_ORDER:1},{COLUMN_NAME:"comment",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("Comment"),DISPLAY_ORDER:2},{COLUMN_NAME:"billing_code",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("BillingCode"),DISPLAY_ORDER:3,settings:{isInSlot:!0}},{COLUMN_NAME:"rate",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("Rate"),DISPLAY_ORDER:3,settings:{isInSlot:!0}},{COLUMN_NAME:"status_name",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("HBStatus"),DISPLAY_ORDER:3,settings:{isInSlot:!0}},{COLUMN_NAME:"start_date",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("EventStartDate"),DISPLAY_ORDER:3,settings:{isInSlot:!0}},{COLUMN_NAME:"end_date",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("EndDate"),DISPLAY_ORDER:3,settings:{isInSlot:!0}},{COLUMN_NAME:"created_by",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("SACreatedBy"),DISPLAY_ORDER:3},{COLUMN_NAME:"created_at",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("SACreatedAt"),DISPLAY_ORDER:3,settings:{isInSlot:!0}},{COLUMN_NAME:"modified_by",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("modified_by"),DISPLAY_ORDER:3,settings:{isInSlot:!0}},{COLUMN_NAME:"modified_at",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("ModifiedAt"),DISPLAY_ORDER:3,settings:{isInSlot:!0}}],Buttons:[{title:"addrate",iconClass:"fa fa-plus pr-2 ",callbackfunction:"EditRateCode",additionalClass:"",isdisabled:!1,isvisible:!1}],IsAddRate:!1,RateObj:null}},async created(){var t=this;t.CurrencyCode=t.GetUserInfo.Currency.replace(/[()]/g,""),await t.displayPlanDetails(),await t.FetchRecords(),t.RHeaders.forEach(e=>{e.DISPLAY_NAME=t.$t(e.DISPLAY_NAME)}),t.GetWorkCodeMappingList()},computed:{parsedFrequencies(){try{var t;const e=null===(t=this.planDetail[0])||void 0===t?void 0:t.ADDITIONAL_FREQUENCY;if(!e)return[];const a=`[${e}]`;return JSON.parse(a)}catch(e){return console.error("Error parsing ADDITIONAL_FREQUENCY:",e),[]}},frequencyLabels(){return this.parsedFrequencies.map(t=>`${t.frequency} (${Number(t.discount)}%)`)}},methods:{async displayPlanDetails(){const t=this,e="planId="+t.PlanId;try{const a=await n["a"].displayPlanDetails(e);if("Success"===a.data.status){const e=JSON.parse(a.data.result).data;e.length>0&&(t.planDetail=e,t.planDetail.forEach(t=>{["EFFECTIVE_DATE","EXPIRATION_DATE"].forEach(e=>{t[e]&&(t[e]=new Date(t[e]))})}),t.paymentType=t.planDetail[0].PAYMENT_TYPE,t.planCode=t.planDetail[0].PLAN_CODE,console.log("vm.planCode",t.planCode),t.planDetail[0].CLIENT_COUNT>0&&(t.listActions[1].isDisabled=!0))}}catch(a){console.error("Error in displayPlanDetails:",a)}},getStatusClassList:function(t){var e="";switch(t){case"UnPublish":e="px-2 text-center bg-danger text-white d-block";break;case"Active":e="px-2 text-center bg-success text-white d-block";break;case"Published":e="px-2 bg-primary text-center text-white d-block";break;case"Draft":e="px-2 text-center bg-warning text-white d-block";break;case"Inactive":e="px-2 text-center bg-danger text-white d-block";break;default:e=""}return e},formatCondition(t){try{if(!t)return"--";let a=[];if(Array.isArray(t))for(const e of t)"object"===typeof e&&e.condition?a.push(e.condition):"string"===typeof e&&""!==e.trim()&&a.push(e.trim());else if("string"===typeof t)if(t.includes('"condition"'))try{const e=JSON.parse(t);if(Array.isArray(e))for(const t of e)"object"===typeof t&&t.condition?a.push(t.condition):"string"===typeof t&&""!==t.trim()&&a.push(t.trim());else e.condition&&a.push(e.condition)}catch(e){console.warn("JSON parse failed, using raw string"),a.push(t)}else a.push(t);else"object"===typeof t&&(t.condition?a.push(t.condition):a.push(String(t)));return a=a.map(t=>t.replace(/\(\s*([^()]+?)\s*\)/g,"$1").trim()).filter(t=>t&&"--"!==t),0===a.length?"--":a.join(" And ")}catch(a){return console.error("Error in formatCondition:",a),console.error("conditionData was:",t),"--"}},OpenRuleDetail:function(t){var e=this;e.$router.push({name:"ManageConfiguration",params:{id:t.configuration_id,serviceId:t.service_id}})},shouldHideColumn(t){return"SUBSCRIPTION_BILLING"===this.planCode&&("payment_type"===t.COLUMN_NAME||"RuleDetails"===t.COLUMN_NAME||"usage_measurement"===t.COLUMN_NAME)},saveServiceRules:function(t){var e={planServiceId:t.plan_service_id,configurationId:t.configuration_id,rules:[]};t.rules.forEach((function(t,a){var i={ruleId:0,ruleName:t.ruleName,conditionId:t.ruleCondition.conditionId,rateCodeId:t.ruleCondition.rateCode,isLeafChecked:t.ruleCondition.isLeafChecked,selectedflag:t.ruleCondition.selectedFlag.value,version:t.version};e.rules.push(i)})),n["a"].SaveServiceRules(JSON.stringify(e)).then((function(t){}))},MapBillingRule:function(t,e){var a=this;a.servicePlanId=t,a.serviceId=e,a.IsRuleListing=!0},addRuleCondition:function(t,e){this.serviceDetailConditions=!this.serviceDetailConditions,this.serviceRuleItem=t,this.serviceDetailForBillingRule=e},addMoreRule:function(t){t.rules.push({ruleDisplayOrder:t.rules.length+1,ruleName:"Rule "+(t.rules.length+1),version:t.rules.length+1,ruleCondition:{}})},FetchRecords:async function(){var t=this;t.ServicePlanListing=[];var e=`planId=${t.PlanId}&sortBy=${t.SortBy}&sortExp=${t.SortExp}&planCode=${t.planCode}&pagesize=${t.PageSize}&pagenumber=${t.PageNumber}`;await n["a"].GetPlanServiceListing(e).then((function(e){if(""!=e.data&&null!=e.data)if(t.Headers.forEach(t=>{t.settings=null,"service_name"==t.COLUMN_NAME&&(t.settings={isInSlot:!0}),"service_code"==t.COLUMN_NAME&&(t.settings={isInSlot:!0}),"usage_measurement"==t.COLUMN_NAME&&(t.settings={isInSlot:!0})}),e.data.result.data.length>0){let a=e.data.result.data;a.forEach((function(t){t.isRuleView=!1,t.rules=[]})),t.ServicePlanListing=a,t.TotalRecords=e.data.result.data[0].TOTALRECORDS,t.TotalPages=Math.ceil(t.TotalRecords/t.PageSize),t.CurrentPage=t.PageNumber,t.noRecord=!1,t.$emit("Bind-Plan-Details",t.PlanId)}else t.noRecord=!0,t.TotalRecords=0,t.ServicePlanListing=[];else t.noRecord=!0,t.TotalRecords=0,t.ServicePlanListing=[]}))},pagerMethod:function(t){this.PageSize=t.PageSize,this.PageNumber=t.PageNumber,this.FetchRecords(),this.GetWorkCodeMappingList()},sortdata:function(t){this.SortBy=t;var e="ASC";"ASC"==this.SortExp&&(e="DESC"),this.SortExp=e,this.SortBy=t,this.SortExp=e,this.PageNumber=1,this.GroupStart=this.PageNumber,this.GroupEnd=this.PageNumber+2,this.FetchRecords()},commonHeaderButtonClick:function(t){switch(t.callbackfunction){case"openExistingService":this.openExistingService();break;case"openCreateService":this.openCreateService();break}},openExistingService:function(){var t=this;t.isExistingService=!0},openCreateService:function(){var t=this;t.isCreateService=!0},renderActions:function(t){var e=this;let a=[];return e.listActions.forEach(t=>{let e={...t};switch(e.title){case"Delete":e.isVisible=!0;break;case"Map Rule":e.isVisible=!0;break;default:e.isVisible=!0}a.push(e)}),a},ViewBillingRule:function(t){t.RuleDetails&&0!==t.RuleDetails.length||(t.RuleDetails=[]),"isRuleView"in t?t.isRuleView=!t.isRuleView:this.$set(t,"isRuleView",!0)},DeleteServiceData:function(t){var e=this,a=t;a>0?e.confirmR(e.$t("ConfirmDelete"),!0,e.$t("Delete")+"  "+e.$t("Service"),(function(){var t={ids:a,moduleName:"BILLING",refCode:"TALYGEN_PLAN_SERVICE"},i=JSON.stringify(t);n["a"].CommonCommonDelete(i).then(t=>{200==t.status?(e.FetchRecords(),e.ShowAlert(e.$t("DeletedSuccess",[e.$t("Service")]),"Success",!0,e.$t("Alert")),e.$emit("Bind-Plan-Details",e.PlanId)):e.ShowAlert(e.$t("DeletedError",[e.$t("Service")]),"failure",!0,e.$t("Alert"))})})):e.ShowAlert(e.$t("Selectanyrecordtodelete"),"warning",!0,e.$t("Alert"))},DeleteRuleData(t){var e=this,a=t;a>0?e.confirmR(e.$t("ConfirmDelete"),!0,e.$t("Delete")+"  "+e.$t("Rule"),(function(){var t={ids:a,moduleName:"BILLING",refCode:"TALYGEN_BE_RULE_PLAN_SERVICE_MAPPING"},i=JSON.stringify(t);n["a"].CommonCommonDelete(i).then(t=>{200==t.status?(e.FetchRecords(),e.ShowAlert(e.$t("DeletedSuccess",[e.$t("Rule")]),"Success",!0,e.$t("Alert"))):e.ShowAlert(e.$t("DeletedError",[e.$t("Rule")]),"failure",!0,e.$t("Alert"))})})):e.ShowAlert(e.$t("Selectanyrecordtodelete"),"warning",!0,e.$t("Alert"))},ViewRuleData(t){var e=this;e.$router.push({name:"ManageConfiguration",params:{id:t.configuration_id}})},leftCommonSearch(){},actionButtonClick:function(t,e){switch(t){case"EditRateCode":this.EditRateCode(e);break;case"DeleteRateCode":this.commonDeleteData(e.rate_schedule_id);break}},GetWorkCodeMappingList(){var t=this;t.isLoading=!0;var e=`Planid=${t.PlanId}&pageSize=${t.PageSize}&pageNum=${t.PageNumber}&sortBy=${t.RSortBy}&sortExp=${t.SortExp}&Clientid=`;n["a"].GetWorkCodeMappingList(e).then(e=>{t.isLoading=!1,e.data.result.DATA.length>0?(t.ListingData=e.data.result.DATA,t.ListingData.forEach(t=>{["start_date","end_date","created_at","modified_at"].forEach(e=>{t[e]&&(t[e]=new Date(t[e]))})}),t.RTotalRecords=e.data.result.DATA[0].TOTAL_RECORDS,t.RTotalPages=Math.ceil(t.RTotalRecords/t.PageSize)):(t.ListingData=[],t.RTotalRecords=0,t.RTotalPages=0)}).catch(()=>{t.isLoading=!1})},EditRateCode(t){var e=this;e.RateObj=t,e.IsAddRate=!0,e.GetWorkCodeMappingList()},CloseRateCode(){var t=this;t.IsAddRate=!1,t.GetWorkCodeMappingList()},commonDeleteData:function(t){var e=this,a=t;null!=a?e.confirmR(e.$t("ConfirmDelete"),!0,e.$t("Delete")+"  "+e.$t("RateCode"),(async function(){var t={ids:a,moduleName:"RateCode",subModuleCode:"RateCode",refCode:"PLAN_RATE_CODE"},i=JSON.stringify(t);n["a"].CommonCommonDelete(i).then((async function(t){200==t.status?(e.ShowAlert(e.$t("DeletedSuccess",[e.$t("RateCode")]),"success",!0,e.$t("Alert")),e.GetWorkCodeMappingList()):e.ShowAlert(e.$t("DeletedError",[e.$t("RateCode")]),"failure",!0,e.$t("Alert"))}))})):e.ShowAlert(e.$t("Selectanyrecordtodelete"))}}},Ye=Ge,Ve=(a("248d"),Object(d["a"])(Ye,Be,Ue,!1,null,null,null)),He=Ve.exports,je={name:"PlanListing",components:{PlanContainer:me,PlanDetails:ce,PlanHistory:Ce,modalViewPlan:Ie,viewReceipt:Pe,AddComment:we["a"],PlanRequest:Oe,ModalViewPlanDetails:He},props:{UserId:{type:Number},ClientData:{type:Object}},data(){return{Headers:[{COLUMN_NAME:"plan_image_url",DATA_TYPE:"image",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Image",DISPLAY_ORDER:1},{COLUMN_NAME:"plan_name",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Plan Name",DISPLAY_ORDER:2},{COLUMN_NAME:"plan_type",DATA_TYPE:"image",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Plan Type",DISPLAY_ORDER:3},{COLUMN_NAME:"billing_frequency",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Frequency",DISPLAY_ORDER:4},{COLUMN_NAME:"plan_description",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Plan Description",DISPLAY_ORDER:5},{COLUMN_NAME:"IsProrated",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Pro Rate",DISPLAY_ORDER:5},{COLUMN_NAME:"total_units",DATA_TYPE:"int",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Total Number Of Quantity",DISPLAY_ORDER:6},{COLUMN_NAME:"BasePriceTotal",DATA_TYPE:"currency",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Plan Charges",DISPLAY_ORDER:7},{COLUMN_NAME:"one_time_charge",DATA_TYPE:"currency",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"One Time Charges",DISPLAY_ORDER:7},{COLUMN_NAME:"status_name",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Status",DISPLAY_ORDER:8},{COLUMN_NAME:"effective_date",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Effective Date",DISPLAY_ORDER:9},{COLUMN_NAME:"next_invoice_date",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Next Invoice Date",DISPLAY_ORDER:10}],listheaderbuttons:Et.buttons,listActions:[{title:"Edit",href:"javascript:void(0)",icon:"fa fa-pencil text-info action-icon",callbackfunction:"Edit",isDisabled:!1,additionalSpan:""},{title:"View Details",href:"javascript:void(0)",icon:"fa fa-eye",isDisabled:!1,callbackfunction:"viewDetails",additionalSpan:""},{title:"View History",href:"javascript:void(0)",icon:"fa fa-eye",isDisabled:!1,callbackfunction:"viewHistory",additionalSpan:""},{title:"Manage discount",href:"javascript:void(0)",icon:"fa fa-pencil text-success action-icon",isDisabled:!1,callbackfunction:"manageDiscount",additionalSpan:""},{title:"De-Activated",href:"javascript:void(0)",icon:"fa fa-times text-danger action-icon",isDisabled:!1,callbackfunction:"deAssociate",additionalSpan:""},{title:"Print Invoice",href:"javascript:void(0)",icon:"fas fa-file-invoice text-info action-icon",callbackfunction:"printInvoice",additionalSpan:""},{title:"Generate Invoice",href:"javascript:void(0)",icon:"fas fa-file-invoice text-info action-icon",isDisabled:!1,callbackfunction:"Generatenvoice",additionalSpan:""},{title:"Receipt",href:"javascript:void(0)",icon:"fas fa-file-invoice text-info action-icon",isDisabled:!1,callbackfunction:"Receipt",additionalSpan:""},{title:"Frequency Change History",href:"javascript:void(0)",icon:"fas fa-exchange-alt text-primary action-icon",isDisabled:!1,callbackfunction:"PlanChangeRequest",additionalSpan:""}],list:[],TotalRecords:0,pageSize:10,pageNum:1,sortBy:"",searchCondition:"",GroupStart:1,GroupEnd:3,PlanId:0,CurrentPage:1,TotalPages:0,sortExp:"",PlanListing:[],noRecords:!1,isPlanContainer:!1,isPlanListing:!0,isPlanDetails:!1,PlanList:[],plandetails:[],isPlanHistory:!1,PlanMappingId:0,isViewPlan:!1,selectedDiscounts:[],selectedTaxes:[],templateDetails:{},isInvoice:!1,IsComment:!1,MappingId:"",type:"Client",CurrencyCode:"PKR",planNamesStr:"",CompanyId:"",SelectedDate:"",isPlanRequest:!1,IsSubscriptionBilling:!1,IsUtilityBilling:!1,FeatureCode:null,isViewPlanDetailsUtilityCase:!1}},async created(){var t=this;t.CompanyId=t.GetUserInfo.CompanyId,await t.CheckExtraFeatures(),await t.FetchData(),t.CurrencyCode=t.GetUserInfo.Currency.replace(/[()]/g,"")},methods:{async CheckExtraFeatures(){var t=this;const e="featureCode=GET_EXTRA_FEATURE_BILLING&outputType=list";try{const a=await n["a"].CheckExtraFeatures(e);if(a.data){const e=JSON.parse(a.data);e.forEach(e=>{"SUBSCRIPTION_BILLING"===e.FEATURE_CODE&&(t.IsSubscriptionBilling=!0,t.FeatureCode=e.FEATURE_CODE),"UTILITY_BILLING"===e.FEATURE_CODE&&(t.IsUtilityBilling=!0,t.FeatureCode=e.FEATURE_CODE,t.listheaderbuttons[0].isvisible=!1)})}}catch(a){console.log("Error checking extra features:",a)}},async FetchData(){var t=this;t.PlanListing=[];var e=`clientId=${this.UserId}&pageSize=${t.pageSize}&pageNum=${t.pageNum}&sortBy=${t.sortBy}&sortExp=${t.sortExp}&search=${t.searchCondition}`;await n["a"].GetPlanMappingListForSubscriptionPlan(e).then((function(e){if(""!=e.data&&null!=e.data)if(e.data.result.data.length>0){for(var a in t.PlanListing=e.data.result.data,t.PlanListing.forEach(e=>{console.log(e),"One Time"==e.frequency&&(e.next_invoice_date=""),"UTILITY_BILLING"==e.plan_code&&(t.Headers.forEach(t=>{t.settings=null,"total_units"==t.COLUMN_NAME&&(t.VISIBLE=!1),"BasePriceTotal"==t.COLUMN_NAME&&(t.VISIBLE=!1),"IsProrated"==t.COLUMN_NAME&&(t.VISIBLE=!1),"one_time_charge"==t.COLUMN_NAME&&(t.VISIBLE=!1)}),t.listheaderbuttons[0].isvisible=!1)}),t.PlanListing)t.PlanListing[a].isCheckBoxDisabled=!1,"Inactive"==t.PlanListing[a].status_name||"Cancelled"==t.PlanListing[a].status_name?t.PlanListing[a].isCheckBoxDisabled=!0:t.PlanListing[a].isCheckBoxDisabled=!1;t.Headers.forEach(t=>{t.settings=null,"effective_date"==t.COLUMN_NAME&&(t.settings={isInSlot:!0}),"status_name"==t.COLUMN_NAME&&(t.settings={isInSlot:!0}),"plan_name"==t.COLUMN_NAME&&(t.settings={isInSlot:!0}),"BasePriceTotal"==t.COLUMN_NAME&&(t.settings={isInSlot:!0}),"one_time_charge"==t.COLUMN_NAME&&(t.settings={isInSlot:!0}),"total_units"==t.COLUMN_NAME&&(t.settings={isInSlot:!0}),"plan_image_url"==t.COLUMN_NAME&&(t.settings={isInSlot:!0}),"next_invoice_date"==t.COLUMN_NAME&&(t.settings={isInSlot:!0})}),t.TotalRecords=e.data.result.data[0].TOTALRECORDS,t.TotalPages=Math.ceil(t.TotalRecords/t.pageSize),t.CurrentPage=t.pageNum,t.listheaderbuttons[1].isdisabled=!0,t.noRecord=!1}else t.noRecord=!0,t.TotalRecords=0,t.PlanListing=[];else t.noRecord=!0,t.TotalRecords=0,t.PlanListing=[]}))},getStatusClassList:function(t){let e="";switch(t){case"Active":e="px-2 text-center text-white d-block bg-success";break;case"Pending Activation":e="px-2 text-center text-dark d-block bg-warning";break;case"Past Due":e="px-2 text-center bg-warning text-white d-block";break;case"Paused":e="px-2 text-center text-white d-block bg-danger";break;case"Grace-Period":e="px-2 text-center text-white d-block bg-secondary";break;case"Suspended":e="px-2 bg-primary text-center text-white d-block";break;case"Cancelled":e="px-2 text-center text-white d-block bg-danger";break;case"Churned":e="px-2 bg-secondary text-center text-white d-block";break;default:e="px-2 text-center text-white d-block bg-danger"}return e},OpenPlanDetail(t){var e=this;e.viewDetails(t)},commonHeaderButtonClick(t){switch(t.callbackfunction){case"AssociatePlan":this.AssociatePlan();break;case"ChangeStatus":this.ChangeStatusModal();break;case"BackToList":this.BackToList();break}},ChangeStatusModal:function(t){var e=this,a="";if(e.isLoading=!0,null==t?$(".chkItems:checkbox:checked").not("[id^='chkAll_0']").each((function(){a.length>0&&(a+=","),a+=$(this).val()})):a=t,null!=a){e.MappingId=a;var i=e.MappingId.split(",").map(t=>parseInt(t.trim()));e.planNamesStr=e.PlanListing.filter(t=>i.includes(t.CLIENT_PLAN_MAPPING_ID)).map(t=>t.plan_name).join(", "),e.IsComment=!0}else e.ShowAlert(e.$t("Selectanyrecordtodelete"));e.isLoading=!1},renderActions(t){var e=this;let a=[];return e.listActions.forEach(i=>{let s={...i};switch(s.title){case"Edit":1002==t.status_id||"One Time"==t.frequency||"Cancelled"==t.status_name?(s.isVisible=!1,s.isDisabled=!0,s.isVisible=!0):s.isVisible=!0;break;case"View Details":1002==t.status_id?(s.isVisible=!1,s.isDisabled=!0,s.isVisible=!1):s.isVisible=!1;break;case"View History":1002==t.status_id?(s.isVisible=!1,s.isDisabled=!0,s.isVisible=!0):s.isVisible=!0;break;case"Manage discount":1002==t.status_id||"Cancelled"==t.status_name?(s.isVisible=!1,s.isDisabled=!0,s.isVisible=!1):s.isVisible=!1;break;case"De-Activated":1002==t.status_id||"Cancelled"==t.status_name?(s.isVisible=!1,s.isDisabled=!0,s.isVisible=!0):s.isVisible=!0;break;case"Print Invoice":s.isVisible=!1;break;case"Generate Invoice":"UTILITY_BILLING"!==e.FeatureCode&&(1001!=t.status_id||158446!=e.CompanyId&&122872!=e.CompanyId&&158770!=e.CompanyId&&125897!=e.CompanyId)?s.isVisible=!1:(s.isVisible=!0,s.isDisabled=!1);break;case"Receipt":1002==t.status_id?(s.isVisible=!1,s.isDisabled=!0,s.isVisible=!0):s.isVisible=!0;break;case"Frequency Change History":"UTILITY_BILLING"!==e.FeatureCode?1002==t.status_id?(s.isVisible=!1,s.isDisabled=!0,s.isVisible=!0):(s.isVisible=!0,s.isDisabled=!1):(s.isVisible=!1,s.isDisabled=!0);break}a.push(s)}),a},actionButtonClick(t,e){var a=this;switch(t){case"Edit":a.edit(e);break;case"viewDetails":a.viewDetails(e);break;case"viewHistory":a.viewHistory(e);break;case"Manage discount":a.manageDiscount(e);break;case"deAssociate":a.deAssociate(e);break;case"printInvoice":a.printInvoice(e);break;case"Generatenvoice":a.Generatenvoice(e);break;case"Receipt":a.GetReceipt(e);break;case"PlanChangeRequest":a.PlanChangeRequest(e);break}},BackToList(){this.$router.push("/Client/Index")},AssociatePlan(){this.isPlanContainer=!0,this.isPlanListing=!1},sortdata(t){this.sortBy=t;var e="ASC";"ASC"==this.sortExp&&(e="DESC"),this.sortExp=e,this.sortBy=t,this.sortExp=e,this.pageNum=1,this.GroupStart=this.pageNum,this.GroupEnd=this.pageNum+2,this.FetchData()},getStatusClass:function(t){var e="";switch(t){case"Active":e="px-2 text-center bg-success text-white d-block";break;case"Inactive":e="px-2 text-center bg-danger text-white d-block";break;default:e=""}return e},async edit(t){this.isPlanContainer=!1,this.isPlanListing=!1,this.isPlanDetails=!0,this.flag="isEditingFromPlanListing",await this.LoadPlansMappingSubscription(t.plan_mapping_id)},async deAssociate(t){var e=this;e.confirmR(e.$t("DeAsscoiateKey"),!0,!1,(async function(a){if(void 0===a)try{var i={planIds:t.id,clientId:e.UserId,type:"DEASSOCIATE",PlanName:t.plan_name},s=JSON.stringify(i);const a=await n["a"].DeAsscoiate(s);200===a.status&&await e.FetchData()}catch(l){console.error("Failed to de-associate plans:",l),alert("Error occurred while de-associating plans")}}))},async LoadPlansMappingSubscription(t){try{this.selectedDiscounts=[],this.selectedTaxes=[];var e="plan_mapping_id="+t;const s=await n["a"].LoadPlansMappingSubscriptionById(e);if("Success"===s.data.status&&"1"===s.data.code){var a;const t=s.data.result;var i;if(t.forEach(t=>{t.services=t.services?JSON.parse(`[${t.services}]`):[],t.planrate=t.planrate?JSON.parse(`[${t.planrate}]`):[],t.timebased_discount=t.discount,t.BaseRate=t.BaseRate.toFixed(2)}),this.plandetails=t,console.log("this.plandetails",this.plandetails),null!=(null===(a=t[0])||void 0===a?void 0:a.tax_discount))null===(i=t[0])||void 0===i||i.tax_discount.map(t=>{let e={};"Discounts"==t.type?(e={ADJUSTMENT_ID:t.ADJUSTMENT_ID,ADJUSTMENT_NAME:t.ADJUSTMENT_NAME,ADJUSTMENT_PERCENTAGE:t.ADJUSTMENT_PERCENTAGE,DISCOUNT_TYPE:t.DISCOUNT_TYPE},this.selectedDiscounts.push(e)):"Tax"==t.type&&(e={ADJUSTMENT_ID:t.ADJUSTMENT_ID,ADJUSTMENT_NAME:t.ADJUSTMENT_NAME,ADJUSTMENT_PERCENTAGE:t.ADJUSTMENT_PERCENTAGE,DISCOUNT_TYPE:t.DISCOUNT_TYPE},this.selectedTaxes.push(e))})}}catch(s){console.error("Error loading plans:",s)}},calculateSavedAmount(t,e){let a=t-e;return a*=12,a.toFixed(2)},backToPlanListing(){this.isPlanContainer=!1,this.isPlanListing=!0,this.FetchData()},async viewDetails(t){var e=this;e.PlanId=t.id,e.PlanMappingId=t.plan_mapping_id,"UTILITY_BILLING"!==e.FeatureCode?e.isViewPlan=!0:e.isViewPlanDetailsUtilityCase=!0},async viewHistory(t){var e=this;e.PlanMappingId=t.plan_mapping_id,e.isPlanHistory=!0},async PlanChangeRequest(t){var e=this;e.PlanMappingId=t.plan_mapping_id,e.isPlanRequest=!0},pagerMethod(t){this.pageSize=t.PageSize,this.pageNum=t.PageNumber,this.FetchData()},async Generatenvoice(t){var e=this;this.selectedBilling=t.billing_frequency;const a={json:"",clientId:this.UserId,type:"Generate",billingCycle:this.selectedBilling,isForAddOrEdit:"no",SelectedDate:e.$options.filters.formatDateYear(t.next_invoice_date),PlanMappingId:t.CLIENT_PLAN_MAPPING_ID,Type:e.FeatureCode};try{const t=await n["a"].GenrateInvoice(a);if(200==t.status){const a=t.data.result.data;"Success"==t.data.status?a&&1==a[0].status_id?(e.ShowAlert(a[0].status_message,"success",!1,this.$t("Alert")),e.FetchData(),e.LoadPlansMappingSubscription()):this.ShowAlert(a[0].status_message,"failure",!0,this.$t("Alert")):this.ShowAlert(this.$t("SomethingWentWrong"),"failure",!0,this.$t("Alert"))}}catch(i){console.error("Error fetching invoice template:",i)}},async GetReceipt(t){var e=this;let a="clientPlanMappingId="+t.CLIENT_PLAN_MAPPING_ID;const i=await n["a"].getSubscribePlanDetails(a),s=i.data.result.data;void 0!=s&&1==s[0].status_id?(e.isInvoice=!0,e.templateDetails=s):(e.isInvoice=!1,e.ShowAlert(s[0].status_message,"failure",!0,this.$t("Alert")))}}},qe=je,ze=Object(d["a"])(qe,It,Tt,!1,null,null,null),We=ze.exports,Je=function(){var t=this,e=t._self._c;return t.isInvoice?e("section",[e("tg-list",{attrs:{IsShowAction:!0,showCheckBox:!0,ModuleName:"Billing",listType:["List"],RenderRowActionMethod:t.billRenderActions,SubModuleCode:"Billing",IdentityColumn:"id",HeaderText:"Invoices",ListData:t.BillListing,HeaderData:t.Headers,callbackfunction:t.FetchData,HeaderButtons:t.listheaderbuttons,TotalRecords:t.TotalRecords,SearchPosition:"top",SearchFields:t.topSearchFields,LegendArray:t.LegendArray,ListDataCallBackFunction:t.FetchData,SortExp:t.sortExp,SortBy:t.sortBy,NorecordfoundText:t.$t("NoRecordfound")},on:{ActionButtonClick:t.billActionButtonClick,LeftsearchButtonClick:t.leftCommonSearch,PagerButtonClick:t.pagerMethod,HeaderButtonClick:t.commonHeaderButtonClick,SortdataButtonClick:t.sortdata},scopedSlots:t._u([{key:"slotdata",fn:function({data:a}){return["CREATED_AT"==a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(t.$options.filters.formatDate(a.row.CREATED_AT))+" ")])]:t._e(),"BILL_DUE_DATE"==a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(t.$options.filters.formatDate(a.row.BILL_DUE_DATE))+" ")])]:t._e(),"BILL_NET_TOTAL"==a.column.COLUMN_NAME?[e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.openPaymentHistory(a)}}},[e("span",[t._v(" "+t._s(t.$n(a.row.BILL_NET_TOTAL,"currency",t.$getLocaleByCurrency(a.row.ISO_CODE))))])])]:t._e(),"STATUS_NAME"==a.column.COLUMN_NAME?[1!=a.row.IS_RECURRING&&"STOP"!=a.row.RECURRING_STATUS?e("span",[e("span",{class:t.getStatusClassList(a.row.STATUS_CODE,"STATUS_NAME")},[t._v(" "+t._s(a.row.STATUS_NAME)+" ")])]):e("span",{staticClass:"stop"},[t._v(t._s(t.$t("Stopped"))+" ")])]:t._e(),"BILL_NUMBER"==a.column.COLUMN_NAME?[e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.BillViewDetail(a.row)}}},[e("span",[t._v(" "+t._s(a.row.BILL_NUMBER)+" ")])])]:t._e()]}}],null,!1,422602378)}),e("transition",{attrs:{name:"modal"}},[e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),t.isPaymentHistory?e("div",{staticClass:"modal d-block dialog"},[e("div",{staticClass:"modal-dialog"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("PaymentHistory")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"card-body float-left p-0 col-12 float-left"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-6 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v(t._s(t.$t("BillNumber"))+":")]),t._v(" "+t._s(t.paymentHistoryData.MainInvoiceNumber))])])]),e("div",{staticClass:"col-md-6 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v(t._s(t.$t("IssueDate"))+":")]),t._v(" "+t._s(t.formatDateMonth(t.paymentHistoryData.MainInvoiceIssueDate)))])])]),e("div",{staticClass:"col-md-6 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v(t._s(t.$t("DueDate"))+":")]),t._v(" "+t._s(t.formatDateMonth(t.paymentHistoryData.MainInvoiceDueDate)))])])]),e("div",{staticClass:"col-md-6 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v("Advance (PKR):")]),0==t.paymentHistoryData.MainInvocieAdvacncedRecived?e("span",[t._v(t._s(t.$n(0,"currency",t.$getLocaleByCurrency(t.CurrencyCode))))]):t._e(),0!=t.paymentHistoryData.MainInvocieAdvacncedRecived?e("span",[t._v(" "+t._s(t.$n(t.paymentHistoryData.MainInvocieAdvacncedRecived,"currency",t.$getLocaleByCurrency(t.CurrencyCode))))]):t._e()])])]),e("div",{staticClass:"col-md-6 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v("Discount Flat Rate (PKR):")]),0==t.paymentHistoryData.MainInvoiceFlatDiscount?e("span",[t._v(t._s(t.$n(0,"currency",t.$getLocaleByCurrency(t.CurrencyCode))))]):t._e(),0!=t.paymentHistoryData.MainInvoiceFlatDiscount?e("span",[t._v(t._s(t.$n(t.paymentHistoryData.MainInvoiceFlatDiscount,"currency",t.$getLocaleByCurrency(t.CurrencyCode))))]):t._e()])])]),e("div",{staticClass:"col-md-6 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v("Amount (PKR):")]),0==t.paymentHistoryData.MainInvocieNetAmount?e("span",[t._v(" 0.00")]):t._e(),0!=t.paymentHistoryData.MainInvocieNetAmount?e("span",[t._v(t._s(t.$n(t.paymentHistoryData.MainInvocieNetAmount,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")]):t._e()])])])]),e("div",{staticClass:"listing"},[e("div",{staticClass:"table-responsive table-fix-header"},[e("table",{staticClass:"table-sorting table table-bordered my-0",attrs:{id:"maintable"}},[e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",{attrs:{width:"30%"}},[e("span",[t._v(t._s(t.$t("Notes")))])]),e("th",{attrs:{width:"20%"}},[e("span",[t._v(t._s(t.$t("PaymentDate")))])]),e("th",{staticClass:"text-right",attrs:{width:"20%"}},[e("span",[t._v(t._s(t.$t("Amount"))+" ("+t._s(t.paymentHistoryData.MainInvoiceCompanyIsoCode)+")")])]),e("th",{staticClass:"text-center",attrs:{width:"30%"}},[e("span",[t._v(t._s(t.$t("Action")))])])])]),e("tbody",[t.paymentList&&0!=t.paymentList.length?t.paymentList&&t.paymentList.length>0&&t.totalPayments<t.MainInvocieNetAmount?t._l(t.paymentList,(function(a,i){return e("tr",{key:i,staticClass:"myrow"},[e("td",[e("span",[t._v(t._s(a.MainNote))])]),e("td",[e("span",[t._v(t._s(t.formatDateMonth(a.PaymentDate)))])]),e("td",{staticClass:"text-right"},[e("span",[t._v(t._s(t.formatAmount(a.Amount)))])]),e("td",{staticClass:"text-center"})])})):t._e():e("tr",[e("td",{staticClass:"text-center text-danger",staticStyle:{"border-bottom":"1px solid #c6cace!important"},attrs:{colspan:"4"}},[t._v(" "+t._s(t.$t("NoPaymentFound"))+" ")])])],2),e("tfoot",[e("tr",[e("td"),e("td",{staticClass:"text-right"},[t._v(" "+t._s(t.$t("NetAmountPaid"))+": ")]),e("td",{staticClass:"text-right font-weight-bold"},[t._v(" "+t._s(t.$n(t.formatAmount(t.totalPaid),"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")]),e("td")]),e("tr",[e("td"),e("td",{staticClass:"text-right"},[t._v(" "+t._s(t.$t("OutStandingAmount"))+" ")]),e("td",{staticClass:"text-right font-weight-bold"},[e("span",{style:{color:t.outstandingAmount<0?"green":"red"}},[t._v(" "+t._s(t.$n(t.formatAmount(t.outstandingAmount),"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])]),e("td")])])])])])])]),e("div",{staticClass:"modal-footer"},[e("div",{staticClass:"col-lg-6 text-right p-0"},[e("a",{staticClass:"btn btn-danger formbtn text-white",attrs:{href:"javascript:;"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-close pr-2"}),t._v(t._s(t.$t("Cancel")))])])])])])]):t._e()],1)]),e("transition",{attrs:{name:"modal"}},[e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),t.isPayment?e("div",{staticClass:"modal d-block dialog"},[e("div",{staticClass:"modal-dialog"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("Payment")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.ClosePayment}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"card-body float-left p-0 col-12 float-left"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-4 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("BillNumber"))+": "+t._s(t.paymentDetailsData[0].BILL_NUMBER))])])]),e("div",{staticClass:"col-md-4 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("IssueDate"))+": "+t._s(t.formatDateM(t.paymentDetailsData[0].BILL_ISSUE_DATE)))])])]),e("div",{staticClass:"col-md-4 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("DueDate"))+": "+t._s(t.formatDateM(t.paymentDetailsData[0].BILL_DUE_DATE)))])])]),e("div",{staticClass:"col-md-4 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Total Amount ("+t._s(t.paymentDetailsData[0].ISO_CODE)+"): "),0==t.paymentDetailsData[0].BILL_NET_TOTAL?e("span",[t._v("0.00")]):t._e(),0!=t.paymentDetailsData[0].BILL_NET_TOTAL?e("span",[t._v(" "+t._s(t.$n(t.paymentDetailsData[0].BILL_NET_TOTAL,"currency",t.$getLocaleByCurrency(t.paymentDetailsData[0].ISO_CODE))))]):t._e()])])]),e("div",{staticClass:"col-md-4 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Paid Amount Till Now ("+t._s(t.paymentDetailsData[0].ISO_CODE)+"): "),t.paymentDetailsData[0].PAID>0?e("span",[t._v(t._s(t.$n(t.paymentDetailsData[0].PAID,"currency",t.$getLocaleByCurrency(t.paymentDetailsData[0].ISO_CODE))))]):e("span",[t._v("0.00")])])])]),e("div",{staticClass:"col-md-4 col-lg-4"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Payment Date:")]),e("span",[t._v(" "+t._s(t.paymentDate)+" ")])])]),e("div",{staticClass:"clearfix"}),t.paymentDetailsData[0].HAS_MULIPLE_TERMS?e("div",{staticClass:"listing mt-2 col-lg-12"},[e("div",{staticClass:"table-responsive table-fix-header"},[e("table",{staticClass:"table-sorting table table-bordered my-0",attrs:{id:"maintable"}},[e("thead",{staticClass:"thead-light"},[e("tr",[e("th",{attrs:{width:"25%"}},[e("span",[t._v(t._s(t.$t("Notes")))])]),e("th",{staticClass:"text-center",attrs:{width:"20%"}},[e("span",[t._v(t._s(t.$t("Due Date"))+" ")])]),e("th",{staticClass:"text-left",attrs:{width:"20%"}},[e("span",[t._v(t._s(t.$t("Due Amount"))+" ("+t._s(t.paymentTermsData[0].ISO_CODE)+")")])]),e("th",{staticClass:"text-left",attrs:{width:"20%"}},[e("span",[t._v(t._s(t.$t("Mark Payment")))])]),e("th",{staticClass:"text-center",attrs:{width:"15%"}},[e("span",[t._v(t._s(t.$t("Action")))])])])]),e("tbody",[t.paymentTermsData&&0!=t.paymentTermsData.length?t.paymentTermsData&&t.paymentTermsData.length>0?t._l(t.paymentTermsData,(function(a,i){return e("tr",{key:i,staticClass:"myrow"},[e("td",[e("span",[t._v(t._s(a.NOTES)+" ")])]),e("td",{staticClass:"text-center"},[e("span",[t._v(t._s(t.formatDateM(a.DUE_ON))+" ")])]),e("td",[e("input",{directives:[{name:"model",rawName:"v-model",value:a.DUE_AMOUNT,expression:"termsPaymentRow.DUE_AMOUNT"}],staticClass:"form-control",attrs:{id:"txtduedamount",maxlength:"12",readonly:""},domProps:{value:a.DUE_AMOUNT},on:{input:function(e){e.target.composing||t.$set(a,"DUE_AMOUNT",e.target.value)}}})]),e("td",[e("label",{staticClass:"mr-2",class:{total_disable_class_bg:0===a.DUE_AMOUNT}},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.IS_FULL_PAYMENT,expression:"termsPaymentRow.IS_FULL_PAYMENT"}],attrs:{type:"radio",value:"1"},domProps:{checked:"1"===a.IS_FULL_PAYMENT,checked:t._q(a.IS_FULL_PAYMENT,"1")},on:{change:function(e){return t.$set(a,"IS_FULL_PAYMENT","1")}}}),t._v(" Full Payment ")]),e("label",{class:{total_disable_class_bg:0===a.DUE_AMOUNT}},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.IS_FULL_PAYMENT,expression:"termsPaymentRow.IS_FULL_PAYMENT"}],attrs:{type:"radio",value:"0"},domProps:{checked:"0"===a.IS_FULL_PAYMENT,checked:t._q(a.IS_FULL_PAYMENT,"0")},on:{change:function(e){return t.$set(a,"IS_FULL_PAYMENT","0")}}}),t._v(" Partial ")]),"0"===a.IS_FULL_PAYMENT?e("div",[e("input",{directives:[{name:"model",rawName:"v-model",value:a.AMOUNT_RECEIVED,expression:"termsPaymentRow.AMOUNT_RECEIVED"}],staticClass:"form-control",class:{total_disable_class_bg:0===a.DUE_AMOUNT},attrs:{type:"number",id:"txtrecivedamount",maxlength:"12"},domProps:{value:a.AMOUNT_RECEIVED},on:{blur:function(e){return t.checkAmountReceived(a)},input:function(e){e.target.composing||t.$set(a,"AMOUNT_RECEIVED",e.target.value)}}})]):t._e()]),e("td",{staticClass:"text-center"},[e("div",{staticClass:"col-lg-12"},[t.shouldDisplay&&t.paymentDetailsData[0].HAS_MULIPLE_TERMS?e("div",[e("span",{attrs:{id:"submitField"}},[e("a",{staticClass:"submitbtn btn btn-success",class:{total_disable_class_bg:0===a.DUE_AMOUNT},attrs:{id:"SaveMultipleTerms",title:"Save",href:"javascript:;"},on:{click:function(e){return t.SaveMultipleTerms(a)}}},[e("i",{staticClass:"fa fa-save pr-2"}),t._v("Save")])])]):t._e()])])])})):t._e():e("tr",[e("td",{staticClass:"text-center text-danger",attrs:{colspan:"5"}},[t._v(" "+t._s(t.$t("NoPaymentFound"))+" ")])])],2)])])]):t._e(),t.paymentDetailsData[0].HAS_MULIPLE_TERMS||0!=t.IsAlreadyPaid?t._e():e("div",{staticClass:"listing mt-2 col-lg-12"},[e("div",{staticClass:"table-responsive table-fix-header"},[e("table",{staticClass:"table-sorting table table-bordered my-0",attrs:{id:"maintable"}},[e("thead",{staticClass:"thead-light"},[e("tr",[e("th",{attrs:{width:"25%"}},[e("label",{staticClass:"float-left"},[t._v("Notes:")]),e("span",{staticClass:"mandatory float-left"},[t._v("*")])]),e("th",{staticClass:"text-left",attrs:{width:"15%"}},[e("label",{staticClass:"float-left"},[t._v("Amount:")]),e("span",{staticClass:"mandatory float-left"},[t._v("*")])]),e("th",{staticClass:"text-left",attrs:{width:"15%"}},[e("label",{staticClass:"float-left"},[t._v("Refrence number:")]),e("span",{staticClass:"mandatory float-left"},[t._v("*")])]),e("th",{staticClass:"text-left",attrs:{width:"15%"}},[e("label",{staticClass:"float-left"},[t._v("Bill Date:")]),e("span",{staticClass:"mandatory float-left"},[t._v("*")])]),e("th",{staticClass:"text-left",attrs:{width:"15%"}},[e("label",{staticClass:"float-left"},[t._v("Payment Mode:")]),e("span",{staticClass:"mandatory float-left"},[t._v("*")])]),e("th",{staticClass:"text-center",attrs:{width:"15%"}},[e("span",[t._v(t._s(t.$t("Action")))])])])]),e("tbody",[e("tr",[e("td",[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.Notes,expression:"Notes"}],staticClass:"form-control",attrs:{name:"Notes",id:"txtNotes",rows:"2",cols:"100"},domProps:{value:t.Notes},on:{input:function(e){e.target.composing||(t.Notes=e.target.value)}}})]),e("td",[t.paymentDetailsData.length>0&&(t.paymentDetailsData[0].BILL_NET_TOTAL||0)-(t.paymentDetailsData[0].PAID||0)<=0?e("span",{staticClass:"fullPaid"},[t._v("Paid")]):e("span",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.amount,expression:"amount"}],staticClass:"form-control",attrs:{type:"number",id:"txtamount",maxlength:"12",onkeypress:"return event.key !== '-' && this.value.length < 12"},domProps:{value:t.amount},on:{input:function(e){e.target.composing||(t.amount=e.target.value)}}})])]),e("td",[e("span",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.RefNo,expression:"RefNo"}],staticClass:"form-control",attrs:{type:"text",id:"txtamount",maxlength:"18"},domProps:{value:t.RefNo},on:{input:function(e){e.target.composing||(t.RefNo=e.target.value)}}})])]),e("td",[e("span",[t._v(t._s(t.BillDate))])]),e("td",[e("select",{directives:[{name:"model",rawName:"v-model",value:t.BillMode,expression:"BillMode"}],staticClass:"form-control",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.BillMode=e.target.multiple?a:a[0]}}},[e("option",{attrs:{value:"Cash"}},[t._v("Cash")]),e("option",{attrs:{value:"Cheque"}},[t._v("Cheque")]),e("option",{attrs:{value:"Online"}},[t._v("Online")]),e("option",{attrs:{value:"DD"}},[t._v("DD")])])]),e("td",{staticClass:"text-center"},[e("div",{staticClass:"col-lg-12"},[t.shouldDisplay&&!t.paymentDetailsData[0].HAS_MULIPLE_TERMS?e("a",{staticClass:"submitbtn btn btn-success mr-2",attrs:{id:"MakePartialPay",title:"Save",href:"javascript:;"},on:{click:t.SavePartialPayment}},[e("i",{staticClass:"fa fa-save pr-2"}),t._v("Save")]):t._e()])])])])])])]),1==t.IsAlreadyPaid?e("div",{staticClass:"mt-2 col-lg-12"},[e("div",{staticClass:"alert alert-danger text-center",attrs:{role:"alert"}},[t._v(" "+t._s(t.$t("InvoiceAlreadyPaid"))+" ")])]):t._e(),e("div",{staticClass:"col-lg-12 text-right mt-3"},[e("a",{staticClass:"btn btn-danger formbtn text-white",attrs:{href:"javascript:;"},on:{click:t.ClosePayment}},[e("em",{staticClass:"fa fa-close pr-2"}),t._v(t._s(t.$t("Cancel")))])])])])])])])]):t._e()],1)]),t.isAttachment?e("Attachment",{attrs:{BillId:t.billId}}):t._e(),t.IsLogError?e("ExportError",{attrs:{BillId:t.billId}}):t._e(),t.isInvoiceHistory?e("InvoiceHistory",{attrs:{BillId:t.billId}}):t._e(),t.isPaySlip?e("InvoicePaySlip",{attrs:{BillId:t.billId}}):t._e(),t.isSendBill?e("SendBill",{attrs:{BillId:t.billId}}):t._e(),t.isInvoiceCancel?e("InvoiceCancelModal",{attrs:{Billid:t.billId}}):t._e()],1):e("section",[t.isTemplate?e("InvoiceTemplate",{attrs:{details:t.templatedata,hitFrom:"Invoice"},on:{backtoInvoiceList:t.backtoInvoiceList}}):t._e()],1)},Ke=[];a("88a7"),a("271a"),a("5494");let Qe=[{title:"MarkSent",iconClass:"fa-paper-plane",callbackfunction:"clkMarkAsSent",isEnabledOnSelectedRow:!0,additionalClass:"",isdisabled:!0,isvisible:!0,checkPrivilege:!0},{title:"Download",iconClass:"fa-download",callbackfunction:"clkDownload",additionalClass:"",isdisabled:!1,isvisible:!0,checkPrivilege:!0},{title:"BackToList",iconClass:"fa-angle-double-left",callbackfunction:"clkBackToList",isdisabled:!1,isvisible:!0}],Ze=[{fieldName:"FilterBy",fieldType:"ddl-check",fieldIcon:"fa-file",fieldSearchConditionName:["searchBy"],isSearch:!1,value:"",listOptions:[{name:"Issue Date",value:"IssueDate"},{name:"Due Date",value:"DueDate"}]},{fieldName:"DateFilterType",fieldType:"ddl-check",fieldIcon:"fa-file",fieldSearchConditionName:["dateFilterType"],isSearch:!1,value:"",listOptions:[{name:"Custom Date",value:"CustomDate"},{name:"Yearly",value:"Yearly"}]},{fieldName:"DateRangeFrom",fieldType:"date",fieldIcon:"fa-calendar",fieldSearchConditionName:["billDateFrom"],isSearch:!1,value:"",datePickerConfig:{formate:"yyyy-mm-dd"}},{fieldName:"DateRangeTo",fieldType:"date",fieldIcon:"fa-calendar",fieldSearchConditionName:["billDateTo"],isSearch:!1,value:"",datePickerConfig:{formate:"yyyy-mm-dd"}}],Xe=[{COLUMN_NAME:"PLAN_NAME",DATA_TYPE:"Text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"PlanName",DISPLAY_ORDER:1},{COLUMN_NAME:"FREQUENCY",DATA_TYPE:"Text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Frequency",DISPLAY_ORDER:2},{COLUMN_NAME:"BILL_NUMBER",DATA_TYPE:"Text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"BillHash",DISPLAY_ORDER:3,settings:{isInSlot:!0}},{COLUMN_NAME:"CREATED_AT",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"IssueDate",DISPLAY_ORDER:4,settings:{isInSlot:!0}},{COLUMN_NAME:"BILL_DUE_DATE",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"DueDate",DISPLAY_ORDER:5,settings:{isInSlot:!0}},{COLUMN_NAME:"BILL_NET_TOTAL",DATA_TYPE:"currency",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Amount",DISPLAY_ORDER:6,settings:{isInSlot:!0}},{COLUMN_NAME:"PERIOD",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Period",DISPLAY_ORDER:7},{COLUMN_NAME:"STATUS_NAME",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Status",DISPLAY_ORDER:8,settings:{isInSlot:!0}}],ta=[{title:"View",callbackfunction:"clkViewDetail",icon:"fa fa-eye action-icon",additionalSpan:""},{title:"History",callbackfunction:"clkHistory",icon:"fa fa-history action-icon",additionalSpan:""},{title:"Pay Slip",callbackfunction:"clkPaySlip",icon:"fa fa-print pr-2 action-icon",additionalSpan:""},{title:"Payment",callbackfunction:"clkPayNow",icon:"fa fa-credit-card action-icon",additionalSpan:""},{title:"Mark as Cancel",callbackfunction:"clkMarkCancelled",icon:"fa fa-times action-icon",additionalSpan:""},{title:"Attachment",callbackfunction:"clkAttachment",icon:"fa fa-upload action-icon",additionalSpan:""}];var ea={buttons:Qe,topsearchSchema:Ze,billColumnSchema:Xe,listActions:ta},aa=a("d00a"),ia=a("b4f9"),sa=a("66b5"),na=a("f8c5"),la=a("78fc"),oa=function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("Reason for Cancelling")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("dynamic-form",{ref:"defaultStatus",attrs:{lang:"en",buttons:t.buttons,schema:t.FormSchema},on:{OnSubmit:t.onSubmit}})],1)])])])],1)},ra=[],ca={props:{Billid:{type:Number}},data(){return{isLoading:!1,FormSchema:[{layoutType:"single",Data:[{astype:"TextAreaField",label:this.$t("Reason"),name:"Reason",value:"",placeholder:this.$t("Enter Reason"),validationRules:{required:!0},disabled:!1}]}],buttons:[{type:"submit",class:"btn btn-success",text:"<i class='fa fa-save pr-2'></i>Save",isVisible:!0},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Cancel",onClick:this.Close}],companyId:null,userId:null}},created:function(){var t=this;t.userId=t.GetUserInfo.ID,t.companyId=t.GetUserInfo.CompanyId,t.GetStatusList()},methods:{async onSubmit(t,e){const a=this,i=t.Reason,s=`billIds=${a.Billid}&statusCode=CLBCNCL&Reason=${i}`,l=await n["a"].UpdateClientInvoiceStatus(s);1==l.data[0].ERROR_CODE?(a.Close(),a.ShowAlert(a.$t("RecordUpdatedSuccessfully"),"success"),a.$parent.FetchData()):a.ShowAlert(a.$t("ErrorWhileProcessingRequest"),"failure")},Close:function(){this.$parent.isInvoiceCancel=!1}}},da=ca,ua=Object(d["a"])(da,oa,ra,!1,null,null,null),pa=ua.exports;var ma={components:{InvoiceTemplate:Gt["a"],Attachment:aa["a"],ExportError:ia["a"],InvoiceHistory:sa["a"],InvoicePaySlip:na["a"],SendBill:la["a"],InvoiceCancelModal:pa},props:{UserId:{type:Number},ClientData:{type:Object}},data(){return{isSaving:!1,isInvoiceCancel:!1,Headers:ea.billColumnSchema,StatusListForListing:[{STATUS:"Active",STATUS_ID:1001,STATUS_COLOR:"#ffffff",STATUS_BG_COLOR:"#28a745"},{STATUS:"Inactive",STATUS_ID:1002,STATUS_COLOR:"#ffffff",STATUS_BG_COLOR:"#d72435"}],listheaderbuttons:ea.buttons,listActions:ea.listActions,topSearchFields:ea.topsearchSchema,list:[],TotalRecords:0,pageSize:10,pageNum:1,sortBy:"",searchCondition:"",isPaymentHistory:!1,GroupStart:1,GroupEnd:3,CurrentPage:1,TotalPages:0,sortExp:"",totalPayments:0,BillListing:[],paymentHistoryData:[],MainInvocieNetAmount:0,paymentList:[],LegendArray:[{class:"legend-Progress colorboxsquare",text:this.$t("BillGenerated")},{class:"legend-ovrdue colorboxsquare",text:this.$t("Credit")+" "+this.$t("Note")}],noRecords:!1,isInvoice:!0,isTemplate:!1,templatedata:{},isPayment:!1,paymentDetailsData:[],paymentTermsData:[],amount:0,amountToPay:0,Notes:"",paymentDate:"",amountRecieved:0,isAttachment:!1,billId:"",IsLogError:!1,isInvoiceHistory:!1,isPaySlip:!1,BillDate:"",BillMode:"Cash",RefNo:0,isSendBill:!1,IsAlreadyPaid:!1,BillId:0,additionalClass:"",isLoading:!1}},created:async function(){var t=this;t.topSearchFields[1].onChange=t.getClickEvent,await t.FetchData(),t.CurrencyCode=t.GetUserInfo.Currency.replace(/[()]/g,""),t.BillDate=t.$options.filters.formatDate(new Date)},computed:{totalPaid(){return this.paymentList.reduce((t,e)=>t+e.Amount,0)},outstandingAmount(){return this.MainInvocieNetAmount-this.totalPaid}},methods:{formatAmount(t){return t.toFixed(2)},Close:function(){var t=this;t.isPaymentHistory=!1},ClosePayment:function(){var t=this;t.isPayment=!1,t.paymentDetailsData=[],t.paymentTermsData=[]},formatDateM(t){if(!t)return"";const e=new Date(t),a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],i=a[e.getMonth()],s=e.getDate(),n=e.getFullYear();return`${i}-${s}-${n}`},formatDateMonth(t){if(!t)return"";const[e,a]=t.split(" "),[i,s,n]=e.split("-"),l=new Date(`${n}-${s}-${i}T00:00:00`),o=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],r=String(l.getDate()).padStart(2,"0"),c=o[l.getMonth()],d=l.getFullYear();return`${c}-${r}-${d}`},openExportErrorModel:async function(t){var e=this;e.billId=t.row.BILL_ID,e.IsLogError=!e.IsLogError},openPaymentHistory:async function(t){var e=this,a=t.row.BILL_ID,i="invoiceId="+a;await n["a"].GetPaymentHistoryPopUp(i).then((function(t){t.data?(e.paymentHistoryData=t.data,e.paymentList=t.data.PaymentLists,e.MainInvocieNetAmount=t.data.MainInvocieNetAmount,e.totalPayments=e.paymentList.reduce((t,e)=>t+e.Amount,0)):e.paymentHistoryData=[]})),e.isPaymentHistory=!0},billActionButtonClick(t,e,a,i){var s=this;switch(t){case"clkViewDetail":this.BillViewDetail(e);break;case"handleSendBill":s.handleSendBill(e);break;case"clkHistory":this.History(e);break;case"clkPaySlip":this.clickPaySlip(e);break;case"clkPayNow":this.BillPayNow(e);break;case"clkMarkCancelled":this.clkMarkCancelled(e);break;case"clkAttachment":this.handleAttachment(e);break}},handleSendBill(t){var e=this;e.isSendBill=!0,e.billId=t.BILL_ID},clkMarkCancelled:async function(t){var e=this;e.billId=t.BILL_ID,e.isInvoiceCancel=!0},async BillViewDetail(t){this.isLoading=!0;const e=`billId=${t.invoiceId_Enc}&sourceType=${t.SOURCE_TYPE}`,a=await n["a"].getInvoiceDetails(e);this.isLoading=!1,this.templatedata=a.data.result.data,this.isInvoice=!1,this.isTemplate=!0},AllowNumberWithDotOnBlur(){let t=this.inputValue;t=t.replace(/[^0-9.]/g,"");const e=t.split(".");e.length>2&&(t=`${e[0]}.${e.slice(1).join("")}`),this.inputValue=t},async BillPayNow(t){var e=this;e.paymentTermsData=[];var a=t.BILL_ID,i="invoiceId="+a;await n["a"].GetInvoicePartailPaymentDetails(i).then((function(t){if(t.data){e.paymentDetailsData=t.data,$.each(e.paymentDetailsData,(function(t,a){var i={BILL_ID:a.BILL_ID,BILL_NUMBER:a.BILL_NUMBER,BILL_ISSUE_DATE:a.BILL_ISSUE_DATE,BILL_DUE_DATE:a.BILL_DUE_DATE,BILL_NET_TOTAL:a.BILL_NET_TOTAL,PAID:a.PAID,ISO_CODE:a.ISO_CODE,HAS_MULIPLE_TERMS:a.HAS_MULIPLE_TERMS,TERM_ID:a.TERM_ID,DUE_ON:a.DUE_ON,DUE_AMOUNT:a.DUE_AMOUNT,NOTES:a.NOTES,IS_FULL_PAYMENT:1==a.IS_FULL_PAYMENT?"1":"0",AMOUNT_RECEIVED:0,AMOUNT_RECEIVED_OLD:a.AMOUNT_RECIEVED};e.paymentTermsData.push(i)}));const a=new Date,i=String(a.getDate()).padStart(2,"0"),s=String(a.getMonth()+1).padStart(2,"0"),n=a.getFullYear();e.paymentDate=`${i}-${s}-${n}`,e.IsAlreadyPaid=!1;let l=parseFloat("string"===typeof e.paymentDetailsData[0].BILL_NET_TOTAL?e.paymentDetailsData[0].BILL_NET_TOTAL.replace(/,/g,""):e.paymentDetailsData[0].BILL_NET_TOTAL||0),o=parseFloat(e.paymentDetailsData[0].PAID||0);l-o==0&&(e.IsAlreadyPaid=!0)}else e.paymentDetailsData=[]})),e.isPayment=!0},checkAmountReceived(t){return t.AMOUNT_RECEIVED>t.DUE_AMOUNT?t.AMOUNT_RECEIVED=0:t.AMOUNT_RECEIVED},SaveMultipleTerms(t){var e=this;if(console.log("IS_FULL_PAYMENT :",t.IS_FULL_PAYMENT),"1"==t.IS_FULL_PAYMENT)console.log("PaymentOption1:",t.IS_FULL_PAYMENT),parseFloat(t.DUE_AMOUNT)==parseFloat(t.AMOUNT_RECEIVED_OLD)?(console.log("AMOUNT_RECEIVED :",t.AMOUNT_RECEIVED_OLD),t.AMOUNT_RECEIVED=parseFloat(Math.abs(t.AMOUNT_RECEIVED_OLD+parseFloat(t.DUE_AMOUNT)).toFixed(2)),t.DUE_AMOUNT=0):(t.AMOUNT_RECEIVED=t.DUE_AMOUNT,t.DUE_AMOUNT=0);else if(console.log("PaymentOption2:",t.IS_FULL_PAYMENT),parseFloat(t.DUE_AMOUNT)==parseFloat(t.AMOUNT_RECEIVED))t.AMOUNT_RECEIVED=parseFloat(Math.abs(t.AMOUNT_RECEIVED_OLD+parseFloat(t.AMOUNT_RECEIVED)).toFixed(2)),t.DUE_AMOUNT=0;else{if(parseFloat(t.AMOUNT_RECEIVED)>parseFloat(t.DUE_AMOUNT))return void e.ShowAlert(e.$t("AmountNotGreaterThanDue"),"warning");if(parseFloat(t.AMOUNT_RECEIVED)<=0)return void e.ShowAlert(e.$t("AmountGreaterThenZero"),"warning");t.AMOUNT_RECEIVED=parseFloat(Math.abs(t.AMOUNT_RECEIVED_OLD+parseFloat(t.AMOUNT_RECEIVED)).toFixed(2)),t.DUE_AMOUNT=parseFloat(Math.abs(t.AMOUNT_RECEIVED-t.DUE_AMOUNT).toFixed(2))}if(""!=t.AMOUNT_RECEIVED&&"0"!=t.AMOUNT_RECEIVED&&0!=parseFloat(t.AMOUNT_RECEIVED)){const a={INVOICEID:t.BILL_ID,AMOUNT:0,DATETIME:e.paymentDate,NOTES:e.Notes,HAS_MULIPLE_TERMS:t.HAS_MULIPLE_TERMS,TERM_ID:t.TERM_ID,IS_FULL_PAYMENT:"1"==t.IS_FULL_PAYMENT,AMOUNT_RECEIVED:t.AMOUNT_RECEIVED,DUE_AMOUNT:t.DUE_AMOUNT};console.log(a),n["a"].SaveInvoicePartialPayment(a).then((function(t){"Success"==t.data.Status?(e.ShowAlert(e.$t("AddedSuccess",[e.$t("Payment")]),"success",!0,e.$t("Alert")),e.FetchData(),e.isPayment=!1):e.ShowAlert(e.$t("ErrorWhileProcessingRequest"),"warning")}))}else e.ShowAlert(e.$t("AmountNotValid"),"warning")},async validateReceiptNumber(t){const e=/^[A-Za-z0-9]{6,}$/;return!!e.test(t)},async SavePartialPayment(){var t=this;if(!t.isSaving){t.isSaving=!0;try{var e=null==t.paymentDetailsData[0].BILL_NET_TOTAL?0:parseFloat(t.paymentDetailsData[0].BILL_NET_TOTAL).toFixed(2);const l=null==t.paymentDetailsData[0].PAID?0:parseFloat(t.paymentDetailsData[0].PAID).toFixed(2);var a=parseFloat(t.amount)+parseFloat(l),i=e-a;if(i.toFixed(2)<0)return t.ShowAlert(t.$t("AmountNotMoreThanTotal"),"warning"),t.amount=0,void(t.isSaving=!1);var s=await t.validateReceiptNumber(t.RefNo);if(!s)return t.ShowAlert(t.$t("InvalidReceiptNumber"),"warning"),void(t.isSaving=!1);if(!this.Notes)return t.ShowAlert(t.$t("NotesRequired"),"warning"),void(t.isSaving=!1);if(""!=t.amount&&"0"!=t.amount&&0!=parseFloat(t.amount)){const e={INVOICEID:t.paymentDetailsData[0].BILL_ID,AMOUNT:t.amount,DATETIME:t.paymentDate,NOTES:t.Notes,HAS_MULIPLE_TERMS:t.paymentDetailsData[0].HAS_MULIPLE_TERMS,AMOUNT_RECEIVED:t.amountRecieved,ReferenceNumber:t.RefNo,PaymentMode:t.BillMode},a=await n["a"].SaveInvoicePartialPayment(e);"Success"==a.data.Status?(t.ShowAlert(t.$t("AddedSuccess",[t.$t("Payment")]),"success",!0,t.$t("Alert")),t.amount=0,t.Notes="",t.RefNo="",t.BillMode="Cash",t.FetchData(),t.isPayment=!1):t.ShowAlert(t.$t("ErrorWhileProcessingRequest"),"warning")}else t.ShowAlert(t.$t("AmountNotValid"),"warning")}finally{t.isSaving=!1}}},billRenderActions:function(t){var e=this;let a=[];return e.listActions.forEach(e=>{let i={...e};switch(i.title){case"View":i.isVisible=!0;break;case"Send Bill":i.isVisible=!0;break;case"History":i.isVisible=!0;break;case"Pay Slip":i.isVisible=!0,i.isDisabled="CLBPAD"!=t.STATUS_CODE&&"CLBPPAD"!=t.STATUS_CODE;break;case"Payment":i.isVisible=!0,i.isDisabled="CLBPAD"!=t.STATUS_CODE&&"CLBSND"!=t.STATUS_CODE&&"CLBPPAD"!=t.STATUS_CODE||!(t.BILL_NET_TOTAL>=0);break;case"Mark as Cancel":i.isVisible=!0,i.isDisabled="CLBPAD"==t.STATUS_CODE||"CLBCNCL"==t.STATUS_CODE||"CLBPPAD"==t.STATUS_CODE;break;case"Attachment":i.isVisible=!0;break}a.push(i)}),a},getClickEvent:async function(){},FetchData:async function(){var t=this;t.BillListing=[];var e=`pageSize=${t.pageSize}&pageNum=${t.pageNum}&sortBy=${t.sortBy}&sortExp=${t.sortExp}&clientId=${t.UserId}`;await n["a"].GetInvoiceListing(e).then((function(e){if(""!=e.data&&null!=e.data)if(e.data.length>0){for(var a in t.BillListing=e.data,t.BillListing.forEach(t=>{t.additionalClass="",t.BILL_NET_TOTAL<0&&(t.additionalClass="danger-bar odd")}),t.BillListing)t.BillListing[a].isCheckBoxDisabled=!1,"RLSTOXERO"!=t.BillListing[a].STATUS_CODE&&"RLSTOWORKDAY"!=t.BillListing[a].STATUS_CODE&&"CLBPAD"!=t.BillListing[a].STATUS_CODE&&"CLBCNCL"!=t.BillListing[a].STATUS_CODE||(t.BillListing[a].isCheckBoxDisabled=!0);t.TotalRecords=e.data[0].TOTAL_RECORDS,t.TotalPages=Math.ceil(t.TotalRecords/t.pageSize),t.CurrentPage=t.pageNum,t.noRecord=!1,t.listheaderbuttons[0].isdisabled=!0}else t.noRecord=!0,t.TotalRecords=0,t.BillListing=[];else t.noRecord=!0,t.TotalRecords=0,t.BillListing=[]}))},leftCommonSearch(t){console.log("value",t),this.pageNum=t.PageNumber,this.isPaged=1,"undefined"!=typeof t.searchCondition?this.searchCondition=t.searchCondition:this.searchCondition="",this.FetchData()},pagerMethod(t){this.pageSize=t.PageSize,this.pageNum=t.PageNumber,this.FetchData()},commonHeaderButtonClick(t){switch(t.callbackfunction){case"clkMarkAsSent":this.MarkAsSent();break;case"clkDownload":this.DownloadBillList();break;case"clkBackToList":this.BackToList();break}},MarkAsSent:async function(t){var e=this,a=[];if(e.BillListing.forEach(t=>{1==t.isSelected&&a.push(t.BILL_ID)}),0!==a.length){var i=a.join(",");e.confirmR(e.$t("ConfirmRelease"),!0,!1,(async function(t){if(void 0===t)try{var a=`billIds=${i}&statusCode=CLBSND`;await n["a"].UpdateClientInvoiceStatus(a).then(t=>{1==t.data[0].ERROR_CODE?(e.ShowAlert(e.$t("RecordUpdatedSuccessfully"),"success"),e.FetchData()):e.ShowAlert(e.$t("ErrorWhileProcessingRequest"),"failure")})}catch(s){}}))}else e.ShowAlert(e.$t("AtLeastOneInvoice"),"failure")},DownloadBillList:async function(){var t=this,e=`pageSize=${t.TotalRecords}&pageNum=${t.pageNum}&sortBy=${t.sortBy}&sortExp=${t.sortExp}&clientId=${t.UserId}`;await n["a"].GetInvoiceListing(e).then((function(e){""!=e.data&&null!=e.data&&e.data.length>0&&t.ConvertJSONToCSV(e.data,"Invoice",!0)}))},ConvertJSONToCSV:function(t,e,a){const i=["BILL_ID","BILL_RECORD_AMOUNT","COMPANY_ID","COMPANY_NAME","IS_AUTO_SEND","ISO_CODE","IS_RECURRING","MILESTONE_ID","RECURRING_FREQUENCY","RECURRING_STATUS","ROWNUMBER","STATUS_CODE","TEMPLATE_ID","TIME_ROUNDING","TOTAL_RECORDS"],s={BILL_NUMBER:"Invoice No",CLIENT_NAME:"Contract",PROJECT_NAME:"Project Name",PARENT_INVOICE:"Parent Invoice",CREATED_AT:"Issue Date",BILL_DUE_DATE:"Due Date",PAYMENT_CREATED_AT:"Payment Date",BILL_NET_TOTAL:"Amount (PKR)",STATUS_NAME:" Status"};if(t&&Array.isArray(t)&&t.length>0){const n=Object.keys(t[0]),l=n.filter(t=>!i.includes(t)),o=l.map(t=>s[t]||t),r=t.map(t=>o.map(e=>{const a=l[o.indexOf(e)];let i=void 0!==t[a]&&null!==t[a]?String(t[a]):"";return(i.includes(",")||i.includes("\n")||i.includes('"'))&&(i=`"${i.replace(/"/g,'""')}"`),i}).join(",")),c=(a?[o.join(",")]:[]).concat(r).join("\n"),d=new Blob([c],{type:"text/csv;charset=utf-8;"}),u=document.createElement("a");u.setAttribute("href",URL.createObjectURL(d)),u.setAttribute("download",e+".csv"),u.click()}else console.log("No valid data to convert.")},BackToList:function(){var t=this;window.location.href=t.$router.resolve({name:"ClientListing"}).href},getStatusClassList:function(t){var e="";switch(t){case"INVPAID":e="btn btn-danger py-0 d-block font-14";break;case"CLBSND":e="btn btn-primary py-0 d-block font-14";break;case"CLBPAD":e="btn btn-info py-0 d-block font-14";break;case"CLBPPAD":e="btn btn-primary py-0 d-block font-14";break;case"CLBGEN":e="btn btn-warning py-0 d-block font-14";break;case"RLSTOXERO":e="btn btn-secondary py-0 d-block font-14";break;case"CLBUPDATED":e="btn btn-success py-0 d-block font-14";break;case"RLSTOWORKDAY":e="btn btn-dark py-0 d-block font-14";break;case"CLBERROR":e="btn btn-danger py-0 d-block font-14";break;default:e=""}return e},sortdata:function(t){this.sortBy=t;var e="ASC";"ASC"==this.sortExp&&(e="DESC"),this.sortExp=e,this.sortBy=t,this.sortExp=e,this.pageNum=1,this.GroupStart=this.pageNum,this.GroupEnd=this.pageNum+2,this.FetchData()},backtoInvoiceList(){this.isInvoice=!0,this.isTemplate=!1,this.FetchData()},shouldDisplay(){var t,e,a,i;const s=null!==(t=null===(e=this.paymentDetailsData[0])||void 0===e?void 0:e.BILL_NET_TOTAL)&&void 0!==t?t:0,n=null!==(a=null===(i=this.paymentDetailsData[0])||void 0===i?void 0:i.PAID)&&void 0!==a?a:0;return!(s-n<=0)},handleAttachment(t){var e=this;e.isAttachment=!0,e.billId=t.BILL_ID},History(t){var e=this;e.isInvoiceHistory=!0,e.billId=t.BILL_ID},async clickPaySlip(t){var e=this;e.isPaySlip=!0,e.billId=t.BILL_ID}}},ha=ma,va=(a("de36"),Object(d["a"])(ha,Je,Ke,!1,null,null,null)),_a=va.exports,ga=function(){var t=this,e=t._self._c;return e("section",[e("loader",{attrs:{"is-visible":t.isLoading}}),e("tg-list",{attrs:{IsShowAction:!0,showCheckBox:!1,ModuleName:"Company",SubModuleCode:"CompanyHoliday",IdentityColumn:"holidayid",HeaderText:t.$t("ContractHoliday"),ListData:t.CompanyHolidayData,HeaderData:t.Header,TotalRecords:t.TotalRecords,IsSearchFieldsOnTop:!1,SearchPosition:"top",SearchFields:t.topSearchFields,RenderRowActionMethod:t.renderActions,ListDataCallBackFunction:t.FetchData,IsFilterApplied:!!t.searchCondition,LegendArray:t.LegendArray,sourcetype:"",NorecordfoundText:t.$t("NoRecordfound")},on:{LeftsearchButtonClick:t.leftCommonSearch,PagerButtonClick:t.pagerMethod,HeaderButtonClick:t.commonHeaderButtonClick,ActionButtonClick:t.actionButtonClick,ClearFilter:t.ClearFilter,SortdataButtonClick:t.sortdata},scopedSlots:t._u([{key:"slotdata",fn:function({data:a}){return["Duration"==a.column.COLUMN_NAME?[a.row.isfullday?e("span",[t._v(t._s(t.$t("FullDay")))]):e("span",[t._v(t._s(t.$t("PartialDay")))])]:t._e(),"holidayname"==a.column.COLUMN_NAME?[e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.EditContractHoliday(a.row)}}},[t._v(t._s(a.row.holidayname))])]:t._e(),"holidaydate"==a.column.COLUMN_NAME?[e("span",[t._v(t._s(t.$options.filters.formatDate(a.row.holidaydate)))])]:t._e(),"Time"==a.column.COLUMN_NAME?[a.row.isfullday?e("span",[t._v(t._s(t.$t("NA")))]):e("span",[t._v(t._s(t.FromTime(a.row.fromtime))+" To "+t._s(t.FromTime(a.row.totime)))])]:t._e(),"AvailableIn"==a.column.COLUMN_NAME?[a.row.isForCompany?e("span",[t._v(t._s(t.$t("Company")))]):e("span",[t._v(t._s(t.$t("Client"))+" ")]),a.row.isForCompany?t._e():e("a",{staticClass:"text-primary showContracts",on:{click:function(e){return t.IsShowContractModal(a.row.holidayid)}}},[e("em",{staticClass:"fa fa-eye"})])]:t._e(),"HolidayType"==a.column.COLUMN_NAME?[a.row.isFixed?e("span",[t._v(t._s(t.$t("Fixed")))]):e("span",[t._v(t._s(t.$t("Observed"))+" ")])]:t._e(),"isrecurring"==a.column.COLUMN_NAME?[a.row.isrecurring?e("span",[t._v(t._s(t.$t("Yes")))]):e("span",[t._v(t._s(t.$t("No"))+" ")])]:t._e(),"companylocation"==a.column.COLUMN_NAME?[t._v(" "+t._s(null==a.row.companylocation?"--":t.truncateText(a.row.companylocation,15))+" ")]:t._e(),"statusid"==a.column.COLUMN_NAME?[e("listing-status",{ref:"updatestatus",attrs:{isfor:"UpdateHolidayStatus",dataid:a.row.holidayid,"data-controller":"Client",statuslist:t.StatusListForListing,item:a.statusid,"data-action":"index",dataselected:1001==a.row.statusid?"Active":"Inactive",callbackfunction:t.FetchData,isselectedvaluestring:!0}})]:t._e()]}}])}),t.IsAddContract?e("AddContractHoliday",{attrs:{IsFor:t.IsFor,ContractHolidayData:t.ContractHolidayData},on:{CloseAddContract:t.CloseAddContract}}):t._e(),t.IsContractHolidayModal?e("ContractViewHoliday",{attrs:{ContractHolidayId:t.ContractHolidayId}}):t._e()],1)},fa=[];let Ca=[{title:"Holiday Bank",iconClass:"fa-gears",callbackfunction:"ShowHolidayList",additionalClass:"",isdisabled:!1,isvisible:!0,checkPrivilege:!0},{title:"Add",iconClass:"fa-plus",callbackfunction:"AddDepartment",additionalClass:"",isdisabled:!1,isvisible:!0,checkPrivilege:!0},{id:"DeleteMultiple",title:"Delete",iconClass:"fa-trash-o",callbackfunction:"commonDeleteData",isdisabled:!0,isvisible:!0,isEnabledOnSelectedRow:!0}],ya=[{fieldName:"Name",fieldType:"text",fieldSearchConditionName:["holiday_name"],isSearch:!1,value:""},{fieldName:"Select Location",fieldType:"ddl-check",fieldIcon:"fa fa-map-marker",paramName:"LocationId",fieldSearchConditionName:[""],isSearch:!1,value:"",listOptions:[]},{fieldName:"Holiday Source",fieldType:"ddl-check",fieldIcon:"fa-file",fieldSearchConditionName:["holiday_source"],isSearch:!1,value:"",listOptions:[{name:"Holiday Bank",value:"holidaybank"},{name:"Manual",value:"manual"}]},{fieldName:"Date Range From",fieldType:"date",fieldIcon:"fa-calendar",fieldSearchConditionName:["holiday_date"],isSearch:!1,value:"",datePickerConfig:{formate:"yyyy-mm-dd"}},{fieldName:"Date Range To",fieldType:"date",fieldIcon:"fa-calendar",fieldSearchConditionName:["holiday_date"],isSearch:!1,value:"",datePickerConfig:{formate:"yyyy-mm-dd"}}],ba=[{title:"Edit",callbackfunction:"EditContractHoliday",icon:"fa fa-pencil text-success action-icon",additionalSpan:""},{title:"Delete",callbackfunction:"DeleteContractHoliday",icon:"fa fa-trash-o action-icon text-danger",additionalSpan:""},{title:"Clone",callbackfunction:"CloneContractHoliday",icon:"fa fa-clone action-icon",additionalSpan:""}];async function Sa(t,e,a){var i=t;if("Location"==a){var s="RequestFrom=COMPANY_LOCATIONS";await n["a"].CompanyHolidayMultipleLocation(s).then((function(t){var e=t.data.result;e.forEach(t=>{var e={name:t.LOCATION_CITY,value:t.COMPANY_LOCATION_ID};i.topSearchFields[1].listOptions.push(e)})}))}}var Aa={buttons:Ca,topsearchSchema:ya,listActions:ba,bindleftCommonSearchdropdown:Sa},Da=function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},["Company"==t.IsFor?e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("AddHoliday"))+" "+t._s(t.$t("For"))+" "+t._s(t.$t("Company"))+" "+t._s(t.$t("Manual"))+" ")]):t._e(),"Update"==t.IsFor?e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("Update"))+" "+t._s(t.$t("Holiday"))+" "+t._s(t.$t("Manual"))+" ")]):t._e(),"Clone"==t.IsFor?e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("Clone"))+" "+t._s(t.$t("Holiday"))+" "+t._s(t.$t("Manual"))+" ")]):t._e(),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.CloseAddContract}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("dynamic-form",{ref:"AssignTagForm",attrs:{lang:"en",buttons:t.buttons,schema:t.FormSchema,mandatorytext:t.MandatoryString},on:{OnSubmit:t.OnSubmit}})],1)])])])],1)},Ia=[],Ta=a("240d"),La={components:{"tree-view":Ta["TreeSelectField"]},props:{UserId:{type:Number},ContractHolidayData:{type:Object},IsFor:{type:String}},data(){return{isLoading:!1,HolidayId:0,FinalLocationData:[],MandatoryString:"Fields marked with an asterisk (*) are mandatory.",FormSchema:[{layoutType:"four",Data:[{astype:"TextField",label:this.$t("name"),name:"Name",value:"",placeholder:this.$t("Enter Name"),validationRules:{required:!0,max:100}},{astype:"DateField",label:this.$t("Date"),name:"Date",value:"",placeholder:this.$t("Select Date"),validationRules:{required:!0,max:100}},{astype:"RadioField",label:this.$t("HolidayType"),name:"HodlidayType",value:"1",placeholder:"",config:{options:[{name:this.$t("Fixed"),value:1},{name:this.$t("Observed"),value:0}],showAddIcon:!1},validationRules:{required:!1}},{astype:"ToggleField",label:this.$t("Recurring"),name:"Recurring",value:"1",visibility:!0,config:{options:[{name:"Yes",value:1},{name:"No",value:0}],showAddIcon:!1}},{astype:"CheckBoxField",label:this.$t("AddToHolidayBank"),name:"AddToHolidayBank",value:"",placeholder:"",config:{options:[{value:"1"}],showAddIcon:!1},validationRules:""},{astype:"RadioField",label:this.$t("Duration"),name:"Duration",value:"1",visibility:!0,config:{options:[{name:this.$t("FullDay"),value:1},{name:this.$t("PartialDay"),value:0}],onChange:this.onChangeRadio}},{astype:"DateField",label:this.$t("StartTime"),name:"StartTime",value:null,visibility:!1,config:{mode:"Time"},placeholder:this.$t("Select Start Time"),validationRules:{required:!0,max:100}},{astype:"DateField",label:this.$t("EndTime"),name:"EndTime",value:null,visibility:!1,config:{mode:"Time"},placeholder:this.$t("Select End Time"),validationRules:{required:!0,max:100}},{astype:"TreeSelectField",label:this.$t("Location"),name:"Location",value:null,placeholder:"Select Location",config:{options:[]},validationRules:{required:!0}},{astype:"SelectField",label:this.$t("Status"),name:"Status",value:"",config:{options:[]},placeholder:this.$t("Select Status"),validationRules:{required:!1,max:100}}]},{layoutType:"single",Data:[{astype:"TextAreaField",label:this.$t("DESCRIPTION"),name:"Description",value:"",validationRules:{required:!1,max:4e3},config:{rows:5}}]}],buttons:[{type:"submit",class:"btn btn-success",text:"<i class='fa fa-save pr-2'></i>Save",isVisible:!0},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Cancel",onClick:this.CloseAddContract}]}},created:function(){var t=this;t.UserId=t.$route.params.id,t.GetStatusList(),t.CompanyHolidayMultipleLocation(),null!=t.ContractHolidayData&&setTimeout(()=>{t.BindHolidayData(t.ContractHolidayData)},200),setTimeout(()=>{t.$refs.AssignTagForm.UpdateKeyValue()},200)},methods:{GetStatusList:function(){var t=this,e="statusType=Category&hasglobal=true&langCode=en";n["a"].GetStatusList(e).then(e=>{if(e.data.length>0){var a=JSON.parse(e.data);a.forEach(e=>{var a={name:e.STATUS,value:e.STATUS_ID};t.FormSchema[0].Data[9].config.options.push(a)}),t.$refs.AssignTagForm.UpdateKeyValue()}})},CompanyHolidayMultipleLocation(){var t=this,e=[],a="RequestFrom=COMPANY_LOCATIONS";n["a"].CompanyHolidayMultipleLocation(a).then((function(a){t.FinalLocationData=a.data.result,t.FinalLocationData.forEach(i=>{var s=e.filter((function(t){return t.COMPANY_LOCATION_ID==i.COMPANY_LOCATION_ID}));if(0==s.length&&null==i.PARENT_LOCATION_ID){let s=i.COMPANY_LOCATION_ID,n=t.getChildLocation(s,i,a.data.result);e.push(n)}}),t.FormSchema[0].Data[8].config.options=e}))},getChildLocation(t,e,a){var i=this;let s={};s={id:e.COMPANY_LOCATION_ID,label:e.LOCATION_NAME};let n=s;var l=a.filter((function(e){return e.PARENT_LOCATION_ID==t}));let o=[];return l.forEach(t=>{let e=t.COMPANY_LOCATION_ID;var n=o.filter((function(e){return e.COMPANY_LOCATION_ID==t.COMPANY_LOCATION_ID}));if(0==n.length){var l=a.filter((function(t){return t.PARENT_LOCATION_ID==e}));if(null!=l&&l.length>0){let s=i.getChildLocation(e,t,a);o.push(s)}else s={id:""+t.COMPANY_LOCATION_ID,label:""+t.LOCATION_NAME},o.push(s)}}),n.children=o,n},BindHolidayData(t){var e=this;if(e.HolidayId=t.holidayid,e.FormSchema[0].Data[0].value=t.holidayname,e.FormSchema[0].Data[1].value=t.holidaydate,e.FormSchema[0].Data[2].value=1==t.isFixed?1:0,e.FormSchema[0].Data[3].value=1==t.isrecurring?1:0,e.FormSchema[0].Data[4].value=1,t.isfullday?(e.FormSchema[0].Data[6].visibility=!1,e.FormSchema[0].Data[7].visibility=!1):(e.FormSchema[0].Data[6].visibility=!0,e.FormSchema[0].Data[7].visibility=!0),e.FormSchema[0].Data[5].value=1==t.isfullday?1:0,e.FormSchema[0].Data[6].value=t.fromtime,e.FormSchema[0].Data[7].value=t.totime,""!=t.companylocation){const a=e.FinalLocationData.filter(e=>e.LOCATION_NAME===t.companylocation.split(",")[0]);e.FormSchema[0].Data[8].value=a[0].COMPANY_LOCATION_ID}e.FormSchema[0].Data[8].value=t.companylocation.split(",")[0],e.FormSchema[0].Data[9].value=t.statusid,e.FormSchema[1].Data[0].value=t.holidaydescription},CloseAddContract(){var t=this;t.$emit("CloseAddContract")},onChangeRadio(){var t=this,e=t.FormSchema[0].Data[5].value;0==e?(t.FormSchema[0].Data[6].visibility=!0,t.FormSchema[0].Data[7].visibility=!0):(t.FormSchema[0].Data[6].visibility=!1,t.FormSchema[0].Data[7].visibility=!1)},OnSubmit(){var t=this;let e={HolidayId:t.HolidayId,HolidayName:t.FormSchema[0].Data[0].value,HolidayDate:t.FormSchema[0].Data[1].value,HolidayType:t.FormSchema[0].Data[2].value,Recurring:t.FormSchema[0].Data[3].value,AddToHolidayBank:t.FormSchema[0].Data[4].value[0],Duration:t.FormSchema[0].Data[5].value,StartTime:1==t.FormSchema[0].Data[5].value?null:t.FormSchema[0].Data[6].value,EndTime:1==t.FormSchema[0].Data[5].value?null:t.FormSchema[0].Data[7].value,LocationId:t.FormSchema[0].Data[8].value,StatusId:t.FormSchema[0].Data[9].value,Description:t.FormSchema[1].Data[0].value,ClientId:t.UserId,IsForContract:1,IsForCompany:0,ReqForm:"Company",ISFULLDAY:"1"==t.FormSchema[0].Data[5].value?1:0};var a=JSON.stringify(e);n["a"].SaveCompanyHoliday(a).then(e=>{200==e.status&&(t.HolidayId>0?t.ShowAlert(t.$t("UpdatedSuccess",[t.$t("CompanyHoliday")]),"success",!0,t.$t("Alert")):t.ShowAlert(t.$t("AddedSuccess",[t.$t("CompanyHoliday")]),"success",!0,t.$t("Alert")),t.CloseAddContract())})}}},Ea=La,xa=(a("a901"),Object(d["a"])(Ea,Da,Ia,!1,null,"8e2971d4",null)),Na=xa.exports,Pa=function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("Contracts"))+" ")]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.CloseAddContract}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"w-100",attrs:{id:"divDialogViewCCoptionTicket"}},[e("div",{staticClass:"table-responsive table-fix-header",staticStyle:{"max-height":"450px","overflow-y":"auto"}},[e("table",{staticClass:"table table-bordered dt-responsive nowrap mt-0 mb-0"},[e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",{staticClass:"text-center font-weight-bold",attrs:{width:"10%"}},[t._v("S.No")]),e("th",{staticClass:"font-weight-bold",attrs:{width:"80%"}},[t._v(t._s(t.$t("Contract")))]),e("th",{staticClass:"font-weight-bold",attrs:{width:"10%"}},[t._v(t._s(t.$t("Status")))])])]),e("tbody",t._l(t.ListData,(function(a,i){return e("tr",{key:i},[e("td",{staticClass:"text-center"},[t._v(t._s(i+1))]),e("td",[t._v(t._s(a.CHILD_NAME))]),e("td",{staticClass:"text-center"},[e("span",{staticClass:"px-2 d-block text-center text-white",class:i.STATUS_NAME==t.Active?"bg-success":"bg-danger"},[t._v(t._s(a.STATUS_NAME))])])])})),0)])])])])])])])],1)},wa=[],Ra={props:{ContractHolidayId:{type:Number}},data(){return{isLoading:!1,ListData:[]}},created:function(){var t=this;t.FetchData()},methods:{FetchData(){var t=this;t.isLoading=!0;var e="holidayId="+t.ContractHolidayId;n["a"].GetContractsListByHolidayId(e).then(e=>{t.isLoading=!1,e.data.result.Data.length>0&&(t.ListData=e.data.result.Data)})},CloseAddContract(){var t=this;t.$parent.IsContractHolidayModal=!1}}},Ma=Ra,$a=Object(d["a"])(Ma,Pa,wa,!1,null,null,null),Fa=$a.exports,ka={components:{AddContractHoliday:Na,ContractViewHoliday:Fa},data(){return{isLoading:!1,CompanyHolidayData:[],TotalRecords:0,LegendArray:[],StatusListForListing:[{STATUS:"Active",STATUS_ID:1001,STATUS_COLOR:"#ffffff",STATUS_BG_COLOR:"#28a745"},{STATUS:"Inactive",STATUS_ID:1002,STATUS_COLOR:"#ffffff",STATUS_BG_COLOR:"#d72435"}],PageSize:10,PageNumber:1,isPaged:1,TotalPages:0,noRecord:!1,SortBy:"",SortExp:"",topSearchFields:Aa.topsearchSchema,listActions:Aa.listActions,Header:[{COLUMN_NAME:"holidayname",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"name",DISPLAY_ORDER:1,settings:{isInSlot:!0}},{COLUMN_NAME:"holidaydate",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Date",DISPLAY_ORDER:1,settings:{isInSlot:!0}},{COLUMN_NAME:"holidaydescription",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"DESCRIPTION",DISPLAY_ORDER:1},{COLUMN_NAME:"Duration",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Duration",DISPLAY_ORDER:1,settings:{isInSlot:!0}},{COLUMN_NAME:"Time",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Time",DISPLAY_ORDER:1,settings:{isInSlot:!0}},{COLUMN_NAME:"AvailableIn",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"AvailableIn",DISPLAY_ORDER:1,settings:{isInSlot:!0}},{COLUMN_NAME:"HolidayType",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"HolidayType",DISPLAY_ORDER:1,settings:{isInSlot:!0}},{COLUMN_NAME:"isrecurring",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Recurring",DISPLAY_ORDER:1,settings:{isInSlot:!0}},{COLUMN_NAME:"companylocation",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Locations",DISPLAY_ORDER:1,settings:{isInSlot:!0}},{COLUMN_NAME:"statusid",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Status",DISPLAY_ORDER:1,settings:{isInSlot:!0}}],ContractHolidayData:null,IsAddContract:!1,UserId:0,ContractHolidayId:0,IsContractHolidayModal:!1,IsFor:""}},created:async function(){var t=this;t.UserId=t.$route.params.id,Aa.bindleftCommonSearchdropdown(t,"Company","Location"),await t.FetchData()},methods:{sortdata:function(t){var e="sort tb_headerSortDown";this.SortBy=t,t===this.SortBy&&(""==this.SortExp?(this.SortExp="ASC",e="sort tb_headerSortDown"):"ASC"==this.SortExp?(this.SortExp="DESC",e="sort tb_headerSortUp"):(this.SortExp="ASC",e="sort tb_headerSortDown")),this.FetchData(),$("#"+t+"  span:first-child").attr("class",e)},ClearFilter(){},actionButtonClick:function(t,e){switch(t){case"EditContractHoliday":this.EditContractHoliday(e);break;case"DeleteContractHoliday":this.DeleteContractHoliday(e);break;case"CloneContractHoliday":this.CloneContractHoliday(e);break}},commonHeaderButtonClick(){},pagerMethod:function(t){this.PageSize=t.PageSize,this.PageNumber=t.PageNumber,this.FetchData()},leftCommonSearch:function(t){if(this.PageNumber=t.PageNumber,this.isPaged=1,"undefined"!=typeof t.searchCondition)if(""!=t.searchConditionJson){const e=t.searchConditionJson.split("=")[1];this.fav=e}else this.searchCondition=t.searchCondition;else this.searchCondition="";this.FetchData()},async FetchData(){var t=this;t.isLoading=!0;var e=`dateFrom=&dateTo=&statusIds=&duration=&Location=&sortBy=${t.SortBy}&sortExp=${t.SortExp}&pageSize=${t.PageSize}&pageNum=${t.PageNumber}&search=&clientId=${t.UserId}&holidayFor=&holidaySource=&contractId`;await n["a"].CompanyHolidayList(e).then(e=>{t.isLoading=!1,e.data.length>0?(t.CompanyHolidayData=e.data,t.TotalRecords=t.CompanyHolidayData[0].totaL_RECORDS,t.TotalPages=Math.ceil(t.TotalRecords/t.PageSize),t.CurrentPage=t.PageNumber,t.noRecord=!1):(t.CompanyHolidayData=[],t.noRecord=!0,t.TotalRecords=0)})},renderActions:function(t){var e=this;let a=[];return e.listActions.forEach(e=>{let i={...e};switch(i.title){case"Delete":i.isVisible=!0;break;case"Edit":i.isVisible=!0;break;case"Clone":i.isVisible=1!=(t.isrecurring&&t.isManual);break;default:i.isVisible=!0}a.push(i)}),a},EditContractHoliday(t){var e=this;e.IsFor="Update",e.ContractHolidayData=t,e.IsAddContract=!0},CloseAddContract(){var t=this;t.IsAddContract=!1,t.FetchData()},DeleteContractHoliday(t){var e=this;e.isLoading=!0;var a=null!=e.UserId?"ContractHoliday":"CompanyHoliday",i=`id=${t.holidayid}&reqFrom=${a}&refId=${e.UserId}`;n["a"].DeleteContractHoliday(i).then(t=>{"success"==t.data.msg?(e.ShowAlert(e.$t("SuccessfullyDelete",[e.$t("ContractHoliday")]),"success",!0,e.$t("Alert")),e.FetchData()):e.ShowAlert(e.$t("ErrorWhileProcessingRequest"),"failure",!0,e.$t("Alert")),e.isLoading=!1})},FromTime(t){var e=new Date(t),a=e.getHours(),i=e.getMinutes(),s=a>=12?"PM":"AM",n=a%12;n=n||12,i=i<10?"0"+i:i;var l=`${n}:${i}:${s}`;return l},IsShowContractModal(t){var e=this;e.ContractHolidayId=t,e.IsContractHolidayModal=!0},CloneContractHoliday(t){var e=this;e.IsFor="Clone",t.holidayid=0,e.ContractHolidayData=t,e.IsAddContract=!0}}},Oa=ka,Ba=Object(d["a"])(Oa,ga,fa,!1,null,null,null),Ua=Ba.exports,Ga=function(){var t=this,e=t._self._c;return e("section",{staticClass:"col-md-12 p-0"},[e("div",{staticClass:"container-fluid p-0"},[e("div",{staticClass:"col-md-12 p-0"},[e("div",{staticClass:"listing"},[e("div",{staticClass:"table-responsive table-fix-header float-left",staticStyle:{"max-height":"630px"}},[e("table",{staticClass:"table table-bordered mt-0",staticStyle:{width:"2500px"},attrs:{id:"mainTable"}},[e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",[t.isCheckExtraFeatureUSICBILLING?e("span",[t._v(t._s(t.$t("DivisionId")))]):t._e(),t.isCheckExtraFeatureUtilityBilling?e("span",[t._v(t._s(t.$t("InvoiceGroupingID")))]):t._e()]),e("th",[e("span",[t._v(t._s(t.$t("DESCRIPTION")))]),e("span",{staticClass:"float-left text-danger"})]),e("th",{staticClass:"text-center"},[e("span",[t._v(t._s(t.$t("AutoGenerateInvoice")))])]),e("th",{staticClass:"text-center"},[t.isCheckExtraFeatureUSICBILLING?e("span",[t._v(t._s(t.$t("AutomateInvoiceWorkday")))]):t._e(),t.isCheckExtraFeatureUtilityBilling?e("span",[t._v(t._s(t.$t("AutomateSendToCustomer")))]):t._e()]),e("th",[e("span",[t._v(t._s(t.$t("InvoiceFrequency")))])]),e("th",[e("span",[t._v(t._s(t.$t("InvoiceMemo")))])]),e("th",[e("span",[t._v(t._s(t.$t("DivisionPONumber")))]),e("span",{staticClass:"float-left text-danger"})]),t.isShowWorkdayInvoiceType?e("th",{attrs:{width:"10%"}},[e("span",{staticClass:"d-inline-block"},[t._v(t._s(t.$t("WorkdayInvoiceType"))),e("span",{staticClass:"text-danger d-inline-block"},[t._v("*")])])]):t._e(),e("th",{staticStyle:{display:"none"}},[e("span",[t._v(t._s(t.$t("InvoiceDetailTemplate")))])]),e("th",{staticStyle:{display:"none"}},[e("span",[t._v(t._s(t.$t("DetailFileFormat")))]),e("span",{staticClass:"float-left text-danger"})]),t.isAssociateProjectWithDivision?e("th",[e("span",[t._v(t._s(t.$t("Project")))])]):t._e(),e("th",{staticClass:"text-center d-none"},[e("span",[t._v(t._s(t.$t("SummarizeLineItems")))])]),"yes"==t.configNotes?e("th",[e("span",[t._v(t._s(t.$t("Notes")))])]):t._e(),e("th",{staticClass:"text-center single-action"},[e("span",[t._v(t._s(t.$t("Delete")))])])])]),e("tbody",[t._l(t.InvoiceData,(function(a,i){return e("tr",{key:a.DIVISIONS_ID},[0==a.DIVISIONS_ID?e("td",[e("input",{directives:[{name:"model",rawName:"v-model",value:a.NAME,expression:"item.NAME"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:a.NAME},on:{input:function(e){e.target.composing||t.$set(a,"NAME",e.target.value)}}})]):0!=a.DIVISIONS_ID?e("td",[t._v(" "+t._s(a.NAME)+" ")]):t._e(),0==a.DIVISIONS_ID?e("td",[e("input",{directives:[{name:"model",rawName:"v-model",value:a.DESCRIPTION,expression:"item.DESCRIPTION"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:a.DESCRIPTION},on:{input:function(e){e.target.composing||t.$set(a,"DESCRIPTION",e.target.value)}}})]):0!=a.DIVISIONS_ID?e("td",[t._v(" "+t._s(a.DESCRIPTION)+" ")]):t._e(),e("td",{staticClass:"text-center"},[e("label",{staticClass:"switch w70"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.AUTO_INVOICE,expression:"item.AUTO_INVOICE"},{name:"disabled",rawName:"v-disabled",value:t.disabled,expression:"disabled"}],staticClass:"form-check-input custom-control-input dynamic",attrs:{type:"checkbox",name:"IsLogin"},domProps:{checked:Array.isArray(a.AUTO_INVOICE)?t._i(a.AUTO_INVOICE,null)>-1:a.AUTO_INVOICE},on:{change:function(e){var i=a.AUTO_INVOICE,s=e.target,n=!!s.checked;if(Array.isArray(i)){var l=null,o=t._i(i,l);s.checked?o<0&&t.$set(a,"AUTO_INVOICE",i.concat([l])):o>-1&&t.$set(a,"AUTO_INVOICE",i.slice(0,o).concat(i.slice(o+1)))}else t.$set(a,"AUTO_INVOICE",n)}}}),e("span",{staticClass:"slider round",staticStyle:{cursor:"default"}},[e("span",{staticClass:"slider-yes"},[t._v(t._s(t.$t("Yes")))]),e("span",{staticClass:"slider-no"},[t._v(t._s(t.$t("No")))])])])]),e("td",{staticClass:"text-center"},[e("label",{staticClass:"switch w70"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.AUTOMATE_INVOICE_WORKDAY,expression:"item.AUTOMATE_INVOICE_WORKDAY"},{name:"disabled",rawName:"v-disabled",value:t.disabled,expression:"disabled"}],staticClass:"form-check-input custom-control-input dynamic",attrs:{type:"checkbox",name:"IsLogin"},domProps:{checked:Array.isArray(a.AUTOMATE_INVOICE_WORKDAY)?t._i(a.AUTOMATE_INVOICE_WORKDAY,null)>-1:a.AUTOMATE_INVOICE_WORKDAY},on:{change:function(e){var i=a.AUTOMATE_INVOICE_WORKDAY,s=e.target,n=!!s.checked;if(Array.isArray(i)){var l=null,o=t._i(i,l);s.checked?o<0&&t.$set(a,"AUTOMATE_INVOICE_WORKDAY",i.concat([l])):o>-1&&t.$set(a,"AUTOMATE_INVOICE_WORKDAY",i.slice(0,o).concat(i.slice(o+1)))}else t.$set(a,"AUTOMATE_INVOICE_WORKDAY",n)}}}),e("span",{staticClass:"slider round",staticStyle:{cursor:"default"}},[e("span",{staticClass:"slider-yes"},[t._v(t._s(t.$t("Yes")))]),e("span",{staticClass:"slider-no"},[t._v(t._s(t.$t("No")))])])])]),e("td",[e("select",{directives:[{name:"model",rawName:"v-model",value:a.INVOICE_FREQUENCY,expression:"item.INVOICE_FREQUENCY"}],class:{"form-control":!0},attrs:{name:"INVOICE_FREQUENCY"},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(a,"INVOICE_FREQUENCY",e.target.multiple?i:i[0])}}},[e("option",{attrs:{value:"",disabled:"",selected:""}},[t._v(t._s(t.$t("Select")))]),e("option",{attrs:{value:"week"}},[t._v(t._s(t.$t("Weekly")))]),e("option",{attrs:{value:"biweek"}},[t._v(t._s(t.$t("BiWeekly")))]),e("option",{attrs:{value:"month"}},[t._v(t._s(t.$t("Monthly")))]),e("option",{attrs:{value:"quarterly"}},[t._v(t._s(t.$t("Quarterly")))]),e("option",{attrs:{value:"halfyear"}},[t._v(t._s(t.$t("HalfYear")))]),e("option",{attrs:{value:"annual"}},[t._v(t._s(t.$t("Annually")))]),e("option",{attrs:{value:"custom"}},[t._v(t._s(t.$t("CustomDate")))]),e("option",{attrs:{value:"daily"}},[t._v(t._s(t.$t("Daily")))])])]),e("td",[e("input",{directives:[{name:"model",rawName:"v-model",value:a.INVOICE_MEMO,expression:"item.INVOICE_MEMO"}],class:{"form-control":!0},attrs:{type:"text"},domProps:{value:a.INVOICE_MEMO},on:{input:function(e){e.target.composing||t.$set(a,"INVOICE_MEMO",e.target.value)}}})]),e("td",[e("input",{directives:[{name:"model",rawName:"v-model",value:a.PO_NUMBER,expression:"item.PO_NUMBER"}],class:{"form-control":!0},attrs:{type:"text"},domProps:{value:a.PO_NUMBER},on:{input:function(e){e.target.composing||t.$set(a,"PO_NUMBER",e.target.value)}}})]),t.isShowWorkdayInvoiceType?e("td",[e("select",{directives:[{name:"model",rawName:"v-model",value:a.INVOICE_TYPE_ID,expression:"item.INVOICE_TYPE_ID"}],class:{"form-control":!0},attrs:{name:"DetailTemplate"},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(a,"INVOICE_TYPE_ID",e.target.multiple?i:i[0])}}},[e("option",{attrs:{value:"",disabled:"",selected:""}},[t._v(t._s(t.$t("Select")))]),t._l(t.invoiceTypeList,(function(a){return e("option",{key:a.INVOICE_TYPE_ID,domProps:{value:a.INVOICE_TYPE_ID}},[t._v(" "+t._s(a.NAME)+" ")])}))],2)]):t._e(),e("td",{staticStyle:{display:"none"}},[e("select",{directives:[{name:"model",rawName:"v-model",value:a.INVOICE_DETAIL_TEMPLATE,expression:"item.INVOICE_DETAIL_TEMPLATE"}],class:{"form-control":!0},attrs:{name:"DetailTemplate"},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(a,"INVOICE_DETAIL_TEMPLATE",e.target.multiple?i:i[0])}}},[e("option",{attrs:{value:"",disabled:"",selected:""}},[t._v(t._s(t.$t("Select")))]),t._l(t.invoiceDetailTemplateList,(function(a){return e("option",{key:a.invoice_template_id,domProps:{value:a.invoice_template_id}},[t._v(" "+t._s(a.invoice_template_name)+" ")])}))],2)]),e("td",{staticStyle:{display:"none"}},[e("select",{directives:[{name:"model",rawName:"v-model",value:a.DETAIL_FORMAT_TYPE,expression:"item.DETAIL_FORMAT_TYPE"}],class:{"form-control":!0},attrs:{name:"DETAIL_FORMAT_TYPE"},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(a,"DETAIL_FORMAT_TYPE",e.target.multiple?i:i[0])}}},[e("option",{attrs:{value:"",disabled:"",selected:""}},[t._v(t._s(t.$t("Select")))]),t._l(t.fileFormatList,(function(a){return e("option",{key:a.Value,domProps:{value:a.Value}},[t._v(" "+t._s(a.Name)+" ")])}))],2)]),t.isAssociateProjectWithDivision?e("td",[e("select",{directives:[{name:"model",rawName:"v-model",value:a.PROJECT_ID,expression:"item.PROJECT_ID"}],class:{"form-control":!0},attrs:{name:"PROJECT_ID"},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(a,"PROJECT_ID",e.target.multiple?i:i[0])}}},[e("option",{attrs:{value:"",disabled:"",selected:""}},[t._v(t._s(t.$t("Select")))]),t._l(t.projectList,(function(a){return e("option",{key:a.PROJECT_ID,domProps:{value:a.PROJECT_ID}},[t._v(" "+t._s(a.PROJECT_NAME)+" ")])}))],2)]):t._e(),e("td",{staticClass:"text-center d-none"},[e("label",{staticClass:"switch w70"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.SUMMARIZED_LINE_ITEMS,expression:"item.SUMMARIZED_LINE_ITEMS"},{name:"disabled",rawName:"v-disabled",value:t.disabled,expression:"disabled"}],staticClass:"form-check-input custom-control-input dynamic",attrs:{type:"checkbox",name:"IsLogin"},domProps:{checked:Array.isArray(a.SUMMARIZED_LINE_ITEMS)?t._i(a.SUMMARIZED_LINE_ITEMS,null)>-1:a.SUMMARIZED_LINE_ITEMS},on:{change:function(e){var i=a.SUMMARIZED_LINE_ITEMS,s=e.target,n=!!s.checked;if(Array.isArray(i)){var l=null,o=t._i(i,l);s.checked?o<0&&t.$set(a,"SUMMARIZED_LINE_ITEMS",i.concat([l])):o>-1&&t.$set(a,"SUMMARIZED_LINE_ITEMS",i.slice(0,o).concat(i.slice(o+1)))}else t.$set(a,"SUMMARIZED_LINE_ITEMS",n)}}}),e("span",{staticClass:"slider round",staticStyle:{cursor:"default"}},[e("span",{staticClass:"slider-yes"},[t._v(t._s(t.$t("Yes")))]),e("span",{staticClass:"slider-no"},[t._v(t._s(t.$t("No")))])])])]),"yes"==t.configNotes?e("td",{staticClass:"text-center single-action"},[e("a",{staticClass:"text-dark single-action",attrs:{href:"javascript:;"},on:{click:function(e){return t.ViewNotes(a)}}},[e("em",{staticClass:"fa fa-file-text-o",attrs:{"aria-hidden":"true"}}),e("span",{staticClass:"noti-circle noti-orange"},[t._v(t._s(a.NO_OF_NOTES))])])]):t._e(),e("td",{staticClass:"text-center"},[e("a",{staticClass:"blue recyclebin enable ancdeleteadditionalinfo",on:{click:function(e){return t.RemoveInvoice(i,a.DIVISIONS_ID)}}},[e("i",{staticClass:"fa fa-trash text-danger action-icon"})])])])})),t.IsInvoiceGroupingDataShow?e("tr",[e("td",{staticClass:"text-center text-danger no_records no-record",attrs:{colspan:"10"}},[t._v(" "+t._s(t.$t("NoRecordfound"))+" ")])]):t._e()],2)])]),e("div",{staticClass:"col-lg-12 p-0 float-left text-right mt-3"},[e("a",{staticClass:"btn btn-success save-btn mr-2",attrs:{href:"javascript:;",title:"Save"},on:{click:function(e){return t.SaveInvoiceData()}}},[e("i",{staticClass:"fa fa-save pr-2"}),t._v(t._s(t.$t("Save"))+" ")]),e("a",{staticClass:"btn btn-danger",attrs:{href:"javascript:;",title:"Cancel"},on:{click:function(e){return t.Cancel()}}},[e("i",{staticClass:"fa fa-close pr-2"}),t._v(t._s(t.$t("Cancel"))+" ")]),e("input",{attrs:{type:"hidden",id:"hdnPageNum",value:"1"}})])])])]),t.isShowAddNoteDivision?e("AddNoteUtilityOrDivision",{attrs:{divisionId:t.divisionId,viewType:"InvoiceGrouping",utilityId:t.utilityId,clientId:t.clientId,modulename:"Billing",submodulecode:"Billing_InvoiceGrouping",callbackfunction:t.GetDivisionMappingDetail}}):t._e()],1)},Ya=[],Va=function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header ui-draggable-handle d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("Notes")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})]),e("span",{staticClass:"user-guide"},[e("a",{staticClass:"ancuserguide text-white",attrs:{"data-toggle":"collapse",href:"#collapseReplyUG",role:"button","aria-expanded":"false","aria-controls":"collapseExample"}},[e("em",{staticClass:"fa fa-files-o pr-2"}),t._v(t._s(t.$t("GuideForUser")))]),e("div",{staticClass:"divancuserguide collapse overflow-auto",attrs:{id:"collapseReplyUG"}},[e("div",{staticClass:"custom-scrollbar-js",attrs:{id:"scrollbarreplyuserguideMangeView"}},[e("div",{staticClass:"con",domProps:{innerHTML:t._s(t.$t("UgAddNotes"))}})])])])]),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"heading-border"},[e("h5",{staticClass:"h5"},[e("span",[t._v(t._s(t.$t("Notes")))]),e("small",{staticClass:"float-right"},[e("a",{attrs:{href:"javascript:;",id:"showattachment",title:"Add Note"},on:{click:t.ShowNotePopUp}},[e("i",{staticClass:"fa fa-file-text-o pr-2"}),t._v(t._s(t.$t("Add"))+" "+t._s(t.$t("NoteKey")))])])])]),e("div",{staticClass:"modal-data",staticStyle:{"padding-top":"10px"}},[t.ShowNotePopUpData?e("dynamic-form",{attrs:{lang:"en",buttons:t.buttons,schema:t.FormSchema},on:{OnSubmit:t.UploadFileWithNote},scopedSlots:t._u([{key:"tgslot-Description",fn:function({data:a}){return[e("ckeditor",{attrs:{editor:t.editor},on:{ready:t.onReady},model:{value:a.fieldInfo.value,callback:function(e){t.$set(a.fieldInfo,"value",e)},expression:"data.fieldInfo.value"}}),e("span",{staticClass:"invalid-feedback d-block",attrs:{name:"Description"}},[t._v(t._s(a.error))])]}}],null,!1,2349768450)}):t._e(),null!=t.NoteList?e("div",{staticClass:"w-100",attrs:{id:"tab-notes-content-quickview"}},[e("NoteUtilityNotes",{attrs:{NoteData:t.NoteList}})],1):t._e(),t.noRecord?e("div",{staticClass:"text-danger text-center no-record float-left w-100"},[t._v(" "+t._s(t.$t("NoRecordfound"))+" ")]):t._e()],1)])])])])],1)},Ha=[],ja=function(){var t=this,e=t._self._c;return e("section",[e("loader",{attrs:{"is-visible":t.isLoading}}),t.NoteList.length>0?[e("div",{staticClass:"pb-2",attrs:{id:"div_NotesLabel"}},[e("span",{staticClass:"legend-Progress colorboxsquare"}),t._v(t._s(t.$t("Private"))+" "),e("span",{staticClass:"legend-upcoming colorboxsquare ml-3"}),t._v(t._s(t.$t("Public"))+" ")]),e("div",{staticClass:"row card-view no-bg custom-box-width"},t._l(t.NoteList,(function(a,i){return e("div",{key:i,staticClass:"col-md-12 col-lg-6 col-xl-3 mb-3"},[e("div",{class:{"card-box":!0,"green-bg-light":"Public"!=a.PRIVACY,"blue-bg-light":"Public"==a.PRIVACY}},[e("div",{staticClass:"card-heading"},[e("span",{staticClass:"user-img-con mr-2"},[a.AVATAR?e("img",{staticClass:"img-circle avatar",attrs:{src:a.AVATAR,alt:t.$t("Image")}}):e("img",{staticClass:"img-circle avatar",attrs:{src:"https://talygenv.github.io/Vue-UI-Content/images/avatar-icon.jpg",alt:t.$t("Image"),border:"0"}})]),t._v(" "+t._s(a.DEPARTMENT_NAME?a.DEPARTMENT_NAME:"--")+" ")]),e("div",{staticClass:"card-detail-main1 dynamiclistol"},[e("div",{staticClass:"card-detail"},[e("em",{staticClass:"fa fa-user",attrs:{"aria-hidden":"true"}}),e("span",[t._v(t._s(a.CREATED_BY_NAME))])]),e("hr",{staticClass:"my-2"}),e("div",{staticClass:"clearfix"}),e("div",{staticClass:"commentnoteslist",staticStyle:{"max-height":"150px","overflow-y":"auto"}},[e("div",{staticClass:"w-100 float-left custom-scrollbar-js",domProps:{innerHTML:t._s(a.NOTE)}})])]),e("div",{staticClass:"bottom-action"},[e("div",{staticClass:"card-date"},[e("em",{staticClass:"fa fa-calendar-o",attrs:{"aria-hidden":"true"}}),e("span",[t._v(" "+t._s(a.CREATED_AT?t.$options.filters.formatDateTime(a.CREATED_AT):"--")+" ")])]),e("div",{staticClass:"card-action"},[a.ATTACHMENT_ID>0?e("a",{staticClass:"round-icon-small btn-primary-light downloadAttachement",attrs:{title:t.$t("ClickHereDownloadAttachment"),alt:t.$t("DownloadFile"),href:"javascript:;",value:a.ATTACHMENT_ID},on:{click:function(e){return t.DownloadAttachment(a)}}},[e("em",{staticClass:"fa fa-download"})]):t._e(),1!=t.ListNoteData?e("a",{staticClass:"round-icon-small btn-success-light",attrs:{title:t.$t("EditNotes"),alt:t.$t("EditNotes"),href:"javascript:;"},on:{click:function(e){return t.EditNote(a)}}},[e("em",{staticClass:"fa fa-edit"})]):t._e()])])])])})),0)]:t._e(),t.NoRecords?e("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 mt-2"},[e("span",{staticClass:"text-danger text-center d-block no-record"},[t._v(t._s(t.$t("NoRecordfound")))])]):t._e()],2)},qa=[],za={props:{NoteData:{type:Array,required:!0},ListNoteData:{type:Number,required:!1}},data(){return{NoRecords:!1,isShowAddNote:!1,UserId:null,NoteList:[],isLoading:!1,noteId:0,noteDataById:[]}},watch:{NoteData:function(t){var e=this;e.NoteList=t,e.NoteList.length>0?e.NoRecords=!1:(e.NoteList=[],e.NoRecords=!0)}},created(){setTimeout(()=>{var t=this;t.UserId=t.GetUserInfo.ID,t.ListNoteData=this.ListNoteData,t.isBlank(t.NoteData)?(t.NoRecords=!0,t.NoteList=[]):(t.NoteList=t.NoteData,t.NoRecords=!1)},500)},methods:{EditNote:function(t){var e=this;e.$parent._data.FormSchema[0].Data[0].value=t.NOTE,e.$parent._data.FormSchema[1].Data[0].value="Public"==t.PRIVACY?2:1,e.$parent.noteId=t.NOTE_ID,e.$parent.ShowNotePopUpData=!0,e.$parent.ShowNotePopUpData=!0},DownloadAttachment(t){var e=this;e.isLoading=!0;var a=`filePath=${t.ATTACHMENT_PATH}&fileName=${t.ATTACHMENT_NAME}`;n["a"].DownloadFile(a).then((function(a){e.isLoading=!1;const i=a.data,s=`data:${JSON.parse(t.ATTACHMENT_DESC).ContentType};base64,${i}`;var n=document.createElement("a");n.href=s,n.setAttribute("download",t.ATTACHMENT_NAME),document.body.appendChild(n),n.click()})),e.isLoading=!1}}},Wa=za,Ja=Object(d["a"])(Wa,ja,qa,!1,null,null,null),Ka=Ja.exports,Qa={components:{NoteUtilityNotes:Ka},props:{divisionId:{type:Number,required:!1},clientId:{type:Number,required:!1},utilityId:{type:Number,required:!1},modulename:{type:String,required:!0},submodulecode:{type:String,required:!0},callbackfunction:{type:Function},viewType:{type:String,required:!0}},data(){return{showError:!1,editor:this.CLASSIC_EDITOR,content:"<h1>Some initial content</h1>",privacyType:"",isLoading:!1,TicketBindList:[],NoteList:[],Description:null,ShowNotePopUpData:!1,FileName:null,checkFileValidSize:!1,checkFileValidExt:!1,allowedPerFileSizeInMb:0,noRecord:!1,disallowFileTypes:"",file:null,noteId:0,fileTypeList:[],noteModal:{NoteDescription:"",privacy:"",NoteId:0,ModuleName:"",SubModuleCode:"",ClientId:0,DivisionId:0,UtilityId:0,fileData:[],type:""},FormSchema:[{layoutType:"single",Data:[{astype:"SlotField",label:this.$t("NotesDescription"),name:"Description",value:"",placeholder:"",config:{options:[]},settings:{isInSlot:!0},visibility:!0,validationRules:{required:!0,max:5e3}}]},{layoutType:"single",Data:[{astype:"RadioField",label:"",name:"Type",value:2,placeholder:"",validationRules:{required:!1,max:200},config:{options:[{name:this.$t("Private"),value:1},{name:this.$t("Public"),value:2}],showAddIcon:!1,onChange:this.onChangeRadio}}]},{group_name:"Attachment",layoutType:"single",Data:[{astype:"FileField",showLabel:!1,name:"ListNoteAttachment",placeholder:"",validationRules:"",FieldIndex:0,config:{maxSize:5,onChange:this.GetBase64String,showAddIcon:!1,onAddButtonClick:"",multiple:!0}}]}],buttons:[{type:"submit",class:"btn btn-success save",text:"<i class='fa fa-save pr-2'></i>Submit"},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Cancel",onClick:this.Close}]}},created:async function(){var t=this;t.LoadUtilityDivisionNotes()},methods:{LoadUtilityDivisionNotes:async function(){var t=this,e="";"Utility"==t.viewType?e=`divisionId=&utilityId=${t.utilityId}&clientId=${t.clientId}`:"InvoiceGrouping"==t.viewType&&(e=`divisionId=${t.divisionId}&utilityId=0&clientId=${t.clientId}`),await n["a"].GetNoteUtilityDivisionList(e).then((function(e){null!=e.data&&e.data.length>0?t.NoteList=e.data:(t.NoteList=null,t.noRecord=!0)}))},ShowNotePopUp:function(){var t=this;0==t.ShowNotePopUpData?(t.ShowNotePopUpData=!0,t.noRecord=!1,t.fileTypeList=this.AttachmentDisallowedFileType(this.disallowFileTypes),t.FormSchema[2].Data[0].config.reject=this.fileTypeList):t.ShowNotePopUpData=!1},onReady(t){t.ui.getEditableElement().parentElement.insertBefore(t.ui.view.toolbar.element,t.ui.getEditableElement())},onChangeRadio:function(t,e){var a=this;a.privacyType=t.target.dataset.value},LoadNotesForQuickView:async function(t){var e=this;null!=t&&"undefined"!=t||(t=e.moduleName);var a=`ticketId=${e.id}&isSuptTckt=false&moduleName=${t}&isView=1`;await n["a"].GetWorkOrderNoteList(a).then((function(t){null!=t.data&&t.data.length>0?(e.NoteList=t.data,$("#tab-notes-content-quickview").removeClass("d-none")):($("#div_NotesLabel").removeClass("d-none"),e.NoteList=null,e.noRecord=!0)}))},GetBase64String:function(t){try{var e=this;e.fileData=[];var a=t.target.files[0],i=new FileReader;i.onload=function(t){return function(t){var i=t.target.result,s=window.btoa(i),n=a.name;e.fileName=n;var l=n.lastIndexOf("."),o=n.substring(l+1,n.length);e.fileExt+="."+o;var r='{"ContentType":"'+a.type+'","Size":"'+a.size+'","Extension":"'+o+'"}',c=a.size;e.fileSize=c;var d={attachement_mime:r,fileName:n,base64String:s,fileSize:a.size,contentType:a.type};e.fileData.push(d)}}(),i.readAsBinaryString(a)}catch(s){}},UploadFileWithNote:function(t,e){var a=this;if(a.buttons[0].class+=" disabled",""!=a._data.FormSchema[0].Data[0].value&&null!=a._data.FormSchema[0].Data[0].value){a.noteModal.privacy=1==a.privacyType?"Private":"Public",a.noteModal.NoteDescription=a._data.FormSchema[0].Data[0].value,a.noteModal.NoteId=0==a.noteId?0:a.noteId,a.noteModal.ClientId=a.clientId,a.noteModal.DivisionId=a.divisionId,a.noteModal.UtilityId=a.utilityId,a.noteModal.ModuleName=a.modulename,a.noteModal.SubModuleCode=a.submodulecode,a.noteModal.type="Add",a.noteModal.fileData=a.fileData;var i=JSON.stringify(a.noteModal);n["a"].AddNoteUtilityDivision(i).then(t=>{try{null!=t.data&&""!=t.data&&"Success"==t.data.status?(a.ShowAlert(a.$t("AddedSuccess",[a.$t("Notes")]),"success",!0,a.$t("Alert")),$("input[type=text]").val(""),a.Close(),"Utility"==a.viewType?a.$parent.$parent.LoadAdditionalInfo():"InvoiceGrouping"==a.viewType&&a.$parent.$parent.GetInvoicedata()):(a.FileSrc="",$("input[type=text]").val(""))}catch(e){return HandleErrorOccured(e,"saveNote")}})}},Close:function(){this._data.FormSchema[0].Data[0].value=null,this.FileName=null,this.file=null,this.FormSchema[2].Data[0].config.onChange=this.GetBase64String,this.$parent.isShowAddNoteDivision=!1,this.$parent.noRecord=!1}}},Za=Qa,Xa=Object(d["a"])(Za,Va,Ha,!1,null,null,null),ti=Xa.exports,ei={components:{AddNoteUtilityOrDivision:ti},props:{UserId:{type:Number},ClientData:{type:Object},InvoiceData:{type:Array},IsInvoiceGroupingDataShow:{type:Boolean}},data(){return{isLoading:!1,CompanyId:null,UserId:null,Result:[],invoiceFrequencyCustomDate:[],invoiceTypeList:[],projectList:[],invoiceDetailTemplateList:[],fileFormatList:[],configNotes:"",isAssociateProjectWithDivision:!1,isShowWorkdayInvoiceType:!1,isShowAddNoteDivision:!1,divisionId:0,clientId:0,utilityId:0,isCheckExtraFeatureUtilityBilling:!1,isCheckExtraFeatureUSICBILLING:!1}},created:async function(){var t=this;t.CompanyId=t.GetUserInfo.CompanyId,await t.CheckFeaturesForCompany("USICBILLING"),await t.CheckFeaturesForCompany("UTILITY_BILLING"),await t.CheckExtraFeatures("AssociateProjectWithDivision"),await t.CheckExtraFeatures("EnableWorkdayInvoiceType"),await t.GetDivisionMappingDetail()},methods:{CheckFeaturesForCompany:async function(t){var e=this,a="featureCode="+t;await n["a"].CheckExtraFeatures(a).then((function(a){"USICBILLING"==t?1==a.data?e.isCheckExtraFeatureUSICBILLING=!0:e.isCheckExtraFeatureUSICBILLING=!1:"UTILITY_BILLING"==t&&(1==a.data?e.isCheckExtraFeatureUtilityBilling=!0:e.isCheckExtraFeatureUtilityBilling=!1)}))},ViewNotes:function(t){var e=this;e.divisionId=t.DIVISIONS_ID,e.clientId=this.UserId,e.isShowAddNoteDivision=!0},GetDivisionMappingDetail:async function(){await n["a"].GetDivisionMappingDetail().then(t=>{null!=t.data&&(this.invoiceFrequencyCustomDate=t.data.invoiceFrequencyCustomDateDropdDownList?JSON.parse(t.data.invoiceFrequencyCustomDateDropdDownList):[],this.invoiceTypeList=t.data.listInvType?JSON.parse(t.data.listInvType):[],this.projectList=t.data.projectDetailDropdDownList?JSON.parse(t.data.projectDetailDropdDownList):[],this.invoiceDetailTemplateList=t.data.invoiceDetailTemplateDropdDownList?JSON.parse(t.data.invoiceDetailTemplateDropdDownList):[],this.fileFormatList=t.data.invoiceDetailFileFormatDropdDownList?JSON.parse(t.data.invoiceDetailFileFormatDropdDownList):[],this.configNotes=t.data.getNotesByCompanyId)})},async CheckExtraFeatures(t){const e="featureCode="+t;try{const a=await n["a"].CheckExtraFeatures(e);a.data&&("AssociateProjectWithDivision"==t?this.isAssociateProjectWithDivision=!0===a.data:this.isShowWorkdayInvoiceType=!0===a.data)}catch(a){console.error("Error checking extra features:",a)}},RemoveInvoice(t,e){var a=this,i=a.$t("ConfirmDelete");a.confirmR(i,!0,null,(function(){if(a.InvoiceData.splice(t,1),0!=e){var i={ids:e,companyId:a.CompanyId,userId:a.user_id,moduleName:"Billing",refCode:"TALYGEN_BE_BILLING_DIVISION"},s=JSON.stringify(i);n["a"].CommonCommonDelete(s).then(t=>{200==t.status?(a.$parent.GetInvoicedata(),a.ShowAlert(a.$t("DeletedSuccess",[a.$t("Division")]),"Success",!0,a.$t("Alert"))):a.ShowAlert(a.$t("DeletedError",[a.$t("Division")]),"failure",!0,a.$t("Alert"))})}}))},SaveInvoiceData:function(){var t=this,e="ClientId="+t.UserId,a={MainData:t.InvoiceData};n["a"].SaveInvoiceData(e,a).then((function(e){"Success"==e.data.status?(t.ShowAlert(t.$t("UpdatedSuccess",[t.$t("Division")]),"success",!0,t.$t("Alert")),t.$parent.GetInvoicedata(),t.$parent.IsInvoiceGroupingDataShow=!1):t.ShowAlert(t.$t("UnknownErrorOccur"),"failure",!0,t.$t("Alert"))}))},Cancel:function(){var t=this;t.$parent.GetInvoicedata()}}},ai=ei,ii=Object(d["a"])(ai,Ga,Ya,!1,null,null,null),si=ii.exports,ni=function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("Holiday"))+" "+t._s(t.$t("Bank"))+" ")]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.CloseHolidayBank}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("dynamic-form",{ref:"AssignTagForm",attrs:{lang:"en",schema:t.FormSchema},on:{OnSubmit:t.OnSubmit}}),t._l(t.countries,(function(a,i){return e("div",{key:i,staticClass:"w-100 float-left",attrs:{id:"divHolidayBankListing"}},t._l(a.locations,(function(s,n){return e("div",{key:n},[e("div",{staticClass:"designcontroller boxsizing mb-3"},[e("div",{staticClass:"col-lg-12 float-left px-0 mb-2 designcontroller boxsizing"},[e("div",{staticClass:"heading-border"},[e("h5",{staticClass:"h5"},[e("span",[e("b",[t._v(t._s(t.$t("CountryLevel"))+":")]),t._v(" "+t._s(a.CountryName))])])])]),e("div",{staticClass:"listing countrylisting"},[e("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 search Search-panel float-left py-2 p-0",attrs:{id:"divHolidayBankDataForSearch"}},[e("div",{staticClass:"col-12 float-left"},[e("div",{staticClass:"row mt-0"},[e("div",{staticClass:"col-6 float-left pr-1 pl-0"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchQuery[i][n],expression:"searchQuery[countryIndex][locationIndex]"}],staticClass:"form-control txtHolidayBankDataSearch",attrs:{type:"text",placeholder:"Search by Holiday Name"},domProps:{value:t.searchQuery[i][n]},on:{input:function(e){e.target.composing||t.$set(t.searchQuery[i],n,e.target.value)}}})]),e("div",{staticClass:"col-3 float-left pl-0"},[e("div",{staticClass:"search-btm-btn background-0 text-left form-check-inline"},[e("a",{staticClass:"btn btn-success mr-1 px-4 text-white",attrs:{title:"Search",id:"aHolidayBankDataSearch_1"},on:{click:function(e){return t.searchHoliday(i,n)}}},[e("i",{staticClass:"fa fa-search"})]),e("a",{staticClass:"btn btn-danger px-4 text-white",attrs:{title:"Clear all ",id:"clearHolidayBank_1"},on:{click:function(e){return t.clearSearch(i,n)}}},[e("i",{staticClass:"fa fa-refresh"})])])]),e("div",{staticClass:"col-lg-3 col-sm-12 mt-3 p-0",attrs:{id:"divShowlistingData"}},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"mr-2 d-inline-block"},[e("span",{staticClass:"legends_medium colorboxsquare"}),t._v(t._s(t.$t("HolidayBank"))+" ")]),e("div",{staticClass:"mr-2 d-inline-block"},[e("span",{staticClass:"legends_high colorboxsquare"}),t._v(t._s(t.$t("ManualHoliday"))+" ")])])])])])])]),e("div",{staticClass:"table-responsive table-fix-header"},[e("table",{staticClass:"table table-bordered mt-0",staticStyle:{width:"100%"},attrs:{id:"tblHBList_"+i+"_"+n}},[e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",{staticClass:"text-center",attrs:{width:"5%"}},[t._v(t._s(t.$t("Select")))]),e("th",{staticStyle:{width:"174px"}},[e("span",{staticClass:"ui-resizable",staticStyle:{"min-width":"174px"},attrs:{id:"HolidayName"}},[t._v(t._s(t.$t("HolidayName")))])]),e("th",{staticStyle:{width:"258px"}},[e("span",{staticClass:"ui-resizable",staticStyle:{"min-width":"258px"},attrs:{id:"HolidayDescription"}},[t._v(t._s(t.$t("HolidayDescription")))])]),e("th",{staticStyle:{width:"138px"}},[e("span",{staticClass:"ui-resizable",staticStyle:{"min-width":"138px"},attrs:{id:"Recurring"}},[t._v(t._s(t.$t("Recurring")))])]),e("th",{staticStyle:{width:"174px"}},[e("span",{staticClass:"ui-resizable",staticStyle:{"min-width":"174px"},attrs:{id:"HolidayType"}},[t._v(t._s(t.$t("HolidayType")))])])])]),t._l(t.filteredHolidays(a.CountryId,s.LocationId),(function(a,i){return e("tbody",{key:i},[e("tr",{class:{"high-bar":1==a.isManual,"medium-bar":0==a.isManual}},[a.old_Holiday_id>0&&t.UserId>0?e("td",{staticClass:"text-center"},[e("div",{staticClass:"custom-control custom-checkbox"},[e("input",{staticClass:"chkItems popchk custom-control-input",staticStyle:{display:"none"},attrs:{type:"checkbox",name:"Checkbox_"+a.bank_Holiday_Id,id:"Checkbox_"+a.bank_Holiday_Id},domProps:{value:a.bank_Holiday_Id},on:{change:function(e){return t.CheckCheckBox(a)}}}),e("label",{staticClass:"custom-control-label universal-custom-control-label pt-1",attrs:{for:"Checkbox_"+a.bank_Holiday_Id}})])]):e("td",{staticClass:"text-center"},[e("div",{staticClass:"custom-control custom-checkbox"},[e("input",{staticClass:"chkItems popchk custom-control-input",staticStyle:{display:"none"},attrs:{disabled:"disabled",type:"checkbox",name:"Checkbox_"+a.bank_Holiday_Id,id:"Checkbox_"+a.bank_Holiday_Id},domProps:{value:a.bank_Holiday_Id}}),e("label",{staticClass:"custom-control-label universal-custom-control-label pt-1",attrs:{for:"Checkbox_"+a.bank_Holiday_Id}})])]),e("td",[t._v(t._s(a.bank_Holiday_Name))]),e("td",[t._v(t._s(a.bank_Holiday_Desc))]),e("td",{staticClass:"text-center"},[e("label",{staticClass:"switch w70"},[e("input",{staticClass:"form-check-input custom-control-input dynamic",attrs:{name:"Checkbox_"+a.isRecurring,type:"checkbox"},domProps:{checked:1==a.isRecurring}}),e("span",{staticClass:"slider round",staticStyle:{cursor:"default"}},[e("span",{staticClass:"slider-yes"},[t._v(t._s(t.$t("Yes")))]),e("span",{staticClass:"slider-no"},[t._v(t._s(t.$t("No")))])])])]),e("td",[e("div",{staticClass:"pl-0 border-0"},[e("div",{staticClass:"custom-control custom-radio d-inline-block"},[e("input",{staticClass:"form-check-input radio-checkbox",attrs:{id:"IsFixed_"+a.isFixedDate,type:"radio",disabled:a.old_Holiday_id>0,name:"IsFixed_"+a.isFixedDate,value:"1"},domProps:{checked:a.isFixedDate>0}}),e("label",{staticClass:"form-check-label",attrs:{for:"IsFixed_"+a.isFixedDate}},[t._v(t._s(t.$t("Fixed")))])]),e("div",{staticClass:"custom-control custom-radio d-inline-block"},[e("input",{staticClass:"form-check-input radio-checkbox",attrs:{id:"IsFixed_"+a.isFixedDate,type:"radio",name:"IsFixed_"+a.isFixedDate,value:"0",disabled:a.old_Holiday_id>0},domProps:{checked:a.isFixedDate<1}}),e("label",{staticClass:"form-check-label",attrs:{for:"IsFixed_"+a.isFixedDate}},[t._v(t._s(t.$t("Observed")))])])])])])])}))],2)])])])])})),0)})),e("div",{staticClass:"clearfix"}),e("div",{staticClass:"row flex-row-reverse"},[e("div",{staticClass:"col-lg-12 text-right mt-3"},[e("a",{staticClass:"btn btn-success mr-2",attrs:{href:"javascript:;",title:"Save",value:"Save",name:"btnSaveHB"},on:{click:t.btnSaveHB}},[e("i",{staticClass:"fa fa-save pr-2"}),t._v(t._s(t.$t("Save")))]),e("a",{staticClass:"btn btn-danger",attrs:{href:"javascript:;",title:"Cancel"},on:{click:t.CloseHolidayBank}},[e("i",{staticClass:"fa fa-close pr-2"}),t._v(t._s(t.$t("Cancel")))])])])],2)])])])],1)},li=[],oi={components:{"tree-view":Ta["TreeSelectField"]},data(){return{isLoading:!1,RequestForm:"Client",FormSchema:[{layoutType:"single",Data:[{astype:"RadioField",name:"rdMapExisting",value:"1",visibility:!0,config:{options:[{name:this.$t("MapwithExistingHoliday"),value:1},{name:this.$t("MapwithNewHoliday"),value:0}],onChange:this.onChangeRadio}}]},{layoutType:"triple",Data:[{astype:"TreeSelectField",label:this.$t("Location"),name:"Location",value:null,visibility:!1,placeholder:"Select Location",config:{options:[]},validationRules:{required:!0}},{astype:"SelectField",label:this.$t("Status"),name:"Status",visibility:!1,value:"",config:{options:[]},placeholder:this.$t("Select Status"),validationRules:{required:!1,max:100}},{astype:"RadioField",label:this.$t("SelectYear"),name:"SelectYear",visibility:!1,value:"1",config:{options:[]}}]}],UserId:0,HolidayListData:[],countries:[],searchQuery:{},saveHolidayBankObj:[],LocationId:0,currentYear:0}},created:function(){var t=this;t.UserId=t.$route.params.id,t.currentYear=(new Date).getFullYear(),t.GetStatusList(),t.HolidayBankList(),t.CompanyHolidayMultipleLocation(),setTimeout(()=>{t.$refs.AssignTagForm.UpdateKeyValue()},200)},methods:{CompanyHolidayMultipleLocation(){var t=this,e=[],a="RequestFrom=COMPANY_LOCATIONS";n["a"].CompanyHolidayMultipleLocation(a).then((function(a){var i=a.data.result;i.forEach(i=>{var s=e.filter((function(t){return t.COMPANY_LOCATION_ID==i.COMPANY_LOCATION_ID}));if(0==s.length&&null==i.PARENT_LOCATION_ID){let s=i.COMPANY_LOCATION_ID,n=t.getChildLocation(s,i,a.data.result);e.push(n)}}),t.FormSchema[1].Data[0].config.options=e}))},getChildLocation(t,e,a){var i=this;let s={};s={id:e.COMPANY_LOCATION_ID,label:e.LOCATION_NAME};let n=s;var l=a.filter((function(e){return e.PARENT_LOCATION_ID==t}));let o=[];return l.forEach(t=>{let e=t.COMPANY_LOCATION_ID;var n=o.filter((function(e){return e.COMPANY_LOCATION_ID==t.COMPANY_LOCATION_ID}));if(0==n.length){var l=a.filter((function(t){return t.PARENT_LOCATION_ID==e}));if(null!=l&&l.length>0){let s=i.getChildLocation(e,t,a);o.push(s)}else s={id:""+t.COMPANY_LOCATION_ID,label:""+t.LOCATION_NAME},o.push(s)}}),n.children=o,n},GetStatusList:function(){var t=this,e="statusType=Category&hasglobal=true&langCode=en";n["a"].GetStatusList(e).then(e=>{if(e.data.length>0){var a=JSON.parse(e.data);a.forEach(e=>{var a={name:e.STATUS,value:e.STATUS_ID};t.FormSchema[1].Data[1].config.options.push(a)}),t.$refs.AssignTagForm.UpdateKeyValue()}})},HolidayBankList(){var t=this,e=`countryId=&searchText=&reqFrom=Client&clientId=${t.UserId}&existingMap=true`;n["a"].HolidayBankList(e).then(e=>{if(e.data.length>1){var a=e.data;t.HolidayListData=a,t.prepareCountries(a)}})},OnSubmit(){},prepareCountries(t){var e=this;const a={};t.forEach(t=>{a[t.bank_Holiday_Country_Id]||(a[t.bank_Holiday_Country_Id]={CountryId:t.bank_Holiday_Country_Id,CountryName:t.bank_Holiday_Country_Name,locations:[]});const i=a[t.bank_Holiday_Country_Id];e.LocationId=a[t.company_Location_Id],i.locations.some(e=>e.LocationId===t.company_Location_Id)||i.locations.push({LocationId:t.company_Location_Id,LocationName:t.location_Name})}),e.countries=Object.values(a),e.countries.forEach((t,a)=>{e.searchQuery[a]=[],t.locations.forEach((t,i)=>{e.searchQuery[a][i]=""})}),e.LocationId=e.countries[0].locations[0].LocationId},filteredHolidays(t,e){return this.HolidayListData.filter(a=>a.bank_Holiday_Country_Id===t&&a.company_Location_Id===e)},searchHoliday(t,e){console.log(`Search for country: ${t}, location: ${e}`)},clearSearch(t,e){this.searchQuery[t][e]=""},CloseHolidayBank(){var t=this;t.$emit("CloseHolidayBank")},onChangeRadio(){var t=this,e=[],a=t.FormSchema[0].Data[0].value;t.currentYear=(new Date).getFullYear();const i=t.currentYear-1,s=t.currentYear+1;e.push({name:`Previous Year (${i})`,value:i},{name:`Current Year (${t.currentYear})`,value:t.currentYear},{name:`Next Year (${s})`,value:s}),0==a?(t.FormSchema[1].Data[0].visibility=!0,t.FormSchema[1].Data[1].visibility=!0,t.FormSchema[1].Data[2].visibility=!0,t.FormSchema[1].Data[2].config.options=e):(t.FormSchema[1].Data[0].visibility=!1,t.FormSchema[1].Data[1].visibility=!1,t.FormSchema[1].Data[2].visibility=!1)},CheckCheckBox(t){var e=this;if(null!=t)var a={country_id:t.bank_Holiday_Country_Id,holidaybank_id:t.bank_Holiday_Id,selectedlocations:t.company_Location_Id,IsRecurring:0!=t.isRecurring,IsFixed:1==t.isFixedDate};else a={};e.saveHolidayBankObj.push(a)},btnSaveHB(){var t=this,e="";let a=t.FormSchema[0].Data[0].value;if(1!=a&&(0!=t.LocationId?e+="":e+="no"),0==t.saveHolidayBankObj.length)return t.ShowAlert(t.$t("SelectHolidayBank"),"warning",!0,t.$t("Alert")),!1;if(0==e.length){$("#visiblecolumn input:checkbox").map((function(){return this.value})).get();var i=0;$(".chkAddHolidayIn:eq(0):checked").length>0&&(i=1);var s=0;$(".contractclick:checked").length>0&&(s=1),"Client"==t.RequestForm&&(s=1);var l=1001;""!=t.FormSchema[1].Data[1].value&&(l=t.FormSchema[1].Data[1].value);var o=!0;0==a&&(o=!1),"Client"!=t.RequestForm&&(o=!1);var r={client_id:t.UserId,selectedBankHolidays:t.saveHolidayBankObj,isforcompany:i,isforcontract:s,year:t.currentYear,status:l,existingMapping:o},c=JSON.stringify(r);n["a"].SaveBankHoliday(c).then(e=>{200==e.status&&t.CloseHolidayBank()})}}}},ri=oi,ci=(a("8e2b"),Object(d["a"])(ri,ni,li,!1,null,"1d391c1a",null)),di=ci.exports,ui=function(){var t=this,e=t._self._c;return e("section",[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticStyle:{"margin-top":"12px"}},[e("MeterListing",{key:t.refreshKey,ref:"meterlisting",attrs:{ClientId:t.ClientId}})],1)],1)},pi=[],mi=function(){var t=this,e=t._self._c;return e("section",[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",[e("tg-list",{attrs:{IsShowAction:!0,ModuleName:"Company",SubModuleCode:"",LegendArray:[],RenderRowActionMethod:t.renderActions,widgets:[],IdentityColumn:"meter_mapping_id",listType:["List"],ListData:t.ListingData,HeaderData:t.Headers,HeaderButtons:t.listheaderbuttons,TotalRecords:t.TotalRecords,SearchFields:t.leftSearchFields,IsSearchFieldsOnTop:"false",SearchPosition:"top",ListDataCallBackFunction:t.FetchData,showCheckBox:!1,SortExp:t.SortExp,SortBy:t.SortBy,NorecordfoundText:t.$t("NoRecordfound")},on:{ActionButtonClick:t.actionButtonClick,LeftsearchButtonClick:function(t){},PagerButtonClick:t.pagerMethod,HeaderButtonClick:t.commonHeaderButtonClick,SortdataButtonClick:t.sortdata},scopedSlots:t._u([{key:"slotdata",fn:function({data:a}){return["SNo"==a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(a.row.SNo)+" ")])]:t._e(),"date_Of_installation"==a.column.COLUMN_NAME?[e("span",{staticClass:"text-center single-action tourguide_a"},[t._v(" "+t._s(t.$options.filters.formatDate(a.row.date_Of_installation))+" ")])]:t._e(),"status_id"==a.column.COLUMN_NAME?[1001==a.row.status_id?e("span",{staticClass:"px-2 text-center text-white d-block bg-success",attrs:{title:t.$t("Active")}},[t._v(t._s(t.$t("Active"))+" ")]):e("span",{staticClass:"px-2 bg-danger text-center text-white d-block",attrs:{title:t.$t("InActive")}},[t._v(t._s(t.$t("InActive"))+" ")])]:t._e(),"property"==a.column.COLUMN_NAME?[e("span",{attrs:{title:t.getFullAddress(a.row)}},[t._v(" "+t._s(a.row.property)+" ")])]:t._e(),"contract_name"==a.column.COLUMN_NAME?[null!=a.row.contract_name?e("span",[t._v(t._s(a.row.contract_name))]):e("span",[t._v("--")])]:t._e(),"invoice_grouping_name"==a.column.COLUMN_NAME?[null!=a.row.invoice_grouping_name?e("span",[t._v(t._s(a.row.invoice_grouping_name))]):e("span",[t._v("--")])]:t._e(),"plan_name"==a.column.COLUMN_NAME?[e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.OpenPlanDetail(a.row)}}},[e("i",{attrs:{"aria-hidden":"true"}}),t._v(t._s(a.row.plan_name)+" ")])]:t._e(),"serial_number"==a.column.COLUMN_NAME?[e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.OpenMeterDetail(a.row)}}},[e("i",{attrs:{"aria-hidden":"true"}}),t._v(t._s(a.row.serial_number)+" ")])]:t._e(),"billing_status_id"==a.column.COLUMN_NAME?["BILLING_PENDING"==a.row.billing_status_code?e("span",{staticClass:"px-2 text-center text-white d-block bg-info",attrs:{title:t.$t("Pending")}},[t._v(t._s(t.$t("Pending"))+" ")]):t._e(),"BILLING_START"==a.row.billing_status_code?e("span",{staticClass:"px-2 text-center text-white d-block bg-success",attrs:{title:t.$t("Started")}},[t._v(t._s(t.$t("Started"))+" ")]):t._e(),"BILLING_STOP"==a.row.billing_status_code?e("span",{staticClass:"px-2 text-center text-white d-block bg-danger",attrs:{title:t.$t("Stopped")}},[t._v(t._s(t.$t("Stopped"))+" ")]):t._e()]:t._e()]}}])})],1),t.IsReplace?e("ReplaceMeter",{attrs:{SerialNo:t.SerialNo,MeterId:t.MeterId,MeterMappingId:t.MeterMappingId}}):t._e(),t.IsHistory?e("ViewHistory",{attrs:{MeterMappingId:t.MeterMappingId}}):t._e(),t.IsSaveDate?e("SaveBillingDate",{attrs:{MeterMappingId:t.MeterMappingId,statusId:t.SelectedStatusId,StartBillingDate:t.StartBillingDate,InstallationDate:t.InstallationDate},on:{billingSaved:t.onBillingSaved}}):t._e(),t.isAddMeter?e("ModalAddMeter",{attrs:{reqFrom:t.reqFrom,utilityTypeId:t.utilityTypeId,ClientAdditionalId:t.ClientAdditionalId,editMeterDetail:t.editMeterDetail,meterMappingId:t.meterMappingId}}):t._e(),t.isViewPlanDetailsUtilityCase?e("ModalViewPlanDetails",{attrs:{PlanId:t.PlanId,ClientId:t.ClientId,PlanMappingId:t.PlanMappingId},on:{close:function(e){t.isViewPlanDetailsUtilityCase=!1}}}):t._e(),e("transition",{attrs:{name:"modal"}},[e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),t.IsShowMeterDetail?e("div",{staticClass:"modal d-block dialog"},[e("div",{staticClass:"modal-dialog modal-lg"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("MeterDetails")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.CloseTemplate}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"heading-border"},[e("h5",{staticClass:"h5 mb-4"},[e("span",[t._v(" "+t._s(t.$t("MeterName"))+": "+t._s(t.editMeterDetail.meter_name||"--"))]),e("small",{staticClass:"float-right"},[1001==t.editMeterDetail.status_id?e("span",{staticClass:"bg-success rounded answer rightlabeltext ml-1 px-3 text-white font-14 py-1",staticStyle:{"border-bottom":"none"}},[t._v(t._s(t.$t("Active")))]):e("span",{staticClass:"bg-danger rounded answer rightlabeltext ml-1 px-3 text-white font-14 py-1",staticStyle:{"border-bottom":"none"}},[t._v(t._s(t.$t("Inactive"))+" ")])])])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("SerialNumber"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s(t.editMeterDetail.serial_number||"--"))])])])]),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("MeterType"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s(t.editMeterDetail.meter_service||"--"))])])])]),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("Plan"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s(t.editMeterDetail.plan_name||"--"))])])])]),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("InstallationDate"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s(t.editMeterDetail.date_Of_installation?t.$options.filters.formatDate(t.editMeterDetail.date_Of_installation):"--"))])])])]),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("BillingStartDate"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s(t.$options.filters.formatDate(t.editMeterDetail.billing_start_date)||"--"))])])])]),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("ModelName"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s(t.editMeterDetail.model_name||"--"))])])])]),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("MeterService"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s(t.editMeterDetail.meter_service||"--"))])])])]),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("SanctionedLoad"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s(t.editMeterDetail.sanctioned_load||"--"))])])])]),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("MultiplyFactor"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s(t.editMeterDetail.multiply_factor||"--"))])])])]),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("PowerFactor"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s(t.editMeterDetail.power_factor||"--"))])])])]),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("VoltageRating"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s(t.editMeterDetail.volate_rating||"--"))])])])]),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("CurrentRating"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s(t.editMeterDetail.current_rating||"--"))])])])]),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("BillingStatus"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s("BILLING_STOP"===t.editMeterDetail.billing_status_code?"Stopped":"BILLING_START"===t.editMeterDetail.billing_status_code?"Started":(t.editMeterDetail.billing_status_code,"Pending")))])])])]),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("ConnectionType"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s(t.editMeterDetail.connection_type||"--"))])])])]),"Temporary"==t.editMeterDetail.connection_type?e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("TentativeEndDate"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s(t.editMeterDetail.tentative_end_date?t.$options.filters.formatDate(t.editMeterDetail.tentative_end_date):"--"))])])])]):t._e(),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("Property"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s(t.editMeterDetail.property||"--"))])])])])])]),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-danger",on:{click:t.CloseTemplate}},[e("em",{staticClass:"fa fa-times pr-2",attrs:{"aria-hidden":"true"}}),t._v(" "+t._s(t.$t("Cancel"))+" ")])])])])]):t._e()],1)])],1)},hi=[];let vi=[{COLUMN_NAME:"SNo",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"#",DISPLAY_ORDER:1,settings:{isInSlot:!0}},{COLUMN_NAME:"meter_type",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Utility",DISPLAY_ORDER:1},{COLUMN_NAME:"meter_name",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"MeterName",DISPLAY_ORDER:2},{COLUMN_NAME:"plan_name",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Plan",DISPLAY_ORDER:3,settings:{isInSlot:!0}},{COLUMN_NAME:"serial_number",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"MeterSerialNumber",DISPLAY_ORDER:4,settings:{isInSlot:!0}},{COLUMN_NAME:"meter_unit",DATA_TYPE:"boolean",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"MeterUnit",DISPLAY_ORDER:7},{COLUMN_NAME:"connection_type",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"ConnectionType",DISPLAY_ORDER:8},{COLUMN_NAME:"property",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Property",DISPLAY_ORDER:9},{COLUMN_NAME:"invoice_grouping_name",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Division",DISPLAY_ORDER:10,settings:{isInSlot:!0}},{COLUMN_NAME:"contract_name",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Contract",DISPLAY_ORDER:11,settings:{isInSlot:!0}},{COLUMN_NAME:"date_Of_installation",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"InstallationDate",DISPLAY_ORDER:12,settings:{isInSlot:!0}},{COLUMN_NAME:"status_id",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Status",DISPLAY_ORDER:13,settings:{isInSlot:!0}},{COLUMN_NAME:"billing_status_id",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"BillingStatus",DISPLAY_ORDER:14,settings:{isInSlot:!0}}],_i=[{title:"Edit Meter",href:"javascript:void(0)",callbackfunction:"EditMeter",icon:"fa fa-pencil text-success action-icon",additionalSpan:""},{title:"Replace",href:"javascript:void(0)",callbackfunction:"Replace",icon:"fa fa-tachometer text-success action-icon",additionalSpan:""},{title:"View History",href:"javascript:void(0)",callbackfunction:"ViewHistory",icon:"fa fa-eye text-info action-icon",additionalSpan:""},{title:"Start Billing",href:"javascript:void(0)",callbackfunction:"StartBilling",icon:"fa fa-hourglass-start text-success action-icon",additionalSpan:""},{title:"Stop Billing",href:"javascript:void(0)",callbackfunction:"StopBilling",icon:"fa fa-stop text-danger action-icon",additionalSpan:""}];var gi={TableHeader:vi,listActions:_i},fi=function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("ReplaceMeter")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("dynamic-form",{ref:"dynamicform",attrs:{lang:"en",buttons:t.buttons,schema:t.FormSchema},on:{OnSubmit:t.onSubmit}})],1)])])])],1)},Ci=[],yi={props:{SerialNo:{type:String,required:!0},MeterId:{type:Number,required:!0},MeterMappingId:{type:Number,required:!0}},data(){return{isLoading:!1,FormSchema:[{layoutType:"four",group_name:this.$t("CurrentMeterInformation"),Data:[{astype:"TextField",label:this.$t("SerialNumber"),name:"SerialNumber",value:"",validationRules:{required:!1,max:100},disabled:!0},{astype:"TextField",label:this.$t("MeterFinalReading"),name:"MeterFinalReading",value:"",validationRules:{required:!0},disabled:!1},{astype:"SelectField",label:this.$t("MeterStatus"),name:"MeterStatus",value:"",placeholder:"",config:{options:[{name:"Faulty",value:"faulty"},{name:"Damaged",value:"damaged"},{name:"Stuck",value:"stuck"}]}},{astype:"DateField",label:this.$t("DateOfMeterReplacement"),name:"DateOfMeterReplacement",value:"",placeholder:this.$t("Select Date"),validationRules:{required:!0,max:100},config:{}}]},{layoutType:"four",group_name:this.$t("NewMeterAssignment"),Data:[{astype:"SelectField",label:this.$t("SerialNumber"),name:"NewSerialNumber",value:"",placeholder:"",config:{options:[]},validationRules:{required:!0}},{astype:"TextField",label:this.$t("NewMeterInitialReading"),name:"NewMeterInitialReading",value:"",validationRules:{required:!0},disabled:!1},{astype:"DateField",label:this.$t("DateOfInstallation"),name:"DateOfInstallation",value:"",placeholder:this.$t("Select Date"),validationRules:{required:!0,max:100},config:{}},{astype:"SelectField",label:this.$t("ReasonforReplacement"),name:"ReasonforReplacement",value:"",placeholder:"",config:{options:[{name:"Faulty",value:"faulty"},{name:"Routine Maintenance",value:"maintenance"},{name:"Upgrade",value:"upgrade"}]}}]},{layoutType:"four",group_name:this.$t("AddtionalInformation"),Data:[{astype:"TextAreaField",label:this.$t("Comments"),name:"Comments",value:"",validationRules:""}]},{layoutType:"double",Data:[{astype:"CheckBoxField",label:this.$t("Carryforwardbillingmeternew"),name:"Carryforwardbillingmeter",value:"",config:{options:[{name:"",value:"true"}]},validationRules:""}]}],buttons:[{type:"submit",class:"btn btn-success",text:"<i class='fa fa-save pr-2'></i>Save"}]}},created:async function(){this.FetchData(),await this.GetSerialNumberData()},methods:{FetchData:function(){var t=this;t.FormSchema[0].Data[0].value=t.SerialNo},Close:function(){this.$parent.IsReplace=!1},GetSerialNumberData:async function(){var t=this;let e="id="+t.MeterId;await n["a"].GetSerialnumberByMeterId(e).then((function(e){e.data&&(t.FormSchema[1].Data[0].config.options=e.data),t.$refs.dynamicform.UpdateKeyValue()}))},onSubmit(t,e){var a=this,i={CurrentMeterId:a.MeterMappingId,MeterFinalReading:t.MeterFinalReading,MeterStatus:t.MeterStatus,DateOfReplacement:t.DateOfMeterReplacement,NewMeterId:t.NewSerialNumber,NewMeterInitialReading:t.NewMeterInitialReading,DateOfInstallation:t.DateOfInstallation,ReplacementReason:t.ReasonforReplacement,CarryForwardBilling:void 0!=t.Carryforwardbillingmeter[0],Comment:t.Comments},s=JSON.stringify(i);n["a"].SaveMeterReplacement(s).then(t=>{"Success"==t.data.Status?(a.ShowAlert(a.$t("AddedSuccess",[a.$t("Meter")]),"success",!0,a.$t("Alert")),a.Close(),a.$parent.FetchData()):(a.ShowAlert(a.$t("AddedError",[a.$t("Meter")]),"failure",!0,a.$t("Alert")),a.Close())})}}},bi=yi,Si=Object(d["a"])(bi,fi,Ci,!1,null,null,null),Ai=Si.exports,Di=function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("ReplaceMeter")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"row listing mt-2",attrs:{id:"app"}},[e("div",{staticClass:"col-lg-12"},[e("h5",[t._v("Meter Replacement History")]),e("div",{staticClass:"table-responsive table-fix-header"},[e("table",{staticClass:"table table-bordered dt-responsive nowrap",attrs:{id:"meterReadingsTable"}},[t._m(0),e("tbody",[t.noRecord?e("tr",[e("td",{staticClass:"text-danger text-center no-record",attrs:{colspan:"9"}},[t._v(" "+t._s(t.$t("NoRecordfound"))+" ")])]):t._e(),t._l(t.ListingData,(function(a,i){return e("tr",{key:i},[e("td",[t._v(t._s(a.Old_Metername))]),e("td",[t._v(t._s(a.old_meter_reading))]),e("td",[t._v(t._s(t.$options.filters.formatDate(a.date_Of_replacement))+" ")]),e("td",[t._v(t._s(a.meter_status))]),e("td",[t._v(t._s(a.replacement_reason))]),e("td",[t._v(t._s(a.New_metername))]),e("td",[t._v(t._s(a.new_meter_reading))]),e("td",[t._v(t._s(t.$options.filters.formatDate(a.date_Of_installation))+" ")]),e("td",[t._v("Yes")])])}))],2)])])])])])])])])],1)},Ii=[function(){var t=this,e=t._self._c;return e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",[t._v("Old Meter ID")]),e("th",[t._v("Final Reading (Old Meter)")]),e("th",[t._v("Replacement Date")]),e("th",[t._v("Reason")]),e("th",[t._v("Old Meter Status")]),e("th",[t._v("New Meter ID")]),e("th",[t._v("New Meter Initial Reading")]),e("th",[t._v("New Meter Installation Date")]),e("th",[t._v("Reading Carry Forwarded?")])])])}],Ti={props:{MeterMappingId:{type:Number,required:!0}},data(){return{isLoading:!1,ListingData:[],noRecord:!1}},created:async function(){await this.FetchData()},methods:{async FetchData(){try{this.isLoading=!0;const t=await n["a"].ViewHistory("meterId="+this.MeterMappingId);t.data&&(this.ListingData=t.data,this.noRecord=0===this.ListingData.length)}catch(t){console.error("Error fetching meter replacement history:",t),this.noRecord=!0}finally{this.isLoading=!1}},formatDateTime:function(t){if(t)return new Date(t).toLocaleString()},Close(){this.$parent.IsHistory=!1}}},Li=Ti,Ei=Object(d["a"])(Li,Di,Ii,!1,null,"51bc0f61",null),xi=Ei.exports,Ni=function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("BillingStartDate")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("dynamic-form",{ref:"dynamicform",attrs:{lang:"en",buttons:t.buttons,schema:t.FormSchema},on:{OnSubmit:t.onSubmit}})],1)])])])],1)},Pi=[],wi={props:{MeterMappingId:{type:Number,required:!0},statusId:{type:Number,required:!0},StartBillingDate:{type:Date,required:!0},InstallationDate:{type:Date,required:!0}},data(){return{isLoading:!1,FormSchema:[{layoutType:"Single",Data:[{astype:"DateField",label:this.$t("StartBillingDate"),name:"StartBillingDate",value:"",placeholder:this.$t("Select Date"),validationRules:{required:!0,max:100},config:{}}]}],buttons:[{type:"submit",class:"btn btn-success",text:"<i class='fa fa-save pr-2'></i>Save"}]}},created(){var t=this;const e=t.StartBillingDate,a=new Date(t.StartBillingDate);t.StartBillingDate=a,this.FormSchema[0].Data[0].value=null==e?(new Date).toISOString().substr(0,10):t.StartBillingDate,t.InstallationDate=new Date(t.InstallationDate),this.FormSchema[0].Data[0].config.minDate=t.InstallationDate},methods:{Close:function(){this.$parent.IsSaveDate=!1},onSubmit(t,e){const a=new Date(t.StartBillingDate),i=60*a.getTimezoneOffset()*1e3,s=new Date(a.getTime()-i),n=s.toISOString().slice(0,19);this.$emit("billingSaved",{meterMappingId:this.MeterMappingId,billingStartDate:n,statusId:this.statusId}),this.Close()}}},Ri=wi,Mi=Object(d["a"])(Ri,Ni,Pi,!1,null,null,null),$i=Mi.exports,Fi=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header ui-draggable-handle d-flex"},[t.meterMappingId>0?e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("UpdateMeter")))]):e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("AddMeter")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("dynamic-form",{ref:"dynamicform",attrs:{lang:"en",buttons:t.buttons,schema:t.FormSchema},on:{OnSubmit:t.OnSubmit}})],1)])])])],1),t.IsAddProperty?e("AddPropertymodal",{attrs:{ClientData:t.ClientData,ClientId:t.ClientId,AddAddProperty:t.AddAddProperty},on:{CloseAddProperty:t.CloseAddProperty}}):t._e()],1)},ki=[],Oi=function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("Add"))+" "+t._s(t.$t("Property")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.CloseAddProperty}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("dynamic-form",{ref:"AddTaxCategoryForm",attrs:{lang:"en",schema:t.FormSchema,mandatorytext:t.MandatoryString}}),e("div",{staticClass:"row"},[e("div",{staticClass:"col-lg-12 mb-3"},[e("div",{staticClass:"heading-border mt-2"},[e("h5",{staticClass:"h5"},[e("span",[t._v(t._s(t.$t("LocationDetails")))])])])]),e("div",{staticClass:"col-12 float-left mb-3"},[e("div",{staticClass:"custom-control custom-checkbox"},[e("input",{staticClass:"custom-control-input",staticStyle:{"z-index":"1",width:"19px","margin-top":"6px"},attrs:{type:"checkbox"},on:{change:function(e){return t.GetPrimaryAddress(e)}}}),e("label",{staticClass:"custom-control-label universal-custom-control-label pt-1"},[e("span",{staticClass:"float-left"},[t._v(t._s(t.$t("SameAsPrimaryAddress")))])])])]),e("div",{staticClass:"col-md-6"},[e("dynamic-form",{ref:"refAddress",attrs:{lang:"en",buttons:!1,schema:t.FormSchemaa}})],1),e("div",{staticClass:"col-md-6"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-12"},[e("MapComponent",{ref:"mapComponnet",staticClass:"row",attrs:{mapType:"MapBox",mapContainer:"addAddress",config:t.config,mapHeight:"355px",Data:t.mapObj,latLng:t.latLngValues},on:{GetAddress:t.GetAddress}}),e("div",{staticClass:"row flex-row-reverse mt-2 pt-2"},[e("div",{staticClass:"col-lg-6 text-right"},[e("a",{staticClass:"btn btn-success mr-2",attrs:{href:"javascript:;",title:"",id:"addAddress","data-toggle-tooltip":"tooltip","data-original-title":"Save"},on:{click:t.OnSubmit}},[e("i",{staticClass:"fa fa-save mr-2"}),e("span",{attrs:{id:"btnAddressText"}},[t._v(" "+t._s(t.$t("Save")))])]),e("a",{staticClass:"btn btn-danger",attrs:{href:"javascript:;",title:"",id:"CancelAddress","data-toggle-tooltip":"tooltip","data-original-title":"Cancel"},on:{click:t.CloseAddProperty}},[e("i",{staticClass:"fa fa-times mr-2"}),t._v(t._s(t.$t("Cancel")))])])])],1)])])]),e("div",{staticClass:"row col-lg-6"},[e("div",{staticClass:"py-2"},[e("span",{staticClass:"mandatory"},[t._v(t._s(t.MandatoryString))])])])],1)])])])],1)},Bi=[],Ui=a("5dbc"),Gi={components:{MapComponent:Ui["a"]},props:{ClientId:{type:Number,required:!0},ClientData:{type:Object},AddAddProperty:{type:Object,required:!0}},data(){return{isLoading:!1,PropertyId:0,mapObj:[],MandatoryString:this.$t("MandatoryString"),FormSchema:[{layoutType:"four",group_name:"Property Details",Data:[{astype:"TextField",label:this.$t("PropertyTitle"),name:"PropertyTitle",value:"",disabled:!1,visibility:!0,placeholder:this.$t("PropertyTitle"),validationRules:{required:!0,max:100}},{astype:"SelectField",label:this.$t("PropertyType"),name:"PropertyType",value:"",disabled:!1,visibility:!0,config:{options:[]},placeholder:this.$t("PropertyType"),validationRules:{required:!0,max:100}},{astype:"SelectField",label:this.$t("ConstructionStatus"),name:"ConstructionStatus",value:"",disabled:!1,visibility:!0,config:{options:[]},placeholder:this.$t("ConstructionStatus"),validationRules:{required:!0,max:100}},{astype:"TextField",label:this.$t("Block"),name:"BlockName",value:"",disabled:!1,visibility:!0,placeholder:this.$t("BlockName"),validationRules:{required:!1,max:100}},{astype:"TextField",label:this.$t("Floor"),name:"Floor",value:"",disabled:!1,visibility:!0,placeholder:this.$t("Floor"),validationRules:{required:!1,max:100}},{astype:"NumericField",label:this.$t("PropertySize"),name:"PropertySize",value:"",disabled:!1,visibility:!0,placeholder:this.$t("PropertySize"),validationRules:{required:!1}},{astype:"SelectField",label:this.$t("Unit"),name:"Unit",value:"",disabled:!1,visibility:!0,config:{options:[]},placeholder:this.$t("Unit"),validationRules:{required:!1,max:100}}]}],buttons:[{type:"submit",class:"btn btn-success",text:"<i class='fa fa-save pr-2'></i>Save"},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Cancel",onClick:this.CloseAddProperty}],FormSchemaa:[{layoutType:"double",Data:[{astype:"TextField",label:this.$t("AddressLine1"),name:"Address Line 1:",value:"",placeholder:"",validationRules:{max:200,required:!0}},{astype:"TextField",label:this.$t("AddressLine2"),name:"Address Line 2:",value:"",placeholder:"",validationRules:{max:200,required:!1}},{astype:"SelectField",label:this.$t("COUNTRY"),name:"Country",value:"",placeholder:"",disabled:!0,validationRules:{required:!0,max:250},config:{options:[],onChange:this.ChangeState}},{astype:"TextField",label:this.$t("StateProvince"),name:"State",value:"",placeholder:"",disabled:!0,validationRules:{required:!1},config:{options:[]}},{astype:"TextField",label:this.$t("City"),name:"City:",value:"",placeholder:"",disabled:!0,validationRules:{required:!1},config:{options:[]}},{astype:"TextField",label:this.$t("ZIPCODE"),name:"Zip Code:",value:"",placeholder:"",disabled:!0,validationRules:{required:!1}},{astype:"TextField",label:this.$t("NotesDescriptionAbtAddress"),name:"Note/Description About Address",userGuide:"Example: office Address",value:"",placeholder:"",validationRules:{max:200,required:!1}}]}],AddressList:[],countryList:[],Longitude:null,Latitude:null,latLngValues:"",config:{isShowDrawButton:!0,isShowEtaOrLocator:!0,isShowSearchBox:!0,showPolygonButton:!0},StateDDl:[]}},created:function(){var t=this;null==t.AddAddProperty&&t.GetCompanyAddress(),t.GetPropertyType(),t.GetPropertyUnit(),t.GetPropertConstructioStauts(),t.GetCountryDDL(),null!=t.AddAddProperty&&t.BindPropertyDetails()},methods:{BindPropertyDetails(){var t=this;t.PropertyId=t.AddAddProperty.id,t.FormSchema[0].Data[0].value=t.AddAddProperty.property_title,t.FormSchema[0].Data[1].value=t.AddAddProperty.property_type_id,t.FormSchema[0].Data[2].value=t.AddAddProperty.construction_status_id,t.FormSchema[0].Data[3].value=t.AddAddProperty.block_name,t.FormSchema[0].Data[4].value=t.AddAddProperty.floor_name,t.FormSchemaa[0].Data[0].value=t.AddAddProperty.user_address_1,t.FormSchemaa[0].Data[1].value=t.AddAddProperty.user_address_2,t.FormSchemaa[0].Data[2].value=t.AddAddProperty.country_id,t.FormSchemaa[0].Data[3].value=t.AddAddProperty.user_state,t.FormSchemaa[0].Data[4].value=t.AddAddProperty.user_state,t.FormSchemaa[0].Data[5].value=t.AddAddProperty.user_zipcode,t.FormSchemaa[0].Data[6].value=t.AddAddProperty.user_address_desc,t.Latitude=t.AddAddProperty.latitude,t.Longitude=t.AddAddProperty.longitude;let e={location_nw:`${t.Latitude},${t.Longitude}`};t.latLngValues=e},async GetCompanyAddress(){var t=this,e="",a="";await n["a"].GetCompanyAddress().then(t=>{e=t.data[0].latitude,a=t.data[0].longitude}),t.Latitude=e,t.Longitude=a;let i={location_nw:`${t.Latitude},${t.Longitude}`};t.latLngValues=i},GetAddress(t){var e=this;e.Latitude="",e.Longitude="";var a=t.length-1;e.$refs.mapComponnet.fullAddress=[],e.$refs.mapComponnet.lngLatData=[];let i=e.countryList.filter(e=>e.name===t[a].CompleteAddress.Country.LongName);var s=""==i?"":i[0].value;e.FormSchemaa[0].Data[2].value=s,e.FormSchemaa[0].Data[0].value=t[a].CompleteAddress.FullAddress,e.FormSchemaa[0].Data[1].value=t[a].CompleteAddress.FullAddress,e.ChangeState(null,s),setTimeout((function(){let i=e.StateDDl.filter(e=>e.name===t[a].CompleteAddress.AdministrativeAreaLevel1.LongName);var s=""==i?"":i[0].name;e.FormSchemaa[0].Data[3].value=s,e.$refs.refAddress.updateProperty("State","value",e.FormSchemaa[0].Data[3].value)}),2e3),e.FormSchemaa[0].Data[4].value=t[a].CompleteAddress.City.LongName,e.FormSchemaa[0].Data[5].value=t[a].CompleteAddress.PinCode,e.FormSchemaa[0].Data[6].value=t[a].CompleteAddress.AdministrativeAreaLevel2.LongName;var n="",l="",o="",r="";t[a].LatLng.forEach((t,e)=>{0==e&&(n=t.Lat,l=t.Lng)}),e.Latitude=o+","+l,e.Longitude=n+","+r;let c={location_nw:e.Longitude.replace(",","")+e.Latitude.replace(",",",")};e.latLngValues=c},GetCountryDDL(){var t="moduleName=CRM&type=COUNTRIES",e=this;n["a"].GetCountryDDL(t).then(t=>{e.countryList=t.data.DATA,e.countryList.forEach(t=>{e.FormSchemaa[0].Data[2].config.options.push({name:""+t.name,value:""+t.value})}),this.$refs.refAddress.UpdateKeyValue()})},ChangeState:async function(t,e){var a=this,i=0;i=null==t?e:t.target.value.toString(),a.FormSchemaa[0].Data[3].config.options=[],a.StateDDl="";var s="id=&&moduleName=CRM&type=STATE&search=&refId="+i;await n["a"].GetCountryDDL(s).then((function(t){t.data&&t.data.DATA.length>0&&(a.StateDDl=t.data.DATA)}))},GetPropertyType(){var t=this,e="id=&moduleName=&type=PROPERTY_TYPE&search=&refId=";n["a"].GetDDLData(e).then(e=>{200==e.status&&(void 0==e.data.DATA&&null==e.data.DATA||e.data.DATA.length>0&&e.data.DATA.forEach(e=>{let a={value:e.value,name:e.name};t.FormSchema[0].Data[1].config.options.push(a),t.$refs.AddTaxCategoryForm.UpdateKeyValue()}))})},GetPropertyUnit(){var t=this,e="id=&moduleName=&type=PROPERTY_UNIT&search=&refId=";n["a"].GetDDLData(e).then(e=>{200==e.status&&(void 0==e.data.DATA&&null==e.data.DATA||e.data.DATA.length>0&&e.data.DATA.forEach(e=>{let a={value:e.value,name:e.name};t.FormSchema[0].Data[6].config.options.push(a),t.$refs.AddTaxCategoryForm.UpdateKeyValue()}))})},GetPropertConstructioStauts(){var t=this,e="id=&moduleName=&type=PROPERTY_CONSTRUCTION_STATUS&search=&refId=";n["a"].GetDDLData(e).then(e=>{200==e.status&&(void 0==e.data.DATA&&null==e.data.DATA||e.data.DATA.length>0&&e.data.DATA.forEach(e=>{let a={value:e.value,name:e.name};t.FormSchema[0].Data[2].config.options.push(a),t.$refs.AddTaxCategoryForm.UpdateKeyValue()}))})},GetPrimaryAddress(t){var e=this,a=t.target.checked;if(a){var i=`userId=${e.ClientId}&userAddressId=0`;n["a"].GetAdditionalAddressList(i).then(t=>{null!=t.data&&(e.AddressList=[],t.data.result.length>0&&(e.AddressList=t.data.result,e.FormSchemaa[0].Data[0].value=e.AddressList[0].user_address_1,e.FormSchemaa[0].Data[1].value=e.AddressList[0].user_address_2,e.FormSchemaa[0].Data[2].value=e.AddressList[0].country_id,e.FormSchemaa[0].Data[3].value=e.AddressList[0].user_state,e.FormSchemaa[0].Data[4].value=e.AddressList[0].user_state,e.FormSchemaa[0].Data[5].value=e.AddressList[0].user_zipcode,e.FormSchemaa[0].Data[6].value=e.AddressList[0].user_address_desc,e.AddressList.forEach(t=>{if(t.isSelected=!1,1==t.is_primary_address){e.Latitude=t.latitude.replace(",",""),e.Longitude=t.longitude.replace(",","");let a={location_nw:t.longitude.replace(",","")+t.latitude.replace(",",",")};e.latLngValues=a}})))})}else e.FormSchemaa[0].Data[0].value="",e.FormSchemaa[0].Data[1].value="",e.FormSchemaa[0].Data[2].value="",e.FormSchemaa[0].Data[3].value="",e.FormSchemaa[0].Data[4].value="",e.FormSchemaa[0].Data[5].value="",e.FormSchemaa[0].Data[6].value="",e.latLngValues=""},CloseAddProperty(){var t=this;t.$emit("CloseAddProperty")},OnSubmit(){var t=this;t.isLoading=!0,t.$refs.AddTaxCategoryForm.validateForm.validate().then(async e=>{e?t.$refs.refAddress.validateForm.validate().then(async e=>{if(e){var a={id:t.PropertyId,property_title:t.FormSchema[0].Data[0].value,property_type_id:t.FormSchema[0].Data[1].value,construction_status_id:t.FormSchema[0].Data[2].value,block_name:t.FormSchema[0].Data[3].value,floor_name:t.FormSchema[0].Data[4].value,property_size:t.FormSchema[0].Data[5].value,property_unit:t.FormSchema[0].Data[6].value,client_id:t.ClientId,user_address_1:t.FormSchemaa[0].Data[0].value,user_address_2:t.FormSchemaa[0].Data[1].value,user_city:t.FormSchemaa[0].Data[4].value,user_state:t.FormSchemaa[0].Data[3].value,country_id:t.FormSchemaa[0].Data[2].value,user_zipcode:t.FormSchemaa[0].Data[5].value,user_address_desc:t.FormSchemaa[0].Data[6].value,latitude:t.Latitude,longitude:t.Longitude},i=JSON.stringify(a);n["a"].SaveClientProperty(i).then((function(e){t.isLoading=!1,e.data.result.DATA.length>0?"UPDATE"==e.data.result.DATA[0].VALUE?(t.ShowAlert(t.$t("UpdatedSuccess",[t.$t("Property")]),"success",!0,t.$t("Alert")),t.CloseAddProperty()):"EXISTS"==e.data.result.DATA[0].VALUE?t.ShowAlert(t.$t("AlreadyExists",[t.$t("Property")]),"warning",!0,t.$t("Alert")):(t.ShowAlert(t.$t("AddedSuccess",[t.$t("Property")]),"success",!0,t.$t("Alert")),t.CloseAddProperty()):t.ShowAlert(t.$t("UnknownErrorOccur"),"failure",!0,t.$t("Alert"))}))}else t.isLoading=!1}):t.isLoading=!1})}}},Yi=Gi,Vi=Object(d["a"])(Yi,Oi,Bi,!1,null,null,null),Hi=Vi.exports,ji={components:{AddPropertymodal:Hi},props:{reqFrom:{type:String,required:!1},ClientAdditionalId:{type:Number,required:!1},utilityTypeId:{type:Number,required:!1},editMeterDetail:{type:Array,required:!1},meterMappingId:{type:Number,required:!1},ClientId:{type:Number},ClientData:{type:Object}},data(){return{FormSchema:[{layoutType:"four",Data:[{astype:"SelectField",label:this.$t("MeterType"),name:"Meter_type",value:"",config:{options:[],onChange:this.GetMeterNameDDlData},placeholder:this.$t("Meter"),validationRules:{required:!0,max:100},disabled:!0,visibility:!0},{astype:"SelectField",label:this.$t("MeterName"),name:"MeterName",value:"",placeholder:"",visibility:!0,config:{options:[],onChange:this.getSerialNumber},validationRules:{required:!0}},{astype:"CustomSelectField",label:this.$t("MeterSerialNumber"),name:"SerialNumber",value:"",placeholder:"",visibility:!0,config:{options:[],onChange:this.getMeterMappingDetails},validationRules:{required:!0}},{astype:"TextField",label:this.$t("ModelName"),name:"ModelName",value:"",visibility:!0,validationRules:[{required:!1}],disabled:!0}]},{layoutType:"four",Data:[{astype:"TextField",label:this.$t("MeterService"),name:"MeterService",value:"",validationRules:[{required:!1}],disabled:!0,visibility:!0},{astype:"TextField",label:this.$t("MeterUnit"),name:"MeterUnit",value:"",validationRules:[{required:!1}],disabled:!0,visibility:!0},{astype:"SelectField",label:this.$t("Plan"),name:"Plan",value:"",placeholder:"",visibility:!0,config:{options:[]},validationRules:{required:!0}},{astype:"DateField",label:this.$t("InstallationDate"),name:"InstallationDate",value:"",placeholder:this.$t("Select Date"),validationRules:{required:!0,max:100},config:{},visibility:!0}]},{layoutType:"four",Data:[{astype:"TextField",label:this.$t("SanctionedLoad"),name:"Sanctioned_Load",value:"",validationRules:[{required:!0}],disabled:!1,visibility:!1},{astype:"NumericField",label:this.$t("MultiplyFactor"),name:"Multiply_Factor",value:"",validationRules:[{required:!0}],disabled:!1,visibility:!1},{astype:"NumericField",label:this.$t("PowerFactor"),name:"Power_factor",value:"",validationRules:[{required:!1}],disabled:!1,visibility:!1},{astype:"TextField",label:this.$t("VoltageRating"),name:"Voltage_Rating",value:"",validationRules:[{required:!1}],disabled:!1,visibility:!1},{astype:"TextField",label:this.$t("CurrentRating"),name:"Current_Rating",value:"",validationRules:[{required:!1}],disabled:!1,visibility:!1},{astype:"SelectField",label:this.$t("PhaseType"),name:"Phase_Type",value:"",placeholder:"",visibility:!1,config:{options:[{value:"1",name:"Single Phase"},{value:"2",name:"Triple Phase"}]},validationRules:{required:!0}},{astype:"TextField",label:this.$t("RegisterConstant"),name:"RegisterConstant",value:"",validationRules:[{required:!1}],disabled:!1,visibility:!1},{astype:"SelectField",label:this.$t("Status"),name:"Status",value:"",config:{options:[{value:"1001",name:"Active"},{value:"1002",name:"InActive"}]},placeholder:this.$t("SelectStatus"),validationRules:{required:!0,max:100}},{astype:"SelectField",label:this.$t("ConnectionType"),name:"ConnectionType",value:"",placeholder:"",visibility:!0,config:{options:[{value:"Permanent",name:"Permanent"},{value:"Temporary",name:"Temporary"}],onChange:this.showTantativeField},validationRules:{required:!0}},{astype:"DateField",label:this.$t("TentativeEndDate"),name:"TentativeEndDate",value:"",placeholder:this.$t("Select Date"),validationRules:{required:!1,max:100},config:{},visibility:!1},{astype:"SelectField",label:this.$t("Property"),name:"Property",value:"",placeholder:"",visibility:!0,config:{options:[],showAddIcon:!0,onAddButtonClick:this.OpenAddProperty},validationRules:{required:!0}},{astype:"SelectField",label:this.$t("Division"),name:"Division",value:"",placeholder:"",visibility:!0,config:{options:[]},validationRules:{required:!1}},{astype:"SelectField",label:this.$t("Contract"),name:"Contract",value:"",placeholder:"",visibility:!0,config:{options:[]},validationRules:{required:!1}}]}],buttons:[{type:"submit",class:"btn btn-success",text:"<i class='fa fa-save pr-2'></i>Save",isVisible:!0},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Close",onClick:this.Close}],MeterNameData:[],MeterId:null,SerialNumberData:[],SerialId:null,PlanData:[],PlanId:null,refreshKey:0,isLoading:!1,ClientId:0,fileError:null,IsAddProperty:!1,AddAddProperty:null}},created:async function(){var t=this;t.isLoading=!0,t.ClientId=t.$route.params.id,await t.getMeterTypes(),await t.getPropertyType(),await t.getContractList(),await t.getDivisionList(),setTimeout((function(){t.BindMeterType()}),200),setTimeout((function(){"Edit"==t.reqFrom&&t.BindMeterDetailData(),t.isLoading=!1}),400)},methods:{OpenAddProperty(t){var e=this;e.AddAddProperty=t,e.IsAddProperty=!0},CloseAddProperty(){var t=this;t.IsAddProperty=!1,t.getPropertyType()},BindMeterDetailData:async function(){var t=this;t.$refs.dynamicform.updateProperty("MeterName","value",t.editMeterDetail.asset_catalogue_id),t.$refs.dynamicform.updateProperty("MeterName","disabled",!0);let e=[];e.push({value:t.editMeterDetail.related_info_id,label:t.editMeterDetail.serial_number}),t.$refs.dynamicform.updateProperty("SerialNumber","value",e),t.$refs.dynamicform.updateProperty("SerialNumber","disabled",!0),t.$refs.dynamicform.updateProperty("ModelName","value",t.editMeterDetail.model_name),t.$refs.dynamicform.updateProperty("ModelName","disabled",!0),t.$refs.dynamicform.updateProperty("MeterService","value",t.editMeterDetail.meter_service),t.$refs.dynamicform.updateProperty("MeterService","disabled",!0),t.$refs.dynamicform.updateProperty("MeterUnit","value",t.editMeterDetail.meter_unit),t.$refs.dynamicform.updateProperty("MeterUnit","disabled",!0),t.$refs.dynamicform.updateProperty("Plan","value",t.editMeterDetail.plan_id),t.$refs.dynamicform.updateProperty("Status","value",t.editMeterDetail.status_id),t.$refs.dynamicform.updateProperty("InstallationDate","value",t.editMeterDetail.date_Of_installation),t.$refs.dynamicform.updateProperty("RegisterConstant","value",t.editMeterDetail.register_constant),t.$refs.dynamicform.updateProperty("ConnectionType","value",t.editMeterDetail.connection_type),"Temporary"==t.editMeterDetail.connection_type?(t.$refs.dynamicform.updateProperty("TentativeEndDate","value",t.editMeterDetail.tentative_end_date),t.$refs.dynamicform.updateProperty("TentativeEndDate","visibility",!0)):t.$refs.dynamicform.updateProperty("TentativeEndDate","visibility",!1),t.$refs.dynamicform.updateProperty("Property","value",t.editMeterDetail.property_id),t.$refs.dynamicform.updateProperty("Division","value",t.editMeterDetail.invoice_grouping_id),t.$refs.dynamicform.updateProperty("Contract","value",t.editMeterDetail.contract_id),t.$refs.dynamicform.updateProperty("Phase_Type","value",t.editMeterDetail.phase_type),t.$refs.dynamicform.updateProperty("Sanctioned_Load","value",t.editMeterDetail.sanctioned_load),t.$refs.dynamicform.updateProperty("Multiply_Factor","value",t.editMeterDetail.multiply_factor),t.$refs.dynamicform.updateProperty("Power_factor","value",t.editMeterDetail.power_factor),t.$refs.dynamicform.updateProperty("Voltage_Rating","value",t.editMeterDetail.volate_rating),t.$refs.dynamicform.updateProperty("Current_Rating","value",t.editMeterDetail.current_rating),t.$refs.dynamicform.UpdateKeyValue()},showTantativeField:function(t){var e=this,a=t.target.value;"Temporary"==a?(e.$refs.dynamicform.updateProperty("TentativeEndDate","visibility",!0),e.$refs.dynamicform.UpdateKeyValue()):(e.$refs.dynamicform.updateProperty("TentativeEndDate","visibility",!1),e.$refs.dynamicform.UpdateKeyValue())},getDivisionList:async function(t){var e=this;let a="id=&moduleName=Billing&type=CDC_DIVISION_LIST_BY_CLIENT_ID&search=&refId="+e.ClientId;await n["a"].GetDDLData(a).then(t=>{if(""!=t.data&&null!=t.data){var a=[];t.data.DATA.length>0&&t.data.DATA.forEach((t,e)=>{a.push({value:t.value,name:t.name})}),e.$refs.dynamicform.updateProperty("Division","config.options",a),e.$refs.dynamicform.UpdateKeyValue()}})},getContractList:async function(t){var e=this;let a="id=&moduleName=Billing&type=CONTRACT_LIST_BY_CLIENT_ID&search=&refId="+e.ClientId;await n["a"].GetDDLData(a).then(t=>{""!=t.data&&null!=t.data&&t.data.DATA.length>0&&(e.$refs.dynamicform.updateProperty("Contract","config.options",t.data.DATA),e.$refs.dynamicform.UpdateKeyValue())})},getPropertyType:async function(t){var e=this;let a=`id=${e.meterMappingId}&moduleName=Billing&type=PROPERTY_BY_CLIENT_ID&search=${e.reqFrom}&refId=${e.ClientId}`;await n["a"].GetDDLData(a).then(t=>{""!=t.data&&null!=t.data&&t.data.DATA.length>0&&(e.$refs.dynamicform.updateProperty("Property","config.options",t.data.DATA),e.$refs.dynamicform.UpdateKeyValue())})},BindMeterType:async function(){var t=this;t.FormSchema[0].Data[0].value=t.utilityTypeId,await t.BindMeterNameData(null,t.FormSchema[0].Data[0])},async BindMeterNameData(t,e){var a=this;a.FormSchema[0].Data[1].value="",a.FormSchema[0].Data[2].value="",a.FormSchema[0].Data[3].value="",a.FormSchema[1].Data[0].value="",a.FormSchema[1].Data[1].value="",a.FormSchema[1].Data[2].value="",a.FormSchema[0].Data[1].config.options=[],a.FormSchema[0].Data[2].config.options=[],a.FormSchema[1].Data[2].config.options=[];let i=e.config.options.find(t=>t.value==e.value);"Gas"==i.name&&(a.FormSchema[2].Data[0].visibility=!1,a.FormSchema[2].Data[1].visibility=!1,a.FormSchema[2].Data[2].visibility=!1,a.FormSchema[2].Data[3].visibility=!1,a.FormSchema[2].Data[4].visibility=!1,a.FormSchema[2].Data[5].visibility=!1,a.FormSchema[2].Data[6].visibility=!0),"Electric"==i.name&&(a.FormSchema[2].Data[0].visibility=!0,a.FormSchema[2].Data[1].visibility=!0,a.FormSchema[2].Data[2].visibility=!0,a.FormSchema[2].Data[3].visibility=!0,a.FormSchema[2].Data[4].visibility=!0,a.FormSchema[2].Data[5].visibility=!0,a.FormSchema[2].Data[6].visibility=!1),"Water"==i.name&&(a.FormSchema[2].Data[0].visibility=!1,a.FormSchema[2].Data[1].visibility=!1,a.FormSchema[2].Data[2].visibility=!1,a.FormSchema[2].Data[3].visibility=!1,a.FormSchema[2].Data[4].visibility=!1,a.FormSchema[2].Data[5].visibility=!1,a.FormSchema[2].Data[6].visibility=!1);try{let t="type=is_meter&TypeValue=1&type2=utility_type_id&TypeValue2="+e.value;const i=await n["a"].GetMeterNameDDlData(t),s=i.data;Array.isArray(s)&&s.length>0?(a.$refs.dynamicform.updateProperty("MeterName","config.options",s),a.$refs.dynamicform.UpdateKeyValue(),a.GetPlanDDlData(e.value)):(a.$refs.dynamicform.updateProperty("MeterName","config.options",[]),a.$refs.dynamicform.UpdateKeyValue())}catch(s){console.error("Error fetching meter name data:",s)}},async GetPlanDDlData(t){var e=this;let a="clientId=0&meter_type_id="+t;try{const t=await n["a"].GetCompanyPlans(a);let i=t.data;Array.isArray(i)&&i.length>0?(e.$refs.dynamicform.updateProperty("Plan","config.options",i),e.$refs.dynamicform.UpdateKeyValue()):(e.$refs.dynamicform.updateProperty("Plan","config.options",[]),e.$refs.dynamicform.UpdateKeyValue())}catch(i){console.error("Error fetching plan data:",i)}},async getMeterTypes(){const t=this;let e="is_mapped=1";const a=await n["a"].GetMeterTypes(e);if(null!==a&&void 0!==a&&a.data){const e=JSON.parse(a.data.result).data;if(Array.isArray(e)&&e.length>0){var i=[];e.forEach((t,e)=>{i.push({value:t.meter_id,name:t.meter_name})}),t.$refs.dynamicform.updateProperty("Meter_type","config.options",i),t.$refs.dynamicform.UpdateKeyValue()}else console.warn("No valid data found in the response")}else console.error("Invalid response structure:",a)},async GetMeterNameDDlData(t,e){var a=this;a.FormSchema[0].Data[1].value="",a.FormSchema[0].Data[2].value="",a.FormSchema[0].Data[3].value="",a.FormSchema[1].Data[0].value="",a.FormSchema[1].Data[1].value="",a.FormSchema[1].Data[2].value="",a.FormSchema[0].Data[1].config.options=[],a.FormSchema[0].Data[2].config.options=[],a.FormSchema[1].Data[2].config.options=[];let i=e.config.options.find(t=>t.value==e.value);"Gas"==i.name&&(a.FormSchema[2].Data[0].visibility=!1,a.FormSchema[2].Data[1].visibility=!1,a.FormSchema[2].Data[2].visibility=!1,a.FormSchema[2].Data[3].visibility=!1,a.FormSchema[2].Data[4].visibility=!1,a.FormSchema[2].Data[5].visibility=!1,a.FormSchema[2].Data[6].visibility=!0),"Electric"==i.name&&(a.FormSchema[2].Data[0].visibility=!0,a.FormSchema[2].Data[1].visibility=!0,a.FormSchema[2].Data[2].visibility=!0,a.FormSchema[2].Data[3].visibility=!0,a.FormSchema[2].Data[4].visibility=!0,a.FormSchema[2].Data[5].visibility=!0,a.FormSchema[2].Data[6].visibility=!1),"Water"==i.name&&(a.FormSchema[2].Data[0].visibility=!1,a.FormSchema[2].Data[1].visibility=!1,a.FormSchema[2].Data[2].visibility=!1,a.FormSchema[2].Data[3].visibility=!1,a.FormSchema[2].Data[4].visibility=!1,a.FormSchema[2].Data[5].visibility=!1,a.FormSchema[2].Data[6].visibility=!1);try{let t="type=is_meter&TypeValue=1&type2=utility_type_id&TypeValue2="+e.value;const i=await n["a"].GetMeterNameDDlData(t),s=i.data;Array.isArray(s)&&s.length>0?(s.forEach(t=>{a.FormSchema[0].Data[1].config.options.push({value:t.value,name:t.name})}),a.$refs.dynamicform.UpdateKeyValue(),a.GetPlanDDlData(e.value)):(a.FormSchema[0].Data[1].config.options=[],console.warn("No data found or data is not an array."))}catch(s){console.error("Error fetching meter name data:",s)}},getSerialNumber(t,e){var a=this;if(a.FormSchema[0].Data[2].config.options=[],a.FormSchema[0].Data[3].value="",a.FormSchema[1].Data[0].value="",a.FormSchema[1].Data[1].value="",e){var i="id="+e.value;n["a"].GetSerialnumberByMeterId(i).then((function(t){if(null!==t&&void 0!==t&&t.data)if(Array.isArray(t.data)&&t.data.length>0){a.FormSchema[0].Data[2].config.options=[];let e=t.data;e.forEach(t=>{a.FormSchema[0].Data[2].config.options.push({value:t.value,name:t.name})}),a.$refs.dynamicform.UpdateKeyValue()}else console.warn("No data found or data is not an array.")}))}},async getMeterMappingDetails(t,e,a){try{var i=this;if(i.FormSchema[0].Data[3].value="",i.FormSchema[1].Data[0].value="",i.FormSchema[1].Data[1].value="",null!=(null===a||void 0===a?void 0:a.value)&&null!=(null===a||void 0===a?void 0:a.label)){var s="id="+a.value;let t=await n["a"].GetMeterMappingDetails(s);t.data&&Array.isArray(t.data)&&t.data.length>0?(i.FormSchema[0].Data[3].value=t.data[0].model_name||"",i.FormSchema[1].Data[0].value=t.data[0].meter_service||"",i.FormSchema[1].Data[1].value=t.data[0].meter_unit||""):console.warn("No data found or data is empty")}}catch(l){console.error("Error fetching meter mapping details:",l)}},Close(){var t=this;t.FormSchema[0].Data[0].value="",t.FormSchema[0].Data[1].value="",t.FormSchema[0].Data[2].value="",t.FormSchema[0].Data[3].value="",t.FormSchema[1].Data[0].value="",t.FormSchema[1].Data[1].value="",t.FormSchema[1].Data[2].value="",t.FormSchema[1].Data[3].value="",t.FormSchema[2].Data[0].value="",t.FormSchema[2].Data[1].value="",t.FormSchema[2].Data[2].value="",t.FormSchema[2].Data[3].value="",t.FormSchema[2].Data[4].value="",t.FormSchema[2].Data[5].value="",t.FormSchema[2].Data[6].value="",t.FormSchema[2].Data[7].value="",t.FormSchema[2].Data[8].value="",t.$refs.dynamicform.validateForm.reset(),t.$parent.isAddMeter=!1},async OnSubmit(t,e){var a=this,i={MeterMappingId:a.meterMappingId,ClientId:a.ClientId,ClientAdditionalId:a.ClientAdditionalId,SerialNumber:"Edit"==a.reqFrom?t.SerialNumber[0].value:t.SerialNumber.value,PlanId:t.Plan,InstallationDate:t.InstallationDate,RegisterConstant:t.RegisterConstant,SanctionedLoad:t.Sanctioned_Load,MultiplyFactor:t.Multiply_Factor||1,PowerFactor:t.Power_factor||0,VoltageRating:t.Voltage_Rating,Current_Rating:t.Current_Rating,MeterTypeID:t.Meter_type,MeterNameID:t.MeterName,PhaseType:t.Phase_Type,ConnectionType:t.ConnectionType,Property:t.Property,InvoiceGroupingId:t.Division,ContractId:t.Contract,TentativeEndDate:t.TentativeEndDate,Status:t.Status},s=JSON.stringify(i);n["a"].MeterMapping(s).then(t=>{"Success"==t.data.Status&&("1"==t.data.Result?(a.refreshKey+=1,a.$parent.FetchData(),a.ShowAlert(a.$t("UpdatedSuccess",[a.$t("Meter")]),"success",!0,a.$t("Alert")),a.Close()):"0"==t.data.Result&&(a.refreshKey+=1,a.$parent.FetchData(),a.ShowAlert(a.$t("AddedSuccess",[a.$t("Meter")]),"success",!0,a.$t("Alert")),a.Close()))})}}},qi=ji,zi=Object(d["a"])(qi,Fi,ki,!1,null,null,null),Wi=zi.exports,Ji={components:{ReplaceMeter:Ai,ViewHistory:xi,SaveBillingDate:$i,ModalAddMeter:Wi,ModalViewPlanDetails:He},props:{ClientId:{type:Number}},data(){return{TotalRecords:0,noRecord:!1,isLoading:!1,CompanyId:null,PageSize:10,statusId:"",PageNumber:1,isPaged:1,TotalPages:0,widgets:[],SortBy:"",SortExp:"",ProjectName:"",taskId:"",listActions:gi.listActions,Headers:gi.TableHeader,ListingData:[],searchCondition:"",Buttons:gi.buttons,QuotesListingSchema:!1,IsReplace:!1,SerialNo:null,MeterId:null,IsHistory:!1,IsSaveDate:!1,SelectedStatusId:null,reqFrom:"",utilityTypeId:0,ClientAdditionalId:0,editMeterDetail:[],isAddMeter:!1,isViewPlanDetailsUtilityCase:!1,PlanId:"",PlanMappingId:"",IsShowMeterDetail:!1,StartBillingDate:"",InstallationDate:""}},created:async function(){this.CompanyId=this.GetUserInfo.CompanyId,this.user_Id=this.GetUserInfo.ID,this.FetchData()},methods:{EditMeter:function(t){var e=this;e.utilityTypeId=t.meter_type_id,e.meterMappingId=t.meter_mapping_id,e.ClientAdditionalId=t.client_additional_id,e.editMeterDetail=t,e.reqFrom="Edit",e.isAddMeter=!0},getFullAddress(t){return`${t.user_address_1}, ${t.user_city}, ${t.user_state}, ${t.user_zipcode}, India`},FetchData:async function(){var t=this;t.isLoading=!0;var e="clientId="+t.ClientId;t.isBlank(this.searchCondition)||(e+="&search="+this.searchCondition),await n["a"].GetMapMeterById(e).then((function(e){null!==e&&void 0!==e&&e.data?e.data.length>0?(t.isLoading=!1,t.ListingData=e.data,t.noRecord=!1,t.TotalRecords=e.data[0].TOTAL_RECORDS):(t.ListingData=[],t.noRecord=!0,t.TotalRecords=0,t.isLoading=!1):(t.noRecord=!0,t.isLoading=!1,t.ListingData=[],t.TotalRecords=0)}))},leftCommonSearch:function(t){if(this.PageNumber=t.PageNumber,this.isPaged=1,"undefined"!=typeof t.searchCondition)if(""!=t.searchCondition){let e=t.searchConditionJson,a=e.split("=")[1];this.searchCondition=a}else this.searchCondition="";else this.searchCondition="";this.FetchData()},OpenMeterDetail(t){var e=this;e.editMeterDetail=t,e.IsShowMeterDetail=!0},CloseTemplate:function(){var t=this;t.IsShowMeterDetail=!1},OpenPlanDetail(t){var e=this;e.viewDetails(t)},async viewDetails(t){var e=this;e.PlanId=t.plan_id,e.PlanMappingId=t.plan_mapping_id,e.isViewPlanDetailsUtilityCase=!0},renderActions:function(t){var e=this;let a=[];return e.listActions.forEach(e=>{let i={...e};switch(i.title){case"Delete":"BILLING_START"==t.billing_status_code?i.isVisible=!1:i.isVisible=!0;break;case"Replace":1001==t.status_id?i.isVisible=!0:i.isVisible=!1;break;case"View History":1002==t.status_id?i.isVisible=!0:i.isVisible=!1;break;case"Start Billing":"BILLING_PENDING"!=t.billing_status_code&&"BILLING_STOP"!=t.billing_status_code||1001!=t.status_id?i.isVisible=!1:i.isVisible=!0;break;case"Stop Billing":"BILLING_START"==t.billing_status_code&&1001==t.status_id?i.isVisible=!0:i.isVisible=!1;break;case"Edit Meter":1001==t.status_id?(i.isVisible=!0,i.isDisabled=!1):(i.isVisible=!0,i.isDisabled=!0);break;default:i.isVisible=!0}a.push(i)}),a},formatDate:function(t){return t?E()(t).format("MMMM Do, YYYY"):""},pagerMethod:function(t){this.PageSize=t.PageSize,this.PageNumber=t.PageNumber,this.FetchData()},actionButtonClick:function(t,e){switch(t){case"Delete":this.DeleteMultiple(e);break;case"Replace":this.ReplaceMeter(e);break;case"ViewHistory":this.ViewHistory(e);break;case"StartBilling":this.StartBilling(e);break;case"StopBilling":this.StopBilling(e);break;case"EditMeter":this.EditMeter(e);break}},ReplaceMeter:function(t){var e=this;e.SerialNo=t.serial_number,e.MeterId=t.asset_catalogue_id,e.MeterMappingId=t.meter_mapping_id,e.IsReplace=!e.IsReplace},ViewHistory:function(t){var e=this;e.MeterMappingId=t.meter_mapping_id,e.IsHistory=!e.IsHistory},DeleteMultiple:function(t){var e=this,a="";a+=t.meter_mapping_id,a.length>0&&e.confirmR(e.$t("ConfirmDelete"),!0,e.$t("Delete")+"  "+e.$t("Meter"),(function(){let t=`ids=${a}&tableName=talygen_meter_mapping&primaryKey=meter_mapping_id`;n["a"].Delete(t).then(t=>{t.data?($("[id^='chkAll']").prop("checked",!1).removeAttr("checked"),$(".chkItems:checkbox:checked").prop("checked",!1).removeAttr("checked"),e.ShowAlert(e.$t("DeletedSuccessfully"),"Success",!0,e.$t("Alert"))):e.ShowAlert(e.$t("DeletedError",[e.$t("val")]),"failure",!0,e.$t("Alert")),e.FetchData()})}))},commonHeaderButtonClick:async function(t){},sortdata:function(t){var e="sort tb_headerSortDown";this.SortBy=t,t===this.SortBy&&(""==this.SortExp?(this.SortExp="ASC",e="sort tb_headerSortDown"):"ASC"==this.SortExp?(this.SortExp="DESC",e="sort tb_headerSortUp"):(this.SortExp="ASC",e="sort tb_headerSortDown")),this.FetchData(),$("#"+t+"  span:first-child").attr("class",e)},UpdateBillingStatus(t){this.isLoading=!0,n["a"].UpdateMeterBillingStatus(t).then(t=>{var e;null!==(e=t.data)&&void 0!==e&&e.success?(this.ShowAlert(this.$t("UpdatedSuccessfully"),"Success",!0,this.$t("Alert")),this.FetchData()):this.ShowAlert(this.$t("UpdateFailed"),"Failure",!0,this.$t("Alert"))}).catch(t=>{console.error(t),this.ShowAlert(this.$t("UpdateFailed"),"Failure",!0,this.$t("Alert"))}).finally(()=>{this.isLoading=!1,this.IsSaveDate=!1})},StartBilling(t){var e=this;e.MeterMappingId=t.meter_mapping_id,e.SelectedStatusId=t.billing_changed_status_id,e.StartBillingDate=t.billing_start_date,e.InstallationDate=t.date_Of_installation,e.IsSaveDate=!e.IsSaveDate},StopBilling(t){const e={meterMappingId:t.meter_mapping_id,statusId:t.billing_changed_status_id,billingStartDate:null};this.UpdateBillingStatus(e)},onBillingSaved({meterMappingId:t,billingStartDate:e,statusId:a}){const i={meterMappingId:t,statusId:a,billingStartDate:e};this.UpdateBillingStatus(i)}}},Ki=Ji,Qi=Object(d["a"])(Ki,mi,hi,!1,null,null,null),Zi=Qi.exports,Xi={components:{MeterListing:Zi},props:{ClientData:{type:Object,required:!0}},data(){return{isLoading:!1,userId:0,ClientId:0,fileError:null,MandatoryString:this.$t("MandatoryString"),companyId:null,MeterNameData:[],MeterId:null,SerialNumberData:[],SerialId:null,PlanData:[],PlanId:null,refreshKey:0,FormSchema:[{layoutType:"four",Data:[{astype:"SelectField",label:this.$t("MeterType"),name:"Meter_type",value:"",config:{options:[],onChange:this.GetMeterNameDDlData},placeholder:this.$t("Meter"),validationRules:{required:!0,max:100},disabled:!1,visibility:!0},{astype:"SelectField",label:this.$t("MeterName"),name:"MeterName",value:"",placeholder:"",visibility:!0,config:{options:[],onChange:this.getSerialNumber},validationRules:{required:!0}},{astype:"SelectField",label:this.$t("SerialNumber"),name:"SerialNumber",value:"",placeholder:"",visibility:!0,config:{options:[],onChange:this.getMeterMappingDetails},validationRules:{required:!0}},{astype:"TextField",label:this.$t("ModelName"),name:"ModelName",value:"",visibility:!0,validationRules:[{required:!1}],disabled:!0}]},{layoutType:"four",Data:[{astype:"TextField",label:this.$t("MeterService"),name:"MeterService",value:"",validationRules:[{required:!1}],disabled:!0,visibility:!0},{astype:"TextField",label:this.$t("MeterUnit"),name:"MeterUnit",value:"",validationRules:[{required:!1}],disabled:!0,visibility:!0},{astype:"SelectField",label:this.$t("Plan"),name:"Plan",value:"",placeholder:"",visibility:!0,config:{options:[]},validationRules:{required:!0}},{astype:"DateField",label:this.$t("InstallationDate"),name:"InstallationDate",value:"",placeholder:this.$t("Select Date"),validationRules:{required:!0,max:100},config:{},visibility:!0}]},{layoutType:"four",Data:[{astype:"TextField",label:this.$t("SanctionedLoad"),name:"Sanctioned_Load",value:"",validationRules:[{required:!0}],disabled:!1,visibility:!1},{astype:"NumericField",label:this.$t("MultiplyFactor"),name:"Multiply_Factor",value:"",validationRules:[{required:!0}],disabled:!1,visibility:!1},{astype:"NumericField",label:this.$t("PowerFactor "),name:"Power_factor",value:"",validationRules:[{required:!1}],disabled:!1,visibility:!1},{astype:"TextField",label:this.$t("VoltageRating"),name:"Voltage_Rating",value:"",validationRules:[{required:!1}],disabled:!1,visibility:!1},{astype:"TextField",label:this.$t("CurrentRating"),name:"Current_Rating",value:"",validationRules:[{required:!1}],disabled:!1,visibility:!1},{astype:"SelectField",label:this.$t("PhaseType"),name:"Phase_Type",value:"",placeholder:"",visibility:!1,config:{options:[{value:"1",name:"Single Phase"},{value:"2",name:"Triple Phase"}]},validationRules:{required:!0}},{astype:"TextField",label:this.$t("RegisterConstant"),name:"RegisterConstant",value:"",validationRules:[{required:!1}],disabled:!1,visibility:!1},{astype:"SelectField",label:this.$t("ConnectionType"),name:"ConnectionType",value:"",placeholder:"",visibility:!0,config:{options:[{value:"Permanent",name:"Permanent"},{value:"Temporary",name:"Temporary"}]},validationRules:{required:!0}},{astype:"SelectField",label:this.$t("Property"),name:"Property",value:"",placeholder:"",visibility:!0,config:{options:[]},validationRules:{required:!0}}]}],buttons:[{type:"button",class:"btn btn-danger",text:"<i class='fa fa-refresh pr-2'></i>Reset",onClick:this.Close},{type:"submit",class:"btn btn-success",text:"<i class='fa fa-save pr-2'></i>Save",isVisible:!0}]}},async created(){var t=this;t.userId=t.GetUserInfo.ID,t.user_type=t.GetUserInfo.UserType,t.companyId=t.GetUserInfo.CompanyId,t.CompanyName=t.GetUserInfo.CompanyName,t.ClientId=t.$route.params.id,await t.getMeterTypes(),await t.getPropertyType()},methods:{getPropertyType:async function(t){var e=this;let a="id=0&moduleName=Billing&type=PROPERTY_BY_CLIENT_ID&search=&refId="+e.ClientId;await n["a"].GetDDLData(a).then(t=>{""!=t.data&&null!=t.data&&(e.$refs.dynamicform.updateProperty("Property","config.options",t.data.DATA),e.$refs.dynamicform.UpdateKeyValue())})},async GetPlanDDlData(t){var e=this;let a=`clientId=${e.ClientId}&meter_type_id=${t}`;try{const t=await n["a"].GetCompanyPlans(a);let i=t.data;Array.isArray(i)&&i.length>0?(i.forEach(t=>{e.FormSchema[1].Data[2].config.options.push({value:t.value,name:t.name})}),e.$refs.dynamicform.UpdateKeyValue()):e.FormSchema[1].Data[2].config.options=[]}catch(i){console.error("Error fetching plan data:",i)}},async getMeterTypes(){const t=this;try{let e="is_mapped=1";const a=await n["a"].GetMeterTypes(e);if(null!==a&&void 0!==a&&a.data){const e=JSON.parse(a.data.result).data;Array.isArray(e)&&e.length>0?(e.map(e=>{t.FormSchema[0].Data[0].config.options.push({value:e.meter_id,name:e.meter_name})}),t.$refs.dynamicform.UpdateKeyValue()):console.warn("No valid data found in the response")}else console.error("Invalid response structure:",a)}catch(e){console.error("Error fetching Meter types:",e)}},async GetMeterNameDDlData(t,e){var a=this;a.FormSchema[0].Data[1].value="",a.FormSchema[0].Data[2].value="",a.FormSchema[0].Data[3].value="",a.FormSchema[1].Data[0].value="",a.FormSchema[1].Data[1].value="",a.FormSchema[1].Data[2].value="",a.FormSchema[0].Data[1].config.options=[],a.FormSchema[0].Data[2].config.options=[],a.FormSchema[1].Data[2].config.options=[];let i=e.config.options.find(t=>t.value==e.value);"Gas"==i.name&&(a.FormSchema[2].Data[0].visibility=!1,a.FormSchema[2].Data[1].visibility=!1,a.FormSchema[2].Data[2].visibility=!1,a.FormSchema[2].Data[3].visibility=!1,a.FormSchema[2].Data[4].visibility=!1,a.FormSchema[2].Data[5].visibility=!1,a.FormSchema[2].Data[6].visibility=!0),"Electric"==i.name&&(a.FormSchema[2].Data[0].visibility=!0,a.FormSchema[2].Data[1].visibility=!0,a.FormSchema[2].Data[2].visibility=!0,a.FormSchema[2].Data[3].visibility=!0,a.FormSchema[2].Data[4].visibility=!0,a.FormSchema[2].Data[5].visibility=!0,a.FormSchema[2].Data[6].visibility=!1),"Water"==i.name&&(a.FormSchema[2].Data[0].visibility=!1,a.FormSchema[2].Data[1].visibility=!1,a.FormSchema[2].Data[2].visibility=!1,a.FormSchema[2].Data[3].visibility=!1,a.FormSchema[2].Data[4].visibility=!1,a.FormSchema[2].Data[5].visibility=!1,a.FormSchema[2].Data[6].visibility=!1);try{let t="type=is_meter&TypeValue=1&type2=utility_type_id&TypeValue2="+e.value;const i=await n["a"].GetMeterNameDDlData(t),s=i.data;Array.isArray(s)&&s.length>0?(s.forEach(t=>{a.FormSchema[0].Data[1].config.options.push({value:t.value,name:t.name})}),a.$refs.dynamicform.UpdateKeyValue(),a.GetPlanDDlData(e.value)):(a.FormSchema[0].Data[1].config.options=[],console.warn("No data found or data is not an array."))}catch(s){console.error("Error fetching meter name data:",s)}},getSerialNumber(t,e){var a=this;if(a.FormSchema[0].Data[2].config.options=[],a.FormSchema[0].Data[3].value="",a.FormSchema[1].Data[0].value="",a.FormSchema[1].Data[1].value="",e){var i="id="+e.value;n["a"].GetSerialnumberByMeterId(i).then((function(t){if(null!==t&&void 0!==t&&t.data)if(Array.isArray(t.data)&&t.data.length>0){a.FormSchema[0].Data[2].config.options=[];let e=t.data;e.forEach(t=>{a.FormSchema[0].Data[2].config.options.push({value:t.value,name:t.name})}),a.$refs.dynamicform.UpdateKeyValue()}else console.warn("No data found or data is not an array.")}))}},async getMeterMappingDetails(t,e,a){try{var i=this;if(i.FormSchema[0].Data[3].value="",i.FormSchema[1].Data[0].value="",i.FormSchema[1].Data[1].value="",null!=(null===a||void 0===a?void 0:a.value)&&null!=(null===a||void 0===a?void 0:a.label)){var s="id="+a.value;let t=await n["a"].GetMeterMappingDetails(s);t.data&&Array.isArray(t.data)&&t.data.length>0?(i.FormSchema[0].Data[3].value=t.data[0].model_name||"",i.FormSchema[1].Data[0].value=t.data[0].meter_service||"",i.FormSchema[1].Data[1].value=t.data[0].meter_unit||""):console.warn("No data found or data is empty")}}catch(l){console.error("Error fetching meter mapping details:",l)}},Close(){var t=this;t.FormSchema[0].Data[0].value="",t.FormSchema[0].Data[1].value="",t.FormSchema[0].Data[2].value="",t.FormSchema[0].Data[3].value="",t.FormSchema[1].Data[0].value="",t.FormSchema[1].Data[1].value="",t.FormSchema[1].Data[2].value="",t.FormSchema[1].Data[3].value="",t.FormSchema[2].Data[0].value="",t.FormSchema[2].Data[1].value="",t.FormSchema[2].Data[2].value="",t.FormSchema[2].Data[3].value="",t.FormSchema[2].Data[4].value="",t.FormSchema[2].Data[5].value="",t.FormSchema[2].Data[6].value="",t.FormSchema[2].Data[7].value="",t.FormSchema[2].Data[8].value="",t.$refs.dynamicform.validateForm.reset()},async OnSubmit(t,e){var a=this,i={ClientId:a.ClientId,SerialNumber:t.SerialNumber,PlanId:t.Plan,InstallationDate:t.InstallationDate,RegisterConstant:t.RegisterConstant,SanctionedLoad:t.Sanctioned_Load,MultiplyFactor:t.Multiply_Factor||1,PowerFactor:t.Power_factor||0,VoltageRating:t.Voltage_Rating,Current_Rating:t.Current_Rating,MeterTypeID:t.Meter_type,MeterNameID:t.MeterName,PhaseType:t.Phase_Type,ConnectionType:t.ConnectionType,Property:t.Property},s=JSON.stringify(i);n["a"].MeterMapping(s).then(t=>{"Success"==t.data.Status&&(a.refreshKey+=1,a.$refs.meterlisting.FetchData(),a.ShowAlert(a.$t("AddedSuccess",[a.$t("Meter")]),"success",!0,a.$t("Alert")),a.Close())})}}},ts=Xi,es=(a("450c"),Object(d["a"])(ts,ui,pi,!1,null,null,null)),as=es.exports,is=function(){var t=this,e=t._self._c;return e("div",{staticClass:"col-md-12 p-0"},[e("div",{staticClass:"container-fluid py-3 border",attrs:{id:"divAddressfields"}},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-6"},[e("dynamic-form",{ref:"AdditionalOwner",attrs:{lang:"en",buttons:!1,schema:t.FormSchema}})],1)]),e("div",{staticClass:"row flex-row-reverse mt-2"},[e("div",{staticClass:"col-lg-6 text-right"},[e("a",{staticClass:"btn btn-success mr-2",attrs:{href:"javascript:;",title:"",id:"addAddress","data-toggle-tooltip":"tooltip","data-original-title":"Save"},on:{click:t.onSubmit}},[e("i",{staticClass:"fa fa-save mr-2"}),e("span",{attrs:{id:"btnAddressText"}},[t._v(" "+t._s(t.$t("Save")))])]),e("a",{staticClass:"btn btn-danger",attrs:{href:"javascript:;",title:"",id:"CancelAddress","data-toggle-tooltip":"tooltip","data-original-title":"Cancel"},on:{click:t.onCancel}},[e("i",{staticClass:"fa fa-times mr-2"}),t._v(t._s(t.$t("Cancel")))])]),e("div",{staticClass:"col-lg-6"},[e("div",{staticClass:"py-2"},[e("span",{staticClass:"mandatory"},[t._v(t._s(t.$t("Mandatory")))])])])])]),e("tg-list",{attrs:{ModuleName:"User",SubModuleCode:"BILLING",IdentityColumn:"ADDITIONAL_OWNER_ID",listType:["List"],ListData:t.AdditionalOwnerListing,HeaderData:t.Headers,TotalRecords:t.TotalRecords,IsShowAction:!1,RenderRowActionMethod:t.renderActions,showCheckBox:!0,ListDataCallBackFunction:t.FetchData,NorecordfoundText:t.$t("NoRecordfound")},on:{ActionButtonClick:t.actionButtonClick,PagerButtonClick:t.pagerMethod,SortdataButtonClick:t.sortdata,HeaderButtonClick:t.commonHeaderButtonClick},scopedSlots:t._u([{key:"slotdata",fn:function({data:a}){return["STATUS_NAME"==a.column.COLUMN_NAME?[e("span",{class:t.getStatusClassList(a.row.STATUS_NAME)},[t._v(" "+t._s(a.row.STATUS_NAME)+" ")])]:t._e(),"Edit"==a.column.COLUMN_NAME?[e("td",{staticClass:"text-center single-action"},[e("div",{staticClass:"cstm-drop-btn"},[e("span",[e("a",{on:{click:function(e){return t.EditAddiotionOwner(a.row)}}},[e("em",{staticClass:"text-success",attrs:{"aria-hidden":"true"}},[e("i",{staticClass:"fa fa-edit action-icon"})])])])])])]:t._e(),"Delete"==a.column.COLUMN_NAME?[e("td",{staticClass:"text-center single-action"},[e("div",{staticClass:"cstm-drop-btn"},[e("span",[e("a",{on:{click:function(e){return t.DeleteAddiotionOwner(a.row.ADDITIONAL_OWNER_ID)}}},[e("em",{staticClass:"text-primary",attrs:{"aria-hidden":"true"}},[e("i",{staticClass:"fa fa-trash text-danger action-icon"})])])])])])]:t._e()]}}])})],1)},ss=[];var ns={props:{ClientId:{type:Number,required:!0}},data(){return{config:{isShowDrawButton:!0,isShowSearchBox:!0},isUpdateForm:!1,AdditionalOwnerId:0,isdeleteButtonVisible:!1,allSelected:!1,FormSchema:[{layoutType:"double",Data:[{astype:"TextField",label:this.$t("name"),name:"Name:",value:"",placeholder:"",validationRules:{max:200,required:!0}},{astype:"SelectField",label:this.$t("User"),mode:"tag",name:"User",value:"",config:{options:[]},placeholder:this.$t("Select User"),validationRules:{required:!0,max:100}}]}],StatusListForListing:[{STATUS:"Active",STATUS_ID:1001,STATUS_COLOR:"#ffffff",STATUS_BG_COLOR:"#28a745"},{STATUS:"Inactive",STATUS_ID:1002,STATUS_COLOR:"#ffffff",STATUS_BG_COLOR:"#d72435"}],TotalRecords:0,PageSize:10,PageNumber:1,SortExp:"",SortBy:"",AdditionalOwnerListing:[],GroupStart:1,GroupEnd:3,CurrentPage:1,TotalPages:0,Headers:[{COLUMN_NAME:"NAME",DATA_TYPE:"string",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"name",DISPLAY_ORDER:1},{COLUMN_NAME:"USER_NAME",DATA_TYPE:"string",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"UserName",DISPLAY_ORDER:2},{COLUMN_NAME:"CREATED_BY",DATA_TYPE:"string",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"CreatedBy",DISPLAY_ORDER:3},{COLUMN_NAME:"CREATED_AT",DATA_TYPE:"string",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"CreatedDate",DISPLAY_ORDER:4},{COLUMN_NAME:"STATUS_NAME",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Status",DISPLAY_ORDER:5},{COLUMN_NAME:"Edit",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Edit",DISPLAY_ORDER:6,settings:{isInSlot:!0}},{COLUMN_NAME:"Delete",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Delete",DISPLAY_ORDER:7,settings:{isInSlot:!0}}]}},created(){var t=this;t.GetUser(),t.FetchData()},methods:{GetUser(){var t=this,e="id=&moduleName=&type=USERS&search=&refId=";n["a"].GetDDLData(e).then(e=>{console.log("response : ",e.data.DATA),void 0==e.data.DATA&&null==e.data.DATA||e.data.DATA.length>0&&(e.data.DATA.forEach(t=>{let e={value:t.value,name:t.name};this.FormSchema[0].Data[1].config.options.push(e)}),t.$refs.AdditionalOwner.UpdateKeyValue())})},onSubmit(){var t=this;t.FormSchema[0].Data[0].validationRules.required=!0,t.FormSchema[0].Data[1].validationRules.required=!0,t.$refs.AdditionalOwner.validateForm.validate().then(async e=>{if(e){t.isLoading=!0;let e={AdditionalOwnerId:t.AdditionalOwnerId,Name:t.FormSchema[0].Data[0].value,SUserId:parseInt(t.FormSchema[0].Data[1].value),ClientId:t.ClientId,RefSource:"",RefSourceId:""};n["a"].SaveAdditionalOwner(e).then(e=>{t.isLoading=!1,null!=e.data?"0"==e.data.Result?(t.ShowAlert(t.$t("AddedSuccess",[t.$t("AdditionalOwner")]),"success",!0,t.$t("Alert")),t.clearForm(),t.FormSchema[0].Data[0].validationRules.required=!1,t.FormSchema[0].Data[1].validationRules.required=!1,t.FetchData()):"1"==e.data.Result?(t.ShowAlert(t.$t("UpdatedSuccess",[t.$t("AdditionalOwner")]),"success",!0,t.$t("Alert")),t.clearForm(),t.FormSchema[0].Data[0].validationRules.required=!1,t.FormSchema[0].Data[1].validationRules.required=!1,t.isUpdateForm=!1,t.FetchData()):"-2"===e.data.Result?this.ShowAlert(this.$t("RecordAlreadyExists"),"danger",!1,this.$t("Alert")):t.ShowAlert(t.$t("SomethingWentWrong"),"danger",t.$t("Alert")):t.ShowAlert(t.$t("SomethingWentWrong"),"success",t.$t("Alert"))})}}).catch(t=>{console.error("Error validating form:",t)})},EditAddiotionOwner(t){var e=this;e.isUpdateForm=!0,e.FormSchema[0].Data[0].value=t.NAME,e.FormSchema[0].Data[1].value=t.USER_ID,e.AdditionalOwnerId=t.ADDITIONAL_OWNER_ID},FetchData:async function(){var t=this,e=`clientId=${t.ClientId}&pageSize=${t.PageSize}&pageNum=${t.PageNumber}&sortBy=${t.SortBy}&sortExp=${t.SortExp}`;await n["a"].GetGetAdditionalOwnerListing(e).then((function(e){""!=e.data&&null!=e.data&&e.data.length>0?(t.AdditionalOwnerListing=e.data,t.TotalRecords=e.data[0].TOTAL_RECORDS,t.TotalPages=Math.ceil(t.TotalRecords/t.PageSize),t.CurrentPage=t.PageNumber,t.noRecord=!1):(t.noRecord=!0,t.TotalRecords=0,t.AdditionalOwnerListing=[])}))},DeleteAddiotionOwner:function(t){var e=this,a=t;a>0?e.confirmR(e.$t("ConfirmDelete"),!0,e.$t("Delete")+"  "+e.$t("AddiotionOwner"),(function(){var t={Ids:a,ClientId:e.ClientId};n["a"].DeleteAdditionalOwner(t).then(t=>{0==t.data.Result?(e.FetchData(),e.ShowAlert(e.$t("DeletedSuccess",[e.$t("AddiotionOwner")]),"Success",!0,e.$t("Alert"))):e.ShowAlert(e.$t("DeletedError",[e.$t("AddiotionOwner")]),"failure",!0,e.$t("Alert"))})})):e.ShowAlert(e.$t("Selectanyrecordtodelete"),"warning",!0,e.$t("Alert"))},clearForm(){var t=this;t.FormSchema[0].Data[0].value="",t.FormSchema[0].Data[1].value="",t.AdditionalOwnerId=0},onCancel(){var t=this;t.clearForm()},pagerMethod:function(t){this.PageSize=t.PageSize,this.PageNumber=t.PageNumber,this.FetchData()},getStatusClassList(t){let e="";switch(t){case"Inactive":e="btn btn-danger py-0 d-block font-14";break;case"Active":e="btn btn-success py-0 d-block font-14";break;default:e=""}return e},sortdata:function(t){this.SortBy=t;var e="ASC";e="ASC"==this.SortExp?"DESC":"ASC",this.SortExp=e,this.SortBy=t,this.SortExp=e,this.PageNumber=1,this.GroupStart=this.PageNumber,this.GroupEnd=this.PageNumber+2,this.FetchData()},renderActions:function(t){},actionButtonClick(t,e,a,i,s){},commonHeaderButtonClick:function(t){}}},ls=ns,os=(a("7d9e"),Object(d["a"])(ls,is,ss,!1,null,null,null)),rs=os.exports,cs=function(){var t=this,e=t._self._c;return t.IsSubscriptionBilling?e("section",[e("tg-list",{attrs:{IsShowAction:!0,showCheckBox:!1,ModuleName:"Billing",listType:["List"],RenderRowActionMethod:t.renderActions,SubModuleCode:"Billing",IdentityColumn:"client_plan_mapping_id",ListData:t.RateScheduledeListing,HeaderData:t.Headers,callbackfunction:t.FetchData,HeaderButtons:t.listheaderbuttons,TotalRecords:t.TotalRecords,ListDataCallBackFunction:t.FetchData,LegendArray:[],SortExp:t.sortExp,SortBy:t.sortBy,NorecordfoundText:t.$t("NoRecordfound"),isShowHeaderText:!0,HeaderText:t.$t("RateSchedule")},on:{LeftsearchButtonClick:function(t){},PagerButtonClick:t.pagerMethod,ActionButtonClick:t.actionButtonClick,HeaderButtonClick:t.commonHeaderButtonClick,SortdataButtonClick:t.sortdata},scopedSlots:t._u([{key:"slotdata",fn:function({data:a}){return["created_at"==a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(t.$options.filters.formatDate(a.row.created_at))+" ")])]:t._e()]}}],null,!1,622273183)}),t.isServices?e("ServiceRatesList",{attrs:{Id:t.clientplanmappingid,PlanId:t.PlanId,ClientId:t.ClientId}}):t._e(),t.isViewHistory?e("ViewHistory",{attrs:{Id:t.clientplanmappingid}}):t._e()],1):e("section",[e("SubscriptionRateSchedule",{attrs:{ClientId:t.ClientId}})],1)},ds=[],us=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"my-popups"},[e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered ui-draggable"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header ui-draggable-handle"},[e("button",{staticClass:"close",attrs:{type:"button"},on:{click:function(e){return t.closepopup()}}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})]),e("h4",{staticClass:"modal-title",attrs:{name:"header"}},[t._v(" View Rate Schedule History ")])]),e("div",{staticClass:"modal-body"},[e("tg-list",{attrs:{IsShowAction:!1,showCheckBox:!1,ModuleName:"Billing",listType:["List"],RenderRowActionMethod:t.renderActions,SubModuleCode:"Billing",IdentityColumn:"id",ListData:t.historyList,HeaderData:t.Headers,callbackfunction:t.FetchData,HeaderButtons:t.listheaderbuttons,TotalRecords:t.TotalRecords,ListDataCallBackFunction:t.FetchData,LegendArray:t.LegendArray,SortExp:t.sortExp,SortBy:t.sortBy,NorecordfoundText:t.$t("NoRecordfound"),isShowHeaderText:!0,HeaderText:t.$t("RateSchedulede")},on:{LeftsearchButtonClick:function(t){},PagerButtonClick:t.pagerMethod,ActionButtonClick:t.actionButtonClick,HeaderButtonClick:t.commonHeaderButtonClick,SortdataButtonClick:t.sortdata}})],1)])])])])])},ps=[],ms={props:{Id:{type:Number,required:!0}},data(){return{historyList:[],TotalRecords:0,pageSize:10,pageNum:1,sortBy:"",CurrentPage:1,TotalPages:0,sortExp:"",noRecords:!1,Headers:[{COLUMN_NAME:"plan_name",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Plan Name",DISPLAY_ORDER:1},{COLUMN_NAME:"service_name",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Service Name",DISPLAY_ORDER:1},{COLUMN_NAME:"billing_type",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Billing Type",DISPLAY_ORDER:2},{COLUMN_NAME:"billing_interval",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Billing Interval",DISPLAY_ORDER:3},{COLUMN_NAME:"from",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"From",DISPLAY_ORDER:4},{COLUMN_NAME:"to",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"To",DISPLAY_ORDER:5},{COLUMN_NAME:"rate",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Rate",DISPLAY_ORDER:6},{COLUMN_NAME:"modified_at",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Modified At",DISPLAY_ORDER:7},{COLUMN_NAME:"modified_by",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Modified By",DISPLAY_ORDER:8}],listActions:[],LegendArray:[{class:"legend-Progress colorboxsquare",text:this.$t("Active")},{class:"legend-ovrdue colorboxsquare",text:this.$t("Inactive")}]}},created:async function(){var t=this;t.FetchData()},methods:{async FetchData(){try{var t=`clientPlanMappingId=${this.Id}&pageSize=${this.pageSize}&pageNum=${this.pageNum}&sortBy=&sortExp=`;await n["a"].ViewRateSchedulePlanServicesHistory(t).then(t=>{var e;(null==t.data.Result.DATA&&t.data.Result.DATA[0].is_rate_applicable_on_plan&&this.Headers.forEach(t=>{t.settings=null,"service_name"==t.COLUMN_NAME&&(t.VISIBLE=!1),"billing_type"==t.COLUMN_NAME&&(t.VISIBLE=!1)}),t.data.Result.DATA.length>0)?(this.historyList=(null===t||void 0===t||null===(e=t.data)||void 0===e||null===(e=e.Result)||void 0===e?void 0:e.DATA)||[],this.historyList.forEach(t=>{t.additionalClass="",1002==t.status_id?t.additionalClass="danger-bar odd":t.additionalClass="low-bar"}),this.TotalRecords=t.data.Result.DATA[0].TOTAL_RECORDS,this.TotalPages=Math.ceil(this.TotalRecords/this.pageSize),this.CurrentPage=this.pageNum,this.noRecord=!1):(this.noRecord=!0,this.TotalRecords=0,this.historyList=[])})}catch(e){console.error("Error fetching data:",e)}},closepopup(){this.$parent.isViewHistory=!1},actionButtonClick(t,e){},renderActions(t){},pagerMethod:function(t){this.pageSize=t.PageSize,this.pageNum=t.PageNumber,this.FetchData()},sortdata:function(t){this.SortBy=t;var e="ASC";"ASC"==this.SortExp&&(e="DESC"),this.SortExp=e,this.SortBy=t,this.SortExp=e,this.PageNumber=1,this.FetchData()}}},hs=ms,vs=Object(d["a"])(hs,us,ps,!1,null,null,null),_s=vs.exports,gs=function(){var t=this,e=t._self._c;return e("section",[e("loader",{attrs:{"is-visible":t.isLoading}}),e("tg-list",{ref:"tgList",attrs:{listType:["List"],IsShowAction:!0,showCheckBox:!0,ModuleName:"Plan",SubModuleCode:"Plan",IdentityColumn:"rate_schedule_id",HeaderText:t.$t("RateSchedule"),ListData:t.ListingData,HeaderData:t.Headers,widgets:t.widgets,HeaderButtons:t.Buttons,TotalRecords:t.TotalRecords,RenderRowActionMethod:t.renderActions,ListDataCallBackFunction:t.GetWorkCodeMappingList,SortExp:t.SortExp,SortBy:t.SortBy,NorecordfoundText:t.$t("NoRecordfound"),SearchFields:t.leftSearchFields,LegendArray:t.LegendArray},on:{PagerButtonClick:t.pagerMethod,HeaderButtonClick:t.commonHeaderButtonClick,SortdataButtonClick:t.sortdata,LeftsearchButtonClick:t.leftCommonSearch,ActionButtonClick:t.actionButtonClick},scopedSlots:t._u([{key:"slotdata",fn:function({data:a}){return["status_name"==a.column.COLUMN_NAME?[e("a",{staticClass:"inactive-disabled"},[e("span",{staticClass:"text-center text-white d-block",style:{backgroundColor:a.row.status_bg_color}},[t._v(" "+t._s(t.$t(a.row.status_name))+" ")])])]:t._e(),"rate"==a.column.COLUMN_NAME?[e("a",{staticClass:"task-dec",on:{click:function(e){return t.EditRateCode(a.row)}}},[t._v(t._s(null!=a.row.rate?parseFloat(a.row.rate).toFixed(2):"--")+" ")])]:t._e(),"created_at"==a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(t.$d(a.row.created_at))+" ")])]:t._e(),"start_date"==a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(null!=a.row.start_date?t.$d(a.row.start_date):"--")+" ")])]:t._e(),"end_date"==a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(null!=a.row.end_date?t.$d(a.row.end_date):"--")+" ")])]:t._e(),"modified_at"==a.column.COLUMN_NAME?[e("span",{staticClass:"text-center"},[t._v(" "+t._s(null!=a.row.modified_at?t.$d(a.row.modified_at):"--")+" ")])]:t._e(),"modified_by"==a.column.COLUMN_NAME?[e("span",{staticClass:"text-center"},[t._v(" "+t._s(null!=a.row.modified_by?a.row.modified_by:"--")+" ")])]:t._e(),"billing_code"==a.column.COLUMN_NAME?[e("span",{staticClass:"text-center"},[t._v(" "+t._s(""!=a.row.billing_code?a.row.billing_code:"--")+" ")])]:t._e()]}}])}),t.IsAddRate?e("AddRate",{attrs:{RateObj:t.RateObj,ClientId:t.ClientId},on:{CloseRateCode:t.CloseRateCode}}):t._e()],1)},fs=[],Cs=function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered",staticStyle:{"max-width":"1100px"}},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("Add"))+" "+t._s(t.$t("RateCode")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.CloseRateCode}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("dynamic-form",{ref:"AddRate",attrs:{lang:"en",buttons:t.buttons,schema:t.FormSchema,mandatorytext:t.MandatoryString},on:{OnSubmit:t.SubmitData}})],1)])])])],1)},ys=[],bs={props:{RateObj:{type:Object,required:!0},ClientId:{type:Number,required:!0}},data(){return{isLoading:!1,ListingData:[],FormSchema:[{layoutType:"four",Data:[{astype:"SelectField",label:this.$t("RateCode"),name:"RateCode",value:"",disabled:!1,visibility:!0,config:{options:[]},placeholder:this.$t("RateCode"),validationRules:{required:!0,max:100}},{astype:"DateField",label:this.$t("EventStartDate"),name:"StartDate",value:new Date,placeholder:this.$t("EventStartDate"),config:{format:"MM/DD/YYYY",minDate:new Date,maxDate:!1},validationRules:{required:!0}},{astype:"DateField",label:this.$t("EndDate"),name:"EndDate",value:new Date,placeholder:this.$t("EndDate"),config:{format:"MM/DD/YYYY",minDate:new Date,maxDate:!1},validationRules:{required:!0}},{astype:"TextField",label:this.$t("Rate"),name:"Rate",value:"",placeholder:this.$t("Rate"),validationRules:{required:!0}},{astype:"SelectField",label:this.$t("Status"),name:"Status",value:"1001",placeholder:this.$t("Status"),config:{options:[{name:"Active",value:1001},{name:"Inctive",value:1002}]},validationRules:{required:!1}},{astype:"TextField",label:this.$t("CustomerWorkCode"),name:"CustomerWorkCode",value:"",placeholder:this.$t("CustomerWorkCode"),validationRules:{required:!1}}]},{layoutType:"single",Data:[{astype:"TextAreaField",label:this.$t("Comment"),name:"Comment",value:"",placeholder:"",config:{rows:3},validationRules:{required:!1,max:2e3}}]}],buttons:[{type:"submit",class:"btn btn-success",text:"<i class='fa fa-save pr-2'></i>"+this.$t("Save")},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>"+this.$t("Cancel"),onClick:this.CloseRateCode}],WorkCodeList:[],MandatoryString:this.$t("MandatoryString"),RateCodeId:0}},created:function(){var t=this;t.ClientId,t.GetWorkCodes(),null!=t.RateObj&&t.BindRateDetails()},methods:{BindRateDetails(){var t=this;t.RateCodeId=t.RateObj.rate_schedule_id,t.FormSchema[0].Data[0].disabled=!0,t.FormSchema[0].Data[0].value=t.RateObj.workcode,t.FormSchema[0].Data[1].value=t.RateObj.start_date,t.FormSchema[0].Data[2].value=t.RateObj.end_date,t.FormSchema[0].Data[3].value=t.RateObj.rate,t.FormSchema[0].Data[4].value=t.RateObj.status_id,t.FormSchema[0].Data[5].value=t.RateObj.billing_code,t.FormSchema[1].Data[0].value=t.RateObj.comment},CloseRateCode(){this.$emit("CloseRateCode")},GetWorkCodes(){var t="moduleName=Billing&type=WORK_CODES",e=this;n["a"].GetDDLData(t).then(t=>{e.WorkCodeList=t.data.DATA,e.WorkCodeList.forEach(t=>{e.FormSchema[0].Data[0].config.options.push({name:""+t.name,value:""+t.value})}),this.$refs.AddRate.UpdateKeyValue()})},SubmitData(){var t=this;t.isLoading=!0,t.$refs.AddRate.validateForm.validate().then(async e=>{if(e){var a={RateCodeId:t.RateCodeId,PlainId:null,WorkCodeId:t.FormSchema[0].Data[0].value,StartDate:t.FormSchema[0].Data[1].value,EndDate:t.FormSchema[0].Data[2].value,Rate:t.FormSchema[0].Data[3].value,Status:t.FormSchema[0].Data[4].value,CustomerWorkCode:t.FormSchema[0].Data[5].value,Comment:t.FormSchema[1].Data[0].value,ClientId:t.ClientId},i=JSON.stringify(a);n["a"].SaveRateCode(i).then((function(e){e.data.Result.DATA.length>0?(t.isLoading=!1,"INSERT"==e.data.Result.DATA[0].VALUE?(t.ShowAlert(t.$t("AddedSuccess",[t.$t("Rate")]),"success",!0,t.$t("Alert")),t.CloseRateCode()):"UPDATE"==e.data.Result.DATA[0].VALUE?(t.ShowAlert(t.$t("UpdatedSuccess",[t.$t("Rate")]),"success",!0,t.$t("Alert")),t.CloseRateCode()):"EXISTS"==e.data.Result.DATA[0].VALUE?t.ShowAlert(t.$t("AlreadyExists",[t.$t("Rate")]),"warning",!0,t.$t("Alert")):t.ShowAlert(t.$t("UnknownErrorOccur"),"failure",!0,t.$t("Alert"))):t.ShowAlert(t.$t("UnknownErrorOccur"),"failure",!0,t.$t("Alert"))}))}else t.isLoading=!1})}}},Ss=bs,As=Object(d["a"])(Ss,Cs,ys,!1,null,null,null),Ds=As.exports,Is={components:{AddRate:Ds},props:{ClientId:{type:Number,required:!0}},data(){return{isLoading:!1,PageSize:10,PageNumber:1,isPaged:1,TotalPages:0,widgets:[],LegendArray:[],ListingData:[],TotalRecords:0,SortBy:"",listActions:[{title:"Edit",href:"javascript:void(0)",callbackfunction:"EditRateCode",icon:"fa fa-pencil action-icon text-success",additionalSpan:""},{title:"Delete",href:"javascript:void(0)",callbackfunction:"DeleteRateCode",icon:"fa fa-trash-o action-icon text-danger",additionalSpan:""}],Headers:[{COLUMN_NAME:"work_code",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("RateCode"),DISPLAY_ORDER:1},{COLUMN_NAME:"comment",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("Comment"),DISPLAY_ORDER:2},{COLUMN_NAME:"billing_code",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("BillingCode"),DISPLAY_ORDER:3,settings:{isInSlot:!0}},{COLUMN_NAME:"rate",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("Rate"),DISPLAY_ORDER:3,settings:{isInSlot:!0}},{COLUMN_NAME:"status_name",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("HBStatus"),DISPLAY_ORDER:3,settings:{isInSlot:!0}},{COLUMN_NAME:"start_date",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("EventStartDate"),DISPLAY_ORDER:3,settings:{isInSlot:!0}},{COLUMN_NAME:"end_date",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("EndDate"),DISPLAY_ORDER:3,settings:{isInSlot:!0}},{COLUMN_NAME:"created_by",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("SACreatedBy"),DISPLAY_ORDER:3},{COLUMN_NAME:"created_at",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("SACreatedAt"),DISPLAY_ORDER:3,settings:{isInSlot:!0}},{COLUMN_NAME:"modified_by",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("modified_by"),DISPLAY_ORDER:3,settings:{isInSlot:!0}},{COLUMN_NAME:"modified_at",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:this.$t("ModifiedAt"),DISPLAY_ORDER:3,settings:{isInSlot:!0}}],Buttons:[{title:"BacktoList",iconClass:"fa fa-angle-double-left",callbackfunction:"BacktoList",additionalClass:"",isdisabled:!1,isvisible:!0}],IsAddRate:!1,RateObj:null,PlainId:0}},created:function(){var t=this;t.PlainId=this.$route.params.id,t.Headers.forEach(e=>{e.DISPLAY_NAME=t.$t(e.DISPLAY_NAME)}),t.GetWorkCodeMappingList()},methods:{leftCommonSearch(){},renderActions:function(t){var e=this;let a=[];return e.listActions.forEach(t=>{let e={...t};switch(e.title){case"Edit":e.isVisible=!0;break;default:e.isVisible=!0}a.push(e)}),a},pagerMethod:function(t){this.PageSize=t.PageSize,this.PageNumber=t.PageNumber,this.GetWorkCodeMappingList()},actionButtonClick:function(t,e){switch(t){case"EditRateCode":this.EditRateCode(e);break;case"DeleteRateCode":this.commonDeleteData(e.rate_schedule_id);break}},commonHeaderButtonClick:async function(t){var e=this;switch(t.callbackfunction){case"EditRateCode":e.EditRateCode(null);break;case"BacktoList":e.BacktoList();break}},BacktoList(){this.$router.push({name:"ClientListing"})},sortdata:function(t){var e="sort tb_headerSortDown";this.SortBy=t,t===this.SortBy&&(""==this.SortExp?(this.SortExp="ASC",e="sort tb_headerSortDown"):"ASC"==this.SortExp?(this.SortExp="DESC",e="sort tb_headerSortUp"):(this.SortExp="ASC",e="sort tb_headerSortDown")),this.GetWorkCodeMappingList(),$("#"+t+"  span:first-child").attr("class",e)},GetWorkCodeMappingList(){var t=this;t.isLoading=!0;var e=`Planid=&pageSize=${t.PageSize}&pageNum=${t.PageNumber}&sortBy=${t.SortBy}&sortExp=${t.SortExp}&Clientid=${t.ClientId}`;n["a"].GetWorkCodeMappingList(e).then(e=>{t.isLoading=!1,e.data.result.DATA.length>0?(t.ListingData=e.data.result.DATA,t.ListingData.forEach(t=>{["start_date","end_date","created_at","modified_at"].forEach(e=>{t[e]&&(t[e]=new Date(t[e]))})}),t.TotalRecords=e.data.result.DATA[0].TOTAL_RECORDS,t.TotalPages=Math.ceil(t.TotalRecords/t.PageSize)):(t.ListingData=[],t.TotalRecords=0,t.TotalPages=0)}).catch(()=>{t.isLoading=!1})},EditRateCode(t){var e=this;e.RateObj=t,e.IsAddRate=!0,e.GetWorkCodeMappingList()},CloseRateCode(){var t=this;t.IsAddRate=!1,t.GetWorkCodeMappingList()},commonDeleteData:function(t){var e=this,a=t;null!=a?e.confirmR(e.$t("ConfirmDelete"),!0,e.$t("Delete")+"  "+e.$t("RateCode"),(async function(){var t={ids:a,moduleName:"RateCode",subModuleCode:"RateCode",refCode:"PLAN_RATE_CODE"},i=JSON.stringify(t);n["a"].CommonCommonDelete(i).then((async function(t){200==t.status?(e.ShowAlert(e.$t("DeletedSuccess",[e.$t("RateCode")]),"success",!0,e.$t("Alert")),e.GetWorkCodeMappingList()):e.ShowAlert(e.$t("DeletedError",[e.$t("RateCode")]),"failure",!0,e.$t("Alert"))}))})):e.ShowAlert(e.$t("Selectanyrecordtodelete"))}}},Ts=Is,Ls=(a("922e"),Object(d["a"])(Ts,gs,fs,!1,null,"06010b5f",null)),Es=Ls.exports,xs={components:{ServiceRatesList:Xt,ViewHistory:_s,SubscriptionRateSchedule:Es},props:{ClientId:{type:Number,required:!0},ClientData:{type:Object}},data(){return{RateScheduledeListing:[],TotalRecords:0,pageSize:10,pageNum:1,sortBy:"",CurrentPage:1,TotalPages:0,sortExp:"",noRecords:!1,Headers:[{COLUMN_NAME:"plan_name",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Plan Name",DISPLAY_ORDER:1},{COLUMN_NAME:"payment_type",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Payment Type",DISPLAY_ORDER:1},{COLUMN_NAME:"PlanType",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Plan Type",DISPLAY_ORDER:1},{COLUMN_NAME:"IsProrate",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Pro Rate",DISPLAY_ORDER:1},{COLUMN_NAME:"created_at",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Created At",DISPLAY_ORDER:2},{COLUMN_NAME:"modified_at",DATA_TYPE:"text",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Modified At",DISPLAY_ORDER:2},{COLUMN_NAME:"modified_by",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Modified By",DISPLAY_ORDER:3}],listActions:[{title:"Edit",href:"javascript:void(0)",icon:"fa fa-pencil text-info action-icon",callbackfunction:"edit",isDisabled:!1,additionalSpan:""},{title:"View History",href:"javascript:void(0)",icon:"fa fa-eye",isDisabled:!1,callbackfunction:"viewHistory",additionalSpan:""}],isServices:!1,clientplanmappingid:0,PlanId:0,isViewHistory:!1,IsSubscriptionBilling:!1,IsUtilityBilling:!1}},async created(){var t=this;await t.CheckExtraFeatures(),await t.FetchData()},methods:{async CheckExtraFeatures(){var t=this;const e="featureCode=GET_EXTRA_FEATURE_BILLING&outputType=list";try{const a=await n["a"].CheckExtraFeatures(e);if(a.data){const e=JSON.parse(a.data);e.forEach(e=>{"SUBSCRIPTION_BILLING"===e.FEATURE_CODE&&(t.IsSubscriptionBilling=!0),"UTILITY_BILLING"===e.FEATURE_CODE&&(t.IsUtilityBilling=!0)})}}catch(a){console.log("Error checking extra features:",a)}},async FetchData(){var t=this;t.PlanListing=[];var e=`clientId=${this.ClientId}&pageSize=${t.pageSize}&pageNum=${t.pageNum}&sortBy=${t.sortBy}&sortExp=${t.sortExp}&search=${t.searchCondition}`;await n["a"].GetRateScheduleListForSubscription(e).then((function(e){t.Headers.forEach(t=>{t.settings=null,"created_at"==t.COLUMN_NAME&&(t.settings={isInSlot:!0})}),""!=e.data&&null!=e.data?e.data.result.data.length>0?(t.RateScheduledeListing=e.data.result.data,t.TotalRecords=e.data.result.data[0].TOTALRECORDS,t.TotalPages=Math.ceil(t.TotalRecords/t.pageSize),t.CurrentPage=t.pageNum,t.noRecord=!1):(t.noRecord=!0,t.TotalRecords=0,t.RateScheduledeListing=[]):(t.noRecord=!0,t.TotalRecords=0,t.PlanListing=[])}))},actionButtonClick(t,e){var a=this;switch(t){case"edit":a.edit(e);break;case"viewHistory":a.viewHistory(e);break}},renderActions(t){var e=this;let a=[];return e.listActions.forEach(e=>{let i={...e};switch(i.title){case"Edit":i.isVisible=!0,i.isDisabled="One Time"==t.payment_type&&t.client_plan_mapping_id>0;break;case"View History":i.isVisible=!0;break}a.push(i)}),a},edit(t){this.clientplanmappingid=t.client_plan_mapping_id,this.isServices=!0},async viewHistory(t){this.clientplanmappingid=t.client_plan_mapping_id,this.isViewHistory=!0},close(){this.isServices=!1},commonHeaderButtonClick(t){},sortdata(t){this.sortBy=t;var e="ASC";"ASC"==this.sortExp&&(e="DESC"),this.sortExp=e,this.sortBy=t,this.sortExp=e,this.pageNum=1,this.GroupStart=this.pageNum,this.GroupEnd=this.pageNum+2,this.FetchData()},pagerMethod:function(t){this.pageSize=t.PageSize,this.pageNum=t.PageNumber,this.FetchData()}}},Ns=xs,Ps=Object(d["a"])(Ns,cs,ds,!1,null,null,null),ws=Ps.exports,Rs=function(){var t=this,e=t._self._c;return e("div",[e("section",{staticClass:"page-action action-margin"},[e("div",{staticClass:"container-fluid p-0"},[e("div",{staticClass:"col-md-12 p-0"},[e("div",{staticClass:"theme-primary partition p-actions-expand tablehead isExtra"},[e("span",{staticClass:"p-name text-white",attrs:{id:"divModuleHeaderName"}},[t._v(t._s(t.$t("MeterReading")))]),e("span",{staticClass:"p-actions float-right"},[""!=t.meterTypeId?e("span",{attrs:{id:"ClientActions"}},[e("a",{staticClass:"p-action-btn text-white",attrs:{id:"ancCreateHRancCreateHR","data-toggle-tooltip":"tooltip","data-original-title":"Add"},on:{click:t.handleGenerateBill}},[e("i",{staticClass:"fas fa-file-invoice"}),e("br"),e("span",[t._v(t._s(t.$t("GenerateBills")))])])]):t._e(),0==t.isFilterApplied?e("span",{attrs:{id:"ClientActions"}},[e("a",{staticClass:"p-action-btn text-white",attrs:{id:"filterReading","data-toggle-tooltip":"tooltip","data-original-title":"Filter Meter reading"},on:{click:t.handleFilterMeterReading}},[e("i",{staticClass:"fa fa-filter"}),e("br"),e("span",[t._v(t._s(t.$t("Filter")))])])]):t._e(),1==t.isFilterApplied?e("span",{attrs:{id:"ClientActions"}},[e("a",{staticClass:"p-action-btn text-white",attrs:{id:"filterReading","data-toggle-tooltip":"tooltip","data-original-title":"Reset Meter reading"},on:{click:t.handleResetFilter}},[e("i",{staticClass:"fa fa-filter text-danger"}),e("br"),e("span",[t._v(t._s(t.$t("Reset")))])])]):t._e(),e("span",{attrs:{id:"ClientActions"}},[e("a",{staticClass:"p-action-btn text-white",attrs:{id:"ancCreateHRancCreateHR","data-toggle-tooltip":"tooltip","data-original-title":"Add"},on:{click:t.handleAddMeterReading}},[e("i",{staticClass:"fa fa-plus"}),e("br"),e("span",[t._v(t._s(t.$t("Add")))])])]),e("RouterLink",{staticClass:"p-action-btn text-white float-right",attrs:{to:"/Client/Index"}},[e("em",{staticClass:"fa fa-angle-double-left"}),e("br"),t._v(" "+t._s(t.$t("BacktoList"))+" ")])],1)])]),e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"form-group col-4 m-2 p-2"},[e("div",{staticClass:"input-group mb-3"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.meterTypeId,expression:"meterTypeId"}],class:{"form-control":!0},attrs:{name:"meterType"},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.meterTypeId=e.target.multiple?a:a[0]},t.handleMeterTypeChange]}},[e("option",{attrs:{value:""}},[t._v(t._s(t.$t("Select")))]),t._l(t.meterTypes,(function(a,i){return e("option",{key:i,domProps:{value:a.value}},[t._v(" "+t._s(a.name)+" ")])}))],2)])]),e("tg-list",{attrs:{IsShowAction:!0,ModuleName:"Company",SubModuleCode:"",LegendArray:[],RenderRowActionMethod:t.renderActions,widgets:[],IdentityColumn:"MeterReadingId",listType:["List"],ListData:t.ListingData,HeaderData:t.Headers,HeaderButtons:t.listheaderbuttons,TotalRecords:t.TotalRecords,SearchFields:t.leftSearchFields,IsSearchFieldsOnTop:"false",SearchPosition:"top",ListDataCallBackFunction:t.FetchData,showCheckBox:t.isShowCheckbox,SortExp:t.SortExp,SortBy:t.SortBy,NorecordfoundText:t.$t("NoRecordfound")},on:{ActionButtonClick:t.actionButtonClick,LeftsearchButtonClick:function(t){},PagerButtonClick:t.pagerMethod,HeaderButtonClick:t.commonHeaderButtonClick,SortdataButtonClick:t.sortdata},scopedSlots:t._u([{key:"slotdata",fn:function({data:a}){return["file_names"==a.column.COLUMN_NAME?[null!=a.row.file_names?e("div",{staticClass:"form-control p-0 border-0",attrs:{alt:"",title:""}},[e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.openLightbox(a.row.file_names)}}},[e("img",{staticClass:"border p-2",attrs:{src:a.row.file_names,height:"50",width:"100",title:""}})])]):t._e(),null==a.row.file_names?e("div",{staticClass:"form-control p-0 border-0"},[e("img",{attrs:{src:"/Content/images/imagenotavailable.jpg",alt:"No Image Available",height:"50",width:"100",title:""}})]):t._e()]:t._e(),"ReadingDate"==a.column.COLUMN_NAME?[e("span",{staticClass:"text-center single-action tourguide_a",attrs:{title:t.$options.filters.formatDate(a.row.ReadingDate)}},[t._v(" "+t._s(t.$options.filters.formatDate(a.row.ReadingDate))+" ")])]:t._e(),"processStatus"==a.column.COLUMN_NAME?[e("span",{class:t.getStatusClass(a.row.is_processed)},[t._v(" "+t._s(a.row.processStatus)+" ")])]:t._e()]}}])}),t.IsAddMeterReading?e("AddMeterReading",{attrs:{ClientId:t.UserId,EditDetails:t.EditDetails},on:{refreshList:t.refreshList}}):t._e(),t.IsMeterReadingDetail?e("MeterReadingDetail",{attrs:{MeterReadingId:t.MeterReadingId},on:{refreshList:t.refreshList}}):t._e(),t.IsFilterMeterReading?e("FilterMeterReading",{attrs:{ClientId:t.UserId},on:{filterSearch:t.handlefilterSearch}}):t._e(),t.IsMeterDetails?e("MeterReadingDeatils",{attrs:{MeterDeatilsObject:t.MeterDeatilsObject},on:{CloseDetails:t.CloseDetails}}):t._e()],1),e("vue-image-lightbox-carousel",{ref:"lightbox",attrs:{show:t.showLightbox,images:t.images,"show-footer-count":!1},on:{close:t.closeshowLightbox}})],1)])},Ms=[],$s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[0==t.IsEdit?e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("AddMeterReading")))]):e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("UpdateMeterReading")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("dynamic-form",{ref:"dynamicform",attrs:{lang:"en",buttons:t.buttons,schema:t.FormSchema},on:{OnSubmit:t.OnSubmit}})],1)])])])],1)},Fs=[],ks={props:{ClientId:{type:Number},EditDetails:{type:Object,required:!0}},data(){return{isLoading:!1,ListingData:[],noRecord:!1,IsEdit:!1,FormSchema:[{layoutType:"four",Data:[{astype:"SelectField",label:this.$t("MeterType"),name:"Meter_type",value:"",config:{options:[],onChange:this.getMeters},placeholder:this.$t("Meter"),validationRules:{required:!0,max:100},disabled:!1,visibility:!0},{astype:"SelectField",label:this.$t("MeterSerialNumber"),name:"Meter",value:"",config:{options:[],onChange:this.getPreviousReadingDate},placeholder:this.$t("Meter"),validationRules:{required:!0,max:100},disabled:!1},{astype:"DateField",label:this.$t("PreviousReadingDate"),name:"Previous_Reading_Date",value:"",placeholder:"",config:{format:"MM/DD/YYYY",minDate:"",onChange:this.setReadDate},validationRules:{required:!1},disabled:!1},{astype:"NumericField",label:this.$t("PreviousReading"),name:"Pervious_Reading",value:"",config:{options:[],onChange:this.calculateConsumption},placeholder:"",validationRules:{required:!1,max:100},disabled:!1}]},{layoutType:"four",Data:[{astype:"DateField",label:this.$t("ReadDate"),name:"Read_Date",value:"",placeholder:"",config:{format:"MM/DD/YYYY",minDate:""},validationRules:{required:!0},disabled:!1},{astype:"NumericField",label:this.$t("Reading"),name:"Reading",value:"",config:{options:[],onChange:this.calculateConsumption},placeholder:"",validationRules:{required:!0,max:100},disabled:!1},{astype:"NumericField",label:this.$t("Consumption"),name:"Consumption",value:"0",config:{options:[]},placeholder:"",validationRules:{required:!1,max:100},disabled:!0,visibility:!0},{astype:"NumericField",label:this.$t("PressureValue"),name:"Pressure_Value",value:"",placeholder:"",config:{},validationRules:{required:!0},visibility:!1,disabled:!1},{astype:"NumericField",label:this.$t("GCV"),name:"GCV",value:"",placeholder:"",userGuide:"gross calorific value",config:{},visibility:!1,validationRules:{required:!0},disabled:!1}]},{layoutType:"single",Data:[{astype:"FileField",label:this.$t("Image"),name:"Attachment",placeholder:"",validationRules:{required:!1},FieldIndex:0,config:{maxSize:5,showSelectedFiles:[],accept:[{fileType:"jpg",iconClass:"fa-file-image-o"},{fileType:"jpeg",iconClass:"fa-file-image-o"},{fileType:"png",iconClass:"fa-file-image-o"}],onDeleteSelectedFiles:this.onDeleteSelectedFiles,onChange:this.GetBase64String,showAddIcon:!1,onAddButtonClick:"",multiple:!1,showSelectedFiles:[]}}]}],buttons:[{type:"button",class:"btn btn-danger",text:"<i class='fa fa-refresh pr-2'></i>Reset",onClick:this.resetForm},{type:"submit",class:"btn btn-success",text:"<i class='fa fa-save pr-2'></i>Save"}]}},async created(){var t=this;t.isLoading=!0,await t.getMeterTypes(),void 0!=t.EditDetails&&null!=t.EditDetails?(t.BindMeterDetail(),t.getMeters(null,t.FormSchema[0].Data[0]),t.$refs.dynamicform.updateProperty("Meter","value",t.EditDetails.related_info_id),t.FormSchema[0].Data[2].disabled=!0,t.FormSchema[0].Data[3].disabled=!0,t.IsEdit=!0):t.IsEdit=!1,t.isLoading=!1},methods:{BindMeterDetail:function(){var t=this;if(null!=t.EditDetails.file_names&&void 0!=t.EditDetails.file_names){const a=t.EditDetails.file_names,i=a.split("/"),s=i.pop();var e={attachmentName:s,attachmentPath:t.EditDetails.file_names};t.FormSchema[2].Data[0].config.showSelectedFiles.push(e)}t.$refs.dynamicform.updateProperty("Previous_Reading_Date","value",t.EditDetails.PreviousReadingDate),t.$refs.dynamicform.updateProperty("Pervious_Reading","value",t.EditDetails.OldReading),t.$refs.dynamicform.updateProperty("Read_Date","value",t.EditDetails.ReadingDate),t.$refs.dynamicform.updateProperty("Reading","value",t.EditDetails.CurrentReading),t.$refs.dynamicform.updateProperty("Consumption","value",t.EditDetails.Consumption),t.$refs.dynamicform.updateProperty("Meter_type","value",t.EditDetails.meter_id)},Close(){this.$parent.IsAddMeterReading=!1},setReadDate(t,e){var a=this;const i=new Date(t);a.FormSchema[1].Data[0].config.minDate=i},resetForm(){this.FormSchema[0].Data[0].value="",this.FormSchema[0].Data[1].value="",this.FormSchema[0].Data[2].value="",this.FormSchema[0].Data[3].value="",this.FormSchema[1].Data[0].value="",this.FormSchema[1].Data[1].value="",this.FormSchema[1].Data[2].value="0",this.FormSchema[1].Data[3].value="",this.$refs.dynamicform.validateForm.reset()},onDeleteSelectedFiles:function(t){this.$delete(this.FormSchema[4].Data[0].config,"showSelectedFiles")},GetBase64String:function(t){try{var e=this;e.fileData=[];var a=t.target.files[0],i=new FileReader;i.onload=function(t){return function(t){var i=t.target.result,s=window.btoa(i),n=a.name;e.fileName=n;var l=n.lastIndexOf("."),o=n.substring(l+1,n.length);e.fileExt+="."+o;var r='{"ContentType":"'+a.type+'","Size":"'+a.size+'","Extension":"'+o+'"}',c=a.size;e.fileSize=c;var d={attachement_mime:r,fileName:n,base64String:s,fileSize:a.size,contentType:a.type};e.fileData.push(d)}}(),i.readAsBinaryString(a)}catch(s){}},async getMeterTypes(){const t=this;try{let e="is_mapped=2";const a=await n["a"].GetMeterTypes(e);if(null!==a&&void 0!==a&&a.data){const e=JSON.parse(a.data.result).data;Array.isArray(e)&&e.length>0?(e.map(e=>{t.FormSchema[0].Data[0].config.options.push({value:e.meter_id,name:e.meter_name})}),t.$refs.dynamicform.UpdateKeyValue()):console.warn("No valid data found in the response")}else console.error("Invalid response structure:",a)}catch(e){console.error("Error fetching Meter types:",e)}},async getMeters(t,e){var a=this;a.FormSchema[0].Data[1].value="",a.FormSchema[0].Data[1].config.options=[];let i=e.config.options.find(t=>t.value==e.value);"Gas"==i.name&&(a.FormSchema[1].Data[3].visibility=!0,a.FormSchema[1].Data[4].visibility=!0),"Electric"==i.name&&(a.FormSchema[1].Data[3].visibility=!1,a.FormSchema[1].Data[4].visibility=!1),"Water"==i.name&&(a.FormSchema[1].Data[3].visibility=!1,a.FormSchema[1].Data[4].visibility=!1);try{let t=`clientId=${a.ClientId}&meterTypeId=${e.value}`;const i=await n["a"].GetMeters(t),s=JSON.parse(i.data.result).data;Array.isArray(s)&&s.length>0?(s.forEach(t=>{a.FormSchema[0].Data[1].config.options.push({value:t.value,name:t.name})}),a.$refs.dynamicform.UpdateKeyValue()):(a.FormSchema[0].Data[1].config.options=[],console.warn("No data found or data is not an array."))}catch(s){console.error("Error fetching meter name data:",s)}},GetBase64String:function(t){try{var e=this;e.fileData=[];var a=t.target.files[0],i=new FileReader;i.onload=function(t){return function(t){var i=t.target.result,s=window.btoa(i),n=a.name;e.fileName=n;var l=n.lastIndexOf("."),o=n.substring(l+1,n.length);e.fileExt+="."+o;var r='{"ContentType":"'+a.type+'","Size":"'+a.size+'","Extension":"'+o+'"}',c=a.size;e.fileSize=c;var d={attachement_mime:r,fileName:n,base64String:s,fileSize:a.size,contentType:a.type};e.fileData.push(d)}}(),i.readAsBinaryString(a)}catch(s){}},async getPreviousReadingDate(t,e){const a=this;let i="meterId="+e.value;try{const t=await n["a"].GetPreviousReadingDate(i);null!==t&&void 0!==t&&t.data?""!=t.data.result?(a.FormSchema[0].Data[2].value=t.data.result.PreviousReadingDate,a.FormSchema[0].Data[3].value=t.data.result.PreviousReading,a.FormSchema[1].Data[1].config.minDate=t.data.result.PreviousReadingDate):(a.FormSchema[0].Data[2].value="",a.FormSchema[0].Data[3].value=""):console.error("Invalid response structure:",t)}catch(s){console.error("Error fetching Customer type:",s)}},calculateConsumption(){const t=parseFloat(this.FormSchema[1].Data[1].value),e=parseFloat(this.FormSchema[0].Data[3].value);if(""!==this.FormSchema[1].Data[1].value)if(t>=e){let a=t-e>=0?t-e:0;this.FormSchema[1].Data[2].value=a}else this.ShowAlert(this.$t("MeterReadingValidation"),"warning",this.$t("Alert"))},async OnSubmit(t,e){const a=this;let i={MeterReadingId:a.EditDetails?a.EditDetails.MeterReadingId:0,MeterTypeId:t.Meter_type,MeterId:t.Meter,PreviousReadingDate:t.Previous_Reading_Date,PerviousReading:t.Pervious_Reading,ReadDate:t.Read_Date,CurrentReading:t.Reading,Consumption:t.Consumption,PressureValue:t.Pressure_Value||0,GCV:t.GCV||0,Temperature:0,ClientId:this.ClientId,attachment:a.fileData||[]};try{const t=await n["a"].SaveMeterReading(i);null!==t&&void 0!==t&&t.data&&("0"==t.data.result.Status_code?(this.ShowAlert(this.$t("AddedSuccess",[this.$t("MeterReading")]),"success",!0,this.$t("Alert")),this.$emit("refreshList")):this.ShowAlert(this.$t("Error while save meter data"),"failure",this.$t("Alert")))}catch(s){console.error("SaveMeterReading error:",s),this.ShowAlert(this.$t("Unexpected error occurred"),"failure",this.$t("Alert"))}}}},Os=ks,Bs=Object(d["a"])(Os,$s,Fs,!1,null,null,null),Us=Bs.exports,Gs=function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("ProcessDetail")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[t.MeterData.length>0?e("div",{staticClass:"mb-3"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-4"},[e("strong",[t._v("Reading From Date:")]),t._v(" "+t._s(new Date(t.MeterData[0].start_date).toLocaleDateString()))]),e("div",{staticClass:"col-4"},[e("strong",[t._v("Reading To Date:")]),t._v(" "+t._s(new Date(t.MeterData[0].end_date).toLocaleDateString()))]),e("div",{staticClass:"col-4"},[e("strong",[t._v("Total Consumption:")]),t._v(" "+t._s(t.MeterData[0].consumption.toFixed(2)))])]),e("div",{staticClass:"row mt-3"},[e("div",{staticClass:"col-4"},[e("strong",[t._v("Total Amount:")]),t._v(" "),e("span",{staticStyle:{"font-size":"18px"}},[t._v(" "+t._s(t.$n(t.totalAmount,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])]),e("div",{staticClass:"col-4"},[e("strong",[t._v("Subsidy Amount:")]),t._v(" "),e("span",{staticClass:"text-danger",staticStyle:{"font-size":"18px"}},[t._v(" "+t._s(t.$n(t.subsidyAmount,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])]),e("div",{staticClass:"col-4"},[e("strong",[t._v("Net Total without Tax:")]),t._v(" "),e("span",{staticClass:"text-success",staticStyle:{"font-size":"18px"}},[t._v(" "+t._s(t.$n(t.totalAmount+t.subsidyAmount,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])])])]):t._e(),e("div",[e("div",{staticClass:"table-responsive table-fix-header"},[e("table",{staticClass:"table table-bordered mt-0",staticStyle:{width:"100%"},attrs:{id:"tablelistingdata_186498"}},[e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",{staticStyle:{"text-transform":"capitalize"},attrs:{id:"service"}},[t._v("Service/Subsidy Name")]),e("th",{staticStyle:{"text-transform":"capitalize"},attrs:{id:"work_code"}},[t._v("Work Code")]),e("th",{staticStyle:{"text-transform":"capitalize"},attrs:{id:"condition"}},[t._v("Condition")]),e("th",{staticStyle:{"text-transform":"capitalize"},attrs:{id:"condition"}},[t._v("Subsidy")]),e("th",{staticClass:"text-right",staticStyle:{"text-transform":"capitalize"},attrs:{id:"reading_value"}},[t._v("Units")]),e("th",{staticClass:"text-right",staticStyle:{"text-transform":"capitalize"},attrs:{id:"rate"}},[t._v("Rate ("+t._s(t.CurrencyCode)+")")]),e("th",{staticClass:"text-right",staticStyle:{"text-transform":"capitalize"},attrs:{id:"total_amount"}},[t._v("Amount ("+t._s(t.CurrencyCode)+")")]),e("th",{staticStyle:{"text-transform":"capitalize"},attrs:{id:"created_at"}},[t._v("Created At")])])]),e("tbody",{staticStyle:{"font-size":"13px"}},[t.MeterData&&0===t.MeterData.length?e("tr",[e("td",{staticClass:"text-center text-danger",attrs:{colspan:"8"}},[t._v(" No record found ")])]):t._l(t.MeterData,(function(a,i){return e("tr",{key:i},[e("td",[t._v(t._s(a.service_name))]),e("td",[t._v(t._s(a.work_code_name))]),e("td",[t._v(t._s(a.condition_name))]),e("td",[t._v(t._s(a.is_for_subsidy))]),e("td",{staticClass:"text-right"},[t._v(t._s(a.reading_value.toFixed(2)))]),e("td",{staticClass:"text-right"},[t._v(" "+t._s(t.$n(a.rate,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")]),e("td",{staticClass:"text-right",class:{"text-danger":"Yes"===a.is_for_subsidy}},[t._v(" "+t._s("Yes"===a.is_for_subsidy?"-"+t.$n(a.total_amount,"currency",t.$getLocaleByCurrency(t.CurrencyCode)):t.$n(a.total_amount,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")]),e("td",[t._v(t._s(t.$options.filters.formatDateTime(a.created_at))+" ")])])}))],2)])])])])])])])],1)},Ys=[],Vs={props:{MeterReadingId:{type:Number,required:!0}},data(){return{MeterData:[],isLoading:!1,errorMessage:"",CurrencyCode:"PKR"}},computed:{totalAmount(){return this.MeterData.filter(t=>"No"===t.is_for_subsidy).reduce((t,e)=>t+Math.abs(e.total_amount),0)},subsidyAmount(){return-this.MeterData.filter(t=>"Yes"===t.is_for_subsidy).reduce((t,e)=>t+e.total_amount,0)}},created:async function(){var t=this;t.CurrencyCode=t.GetUserInfo.Currency.replace(/[()]/g,"")},methods:{Close(){this.$parent.IsMeterReadingDetail=!1},async FetchDataByMeterReading(){this.MeterData=[],this.isLoading=!0;const t="meterreadingid="+this.MeterReadingId;try{const e=await n["a"].GetMeterReadingBYId(t);e&&e.data&&(this.MeterData=e.data)}catch(e){this.errorMessage="Error fetching data: "+e.message,console.error("Error fetching meter reading data:",e)}finally{this.isLoading=!1}}},mounted(){this.FetchDataByMeterReading()}},Hs=Vs,js=Object(d["a"])(Hs,Gs,Ys,!1,null,null,null),qs=js.exports,zs=function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("Filter Meter Reading")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("dynamic-form",{ref:"dynamicform",attrs:{lang:"en",buttons:t.buttons,schema:t.FormSchema},on:{OnSubmit:t.OnSubmit}})],1)])])])],1)},Ws=[],Js={components:{},props:{ClientId:{type:Number}},data(){return{isLoading:!1,FormType:"Create",selectedProjects:[],filteredOptions:[],FormSchema:[{layoutType:"four",Data:[{astype:"SelectField",label:this.$t("MeterType"),name:"Meter_type",value:"",config:{options:[],onChange:this.getMeters},placeholder:this.$t("Meter"),validationRules:{required:!0,max:100},disabled:!1,visibility:!0},{astype:"SelectField",label:this.$t("Meter"),name:"Meter",value:"",config:{options:[]},placeholder:this.$t("Meter"),validationRules:{required:!1,max:100},disabled:!1},{astype:"SelectField",label:this.$t("Plans"),name:"Plans",value:"",config:{options:[]},placeholder:this.$t("Plans"),validationRules:{required:!1,max:100}},{astype:"DateField",label:this.$t("ReadingDateFrom"),name:"Reading_Date_From",value:"",placeholder:"",config:{format:"MM/DD/YYYY",onChange:this.setDateForm,minDate:""},validationRules:{required:!1},disabled:!1},{astype:"DateField",label:this.$t("ReadingDateTo"),name:"Reading_Date_To",value:"",placeholder:"",config:{format:"MM/DD/YYYY",minDate:""},validationRules:{required:!1},disabled:!1}]}],buttons:[{type:"submit",class:"btn btn-success",text:"<i class='fa fa-search'></i>"},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-refresh'></i>",onClick:this.resetForm}]}},created(){this.getMeterTypes(),this.GetPlanDDlData()},methods:{Close(){this.$parent.IsFilterMeterReading=!1},async GetPlanDDlData(){var t=this;let e="clientId="+t.ClientId;try{const a=await n["a"].GetCompanyPlans(e);let i=a.data;Array.isArray(i)&&i.length>0?(i.forEach(e=>{t.FormSchema[0].Data[2].config.options.push({value:e.value,name:e.name})}),t.$refs.dynamicform.UpdateKeyValue()):t.FormSchema[0].Data[1].config.options=[]}catch(a){console.error("Error fetching plan data:",a)}},async getMeterTypes(){const t=this;try{let e="is_mapped=1";const a=await n["a"].GetMeterTypes(e);if(null!==a&&void 0!==a&&a.data){const e=JSON.parse(a.data.result).data;Array.isArray(e)&&e.length>0?(e.map(e=>{t.FormSchema[0].Data[0].config.options.push({value:e.meter_id,name:e.meter_name})}),t.$refs.dynamicform.UpdateKeyValue()):console.warn("No valid data found in the response")}else console.error("Invalid response structure:",a)}catch(e){console.error("Error fetching Meter types:",e)}},async getMeters(t,e){var a=this;a.FormSchema[0].Data[1].value="",a.FormSchema[0].Data[1].config.options=[];try{let t=`clientId=${a.ClientId}&meterTypeId=${e.value}`;const i=await n["a"].GetMeters(t),s=JSON.parse(i.data.result).data;Array.isArray(s)&&s.length>0?(s.forEach(t=>{a.FormSchema[0].Data[1].config.options.push({value:t.value,name:t.name})}),a.$refs.dynamicform.UpdateKeyValue()):(a.FormSchema[0].Data[1].config.options=[],console.warn("No data found or data is not an array."))}catch(i){console.error("Error fetching meter name data:",i)}},updateSelectedProjects(t,e){this.selectedProjects=t},resetForm(){this.selectedProjects=[],this.FormSchema[0].Data[2].value="",this.FormSchema[0].Data[3].value="",this.$refs.dynamicform.validateForm.reset()},OnSubmit(t){let e={meterTypeId:t.Meter_type,meterIds:t.Meter||"",planIds:t.planIds||"",dateFrom:this.$options.filters.formatDateTime(t.Reading_Date_From)||"",dateTo:this.$options.filters.formatDateTime(t.Reading_Date_To)||""};this.$emit("filterSearch",e)}}},Ks=Js,Qs=Object(d["a"])(Ks,zs,Ws,!1,null,null,null),Zs=Qs.exports,Xs=a("e8b26"),tn=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex justify-content-between align-items-center"},[e("h5",{staticClass:"modal-title"},[t._v("Meter Reading Details")]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.CloseReadingDetails}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"row"},[t._m(0),e("div",{staticClass:"col-md-12 col-lg-12"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v("Customer Name:")]),t._v(" "),e("span",[t._v(t._s(t.MeterDeatilsObject.customer_name))])])])]),e("div",{staticClass:"col-md-12 col-lg-12"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v("Property Address:")]),t._v(" "),e("span",[t._v(t._s(t.MeterDeatilsObject.property_address))])])])]),t._m(1),e("div",{staticClass:"col-lg-12 mb-3"},[e("div",{staticClass:"col-lg-12"},[e("div",{staticClass:"row"},[e("div",{staticClass:"float-left col-sm-12 col-md-5 col-lg-4 p-0"},[t.MeterDeatilsObject.file_names?e("div",{staticClass:"form-group"},[t.MeterDeatilsObject.file_names?e("img",{attrs:{src:t.MeterDeatilsObject.file_names,width:"304",height:"163"}}):t._e()]):e("div",{staticClass:"form-group"},[e("img",{attrs:{src:"https://talygenv.github.io/Vue-UI-Content/images/no-image-available.jpg"}})])]),e("div",{staticClass:"float-left col-sm-12 col-md-7 col-lg-8 p-0"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-6 col-lg-6"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v("Meter Name:")]),t._v(" "),e("span",[t._v(t._s(t.MeterDeatilsObject.MeterMappingName))])])])]),e("div",{staticClass:"col-md-6 col-lg-6"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v("Measurement Unit: ")]),t._v(" "),e("span",[t._v(t._s(t.MeterDeatilsObject.measurement_unit))])])])]),e("div",{staticClass:"col-md-6 col-lg-6"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v("Meter Type:")]),t._v(" "),e("span",[t._v(t._s(t.MeterDeatilsObject.meter_type))])])])]),e("div",{staticClass:"col-md-6 col-lg-6"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v("Reading Date : ")]),t._v(" "),e("span",[t._v(t._s(t.$options.filters.formatDate(t.MeterDeatilsObject.ReadingDate))+" ")])])])]),e("div",{staticClass:"col-md-6 col-lg-6"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v("Current Reading : ")]),t._v(" "),e("span",[t._v(t._s(t.MeterDeatilsObject.CurrentReading))])])])]),e("div",{staticClass:"col-md-6 col-lg-6"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v("Old Reading : ")]),t._v(" "),e("span",[t._v(t._s(t.MeterDeatilsObject.OldReading))])])])]),e("div",{staticClass:"col-md-6 col-lg-6"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v("Consumption : ")]),t._v(" "),e("span",[t._v(t._s(t.MeterDeatilsObject.Consumption))])])])]),e("div",{staticClass:"col-md-6 col-lg-6"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v("Days : ")]),t._v(" "),e("span",[t._v(t._s(t.MeterDeatilsObject.Days))])])])]),"Electric"!=t.MeterDeatilsObject.meter_type?e("div",{staticClass:"col-md-6 col-lg-6"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v("Pressure Value:")]),t._v(" "),e("span",[t._v(t._s(t.MeterDeatilsObject.PressureValue))])])])]):t._e(),"Electric"!=t.MeterDeatilsObject.meter_type?e("div",{staticClass:"col-md-6 col-lg-6"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v("Gcv : ")]),t._v(" "),e("span",[t._v(t._s(t.MeterDeatilsObject.Gcv))])])])]):t._e(),e("div",{staticClass:"col-md-6 col-lg-6"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v("Previous Reading Date : ")]),t._v(" "),e("span",[t._v(" "+t._s(t.$options.filters.formatDate(t.MeterDeatilsObject.PreviousReadingDate)))])])])]),e("div",{staticClass:"col-md-6 col-lg-6"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v("Is Billed : ")]),t._v(" "),e("span",[t._v(t._s(t.MeterDeatilsObject.is_Billed))])])])]),e("div",{staticClass:"col-md-6 col-lg-6"},[e("div",{staticClass:"form-group"},[e("label",[e("b",[t._v("Status Code : ")]),t._v(" "),e("span",[t._v(t._s(t.MeterDeatilsObject.status_code))])])])])])])])])])])])])])])],1)])},en=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"col-lg-12 mb-3",attrs:{"data-v-99f0210a":""}},[e("div",{staticClass:"heading-border mt-2",attrs:{"data-v-99f0210a":""}},[e("h5",{staticClass:"h5",attrs:{"data-v-99f0210a":""}},[e("span",{attrs:{"data-v-99f0210a":""}},[t._v("Customer Detail")])])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"col-lg-12 mb-3",attrs:{"data-v-99f0210a":""}},[e("div",{staticClass:"heading-border mt-2",attrs:{"data-v-99f0210a":""}},[e("h5",{staticClass:"h5",attrs:{"data-v-99f0210a":""}},[e("span",{attrs:{"data-v-99f0210a":""}},[t._v("Meter Details")])])])])}],an={props:{MeterDeatilsObject:{type:Object,require:!0}},data(){return{isLoading:!1}},created:async function(){var t=this;t.MeterDeatilsObject},methods:{CloseReadingDetails(){this.$emit("CloseDetails")}}},sn=an,nn=Object(d["a"])(sn,tn,en,!1,null,null,null),ln=nn.exports,on={components:{FilterMeterReading:Zs,AddMeterReading:Us,VueImageLightboxCarousel:Xs["a"],MeterReadingDeatils:ln,MeterReadingDetail:qs},props:{UserId:{}},computed:{isShowCheckbox(){return this.isCheckbox}},data(){return{IsAddMeterReading:!1,IsMeterReadingDetail:!1,IsFilterMeterReading:!1,isFilterApplied:!1,isCheckbox:!1,meterTypes:[],meterTypeId:"",TotalRecords:0,noRecord:!1,isLoading:!1,CompanyId:null,PageSize:10,statusId:"",PageNumber:1,isPaged:1,TotalPages:0,widgets:[],SortBy:"",SortExp:"",ProjectName:"",taskId:"",showLightbox:!1,images:[],Headers:[{COLUMN_NAME:"meter_type",DATA_TYPE:"string",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"MeterType",DISPLAY_ORDER:1},{COLUMN_NAME:"MeterMappingName",DATA_TYPE:"string",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"MeterSerialNumber",DISPLAY_ORDER:2},{COLUMN_NAME:"ReadingDate",DATA_TYPE:"string",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"ReadDate",DISPLAY_ORDER:3,settings:{isInSlot:!0}},{COLUMN_NAME:"CurrentReading",DATA_TYPE:"string",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Reading",DISPLAY_ORDER:4},{COLUMN_NAME:"OldReading",DATA_TYPE:"decimal",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"PreviousReading",DISPLAY_ORDER:5},{COLUMN_NAME:"Consumption",DATA_TYPE:"decimal",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Consumption",DISPLAY_ORDER:6},{COLUMN_NAME:"measurement_unit",DATA_TYPE:"string",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Measurement Unit",DISPLAY_ORDER:7},{COLUMN_NAME:"Days",DATA_TYPE:"string",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"DaysPolicy",DISPLAY_ORDER:10},{COLUMN_NAME:"bill_type",DATA_TYPE:"string",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Bill Type",DISPLAY_ORDER:12},{COLUMN_NAME:"processStatus",DATA_TYPE:"string",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Status",DISPLAY_ORDER:12,settings:{isInSlot:!0}},{COLUMN_NAME:"is_Billed",DATA_TYPE:"string",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Is Billed",DISPLAY_ORDER:13}],ListingData:[],meterIds:"",planIds:"",dateFrom:"",dateTo:"",IsMeterDetails:!1,MeterDeatilsObject:{},listActions:[{title:"Delete",icon:"fa fa-trash text-info action-icon",callbackfunction:"DeleteMeterReading",isDisabled:!1,additionalSpan:""},{title:"Edit",icon:"fa fa-pencil text-info action-icon",callbackfunction:"EditMeterReading",isDisabled:!1,additionalSpan:""},{title:"View Process",icon:"fa fa-eye text-info action-icon",callbackfunction:"ViewMeterReading",isDisabled:!1,additionalSpan:""},{title:"Processed",icon:"fa fa-check text-info action-icon",callbackfunction:"Processed",isDisabled:!1,additionalSpan:""}],EditDetails:{},ClientAdditionalId:"",locationId:""}},created(){this.getMeterTypes(),this.FetchData()},methods:{onReadingClick(t){console.log("Reading clicked:",t),this.ShowAlert(`Reading for meter: ${t.MeterId} is ${t.CurrentReading}`,"info")},openLightbox(t){var e=this;if(null==t||void 0==t);else{var a=t.split(",");a.forEach(t=>{var a={path:t,caption:t.split("/")[6].split(".")[0]};e.images.push(a)})}e.showLightbox=!0},handleAddMeterReading(){var t=this;t.EditDetails=null,t.IsAddMeterReading=!0},handleFilterMeterReading(){this.IsFilterMeterReading=!0},async handleGenerateBill(){var t=this;let e="";document.querySelectorAll(".chkItems:checked").forEach((function(t){t.id.startsWith("chkAll")||(e.length>0&&(e+=","),e+=t.value)})),""==e&&t.ShowAlert(t.$t("Please select at least one item"),"warning",t.$t("Alert"));var a=t.ListingData[0].MeterMappingId;let i=`ids=${e}&clientId=${this.UserId}&plan_mapping_id=${a}&type=Generate&billing_cycle=monthly&current_date=&is_foredit=no`;try{const t=await n["a"].GenerateMeterInvoice(i);if(null!==t&&void 0!==t&&t.data){const e=t.data.result;e&&null!=e.result.data[0].bill_id?(this.ShowAlert(this.$t("Invoice generated successfully"),"success",this.$t("Alert")),this.$emit("refreshList"),this.FetchData()):e&&null===e.result.data[0].bill_id?(this.ShowAlert(this.$t(e.result.data[0].status_message),"warning",this.$t("Alert")),this.$emit("refreshList"),this.FetchData()):this.ShowAlert(this.$t("Error while save meter data"),"failure",this.$t("Alert"))}}catch(s){}},handlefilterSearch(t){this.meterTypeId=t.meterTypeId,this.meterIds=t.meterIds,this.planIds=t.planIds,this.dateFrom=t.dateFrom,this.dateTo=t.dateTo,this.IsFilterMeterReading=!1,this.isFilterApplied=!0,this.FetchData()},closeshowLightbox(){var t=this;t.images=[],t.showLightbox=!1},handleResetFilter(){this.meterTypeId="",this.meterIds="",this.planIds="",this.dateFrom="",this.dateTo="",this.isFilterApplied=!1,this.FetchData()},refreshList(){this.IsAddMeterReading=!1,this.IsMeterReadingDetail=!1,this.FetchData()},handleMeterTypeChange(){this.FetchData()},clickEventOfColumn:function(t,e){var a=this;a.MeterDeatilsObject=t,a.IsMeterDetails=!0},CloseDetails(){var t=this;t.IsMeterDetails=!1},async FetchData(){const t=this;t.ListingData=[],t.isLoading=!0;const e=`ClientId=${t.UserId}&pageSize=${t.PageSize}&pageNum=${t.PageNumber}&meter_type_id=${t.meterTypeId}&sortBy=${t.SortBy}&sortExp=${t.SortExp}&customerTypeId=1&meterids=${t.meterIds}&plans=${t.planIds}&datefrom=${t.dateFrom}&dateto=${t.dateTo}&isPartial=0`;try{const i=await n["a"].GetMeterReadingList(e);if(null!==i&&void 0!==i&&i.data){let e=JSON.parse(i.data.result).data;var a;if(e.length>0)t.isLoading=!1,t.isCheckbox=""!=t.meterTypeId,t.ListingData=e.map(t=>(t.processStatus=1===t.is_processed?"Processed":"UnProcessed",t.isCheckBoxDisabled=!1,"No"===t.is_Billed&&1==t.is_processed?t.isCheckBoxDisabled=!1:t.isCheckBoxDisabled=!0,t)),t.Headers.forEach(e=>{e.settings=null,"MeterMappingName"===e.COLUMN_NAME&&(e.settings={clickEvent:t.clickEventOfColumn}),"ReadingDate"==e.COLUMN_NAME&&(e.settings={isInSlot:!0}),"processStatus"==e.COLUMN_NAME&&(e.settings={isInSlot:!0})}),t.noRecord=!1,t.TotalRecords=(null===(a=t.ListingData[0])||void 0===a?void 0:a.TotalRecords)||0;else t.ListingData=[],t.noRecord=!0,t.TotalRecords=0,t.isLoading=!1}else t.ListingData=[],t.noRecord=!0,t.TotalRecords=0,t.isLoading=!1}catch(i){console.error("Error fetching meter reading data:",i),t.ListingData=[],t.noRecord=!0,t.TotalRecords=0,t.isLoading=!1}},async getMeterTypes(){const t=this;try{let e="is_mapped=2";const a=await n["a"].GetMeterTypes(e);if(null!==a&&void 0!==a&&a.data){const e=JSON.parse(a.data.result).data;Array.isArray(e)&&e.length>0?(e.map(t=>{this.meterTypes.push({value:t.meter_id,name:t.meter_name})}),t.$refs.dynamicform.UpdateKeyValue()):console.warn("No valid data found in the response")}else console.error("Invalid response structure:",a)}catch(e){console.error("Error fetching Meter types:",e)}},leftCommonSearch(t){if(this.PageNumber=t.PageNumber,this.isPaged=1,"undefined"!=typeof t.searchCondition)if(""!=t.searchCondition){let e=t.searchConditionJson,a=e.split("=")[1];this.searchCondition=a}else this.searchCondition="";else this.searchCondition="";this.FetchData()},renderActions(t){var e=this;let a=[];return e.listActions.forEach(e=>{let i={...e};switch(i.title){case"Delete":"No"==t.is_Billed&&1==t.ROWNUMBER?i.isVisible=!0:i.isVisible=!1;break;case"Edit":"No"==t.is_Billed&&"Processed"!=t.processStatus&&1==t.ROWNUMBER?i.isVisible=!0:i.isVisible=!1;break;case"Replace":1001==t.status_id?i.isVisible=!0:i.isVisible=!1;break;case"View History":1002==t.status_id?i.isVisible=!0:i.isVisible=!1;break;case"View Process":0==t.is_processed?i.isVisible=!1:i.isVisible=!0;break;case"Processed":0==t.is_processed?i.isVisible=!0:i.isVisible=!1;break;default:i.isVisible=!0}a.push(i)}),a},formatDate(t){return t?E()(t).format("MMMM Do, YYYY"):""},pagerMethod(t){this.PageSize=t.PageSize,this.PageNumber=t.PageNumber,this.FetchData()},actionButtonClick(t,e){switch(t){case"DeleteMeterReading":this.DeleteMeterReading(e);break;case"EditMeterReading":this.EditMeterReading(e);break;case"ViewMeterReading":this.ViewMeterReading(e);break;case"Delete":this.DeleteMultiple(e);break;case"Replace":this.ReplaceMeter(e);break;case"Processed":this.IsProcessed(e);break}},commonHeaderButtonClick(t){},sortdata(t){var e="sort tb_headerSortDown";this.SortBy=t,t===this.SortBy&&(""==this.SortExp?(this.SortExp="ASC",e="sort tb_headerSortDown"):"ASC"==this.SortExp?(this.SortExp="DESC",e="sort tb_headerSortUp"):(this.SortExp="ASC",e="sort tb_headerSortDown")),this.FetchData(),$("#"+t+"  span:first-child").attr("class",e)},DeleteMeterReading(t){var e=this,a="";a=t.MeterReadingId.toString(),null!=a&&void 0!=a?e.confirmR(e.$t("ConfirmDelete"),!0,e.$t("Delete")+"  "+e.$t("Plan"),(function(){var t={ids:a,moduleName:"CompanySetup",refCode:"Delete_Meter_Reading"},i=JSON.stringify(t);n["a"].CommonCommonDelete(i).then(t=>{200==t.status?(e.FetchData(),e.ShowAlert("Deleted Data Successfully!","Success",!0,e.$t("Alert"))):e.ShowAlert(e.$t("DeleteingRecordMsg"),"danger",e.$t("Alert"))})})):e.ShowAlert(e.$t("DeleteingRecordMsg"),"danger",e.$t("Alert"))},EditMeterReading(t){var e=this;e.EditDetails=t,e.IsAddMeterReading=!0},ViewMeterReading(t){var e=this;e.MeterReadingId=t.MeterReadingId,e.IsMeterReadingDetail=!0},IsProcessed(t){var e=this,a=`clientId=${e.UserId}&clientAdditionalId=${t.ClientAdditionalId}&locationId=${e.locationId}&fromDate=&toDate=&meterReadingId=${t.MeterReadingId}&batchDate=&isLog=true&processType=AUTO&processId=`;n["a"].ProcessMeterReading(a).then((function(t){t.data&&1==t.data[0].status_id?(e.ShowAlert(e.$t("UpdatedSuccess",[e.$t("Status")]),"Success",!0,e.$t("Alert")),e.FetchData()):t.data&&2==t.data[0].status_id?(e.ShowAlert("Billing stoped","failure",!0,e.$t("Alert")),e.FetchData()):e.ShowAlert(e.$t("UnknownErrorOccur"),"failure",!0,e.$t("Alert"))}))},getStatusClass:function(t){var e="";return e=1===t?"px-2 text-center bg-success text-white d-block":0===t?"px-2 text-center bg-danger text-white d-block":"",e}}},rn=on,cn=Object(d["a"])(rn,Rs,Ms,!1,null,null,null),dn=cn.exports,un=function(){var t=this,e=t._self._c;return t.IsPrivilege?e("section",[t.IsTaxableOrNot?e("section",[e("loader",{attrs:{"is-visible":t.isLoading}}),e("tg-list",{ref:"tgList",attrs:{listType:["List"],IsShowAction:t.IsShowAction,showCheckBox:!0,ModuleName:"Tax",SubModuleCode:"TaxCategory",IdentityColumn:"jurisdiction_id",HeaderText:t.$t("TaxOverride"),ListData:t.ListingData,HeaderData:t.Headers,widgets:t.widgets,HeaderButtons:t.Buttons,TotalRecords:t.TotalRecords,RenderRowActionMethod:t.renderActions,ListDataCallBackFunction:t.GetModuleConfigurationKeys,SortExp:t.SortExp,SortBy:t.SortBy,NorecordfoundText:t.$t("NoRecordfound"),SearchFields:t.leftSearchFields,LegendArray:t.LegendArray},on:{PagerButtonClick:t.pagerMethod,HeaderButtonClick:t.commonHeaderButtonClick,SortdataButtonClick:t.sortdata,LeftsearchButtonClick:t.leftCommonSearch,ActionButtonClick:t.actionButtonClick},scopedSlots:t._u([{key:"slotdata",fn:function({data:a}){return["effective_from"==a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(t.$options.filters.formatDate(a.row.effective_from))+" ")])]:t._e(),"effective_to"==a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(t.$options.filters.formatDate(a.row.effective_to))+" ")])]:t._e(),"status_name"==a.column.COLUMN_NAME?[e("a",{staticClass:"inactive-disabled"},[e("span",{staticClass:"text-center text-white d-block",style:{backgroundColor:a.row.status_bg_color}},[t._v(" "+t._s(a.row.status_name)+" ")])])]:t._e(),"rate_type"==a.column.COLUMN_NAME?["P"==a.row.rate_type?e("span",[t._v(" "+t._s(t.$t("Percentage"))+" ")]):e("span",[t._v(t._s(t.$t("Flat")))])]:t._e(),"is_slab_rate"==a.column.COLUMN_NAME?[a.row.is_slab_rate?e("span",[e("a",{staticClass:"task-dec",on:{click:function(e){return t.ShowSlabDeails(a.row.tax_category_id,a.row.rate_type)}}},[t._v(t._s(t.$t("Slab")))])]):"P"==a.row.rate_type?e("span",[t._v(t._s(a.row.rate)+"%")]):"F"==a.row.rate_type?e("span",[t._v(t._s(a.row.rate))]):t._e()]:t._e(),"rate"==a.column.COLUMN_NAME?[e("span",[t._v(t._s(a.row.rate.toFixed(2)))])]:t._e()]}},{key:"headerleftbuttons",fn:function({data:a}){return[e("div",{staticClass:"col-sm-12 col-md-2 col-lg-2 float-left mt-2 pt-1 pl-0"},[e("div",{staticClass:"dynamic-form-toggle"},[e("span",{staticClass:"text-white"},[t._v(":")]),e("div",{staticClass:"switch dynamic-form",attrs:{tabindex:"0",role:"switch"}},[e("label",{staticClass:"switch w70"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.IsTaxOverride,expression:"IsTaxOverride"}],staticClass:"form-check-input custom-control-input dynamic",attrs:{type:"checkbox",name:"isTaxOverride"},domProps:{checked:Array.isArray(t.IsTaxOverride)?t._i(t.IsTaxOverride,null)>-1:t.IsTaxOverride},on:{change:[function(e){var a=t.IsTaxOverride,i=e.target,s=!!i.checked;if(Array.isArray(a)){var n=null,l=t._i(a,n);i.checked?l<0&&(t.IsTaxOverride=a.concat([n])):l>-1&&(t.IsTaxOverride=a.slice(0,l).concat(a.slice(l+1)))}else t.IsTaxOverride=s},function(e){return t.ShowButton(e)}]}}),e("span",{staticClass:"slider round",staticStyle:{cursor:"default"}},[e("span",{staticClass:"slider-yes"},[t._v(t._s(t.$t("Yes")))]),e("span",{staticClass:"slider-no"},[t._v(t._s(t.$t("No")))])])])])])])]}}],null,!1,2480930884)}),t.IsSlabDetalis?e("SlabDetalis",{attrs:{TaxCategoryData:t.TaxCategoryData,Type:t.Type,rateType:t.rateType},on:{CloseSlabDeails:t.CloseSlabDeails}}):t._e(),t.IsTaxClient?e("TaxClientModal",{attrs:{ClientId:t.ClientId},on:{CloseTaxClient:t.CloseTaxClient,IsOverrideTaxClient:t.IsOverrideTaxClient}}):t._e(),t.isAddClientTax?e("AddClientTax",{attrs:{ClientData:t.ClientData,ClientId:t.ClientId},on:{CloseTaxClientMap:t.CloseTaxClientMap}}):t._e(),t.isAddTaxCategory?e("AddTaxCategory",{attrs:{TaxCategoryData:t.TaxCategoryId,ClientId:t.ClientId,LayoutType:"Tax"},on:{CloseTaxCategory:t.CloseTaxCategory}}):t._e()],1):e("section",[e("div",{staticClass:"container-fluid mt-2 p-0"},[e("div",{staticClass:"theme-primary"},[e("span",{staticClass:"p-name text-white"},[t._v(t._s(t.$t("Tax")))])]),e("div",{staticClass:"border p-4"},[e("div",{staticClass:"col-lg-12 col-sm-12 alert alert-primary text-center",attrs:{role:"alert"}},[t._v(" "+t._s(t.$t("TaxExemptionis"))+" ")])])])])]):e("section",[e("div",{staticClass:"container-fluid mt-2 p-0"},[e("div",{staticClass:"theme-primary"},[e("span",{staticClass:"p-name text-white"},[t._v(t._s(t.$t("Tax")))])]),e("div",{staticClass:"border p-2"},[e("div",{staticClass:"col-lg-12 col-sm-12 alert alert-warning text-center mb-1",attrs:{role:"alert"}},[t._v(" "+t._s(t.$t("NotAuthorizedSection"))+" ")])])])])},pn=[];let mn=[{title:"AddTax",iconClass:"fa fa-plus pr-2 ",callbackfunction:"AddTaxCategory",additionalClass:"",isdisabled:!1,isvisible:!1},{title:"BacktoList",iconClass:"fa fa-angle-double-left",callbackfunction:"BacktoList",additionalClass:"",isdisabled:!1,isvisible:!0}],hn=[{title:"Edit",icon:"fa fa-pencil action-icon",additionalSpan:"",callbackfunction:"EditTaxCategory"},{title:"Delete",href:"javascript:void(0)",callbackfunction:"DeleteTaxClient",icon:"fa fa-trash-o action-icon text-danger",additionalSpan:""}];var vn={buttons:mn,listActions:hn},_n=a("a015"),gn=function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered",staticStyle:{"max-width":"950px"}},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("Override"))+" "+t._s(t.$t("Tax")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.CloseTaxClient}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"alert alert-primary",attrs:{role:"alert"}},[t._v(" "+t._s(t.$t("ModifyTaxDetails"))+" ")]),e("div",{staticClass:"col-12 p-0"},[e("div",{staticClass:"row flex-row-reverse"},[e("div",{staticClass:"col-lg-12 text-right"},[e("a",{staticClass:"btn btn-success mr-2",attrs:{href:"javascript:;",id:"btnSave",title:"Add Tax"},on:{click:t.TaxClientOverrideNo}},[e("i",{staticClass:"fa fa-plus pr-2"}),t._v(t._s(t.$t("AddTax")))]),e("a",{staticClass:"btn btn-primary",attrs:{href:"javascript:;",id:"btnSave",title:"Apply Override"},on:{click:t.TaxClientOverrideYes}},[e("i",{staticClass:"fa fa-save pr-2"}),t._v(t._s(t.$t("ApplyOverride")))])])])])])])])])],1)},fn=[],Cn={data(){return{isLoading:!1}},created:function(){},methods:{CloseTaxClient(){var t=this;t.$emit("CloseTaxClient")},TaxClientOverrideYes(){var t=this;t.$emit("IsOverrideTaxClient","Yes")},TaxClientOverrideNo(){var t=this;t.$emit("IsOverrideTaxClient","No")}}},yn=Cn,bn=Object(d["a"])(yn,gn,fn,!1,null,null,null),Sn=bn.exports,An=function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("Tax")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.CloseTaxClient}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("tg-list",{ref:"tgList",attrs:{listType:["List"],IsShowAction:!1,showCheckBox:!0,ModuleName:"Tax",SubModuleCode:"TaxCategory",IdentityColumn:"id",HeaderText:t.$t("Tax Category"),ListData:t.ListingData,HeaderData:t.Headers,widgets:t.widgets,HeaderButtons:t.Buttons,TotalRecords:t.TotalRecords,RenderRowActionMethod:t.renderActions,ListDataCallBackFunction:t.FetchTaxCategoryList,SortExp:t.SortExp,SortBy:t.SortBy,NorecordfoundText:t.$t("NoRecordfound"),SearchFields:t.leftSearchFields,LegendArray:t.LegendArray},on:{PagerButtonClick:t.pagerMethod,HeaderButtonClick:t.commonHeaderButtonClick,SortdataButtonClick:t.sortdata,LeftsearchButtonClick:t.leftCommonSearch,ActionButtonClick:t.actionButtonClick},scopedSlots:t._u([{key:"slotdata",fn:function({data:a}){return["name"==a.column.COLUMN_NAME?[e("span",[t._v(t._s(a.row.name)+" ")])]:t._e(),"effective_from"==a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(t.$options.filters.formatDate(a.row.effective_from))+" ")])]:t._e(),"effective_to"==a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(t.$options.filters.formatDate(a.row.effective_to))+" ")])]:t._e(),"status_name"==a.column.COLUMN_NAME?[e("a",{staticClass:"inactive-disabled"},[e("span",{staticClass:"text-center text-white d-block",style:{backgroundColor:a.row.status_bg_color}},[t._v(" "+t._s(a.row.status_name)+" ")])])]:t._e(),"rate_type"==a.column.COLUMN_NAME?["P"==a.row.rate_type?e("span",[t._v(" "+t._s(t.$t("Percentage"))+" ")]):e("span",[t._v(t._s(t.$t("Flat")))])]:t._e(),"is_slab_rate"==a.column.COLUMN_NAME?[a.row.is_slab_rate?e("span",[e("a",{staticClass:"task-dec",on:{click:function(e){return t.ShowSlabDeails(a.row.id)}}},[t._v(t._s(t.$t("Slab")))])]):e("span",[t._v(t._s(a.row.rate)+"%")])]:t._e(),"rate"==a.column.COLUMN_NAME?[e("span",[t._v(t._s(a.row.rate.toFixed(2)))])]:t._e()]}}])}),e("div",{staticClass:"row flex-row-reverse mt-3 pt-2"},[e("div",{staticClass:"col-lg-6 text-right"},[e("a",{staticClass:"btn btn-success mr-2",attrs:{href:"javascript:;",title:"Save"},on:{click:t.SaveClientTax}},[e("i",{staticClass:"fa fa-save pr-2"}),t._v(t._s(t.$t("Save")))]),e("a",{staticClass:"btn btn-danger",attrs:{href:"javascript:;",title:"Cancel"},on:{click:t.CloseTaxClient}},[e("i",{staticClass:"fa fa-close pr-2"}),t._v(t._s(t.$t("Cancel")))])])])],1)])])])],1)},Dn=[],In={props:{ClientId:{type:Number,required:!0},ClientData:{type:Object}},data(){return{isLoading:!1,PageSize:10,PageNumber:1,isPaged:1,TotalPages:0,widgets:[],LegendArray:[],SortBy:"",SortExp:"",CompanyId:null,TotalRecords:0,ListingData:[],Headers:[{COLUMN_NAME:"name",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"TaxName",DISPLAY_ORDER:1,settings:{isInSlot:!0}},{COLUMN_NAME:"description",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"DESCRIPTION",DISPLAY_ORDER:2},{COLUMN_NAME:"effective_from",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Effective_From",DISPLAY_ORDER:3,settings:{isInSlot:!0}},{COLUMN_NAME:"effective_to",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"EffectiveTo",DISPLAY_ORDER:3,settings:{isInSlot:!0}},{COLUMN_NAME:"rate_type",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"EffectiveTo",DISPLAY_ORDER:3,settings:{isInSlot:!0}},{COLUMN_NAME:"is_slab_rate",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!1,DISPLAY_NAME:"TaxRate",DISPLAY_ORDER:3,settings:{isInSlot:!0}},{COLUMN_NAME:"status_name",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"StatusName",DISPLAY_ORDER:3,settings:{isInSlot:!0}}]}},created:async function(){this.FetchTaxCategoryList()},methods:{leftCommonSearch(){},renderActions(){},pagerMethod:function(t){this.PageSize=t.PageSize,this.PageNumber=t.PageNumber,this.FetchTaxCategoryList()},actionButtonClick(){},commonHeaderButtonClick(){},sortdata(){},FetchTaxCategoryList(){var t=this;t.isLoading=!0;var e=`Client=${t.ClientId}&pageSize=${t.PageSize}&pageNum=${t.PageNumber}&sortBy=${t.SortBy}&sortExp=${t.SortExp}`;n["a"].GetTaxCategoryList(e).then(e=>{t.isLoading=!1,e.data.result.DATA.length>0?(t.ListingData=e.data.result.DATA,t.TotalRecords=e.data.result.DATA[0].TOTAL_RECORDS,t.TotalPages=Math.ceil(t.TotalRecords/t.PageSize),t.CurrentPage=t.PageNumber):(t.ListingData=[],t.TotalRecords=0)})},CloseTaxClient(){var t=this;t.$emit("CloseTaxClientMap")},SaveClientTax:function(){var t=this,e="";if(t.isLoading=!0,$(".chkItems:checkbox:checked").not("[id^='chkAll_0']").each((function(){e.length>0&&(e+=","),e+=$(this).val()})),null!=e){var a=`Ids=${e}&ClientId=${t.ClientId}`;n["a"].SaveClientTax(a).then((function(e){t.isLoading=!1,e.data.result.DATA.length>0?"INSERT"==e.data.result.DATA[0].VALUE&&(t.ShowAlert(t.$t("AddedSuccess",[t.$t("Tax")]),"Success",!0,t.$t("Alert")),t.CloseTaxClient()):t.ShowAlert(ths.$t("UnknownErrorOccur"),"failure",!0,t.$t("Alert"))}))}else t.ShowAlert(t.$t("Selectanyrecordtodelete"));t.isLoading=!1}}},Tn=In,Ln=Object(d["a"])(Tn,An,Dn,!1,null,null,null),En=Ln.exports,xn=a("3713"),Nn={components:{SlabDetalis:_n["a"],TaxClientModal:Sn,AddClientTax:En,AddTaxCategory:xn["a"]},props:{ClientId:{type:Number,required:!0},ClientData:{type:Object},ChecKPrivilege:{type:Boolean,required:!0}},data(){return{isLoading:!1,PageSize:10,PageNumber:1,TaxCategoryId:null,isPaged:1,TotalPages:0,widgets:[],LegendArray:[],ListingData:[],Buttons:null,IsShowAction:!1,TotalRecords:0,Type:"Tax_Category",SortBy:"",moduleCode:"Billing",SortExp:"",Buttons:vn.buttons,IsSlabDetalis:!1,TaxCategoryData:null,listActions:vn.listActions,Headers:vn.TableHeader,leftSearchFields:vn.leftsearchSchema,Headers:[{COLUMN_NAME:"tax_name",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"TaxName",DISPLAY_ORDER:1},{COLUMN_NAME:"jurisdiction_name",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"TaxJurisdictionName",DISPLAY_ORDER:2},{COLUMN_NAME:"effective_from",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Effective_From",DISPLAY_ORDER:3,settings:{isInSlot:!0}},{COLUMN_NAME:"effective_to",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"EffectiveTo",DISPLAY_ORDER:3,settings:{isInSlot:!0}},{COLUMN_NAME:"rate_type",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"RateType",DISPLAY_ORDER:3,settings:{isInSlot:!0}},{COLUMN_NAME:"is_slab_rate",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"TaxRate",DISPLAY_ORDER:3,settings:{isInSlot:!0}},{COLUMN_NAME:"status_name",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"StatusName",DISPLAY_ORDER:3,settings:{isInSlot:!0}}],IsTaxableOrNot:!0,IsTaxOverride:!1,IsTaxClient:!1,isAddClientTax:!1,userId:null,companyId:null,IsTaxOverrideId:0,isAddTaxCategory:!1,IsPrivilege:!0}},created:async function(){var t=this;t.userId=t.GetUserInfo.ID,t.companyId=t.GetUserInfo.CompanyId,t.ChecKPrivilege?(t.IsPrivilege=!0,await t.GetModuleConfigurationKeys(),t.GetModuleConfigurationClientKeys()):t.IsPrivilege=!1},methods:{leftCommonSearch:function(t){if(this.PageNumber=t.PageNumber,this.isPaged=1,"undefined"!=typeof t.searchCondition)if(""!=t.searchConditionJson){const e=t.searchConditionJson.split("=")[1];this.fav=e}else this.searchCondition=t.searchCondition;else this.searchCondition="";this.FetchTaxList()},renderActions:function(t){var e=this;let a=[];return e.listActions.forEach(t=>{let e={...t};switch(e.title){case"Edit":e.isVisible=!0;break;case"Delete":e.isVisible=!0;break;default:e.isVisible=!0}a.push(e)}),a},pagerMethod:function(t){this.PageSize=t.PageSize,this.PageNumber=t.PageNumber,this.FetchTaxList()},actionButtonClick:function(t,e){switch(t){case"EditTaxCategory":this.EditTaxCategory(e.id);break;case"DeleteTaxClient":this.commonDeleteData(e.id);break}},commonHeaderButtonClick:async function(t){var e=this;switch(t.callbackfunction){case"AddTaxCategory":e.AddTaxCategory(null);break;case"BacktoList":e.BacktoList();break}},sortdata:function(t){var e="sort tb_headerSortDown";this.SortBy=t,t===this.SortBy&&(""==this.SortExp?(this.SortExp="ASC",e="sort tb_headerSortDown"):"ASC"==this.SortExp?(this.SortExp="DESC",e="sort tb_headerSortUp"):(this.SortExp="ASC",e="sort tb_headerSortDown")),this.FetchTaxList(),$("#"+t+"  span:first-child").attr("class",e)},GetModuleConfigurationKeys:async function(t){var e=this;await e.GetModuleIdByModuleName();var a="moduleId="+e.ModuleId;await n["a"].GetConfigurationkeysData(a).then((function(t){if(null!=t&&null!=t.data){const a=t.data.StorageKeys.filter(t=>"IsTaxable"===t.CORE_CONFIG_KEY);"Exempt"==a[0].CORE_CONFIG_VALUE?e.IsTaxableOrNot=!1:e.IsTaxableOrNot=!0}}))},GetModuleConfigurationClientKeys:async function(t){var e=this;e.isLoading=!0;var a=`ClientId=${e.ClientData.clientdetail.user_id}&Key=TaxOverride`;await n["a"].GetClientConfigurationkeysData(a).then((function(t){null!=t&&null!=t.data&&(e.IsTaxOverrideId=t.data.result.core_config_id,"false"==t.data.result.config_value||"no"==t.data.result.config_value?(e.IsTaxOverride=!1,e.IsShowAction=!1,e.Buttons[0].isvisible=!1):(e.IsTaxOverride=!0,e.IsShowAction=!0,e.Buttons[0].isvisible=!0),e.FetchTaxList())}))},async GetModuleIdByModuleName(){var t=this,e="moduleName="+t.moduleCode;await n["a"].GetModuleIdByModuleName(e).then((function(e){null!=e&&null!=e.data&&(t.ModuleId=e.data)}))},FetchTaxList(){var t=this;t.isLoading=!0;var e=`Clientid=${t.ClientData.clientdetail.user_id}&JurisdictionId=${void 0==t.ClientData.jurisdictionId?0:t.ClientData.jurisdictionId}&pageSize=${t.PageSize}&pageNum=${t.PageNumber}&sortBy=${t.SortBy}&sortExp=${t.SortExp}&isOverride=${1==t.IsTaxOverride?1:0}`;n["a"].GetClientTaxList(e).then(e=>{e.data.result.DATA.length>0?(t.ListingData=e.data.result.DATA,t.TotalRecords=e.data.result.DATA[0].TOTAL_RECORDS,t.TotalPages=Math.ceil(t.TotalRecords/t.PageSize),t.PageNumber=t.PageNumber):(t.ListingData=[],t.TotalRecords=0),t.isLoading=!1})},ShowSlabDeails(t,e){this.TaxCategoryData=t,this.rateType=e,this.IsSlabDetalis=!0},CloseSlabDeails(){this.IsSlabDetalis=!1},ShowButton(t){var e=this;if(t.target.checked){var a=`ClientId=${e.ClientData.clientdetail.user_id}&Id=${e.IsTaxOverrideId}&IsOverride=${1==t.target.checked?1:0}`;n["a"].UpdateIsTaxOverrideTax(a).then(t=>{t.data.result.DATA.length>0&&"UPDATE"==t.data.result.DATA[0].VALUE&&(e.IsTaxClient=!0)})}else e.confirmR(e.$t("ExistingJurisdictionTax"),!0,null,(function(){var a=`ClientId=${e.ClientData.clientdetail.user_id}&Id=${e.IsTaxOverrideId}&IsOverride=${1==t.target.checked?1:0}`;n["a"].UpdateIsTaxOverrideTax(a).then(t=>{t.data.result.DATA.length>0&&"UPDATE"==t.data.result.DATA[0].VALUE&&(e.IsTaxClient=!1,e.GetModuleConfigurationKeys())})}),(function(){e.IsTaxOverride=!t.target.checked}))},CloseTaxClient(){var t=this;t.IsTaxClient=!1;var e=`ClientId=${t.ClientData.clientdetail.user_id}&Id=${t.IsTaxOverrideId}&IsOverride=0`;n["a"].UpdateIsTaxOverrideTax(e).then(e=>{e.data.result.DATA.length>0&&"UPDATE"==e.data.result.DATA[0].VALUE&&(t.IsTaxClient=!1,t.GetModuleConfigurationKeys())})},BacktoList(){this.$router.push({name:"ClientListing"})},IsOverrideTaxClient(t){var e=this;if("Yes"==t){var a=`IsOverride=Yes&ClientId=${e.ClientData.clientdetail.user_id}&JurisdictionId=${e.ClientData.jurisdictionId}`;n["a"].MappingClientTax(a).then(t=>{t.data.result.DATA.length>0&&"CLIENT_MAP"==t.data.result.DATA[0].VALUE&&(e.IsShowAction=!0,e.Buttons[0].isvisible=!0,e.IsTaxClient=!1,e.FetchTaxList())})}"No"==t&&(e.IsTaxClient=!1,e.IsShowAction=!0,e.Buttons[0].isvisible=!0,e.ListingData=[],e.TotalRecords=0,e.TotalPages=10,e.PageNumber=1)},AddTaxCategory(){this.isAddClientTax=!0},CloseTaxClientMap(){this.isAddClientTax=!1,this.FetchTaxList()},commonDeleteData(t){var e=this;null!=t?e.confirmR(e.$t("ConfirmDelete"),!0,e.$t("Delete")+"  "+e.$t("Tax Client"),(function(){var a=`ids=${t}&Type=TAX_CLIENT`;n["a"].RemoveMapping(a).then((function(t){e.isLoading=!1,t.data.result.DATA.length>0&&"DELETE_TAX_CLIENT"==t.data.result.DATA[0].VALUE?(e.ShowAlert(e.$t("DeletedSuccess",[e.$t("Tax Client")]),"Success",!0,e.$t("Alert")),e.FetchTaxList()):e.ShowAlert(e.$t("DeletedError",[e.$t("Tax Client")]),"failure",!0,e.$t("Alert"))}))})):e.ShowAlert(e.$t("Selectanyrecordtodelete")),e.isLoading=!1},EditTaxCategory(t){var e=this;e.TaxCategoryId=t,e.isAddTaxCategory=!0},CloseTaxCategory(){var t=this;t.isAddTaxCategory=!1,t.GetModuleConfigurationKeys()}}},Pn=Nn,wn=(a("aa62"),Object(d["a"])(Pn,un,pn,!1,null,null,null)),Rn=wn.exports,Mn=function(){var t=this,e=t._self._c;return e("section",{staticClass:"col-md-12 p-0"},[e("div",{staticClass:"container-fluid p-0"},[e("div",{staticClass:"col-md-12 p-0"},[e("div",{staticClass:"listing"},[e("div",{staticClass:"table-responsive table-fix-header float-left",staticStyle:{"max-height":"630px"}},[e("table",{staticClass:"table table-bordered mt-0",staticStyle:{width:"1552px"},attrs:{id:"mainTable"}},[e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",[e("span",[t._v(t._s(t.$t("#")))])]),e("th",[e("span",[t._v(t._s(t.$t("UtilityName"))),e("span",{staticClass:"text-danger d-inline-block"},[t._v("*")])])]),t.isCheckExtraFeatureUtilityBilling?e("th",[e("span",[t._v(t._s(t.$t("UtilityType"))),e("span",{staticClass:"text-danger d-inline-block"},[t._v("*")])])]):t._e(),t.isCheckExtraFeatureUtilityBilling?e("th",[e("span",[t._v(t._s(t.$t("MeterInfo")))])]):t._e(),t.isCheckExtraFeatureUSICBILLING?e("th",[e("span",[t._v(t._s(t.$t("Description")))])]):t._e(),t.isCheckExtraFeatureUSICBILLING?e("th",[e("span",[t._v(t._s(t.$t("Utlityid")))])]):t._e(),t.isCheckExtraFeatureUSICBILLING?e("th",[e("span",[t._v(t._s(t.$t("DatabaseName")))])]):t._e(),e("th",[e("span",[t._v(t._s(t.$t("ProcessTime")))])]),"yes"==t.configNotes?e("th",[e("span",[t._v(t._s(t.$t("Notes")))])]):t._e(),e("th",{staticClass:"text-center single-action"},[e("span",[t._v(t._s(t.$t("Delete")))])])])]),e("tbody",[t._l(t.AdditionalInfoData,(function(a,i){return e("tr",{key:a.clientAdditionalId},[e("td",{staticClass:"float-left"},[t._v(" "+t._s(i+1)+" ")]),e("td",[e("input",{directives:[{name:"model",rawName:"v-model",value:a.companyName,expression:"item.companyName"}],class:["form-control",{"border-danger":a._validation&&a._validation.companyName,"is-invalid":a._validation&&a._validation.companyName}],attrs:{type:"text"},domProps:{value:a.companyName},on:{input:[function(e){e.target.composing||t.$set(a,"companyName",e.target.value)},function(e){return t.removeError(a,"companyName")}]}})]),t.isCheckExtraFeatureUtilityBilling?e("td",[e("select",{directives:[{name:"model",rawName:"v-model",value:a.utilityTypeId,expression:"item.utilityTypeId"}],class:["form-control",{"border-danger":a._validation&&a._validation.utilityTypeId,"is-invalid":a._validation&&a._validation.utilityTypeId}],attrs:{disabled:null!==a.meterDescription&&""!==a.meterDescription},on:{change:[function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(a,"utilityTypeId",e.target.multiple?i:i[0])},function(e){return t.removeError(a,"utilityTypeId")}]}},[e("option",{attrs:{value:"",disabled:""}},[t._v(t._s(t.$t("Select")))]),t._l(t.utilityTypeList,(function(a){return e("option",{key:a.value,domProps:{value:a.value}},[t._v(" "+t._s(a.name)+" ")])}))],2)]):t._e(),t.isCheckExtraFeatureUtilityBilling?e("td",[e("div",{staticClass:"description-hover float-left"},[e("span",{staticClass:"description-text",attrs:{title:a.meterDescription},domProps:{innerHTML:t._s(t.TruncateStr(a.meterDescription,40))}})]),0!=a.clientAdditionalId?e("div",{staticClass:"float-right"},[e("a",{staticClass:"viewcdccodenew viewicon enable",attrs:{href:"javascript:;",title:"View All","data-toggle-tooltip":"tooltip"},on:{click:function(e){return t.ViewMeterList(a)}}},[e("i",{staticClass:"fa fa-eye text-info action-icon"})])]):t._e()]):t._e(),t.isCheckExtraFeatureUSICBILLING?e("td",[e("div",{staticClass:"description-hover"},[e("span",{staticClass:"description-text",attrs:{title:a.description},domProps:{innerHTML:t._s(t.TruncateStr(a.description,30))}})]),0!=a.clientAdditionalId?e("div",{staticClass:"float-right"},[e("a",{staticClass:"viewcdccodenew viewicon enable",attrs:{href:"javascript:;",title:"View All","data-toggle-tooltip":"tooltip"},on:{click:function(e){return t.ViewCDCCodeList(a)}}},[e("i",{staticClass:"fa fa-eye text-info action-icon"})])]):t._e()]):t._e(),t.isCheckExtraFeatureUSICBILLING?e("td",[e("input",{directives:[{name:"model",rawName:"v-model",value:a.notes,expression:"item.notes"}],class:{"form-control":!0},attrs:{type:"text"},domProps:{value:a.notes},on:{input:function(e){e.target.composing||t.$set(a,"notes",e.target.value)}}})]):t._e(),t.isCheckExtraFeatureUSICBILLING?e("td",[e("select",{directives:[{name:"model",rawName:"v-model",value:a.dbName,expression:"item.dbName"}],class:{"form-control":!0},attrs:{name:"dbName"},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(a,"dbName",e.target.multiple?i:i[0])}}},[e("option",{attrs:{value:"",disabled:"",selected:""}},[t._v(t._s(t.$t("Select")))]),t._l(t.databaseList,(function(a){return e("option",{key:a.value,domProps:{value:a.value}},[t._v(" "+t._s(a.name)+" ")])}))],2)]):t._e(),e("td",["EventBased"==a.processingBasedOn?e("span",{staticClass:"float-left"},[t._v(t._s(a.eventFor))]):e("span",{staticClass:"float-left"},[t._v(t._s(a.processingTime))]),0!=a.clientAdditionalId?e("div",{staticClass:"float-right width_17 margintop3 single-action"},[e("a",{staticClass:"addProcessTime",attrs:{href:"javascript:;",title:"Add"},on:{click:function(e){return t.AddTime(a)}}},[e("i",{staticClass:"fa fa-plus-circle text-dark action-icon"})])]):t._e()]),"yes"==t.configNotes?e("td",{staticClass:"text-center single-action"},[e("a",{staticClass:"text-darks single-action",attrs:{href:"javascript:;"},on:{click:function(e){return t.NoteDataByUtility(a)}}},[e("em",{staticClass:"fa fa-file-text-o",attrs:{"aria-hidden":"true"}}),e("span",{staticClass:"noti-circle noti-orange"},[t._v(t._s(a.noOfNotes))])])]):t._e(),e("td",{staticClass:"text-center"},[""==a.meterDescription||null==a.meterDescription?e("a",{staticClass:"blue recyclebin enable ancdeleteadditionalinfo",on:{click:function(e){return t.RemoveInvoice(i,a.clientAdditionalId)}}},[e("i",{staticClass:"fa fa-trash text-danger action-icon"})]):t._e()])])})),t.IsAdditionalInfoDataShow?e("tr",[e("td",{staticClass:"text-center text-danger no_records no-record",attrs:{colspan:"10"}},[t._v(" "+t._s(t.$t("NoRecordfound"))+" ")])]):t._e()],2)])]),t.IsAdditionalInfoDataShow?t._e():e("div",{staticClass:"col-lg-12 p-0 float-left text-right mt-3"},[e("a",{staticClass:"btn btn-success save-btn mr-2",attrs:{href:"javascript:;",title:"Save"},on:{click:function(e){return t.SaveUtilityData()}}},[e("i",{staticClass:"fa fa-save pr-2"}),t._v(t._s(t.$t("Save"))+" ")]),e("a",{staticClass:"btn btn-danger",attrs:{href:"javascript:;",title:"Reset"},on:{click:function(e){return t.Reset()}}},[e("i",{staticClass:"fa fa-repeat pr-2"}),t._v(t._s(t.$t("Reset"))+" ")]),e("input",{attrs:{type:"hidden",id:"hdnPageNum",value:"1"}})])])])]),t.isShowAddUtilityTime?e("ModalAddUtilityTime",{attrs:{clientId:t.UserId,ClientAdditionalId:t.ClientAdditionalId}}):t._e(),t.isShowAddNoteDivision?e("AddNoteUtilityOrDivision",{attrs:{utilityId:t.utilityId,divisionId:t.divisionId,viewType:"Utility",clientId:t.clientId,modulename:"Billing",submodulecode:"Billing_InvoiceGrouping",callbackfunction:t.GetDivisionMappingDetail}}):t._e(),t.isCdcCodeList?e("CdcCodeList",{attrs:{clientId:t.clientId,utilityId:t.utilityId,ClientAdditionalId:t.ClientAdditionalId}}):t._e(),t.isMeterList?e("UtilityMeterMapping",{attrs:{utilityTypeId:t.utilityTypeId,clientId:t.clientId,ClientData:t.ClientData,ClientAdditionalId:t.ClientAdditionalId}}):t._e()],1)},$n=[],Fn=function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-popups"},[e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header ui-draggable-handle d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("Time")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})]),e("span",{staticClass:"user-guide"},[e("a",{staticClass:"ancuserguide text-white",attrs:{"data-toggle":"collapse",href:"#collapseReplyUG",role:"button","aria-expanded":"false","aria-controls":"collapseExample"}},[e("em",{staticClass:"fa fa-files-o pr-2"}),t._v(t._s(t.$t("UserGuide")))]),e("div",{staticClass:"divancuserguide collapse overflow-auto",attrs:{id:"collapseReplyUG"}},[e("div",{staticClass:"custom-scrollbar-js",attrs:{id:"scrollbarreplyuserguideMangeView"}},[e("div",{staticClass:"con",domProps:{innerHTML:t._s(t.$t("UserGuideProcessingTimeClients"))}})])])])]),e("div",{staticClass:"modal-body"},[e("dynamic-form",{ref:"TimeForm",attrs:{lang:"en",buttons:t.buttons,schema:t.FormSchema},on:{OnSubmit:t.onSubmit},scopedSlots:t._u([{key:"tgslot-Description",fn:function({data:t}){}}])})],1)])])])])},kn=[],On={props:{clientId:{type:Number,required:!1},ClientAdditionalId:{type:Number,required:!1}},data(){return{FormSchema:[{layoutType:"double",Data:[{astype:"RadioField",label:this.$t("ProcessingBasedOn"),name:"Processingbasedon",visibility:!0,value:"",config:{options:[{value:"TimeBased",name:this.$t("TimeBased")},{value:"EventBased",name:this.$t("EventBased")}],onChange:this.onChangeProcessingBased},validationRules:{required:!0,max:100}}]},{layoutType:"double",Data:[{astype:"SelectField",label:this.$t("ProcessingInterval"),name:"ProcessInterval",value:"",config:{options:[{value:"month",name:"Monthly"},{value:"biweek",name:"Bi-Weekly"},{value:"week",name:"Weekly"},{value:"daily",name:"Daily"}],onChange:this.onChangeProcessInterval},placeholder:"Select",visibility:!1,validationRules:{required:!0}},{astype:"SelectField",label:this.$t("MonthDate"),name:"ProcessDate",value:"",visibility:!1,config:{options:[]},placeholder:"Select",validationRules:{required:!1}},{astype:"SelectField",label:this.$t("ProcessDay"),name:"ProcessDay",value:"",visibility:!1,config:{options:[{name:"Monday",value:"Monday"},{name:"Tuesday",value:"Tuesday"},{name:"Wednesday",value:"Wednesday"},{name:"Thursday",value:"Thursday"},{name:"Friday",value:"Friday"},{name:"Saturday",value:"Saturday"},{name:"Sunday",value:"Sunday"}]},placeholder:"Select",validationRules:{required:!1}},{astype:"SelectField",label:this.$t("EventFor"),name:"EventFor",value:"",config:{options:[{value:"Meter Reading",name:"OnMeterReading"}]},placeholder:"Select",visibility:!1,validationRules:{required:!1}}]}],buttons:[{type:"submit",class:"btn btn-success save",text:"<i class='fa fa-save pr-2'></i>Submit"},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Cancel",onClick:this.Close}],invoiceDurationList:[],processingTimeId:0}},created:async function(){var t=this;await t.GetProcessingTimeNew(),setTimeout(()=>{t.monthDateList()},100)},methods:{GetProcessingTimeNew:async function(){var t=this,e="additionalId="+t.ClientAdditionalId;await n["a"].GetProcessingTimeNew(e).then(e=>{e.data.length>0&&(t.$refs.TimeForm.updateProperty("Processingbasedon","value",e.data[0].processingBased),t.processingTimeId=e.data[0].processingTimeId,"TimeBased"==e.data[0].processingBased?("month"==e.data[0].processInterval?(t.$refs.TimeForm.updateProperty("ProcessDate","value",e.data[0].processDate),t.$refs.TimeForm.updateProperty("ProcessDate","visibility",!0),t.$refs.TimeForm.updateProperty("ProcessDay","visibility",!1)):"week"==e.data[0].processInterval&&(t.$refs.TimeForm.updateProperty("ProcessDay","value",e.data[0].processDay),t.$refs.TimeForm.updateProperty("ProcessDay","visibility",!0),t.$refs.TimeForm.updateProperty("ProcessDate","visibility",!1)),t.$refs.TimeForm.updateProperty("ProcessInterval","visibility",!0),t.$refs.TimeForm.updateProperty("ProcessInterval","value",e.data[0].processInterval)):"EventBased"==e.data[0].processingBased&&(t.$refs.TimeForm.updateProperty("EventFor","value",e.data[0].eventFor),t.$refs.TimeForm.updateProperty("EventFor","visibility",!0),t.$refs.TimeForm.updateProperty("ProcessInterval","visibility",!1),t.$refs.TimeForm.updateProperty("ProcessDay","visibility",!1),t.$refs.TimeForm.updateProperty("ProcessDate","visibility",!1)),t.$refs.TimeForm.UpdateKeyValue())})},onChangeProcessingBased(t,e,a){const i=this,s=t.target.dataset.value;"TimeBased"==s?(i.$refs.TimeForm.updateProperty("ProcessInterval","visibility",!0),i.$refs.TimeForm.updateProperty("EventFor","visibility",!1),i.$refs.TimeForm.UpdateKeyValue()):"EventBased"==s&&(i.$refs.TimeForm.updateProperty("EventFor","visibility",!0),i.$refs.TimeForm.updateProperty("ProcessInterval","visibility",!1),i.$refs.TimeForm.updateProperty("ProcessDay","visibility",!1),i.$refs.TimeForm.updateProperty("ProcessDate","visibility",!1),i.$refs.TimeForm.updateProperty("ProcessInterval","value",""),i.$refs.TimeForm.updateProperty("ProcessDay","value",""),i.$refs.TimeForm.updateProperty("ProcessDate","value",""),i.$refs.TimeForm.UpdateKeyValue())},onChangeProcessInterval(t){const e=this,a=t.target.value,i="month"===a,s="week"===a;e.$refs.TimeForm.updateProperty("ProcessDate","visibility",i),e.$refs.TimeForm.updateProperty("ProcessDay","visibility",s),e.$refs.TimeForm.UpdateKeyValue()},monthDateList:function(){var t=this;t.invoiceDurationList=Array.from({length:31},(t,e)=>{const a=(e+1).toString();return{name:a,value:a}}),t.invoiceDurationList.length>0&&t.$refs.TimeForm&&(t.$refs.TimeForm.updateProperty("ProcessDate","config.options",t.invoiceDurationList),t.$refs.TimeForm.UpdateKeyValue())},onSubmit:function(t,e){var a=this,i=null,s=null;"week"==t.ProcessInterval&&(i=t.ProcessDay),"biweek"==t.ProcessInterval&&(i=t.ProcessDay),"month"==t.ProcessInterval&&(s=t.ProcessDate,i=t.ProcessDay),"daily"==t.ProcessInterval&&(i=t.ProcessDay);var l={additionalId:a.ClientAdditionalId,processingTimeId:a.processingTimeId,processDay:i,processDayDate:s,processInterval:t.ProcessInterval,processingBasedOn:t.Processingbasedon,eventFor:t.EventFor},o=JSON.stringify(l);n["a"].SaveProcessingTime(o).then(t=>{null!=t.data&&""!=t.data&&"Success"==t.data.status?"INSERT"==t.data.result?(a.ShowAlert(a.$t("AddedTime"),"success"),a.Close()):"UPDATE"==t.data.result&&(a.ShowAlert(a.$t("UpdatedTime"),"success"),a.Close()):a.ShowAlert(a.$t("UnknownErrorOccur"),"failure",!0,a.$t("Alert"))})},Close:function(){this.$parent.isShowAddUtilityTime=!1,this.$parent.$parent.LoadAdditionalInfo()}}},Bn=On,Un=Object(d["a"])(Bn,Fn,kn,!1,null,null,null),Gn=Un.exports,Yn=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header ui-draggable-handle d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("AdditionalInfo")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("tg-list",{attrs:{ModuleName:"Billing",HeaderText:t.$t("CDCCode"),isShowHeaderText:!0,SubModuleCode:"Billing",IdentityColumn:"CDC_ID",listType:["List"],showCheckBox:!0,ListData:t.CdcCodeListing,HeaderData:t.Headers,HeaderButtons:t.listheaderbuttons,TotalRecords:t.TotalRecords,IsShowAction:!1,RenderRowActionMethod:()=>{},ListDataCallBackFunction:t.FetchRecords,NorecordfoundText:t.$t("NoRecordfound")},on:{PagerButtonClick:t.pagerMethod,HeaderButtonClick:t.commonHeaderButtonClick,SortdataButtonClick:t.sortdata},scopedSlots:t._u([{key:"slotdata",fn:function({data:a}){return["Edit"==a.column.COLUMN_NAME?[e("span",[e("div",{staticClass:"text-center single-action"},[e("a",{staticClass:"EditCdc",attrs:{href:"javascript:;",title:"Edit",id:"EditCdc"},on:{click:function(e){return t.EditCdcCode(a.row)}}},[e("i",{staticClass:"fa fa-pencil text-success action-icon"})])])])]:t._e(),"STATUS_NAME"==a.column.COLUMN_NAME?["Active"==a.row.STATUS_NAME?e("span",[e("div",{staticClass:"text-center single-action"},[e("a",{staticClass:"UpdateCDCCodeStatus",attrs:{href:"javascript:;"},on:{click:function(e){return t.ChangeCdcStatus(a.row)}}},[e("i",{staticClass:"fa fa-check text-info action-icon"})])])]):"Inactive"==a.row.STATUS_NAME?e("span",[e("div",{staticClass:"text-center single-action"},[e("a",{staticClass:"UpdateCDCCodeStatus",attrs:{href:"javascript:;"},on:{click:function(e){return t.ChangeCdcStatus(a.row)}}},[e("i",{staticClass:"fa fa-check text-secondary action-icon"})])])]):t._e()]:t._e()]}}])})],1)])])])],1),t.isAddCdcCode?e("ModalAddCdcCode",{attrs:{cdcId:t.cdcId,clientId:t.clientId,utilityId:t.utilityId,ClientAdditionalId:t.ClientAdditionalId}}):t._e()],1)},Vn=[],Hn=function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-popups"},[e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header ui-draggable-handle d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("AdditionalInfo")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("dynamic-form",{ref:"AdditionalInfoForm",attrs:{lang:"en",buttons:t.buttons,schema:t.FormSchema},on:{OnSubmit:t.onSubmit},scopedSlots:t._u([{key:"tgslot-Description",fn:function({data:t}){}}])})],1)])])])])},jn=[],qn={props:{clientId:{type:Number,required:!1},ClientAdditionalId:{type:Number,required:!1},cdcId:{type:Number,required:!1},utilityId:{type:Number,required:!1}},data(){return{FormSchema:[{layoutType:"triple",Data:[{astype:"SelectField",label:this.$t("Division"),name:"Division",value:"",config:{options:[]},placeholder:"Select",validationRules:{required:!0}},{astype:"CustomSelectField",label:this.$t("State"),name:"State",value:"",placeholder:"",visibility:!0,config:{options:[],onChange:this.onChangeState},placeholder:"Select",validationRules:{required:!0}},{astype:"SelectField",label:this.$t("sba_id"),name:"sba_id",value:"",config:{options:[]},placeholder:"Select",validationRules:{required:!1}}]},{layoutType:"triple",Data:[{astype:"TextField",label:this.$t("cdc_code"),name:"cdc_code",value:"",placeholder:"",validationRules:{required:!0,max:100}},{astype:"CheckBoxField",label:this.$t("IsWireCenter"),name:"IsWireCenter",value:"",config:{options:[{name:"",value:"true"}],onChange:this.onChangeWireCenter},validationRules:{required:!1}},{astype:"TextField",label:this.$t("Abbreviations"),name:"Abbreviations",value:"",placeholder:"",validationRules:{required:!1,max:100}}]},{layoutType:"triple",Data:[{astype:"CheckBoxField",label:this.$t("IsCountyDependent"),name:"IsCountyDependent",value:"",config:{options:[{name:"",value:"true"}],onChange:this.onChangeCountyDependent},validationRules:{required:!1}},{astype:"CustomSelectField",label:this.$t("County"),name:"County",mode:"tag",value:"",disabled:!0,config:{options:[]},placeholder:"Select",validationRules:{required:!1}},{astype:"CheckBoxField",label:this.$t("IsAH"),name:"IsAH",value:"",config:{options:[{name:"",value:"true"}]},validationRules:{required:!1}}]},{layoutType:"single",Data:[{astype:"CheckBoxField",label:this.$t("UseDistrictMapping"),name:"UseDistrictMapping",value:"",config:{options:[{name:"",value:"true"}]},validationRules:{required:!1}}]}],buttons:[{type:"submit",class:"btn btn-success save",text:"<i class='fa fa-save pr-2'></i>Submit"},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Cancel",onClick:this.Close}],stateList:[],sbaList:[],countyList:[],countydData:[]}},created:async function(){var t=this;await t.getDropdownList("CDC_DIVISION_LIST_BY_CLIENT_ID"),await t.getDropdownList("SBA_LIST_BY_CLIENT_ID"),await t.getDropdownList("UTILITY_STATE_LIST_BY_COUNTRY_ID"),0!=t.cdcId&&await t.GetSelectedWorkCode()},methods:{GetDDLCounty:function(t){var e=this,a=e.stateList.find(e=>e.value==t),i=a?a.first_value:null;let s="id=&moduleName=Billing&type=UTILITY_COUNTY_BY_STATE_ID&search=&refId="+i;n["a"].GetDDLData(s).then(t=>{""!=t.data&&null!=t.data&&(t.data.DATA.length>0&&(e.countyList=t.data.DATA),e.$refs.AdditionalInfoForm.UpdateKeyValue())})},onChangeState:function(t,e,a){var i=this,s=a.value,l=i.stateList.find(t=>t.value==s),o=l?l.first_value:null;let r="id=&moduleName=Billing&type=UTILITY_COUNTY_BY_STATE_ID&search=&refId="+o;n["a"].GetDDLData(r).then(t=>{""!=t.data&&null!=t.data&&(t.data.DATA.length>0&&(i.$refs.AdditionalInfoForm.updateProperty("County","value",""),i.countyList=t.data.DATA,i.$refs.AdditionalInfoForm.updateProperty("County","config.options",t.data.DATA)),i.$refs.AdditionalInfoForm.UpdateKeyValue())})},GetSelectedWorkCode:async function(){var t=this,e="CDC_Code_Id="+t.cdcId;await n["a"].GetCdcCodeListById(e).then((function(e){""!=e.data&&null!=e.data&&e.data.length>0&&(t.GetDDLCounty(e.data[0].state),t.$refs.AdditionalInfoForm.updateProperty("Division","value",e.data[0].division_id),t.$refs.AdditionalInfoForm.updateProperty("State","value",e.data[0].state),t.$refs.AdditionalInfoForm.updateProperty("sba_id","value",e.data[0].be_sba_id),t.$refs.AdditionalInfoForm.updateProperty("cdc_code","value",e.data[0].cdc_code),t.$refs.AdditionalInfoForm.updateProperty("IsWireCenter","value",e.data[0].iswirecenter),t.$refs.AdditionalInfoForm.updateProperty("Abbreviations","value",e.data[0].abbreviations),t.$refs.AdditionalInfoForm.updateProperty("IsCountyDependent","value",e.data[0].is_county_dependent),t.$refs.AdditionalInfoForm.updateProperty("IsAH","value",e.data[0].isah),t.$refs.AdditionalInfoForm.updateProperty("UseDistrictMapping","value",e.data[0].use_district_mapping),1==e.data[0].is_county_dependent?t.$refs.AdditionalInfoForm.updateProperty("County","disabled",!1):t.$refs.AdditionalInfoForm.updateProperty("County","disabled",!0),1==e.data[0].iswirecenter?t.$refs.AdditionalInfoForm.updateProperty("Abbreviations","disabled",!0):t.$refs.AdditionalInfoForm.updateProperty("Abbreviations","disabled",!1),setTimeout((function(){var a=e.data[0].county_id;if(!t.isBlank(a)){var i=[],s=a.split(",").map(t=>t.trim());t.countydData=t.countyList.filter(t=>s.includes(t.value.toString())),t.countydData.forEach(t=>{i.push({value:t.value,label:t.name})}),t.$refs.AdditionalInfoForm.updateProperty("County","value",i)}}),500),t.$refs.AdditionalInfoForm.UpdateKeyValue())}))},getDropdownList:async function(t){var e=this;let a="";a="CDC_DIVISION_LIST_BY_CLIENT_ID"==t||"SBA_LIST_BY_CLIENT_ID"==t?`id=&moduleName=Billing&type=${t}&search=&refId=${e.clientId}`:`id=&moduleName=Billing&type=${t}&search=&refId=223`,await n["a"].GetDDLData(a).then(a=>{""!=a.data&&null!=a.data&&("CDC_DIVISION_LIST_BY_CLIENT_ID"==t?e.$refs.AdditionalInfoForm.updateProperty("Division","config.options",a.data.DATA):"SBA_LIST_BY_CLIENT_ID"==t?(e.sbaList=a.data.DATA,e.$refs.AdditionalInfoForm.updateProperty("sba_id","config.options",a.data.DATA)):(e.stateList=a.data.DATA,e.$refs.AdditionalInfoForm.updateProperty("State","config.options",a.data.DATA)),e.$refs.AdditionalInfoForm.UpdateKeyValue())})},onChangeCountyDependent:function(t,e,a){var i=this,s=e.value[0];"true"==s?i.$refs.AdditionalInfoForm.updateProperty("County","disabled",!1):i.$refs.AdditionalInfoForm.updateProperty("County","disabled",!0),i.$refs.AdditionalInfoForm.UpdateKeyValue()},onChangeWireCenter:function(t,e,a){var i=this,s=e.value[0];"true"==s?i.$refs.AdditionalInfoForm.updateProperty("Abbreviations","disabled",!0):i.$refs.AdditionalInfoForm.updateProperty("Abbreviations","disabled",!1),i.$refs.AdditionalInfoForm.UpdateKeyValue()},Close:function(){this.$parent.isAddCdcCode=!1,this.$parent.FetchRecords()},onSubmit:function(t,e){var a=this;let i="",s="",l=Array.isArray(t.County)?t.County:[t.County];const o=l.map(t=>t.value);let r=a.countyList.filter(t=>o.includes(t.value));i=r.map(t=>t.value).join(","),s=r.map(t=>t.name).join(",");var c=a.sbaList.find(e=>e.value==t.sba_id),d=c?c.name:null,u={cdcId:a.cdcId,cdcCode:t.cdc_code,sbaId:d,state:t.State.value,additionalId:a.ClientAdditionalId,clientId:a.clientId,utilityId:a.utilityId,abbreviations:t.Abbreviations,isah:!!t.IsAH[0],isWireCenter:!!t.IsWireCenter[0],divisionId:t.Division,beSbaId:t.sba_id,isCountyDependent:!!t.IsCountyDependent[0],countyId:i,useDistrictMapping:!!t.UseDistrictMapping[0],districtId:0,countyName:s},p=JSON.stringify(u);n["a"].SaveCDCCodeInfo(p).then(t=>{null!=t.data&&""!=t.data&&"Success"==t.data.status?"INSERT"==t.data.result?(a.ShowAlert(a.$t("AddedSuccess",[a.$t("cdc_code")]),"success",!0,a.$t("Alert")),a.Close()):"UPDATE"==t.data.result?(a.ShowAlert(a.$t("UpdatedSuccess",[a.$t("cdc_code")]),"success",!0,a.$t("Alert")),a.Close()):"ALREADY EXIST"==t.data.result&&a.ShowAlert(a.$t("AlreadyExists",[a.$t("cdc_code")]),"failure",!0,a.$t("Alert")):a.ShowAlert(a.$t("UnknownErrorOccur"),"failure",!0,a.$t("Alert"))})}}},zn=qn,Wn=Object(d["a"])(zn,Hn,jn,!1,null,null,null),Jn=Wn.exports,Kn={components:{ModalAddCdcCode:Jn},props:{utilityId:{type:Number,required:!1},clientId:{type:Number,required:!1},ClientAdditionalId:{type:Number,required:!1}},data(){return{noRecords:!1,TotalRecords:0,isLoading:!1,CurrentPage:1,TotalPages:0,Headers:[{COLUMN_NAME:"CDC_CODE",DATA_TYPE:"string",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"CDC Code",DISPLAY_ORDER:1},{COLUMN_NAME:"SBA_NAME",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"SBA Id",DISPLAY_ORDER:2},{COLUMN_NAME:"STATE",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"State",DISPLAY_ORDER:3},{COLUMN_NAME:"ABBREVIATIONS",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Abbreviations",DISPLAY_ORDER:4},{COLUMN_NAME:"ISAH",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Is After Hour",DISPLAY_ORDER:5},{COLUMN_NAME:"ISWIRECENTER",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Is Wire Center",DISPLAY_ORDER:6},{COLUMN_NAME:"DIVISION_NAME",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Invoice Grouping",DISPLAY_ORDER:7},{COLUMN_NAME:"Edit",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Edit",DISPLAY_ORDER:8,settings:{isInSlot:!0}},{COLUMN_NAME:"STATUS_NAME",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Status",DISPLAY_ORDER:9,settings:{isInSlot:!0}}],SortBy:"",SortExp:"",PageSize:"10",PageNumber:"1",GroupStart:1,GroupEnd:3,CdcCodeListing:[],listheaderbuttons:[{title:"Add New",iconClass:"fa fa-plus",callbackfunction:"Add",additionalClass:"",isdisabled:!1,isvisible:!0,checkPrivilege:!1},{title:"Delete",iconClass:"fa fa-trash",callbackfunction:"Delete",additionalClass:"",isdisabled:!0,isvisible:!0,checkPrivilege:!1,isEnabledOnSelectedRow:!0}],isAddCdcCode:!1,cdcId:0}},created:async function(){var t=this;await t.FetchRecords()},methods:{commonHeaderButtonClick(t){switch(t.callbackfunction){case"Add":this.AddNew();break;case"Delete":this.DeleteCdc();break}},AddNew:function(){var t=this;t.cdcId=0,t.isAddCdcCode=!0},EditCdcCode:function(t){var e=this;e.cdcId=t.CDC_ID,e.isAddCdcCode=!0},DeleteCdc:function(t){var e=this,a="";$(".chkItems:checkbox:checked").not("[id^='chkAll']").each((function(){a.length>0&&(a+=","),a+=$(this).val()})),a.length>0?e.confirmR(e.$t("ConfirmDelete"),!0,e.$t("Delete")+"  "+e.$t("cdc_code"),(function(){var t={ids:a,companyId:e.companyId,userId:e.user_id,moduleName:"Billing",refCode:"TALYGEN_BE_CDC_CODE_INFO"},i=JSON.stringify(t);n["a"].CommonCommonDelete(i).then(t=>{200==t.status?(e.FetchRecords(),e.ShowAlert(e.$t("DeletedSuccess",[e.$t("cdc_code")]),"Success",!0,e.$t("Alert"))):e.ShowAlert(e.$t("DeletedError",[e.$t("cdc_code")]),"failure",!0,e.$t("Alert"))})})):e.ShowAlert(e.$t("Selectanyrecordtodelete",[e.$t("cdc_code")]),"failure",!0,e.$t("Alert"))},ChangeCdcStatus:function(t){var e=this;e.isLoading=!0;let a=0;a="Active"==t.STATUS_NAME?1002:1001;var i=`id=${t.CDC_ID}&statusId=${a}`;n["a"].UpdateCDCCodeStatus(i).then(t=>{"success"==t.data.msg?(e.ShowAlert(e.$t("CDCCodeStatusUpdated"),"success",!0,e.$t("Alert")),e.FetchRecords()):e.ShowAlert(e.$t("ErrorWhileProcessingRequest"),"failure",!0,e.$t("Alert")),e.isLoading=!1})},FetchRecords:async function(){var t=this,e=`clientId=${t.clientId}&clientAdditionalId=${t.ClientAdditionalId}&sortBy=${t.SortBy}&sortExp=${t.SortExp}&pageSize=${t.PageSize}&pageNumber=${t.PageNumber}`;await n["a"].GetCdcCodeListing(e).then((function(e){""!=e.data&&null!=e.data&&null!=e.data.cdcCodeListing?(t.CdcCodeListing=JSON.parse(e.data.cdcCodeListing),t.TotalRecords=JSON.parse(e.data.cdcCodeListing)[0].TOTAL,t.TotalPages=Math.ceil(t.TOTAL/t.PageSize),t.CurrentPage=t.PageNumber,t.noRecord=!1):(t.noRecord=!0,t.TotalRecords=0,t.CdcCodeListing=[])}))},pagerMethod:function(t){this.PageSize=t.PageSize,this.PageNumber=t.PageNumber,this.FetchRecords()},sortdata:function(t){this.SortBy=t;var e="ASC";"ASC"==this.SortExp&&(e="DESC"),this.SortExp=e,this.SortBy=t,this.SortExp=e,this.PageNumber=1,this.GroupStart=this.PageNumber,this.GroupEnd=this.PageNumber+2,this.FetchRecords()},Close:function(){this.$parent.isCdcCodeList=!1,this.$parent.$parent.LoadAdditionalInfo()}}},Qn=Kn,Zn=Object(d["a"])(Qn,Yn,Vn,!1,null,null,null),Xn=Zn.exports,tl=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header ui-draggable-handle d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("UtilityInfo"))+" ")]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("tg-list",{attrs:{IsShowAction:!0,ModuleName:"Company",SubModuleCode:"",LegendArray:[],HeaderText:t.$t("Meter"),isShowHeaderText:!1,RenderRowActionMethod:t.renderActions,widgets:[],IdentityColumn:"meter_mapping_id",listType:["List"],ListData:t.ListingData,HeaderData:t.Headers,HeaderButtons:t.listheaderbuttons,TotalRecords:t.TotalRecords,ListDataCallBackFunction:t.FetchData,showCheckBox:!1,SortExp:t.SortExp,SortBy:t.SortBy,NorecordfoundText:t.$t("NoRecordfound")},on:{ActionButtonClick:t.actionButtonClick,LeftsearchButtonClick:function(t){},PagerButtonClick:t.pagerMethod,HeaderButtonClick:t.commonHeaderButtonClick,SortdataButtonClick:t.sortdata},scopedSlots:t._u([{key:"slotdata",fn:function({data:a}){return["SNo"==a.column.COLUMN_NAME?[e("span",[t._v(" "+t._s(a.row.SNo)+" ")])]:t._e(),"date_Of_installation"==a.column.COLUMN_NAME?[e("span",{staticClass:"text-center single-action tourguide_a"},[t._v(" "+t._s(t.$options.filters.formatDate(a.row.date_Of_installation))+" ")])]:t._e(),"status_id"==a.column.COLUMN_NAME?[1001==a.row.status_id?e("span",{staticClass:"px-2 text-center text-white d-block bg-success",attrs:{title:t.$t("Active")}},[t._v(t._s(t.$t("Active"))+" ")]):e("span",{staticClass:"px-2 bg-danger text-center text-white d-block",attrs:{title:t.$t("InActive")}},[t._v(t._s(t.$t("InActive"))+" ")])]:t._e(),"property"==a.column.COLUMN_NAME?[e("span",{attrs:{title:t.getFullAddress(a.row)}},[t._v(" "+t._s(a.row.property)+" ")])]:t._e(),"contract_name"==a.column.COLUMN_NAME?[null!=a.row.contract_name?e("span",[t._v(t._s(a.row.contract_name))]):e("span",[t._v("--")])]:t._e(),"invoice_grouping_name"==a.column.COLUMN_NAME?[null!=a.row.invoice_grouping_name?e("span",[t._v(t._s(a.row.invoice_grouping_name))]):e("span",[t._v("--")])]:t._e(),"billing_status_id"==a.column.COLUMN_NAME?["BILLING_PENDING"==a.row.billing_status_code?e("span",{staticClass:"px-2 text-center text-white d-block bg-info",attrs:{title:t.$t("Pending")}},[t._v(t._s(t.$t("Pending"))+" ")]):t._e(),"BILLING_START"==a.row.billing_status_code?e("span",{staticClass:"px-2 text-center text-white d-block bg-success",attrs:{title:t.$t("Started")}},[t._v(t._s(t.$t("Started"))+" ")]):t._e(),"BILLING_STOP"==a.row.billing_status_code?e("span",{staticClass:"px-2 text-center text-white d-block bg-danger",attrs:{title:t.$t("Stopped")}},[t._v(t._s(t.$t("Stopped"))+" ")]):t._e()]:t._e(),"plan_name"==a.column.COLUMN_NAME?[e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.OpenPlanDetail(a.row)}}},[e("i",{attrs:{"aria-hidden":"true"}}),t._v(" "+t._s(a.row.plan_name)+" ")])]:t._e(),"serial_number"==a.column.COLUMN_NAME?[e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.OpenMeterDetail(a.row)}}},[e("i",{attrs:{"aria-hidden":"true"}}),t._v(" "+t._s(a.row.serial_number)+" ")])]:t._e()]}}])})],1)])])])],1),t.isAddMeter?e("ModalAddMeter",{attrs:{reqFrom:t.reqFrom,ClientId:t.clientId,ClientData:t.ClientData,utilityTypeId:t.utilityTypeId,ClientAdditionalId:t.ClientAdditionalId,editMeterDetail:t.editMeterDetail,meterMappingId:t.meterMappingId}}):t._e(),t.IsReplace?e("ReplaceMeter",{attrs:{SerialNo:t.SerialNo,MeterId:t.MeterId,MeterMappingId:t.MeterMappingId}}):t._e(),t.IsHistory?e("ViewHistory",{attrs:{MeterMappingId:t.MeterMappingId}}):t._e(),t.IsSaveDate?e("SaveBillingDate",{attrs:{MeterMappingId:t.MeterMappingId,statusId:t.SelectedStatusId,StartBillingDate:t.StartBillingDate,InstallationDate:t.InstallationDate},on:{billingSaved:t.onBillingSaved}}):t._e(),t.isViewPlanDetailsUtilityCase?e("ModalViewPlanDetails",{attrs:{PlanId:t.PlanId,ClientId:t.ClientId,PlanMappingId:t.c},on:{close:function(e){t.isViewPlanDetailsUtilityCase=!1}}}):t._e(),e("transition",{attrs:{name:"modal"}},[e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),t.IsShowMeterDetail?e("div",{staticClass:"modal d-block dialog"},[e("div",{staticClass:"modal-dialog modal-lg"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("MeterDetails")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.CloseTemplate}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"heading-border"},[e("h5",{staticClass:"h5 mb-4"},[e("span",[t._v(" "+t._s(t.$t("MeterName"))+": "+t._s(t.editMeterDetail.meter_name||"--"))]),e("small",{staticClass:"float-right"},[1001==t.editMeterDetail.status_id?e("span",{staticClass:"bg-success rounded answer rightlabeltext ml-1 px-3 text-white font-14 py-1",staticStyle:{"border-bottom":"none"}},[t._v(t._s(t.$t("Active")))]):e("span",{staticClass:"bg-danger rounded answer rightlabeltext ml-1 px-3 text-white font-14 py-1",staticStyle:{"border-bottom":"none"}},[t._v(t._s(t.$t("Inactive"))+" ")])])])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("SerialNumber"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s(t.editMeterDetail.serial_number||"--"))])])])]),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("MeterType"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s(t.editMeterDetail.meter_service||"--"))])])])]),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("Plan"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s(t.editMeterDetail.plan_name||"--"))])])])]),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("InstallationDate"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s(t.editMeterDetail.date_Of_installation?t.$options.filters.formatDate(t.editMeterDetail.date_Of_installation):"--"))])])])]),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("BillingStartDate"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s(t.$options.filters.formatDate(t.editMeterDetail.billing_start_date)||"--"))])])])]),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("ModelName"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s(t.editMeterDetail.model_name||"--"))])])])]),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("MeterService"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s(t.editMeterDetail.meter_service||"--"))])])])]),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("SanctionedLoad"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s(t.editMeterDetail.sanctioned_load||"--"))])])])]),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("MultiplyFactor"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s(t.editMeterDetail.multiply_factor||"--"))])])])]),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("PowerFactor"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s(t.editMeterDetail.power_factor||"--"))])])])]),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("VoltageRating"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s(t.editMeterDetail.volate_rating||"--"))])])])]),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("CurrentRating"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s(t.editMeterDetail.current_rating||"--"))])])])]),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("BillingStatus"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s("BILLING_STOP"===t.editMeterDetail.billing_status_code?"Stopped":"BILLING_START"===t.editMeterDetail.billing_status_code?"Started":(t.editMeterDetail.billing_status_code,"Pending")))])])])]),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("ConnectionType"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s(t.editMeterDetail.connection_type||"--"))])])])]),"Temporary"==t.editMeterDetail.connection_type?e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("TentativeEndDate"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s(t.editMeterDetail.tentative_end_date?t.$options.filters.formatDate(t.editMeterDetail.tentative_end_date):"--"))])])])]):t._e(),e("div",{staticClass:"col-md-4"},[e("div",{staticClass:"form-group"},[e("label",[e("strong",[t._v(" "+t._s(t.$t("Property"))+":")]),e("span",{staticClass:"answer rightlabeltext ml-1"},[t._v(" "+t._s(t.editMeterDetail.property||"--"))])])])])])]),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-danger",on:{click:t.CloseTemplate}},[e("em",{staticClass:"fa fa-times pr-2",attrs:{"aria-hidden":"true"}}),t._v(" "+t._s(t.$t("Cancel"))+" ")])])])])]):t._e()],1)])],1)},el=[],al={components:{ReplaceMeter:Ai,ViewHistory:xi,ModalAddMeter:Wi,SaveBillingDate:$i,ModalViewPlanDetails:He},props:{clientId:{type:Number},ClientData:{type:Object},ClientAdditionalId:{type:Number,required:!1},utilityTypeId:{type:Number,required:!1}},data(){return{TotalRecords:0,noRecord:!1,isLoading:!1,CompanyId:null,PageSize:10,statusId:"",PageNumber:1,isPaged:1,TotalPages:0,widgets:[],SortBy:"",SortExp:"",ProjectName:"",taskId:"",listActions:gi.listActions,Headers:gi.TableHeader,ListingData:[],searchCondition:"",Buttons:gi.buttons,QuotesListingSchema:!1,IsReplace:!1,SerialNo:null,MeterId:null,isAddMeter:!1,reqFrom:"",IsHistory:!1,listheaderbuttons:[{title:"Add",iconClass:"fa fa-plus",callbackfunction:"Add",additionalClass:"",isdisabled:!1,isvisible:!0,checkPrivilege:!1}],editMeterDetail:[],SelectedStatusId:null,IsSaveDate:!1,isViewPlanDetailsUtilityCase:!1,IsShowMeterDetail:!1,StartBillingDate:"",InstallationDate:""}},created:async function(){this.CompanyId=this.GetUserInfo.CompanyId,this.user_Id=this.GetUserInfo.ID,this.FetchData()},methods:{EditMeter:function(t){var e=this;e.utilityTypeId=t.meter_type_id,e.meterMappingId=t.meter_mapping_id,e.ClientAdditionalId=t.client_additional_id,e.editMeterDetail=t,e.reqFrom="Edit",e.isAddMeter=!0},getFullAddress(t){return`${t.user_address_1}, ${t.user_city}, ${t.user_state}, ${t.user_zipcode}, India`},commonHeaderButtonClick(t){switch(t.callbackfunction){case"Add":this.AddMeter();break}},AddMeter:function(){var t=this;t.isAddMeter=!0,t.reqFrom="Add",t.meterMappingId=0},FetchData:async function(){var t=this;t.isLoading=!0;var e=`clientId=${t.clientId}&clientAdditionalId=${t.ClientAdditionalId}`;t.isBlank(this.searchCondition)||(e+="&search="+this.searchCondition),await n["a"].GetMapMeterById(e).then((function(e){e.data?e.data.length>0?(t.isLoading=!1,t.ListingData=e.data,t.noRecord=!1,t.TotalRecords=e.data[0].TOTAL_RECORDS):(t.ListingData=[],t.noRecord=!0,t.TotalRecords=0,t.isLoading=!1):(t.noRecord=!0,t.isLoading=!1,t.ListingData=[],t.TotalRecords=0)}))},leftCommonSearch:function(t){if(this.PageNumber=t.PageNumber,this.isPaged=1,"undefined"!=typeof t.searchCondition)if(""!=t.searchCondition){let e=t.searchConditionJson,a=e.split("=")[1];this.searchCondition=a}else this.searchCondition="";else this.searchCondition="";this.FetchData()},renderActions:function(t){var e=this;let a=[];return e.listActions.forEach(e=>{let i={...e};switch(i.title){case"Delete":"BILLING_START"==t.billing_status_code?i.isVisible=!1:i.isVisible=!0;break;case"Replace":1001==t.status_id?i.isVisible=!0:i.isVisible=!1;break;case"View History":1002==t.status_id?i.isVisible=!0:i.isVisible=!1;break;case"Start Billing":"BILLING_PENDING"==t.billing_status_code||"BILLING_STOP"==t.billing_status_code?i.isVisible=!0:i.isVisible=!1;break;case"Stop Billing":"BILLING_START"==t.billing_status_code?i.isVisible=!0:i.isVisible=!1;break;case"Edit Meter":i.isVisible=!0;break;default:i.isVisible=!0}a.push(i)}),a},formatDate:function(t){return t?E()(t).format("MMMM Do, YYYY"):""},pagerMethod:function(t){this.PageSize=t.PageSize,this.PageNumber=t.PageNumber,this.FetchData()},actionButtonClick:function(t,e){switch(t){case"Delete":this.DeleteMultiple(e);break;case"Replace":this.ReplaceMeter(e);break;case"ViewHistory":this.ViewHistory(e);break;case"StartBilling":this.StartBilling(e);break;case"StopBilling":this.StopBilling(e);break;case"EditMeter":this.EditMeter(e);break}},onBillingSaved({meterMappingId:t,billingStartDate:e,statusId:a}){const i={meterMappingId:t,statusId:a,billingStartDate:e};this.UpdateBillingStatus(i)},UpdateBillingStatus(t){this.isLoading=!0,n["a"].UpdateMeterBillingStatus(t).then(t=>{var e;null!==(e=t.data)&&void 0!==e&&e.success?(this.ShowAlert(this.$t("UpdatedSuccessfully"),"Success",!0,this.$t("Alert")),this.FetchData()):this.ShowAlert(this.$t("UpdateFailed"),"Failure",!0,this.$t("Alert"))}).catch(t=>{console.error(t),this.ShowAlert(this.$t("UpdateFailed"),"Failure",!0,this.$t("Alert"))}).finally(()=>{this.isLoading=!1,this.IsSaveDate=!1})},StartBilling(t){var e=this;e.MeterMappingId=t.meter_mapping_id,e.SelectedStatusId=t.billing_changed_status_id,e.StartBillingDate=t.billing_start_date,e.InstallationDate=t.date_Of_installation,e.IsSaveDate=!e.IsSaveDate},StopBilling(t){const e={meterMappingId:t.meter_mapping_id,statusId:t.billing_changed_status_id,billingStartDate:null};this.UpdateBillingStatus(e)},ReplaceMeter:function(t){var e=this;e.SerialNo=t.serial_number,e.MeterId=t.asset_catalogue_id,e.MeterMappingId=t.meter_mapping_id,e.IsReplace=!e.IsReplace},ViewHistory:function(t){var e=this;e.MeterMappingId=t.meter_mapping_id,e.IsHistory=!e.IsHistory},DeleteMultiple:function(t){var e=this,a="";a+=t.meter_mapping_id,a.length>0&&e.confirmR(e.$t("ConfirmDelete"),!0,e.$t("Delete")+"  "+e.$t("Meter"),(function(){let t=`ids=${a}&tableName=talygen_meter_mapping&primaryKey=meter_mapping_id`;n["a"].Delete(t).then(t=>{t.data?($("[id^='chkAll']").prop("checked",!1).removeAttr("checked"),$(".chkItems:checkbox:checked").prop("checked",!1).removeAttr("checked"),e.ShowAlert(e.$t("DeletedSuccessfully"),"Success",!0,e.$t("Alert"))):e.ShowAlert(e.$t("DeletedError",[e.$t("val")]),"failure",!0,e.$t("Alert")),e.FetchData()})}))},OpenPlanDetail(t){var e=this;e.viewDetails(t)},async viewDetails(t){var e=this;e.PlanId=t.plan_id,e.PlanMappingId=t.plan_mapping_id,e.isViewPlanDetailsUtilityCase=!0},OpenMeterDetail(t){var e=this;e.editMeterDetail=t,e.IsShowMeterDetail=!0},CloseTemplate:function(){var t=this;t.IsShowMeterDetail=!1},sortdata:function(t){var e="sort tb_headerSortDown";this.SortBy=t,t===this.SortBy&&(""==this.SortExp?(this.SortExp="ASC",e="sort tb_headerSortDown"):"ASC"==this.SortExp?(this.SortExp="DESC",e="sort tb_headerSortUp"):(this.SortExp="ASC",e="sort tb_headerSortDown")),this.FetchData(),$("#"+t+"  span:first-child").attr("class",e)},Close:function(){var t=this;t.$parent.isMeterList=!1,t.$parent.$parent.LoadAdditionalInfo()}}},il=al,sl=Object(d["a"])(il,tl,el,!1,null,null,null),nl=sl.exports,ll={components:{ModalAddUtilityTime:Gn,CdcCodeList:Xn,AddNoteUtilityOrDivision:ti,UtilityMeterMapping:nl},props:{UserId:{type:Number},ClientData:{type:Object},IsAdditionalInfoDataShow:{type:Boolean},AdditionalInfoData:{type:Array}},data(){return{isLoading:!1,CompanyId:null,UserId:null,Result:[],invoiceFrequencyCustomDate:[],invoiceTypeList:[],projectList:[],invoiceDetailTemplateList:[],fileFormatList:[],configNotes:"",isAssociateProjectWithDivision:!1,isShowWorkdayInvoiceType:!1,isShowAddNoteDivision:!1,divisionId:0,clientId:0,utilityId:0,AdditionalInfoData:[],databaseList:[],districtList:[],isShowAddUtilityTime:!1,ClientAdditionalId:0,isCdcCodeList:!1,isCheckExtraFeatureUtilityBilling:!1,isCheckExtraFeatureUSICBILLING:!1,utilityTypeList:[],isMeterList:!1,utilityTypeId:0}},created:async function(){var t=this;t.CompanyId=t.GetUserInfo.CompanyId,await t.CheckFeaturesForCompany("USICBILLING"),await t.CheckFeaturesForCompany("UTILITY_BILLING"),t.isCheckExtraFeatureUSICBILLING&&(await t.getDatabaseOrDistrictList("DATABASE_LIST"),await t.getDatabaseOrDistrictList("BILLING_DISTRICT_LIST")),t.isCheckExtraFeatureUtilityBilling&&await t.getDatabaseOrDistrictList("UTILITY_TYPE_FOR_BILLING"),await t.GetUtilityMappingDetail()},methods:{removeError(t,e){t._validation&&(t._validation[e]=!1)},Reset:function(){var t=this;t.$parent.LoadAdditionalInfo()},CheckFeaturesForCompany:async function(t){var e=this,a="featureCode="+t;await n["a"].CheckExtraFeatures(a).then((function(a){"USICBILLING"==t?1==a.data?e.isCheckExtraFeatureUSICBILLING=!0:e.isCheckExtraFeatureUSICBILLING=!1:"UTILITY_BILLING"==t&&(1==a.data?e.isCheckExtraFeatureUtilityBilling=!0:e.isCheckExtraFeatureUtilityBilling=!1)}))},ViewMeterList:function(t){var e=this;e.utilityTypeId=t.utilityTypeId,e.ClientAdditionalId=t.clientAdditionalId,e.clientId=this.UserId,e.isMeterList=!0},ViewCDCCodeList:function(t){var e=this;e.ClientAdditionalId=t.clientAdditionalId,e.clientId=this.UserId,e.utilityId=t.clientAdditionalId,e.isCdcCodeList=!0},NoteDataByUtility:function(t){var e=this;e.utilityId=t.clientAdditionalId,e.clientId=this.UserId,e.isShowAddNoteDivision=!0},AddTime:function(t){var e=this;e.ClientAdditionalId=t.clientAdditionalId,e.isShowAddUtilityTime=!0},getDatabaseOrDistrictList:async function(t){var e=this;let a=`id=&moduleName=Billing&type=${t}&search=&refId=`;await n["a"].GetDDLData(a).then(a=>{""!=a.data&&null!=a.data&&("DATABASE_LIST"==t?e.databaseList=a.data.DATA:"UTILITY_TYPE_FOR_BILLING"==t?e.utilityTypeList=a.data.DATA:e.districtList=a.data.DATA)})},GetUtilityMappingDetail:async function(){await n["a"].GetUtilityMappingDetail().then(t=>{null!=t.data&&(this.configNotes=t.data.getNotesByCompanyId)})},ViewNotes:function(t){var e=this;e.divisionId=t.DIVISIONS_ID,e.clientId=this.UserId,e.isShowAddNoteDivision=!0},async CheckExtraFeatures(t){const e="featureCode="+t;try{const a=await n["a"].CheckExtraFeatures(e);a.data&&("AssociateProjectWithDivision"==t?this.isAssociateProjectWithDivision=!0===a.data:this.isShowWorkdayInvoiceType=!0===a.data)}catch(a){console.error("Error checking extra features:",a)}},RemoveInvoice(t,e){var a=this;const i=a.isCheckExtraFeatureUtilityBilling?"UTILITY_BILLING":"USIC_BILLING";var s=a.$t("ConfirmDelete");a.confirmR(s,!0,null,(function(){if(a.AdditionalInfoData.splice(t,1),0!=e){var s={ids:e,companyId:a.CompanyId,userId:a.user_id,moduleName:"Billing",refCode:"TALYGEN_CLIENT_ADDITIONAL_INFO"},l=JSON.stringify(s);n["a"].CommonCommonDelete(l).then(t=>{200==t.status?(a.$parent.LoadAdditionalInfo(),"UTILITY_BILLING"==i?a.ShowAlert(a.$t("DeletedSuccess",[a.$t("TalygenUtility")]),"success",!0,a.$t("Alert")):a.ShowAlert(a.$t("DeletedSuccess",[a.$t("AdditionalInfoClient")]),"Success",!0,a.$t("Alert"))):"UTILITY_BILLING"==i?a.ShowAlert(a.$t("DeletedError",[a.$t("TalygenUtility")]),"failure",!0,a.$t("Alert")):a.ShowAlert(a.$t("DeletedError",[a.$t("AdditionalInfoClient")]),"failure",!0,a.$t("Alert"))})}}))},SaveUtilityData:function(){var t=this;let e=!1;if(t.AdditionalInfoData.forEach(a=>{a._validation||(a._validation={}),a.companyName&&""!==a.companyName.trim()?a._validation.companyName=!1:(a._validation.companyName=!0,e=!0),t.isCheckExtraFeatureUtilityBilling&&(a.utilityTypeId&&""!==a.utilityTypeId?a._validation.utilityTypeId=!1:(a._validation.utilityTypeId=!0,e=!0))}),e)return;const a=t.isCheckExtraFeatureUtilityBilling?"UTILITY_BILLING":"USIC_BILLING";var i=`ClientId=${t.UserId}&ReqFrom=${a}`,s={MainData:t.AdditionalInfoData};n["a"].SaveUtilityData(i,s).then((function(e){"Success"==e.data.status?("UTILITY_BILLING"==a?t.ShowAlert(t.$t("UpdatedSuccess",[t.$t("TalygenUtility")]),"success",!0,t.$t("Alert")):t.ShowAlert(t.$t("UpdatedSuccess",[t.$t("AdditionalInfoClient")]),"success",!0,t.$t("Alert")),t.$parent.LoadAdditionalInfo(),t.GetUtilityMappingDetail(),t.$parent.IsAdditionalInfoDataShow=!1):t.ShowAlert(t.$t("UnknownErrorOccur"),"failure",!0,t.$t("Alert"))}))}}},ol=ll,rl=Object(d["a"])(ol,Mn,$n,!1,null,null,null),cl=rl.exports,dl=function(){var t=this,e=t._self._c;return t.IsPrivilege?e("section",[e("loader",{attrs:{"is-visible":t.isLoading}}),e("tg-list",{ref:"tgList",attrs:{listType:["List"],IsShowAction:!0,showCheckBox:!0,ModuleName:"Tax",SubModuleCode:"TaxCategory",IdentityColumn:"id",HeaderText:t.$t("Property"),ListData:t.ListingData,HeaderData:t.Headers,widgets:t.widgets,HeaderButtons:t.Buttons,TotalRecords:t.TotalRecords,RenderRowActionMethod:t.renderActions,ListDataCallBackFunction:t.GetPropertyList,SortExp:t.SortExp,SortBy:t.SortBy,NorecordfoundText:t.$t("NoRecordfound"),SearchFields:t.leftSearchFields,LegendArray:t.LegendArray},on:{PagerButtonClick:t.pagerMethod,HeaderButtonClick:t.commonHeaderButtonClick,SortdataButtonClick:t.sortdata,LeftsearchButtonClick:t.leftCommonSearch,ActionButtonClick:t.actionButtonClick},scopedSlots:t._u([{key:"slotdata",fn:function({data:a}){return["status_name"==a.column.COLUMN_NAME?[e("a",{staticClass:"inactive-disabled"},[e("span",{staticClass:"text-center text-white d-block",style:{backgroundColor:a.row.status_bg_color}},[t._v(" "+t._s(a.row.status_name)+" ")])])]:t._e(),"meter_count"==a.column.COLUMN_NAME?[e("span",[e("a",{class:{"text-dark text-center":!0,disabled:0==a.row.meter_count},attrs:{id:"ancProjectDetail",href:"javascript:;"},on:{click:function(e){return t.OpenMeterListPopup(a.row.id)}}},[e("i",{staticClass:"fa fa-user",attrs:{"aria-hidden":"true"}}),e("span",{staticClass:"noti-circle noti-blue"},[t._v(t._s(a.row.meter_count))])])])]:t._e(),"property_size"==a.column.COLUMN_NAME?[e("span",[0==a.row.property_size?e("span"):e("span",[t._v(t._s(a.row.property_size))])])]:t._e(),"user_zipcode"==a.column.COLUMN_NAME?[e("span",[0==a.row.user_zipcode?e("span"):e("span",[t._v(t._s(a.row.user_zipcode))])])]:t._e()]}}],null,!1,2912831026)}),t.IsAddProperty?e("AddPropertymodal",{attrs:{ClientData:t.ClientData,ClientId:t.ClientId,AddAddProperty:t.AddAddProperty},on:{CloseAddProperty:t.CloseAddProperty}}):t._e(),t.IsPropertyHistory?e("PropertyHistory",{attrs:{PropertyId:t.PropertyId,PropertyName:t.PropertyName},on:{ClosePropertyHistory:t.ClosePropertyHistory}}):t._e(),t.IsConstructionType?e("ConstructionType",{attrs:{ClientData:t.ClientData,ClientId:t.ClientId,Type:t.IsType,AddAddProperty:t.AddAddProperty},on:{CloseConstructionType:t.CloseConstructionType}}):t._e(),e("transition",{attrs:{name:"modal"}},[e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),t.isMeterMapped?e("div",{staticClass:"modal d-block dialog"},[e("div",{staticClass:"modal-dialog"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("MappedMeter")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.popupClose}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"col-md-12"},[e("div",{staticClass:"listing"},[e("div",{staticClass:"table-responsive table-fix-header"},[e("table",{staticClass:"table table-bordered dt-responsive nowrap mt-0",attrs:{id:"tbl_formList"}},[e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",[e("span",[t._v(t._s(t.$t("MeterType")))])]),e("th",[e("span",[t._v(t._s(t.$t("MeterName")))])]),e("th",[e("span",[t._v(t._s(t.$t("Plan")))])]),e("th",[e("span",[t._v(t._s(t.$t("SerialNumber")))])]),e("th",[e("span",[t._v(t._s(t.$t("ModelName")))])]),e("th",[e("span",[t._v(t._s(t.$t("MeterService")))])]),e("th",[e("span",[t._v(t._s(t.$t("MeterUnit")))])]),e("th",[e("span",[t._v(t._s(t.$t("ConnectionType")))])]),e("th",[e("span",[t._v(t._s(t.$t("Property")))])])])]),e("tbody",[t._l(t.meterList,(function(a,i){return e("tr",[e("td",[t._v(t._s(a.meter_type))]),e("td",[t._v(t._s(a.meter_name))]),e("td",[t._v(t._s(a.plan_name))]),e("td",[t._v(t._s(a.serial_number))]),e("td",[t._v(t._s(a.model_name))]),e("td",[t._v(t._s(a.meter_service))]),e("td",[t._v(t._s(a.meter_unit))]),e("td",[t._v(t._s(a.connection_type))]),e("td",[t._v(t._s(a.property))])])})),null==t.meterList||0==t.meterList.length?e("tr",[e("td",{staticClass:"text-danger text-center",attrs:{colspan:"9"}},[t._v(" "+t._s(t.$t("NoRecordfound"))+" ")])]):t._e()],2)])])])])])])])]):t._e()],1)])],1):e("section",[e("div",{staticClass:"container-fluid mt-2 p-0"},[e("div",{staticClass:"theme-primary"},[e("span",{staticClass:"p-name text-white"},[t._v(t._s(t.$t("Property")))])]),e("div",{staticClass:"border p-2"},[e("div",{staticClass:"col-lg-12 col-sm-12 alert alert-warning text-center mb-1",attrs:{role:"alert"}},[t._v(" "+t._s(t.$t("NotAuthorizedSection"))+" ")])])])])},ul=[];let pl=[{title:"AddProperty",iconClass:"fa fa-plus pr-2 ",callbackfunction:"AddProperty",additionalClass:"",isdisabled:!1,isvisible:!0},{id:"DeleteMultiple",title:"Delete",iconClass:"fa-trash-o",callbackfunction:"commonDeleteData",isdisabled:!0,isvisible:!0,isEnabledOnSelectedRow:!0},{title:"BacktoList",iconClass:"fa fa-angle-double-left",callbackfunction:"BacktoList",additionalClass:"",isdisabled:!1,isvisible:!0}],ml=[{title:"History",href:"javascript:void(0)",callbackfunction:"PropertyHistory",icon:"fa fa-history action-icon",additionalSpan:""},{title:"Update Construction",icon:"fa fa-pencil-square action-icon",additionalSpan:"",callbackfunction:"EditUpdateConstruction"},{title:"Update Type",icon:"fa fa-pencil-square-o action-icon",additionalSpan:"",callbackfunction:"EditUpdateType"},{title:"Delete",href:"javascript:void(0)",callbackfunction:"DeleteTaxClient",icon:"fa fa-trash-o action-icon text-danger",additionalSpan:""}];var hl={buttons:pl,listActions:ml},vl=function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("Property Log"))+" - ("+t._s(t.PropertyName)+")")]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.ClosePropertyHistory}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("tg-list",{ref:"tgList",attrs:{listType:["List"],IsShowAction:!1,showCheckBox:!1,ModuleName:"Property",SubModuleCode:"TaxCategory",IdentityColumn:"id",HeaderText:t.$t("Property"),ListData:t.ListingData,HeaderData:t.Headers,widgets:t.widgets,TotalRecords:t.TotalRecords,ListDataCallBackFunction:t.GetPropertyHistoryList,SortExp:t.SortExp,SortBy:t.SortBy,NorecordfoundText:t.$t("NoRecordfound"),LegendArray:t.LegendArray},on:{PagerButtonClick:t.pagerMethod,SortdataButtonClick:t.sortdata},scopedSlots:t._u([{key:"slotdata",fn:function({data:a}){return["next_modified_date"==a.column.COLUMN_NAME?[e("td",{staticClass:"text-center single-action tourguide_a"},[t._v(" "+t._s(t.$options.filters.formatDateTime(a.row.next_modified_date))+" ")])]:t._e()]}}])})],1)])])])],1)},_l=[],gl={data(){return{isLoading:!1,PageSize:10,PageNumber:1,isPaged:1,TotalPages:0,widgets:[],LegendArray:[],ListingData:[],TotalRecords:0,SortBy:"",SortExp:"",Headers:[{COLUMN_NAME:"property_field",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"property Field",DISPLAY_ORDER:1},{COLUMN_NAME:"old_value",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Old Value",DISPLAY_ORDER:2},{COLUMN_NAME:"new_value",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"New Value",DISPLAY_ORDER:3},{COLUMN_NAME:"full_name",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Changed By",DISPLAY_ORDER:3},{COLUMN_NAME:"next_modified_date",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Changed On",DISPLAY_ORDER:2,settings:{isInSlot:!0}}],Buttons:[],listActions:[],leftSearchFields:null}},props:{PropertyId:{type:Number,required:!0},PropertyName:{type:String,required:!0}},created:function(){var t=this;t.GetPropertyHistoryList()},methods:{ClosePropertyHistory(){var t=this;t.$emit("ClosePropertyHistory")},GetPropertyHistoryList(){var t=this;t.isLoading=!0;var e=`Propertyid=${t.PropertyId}&pageSize=${t.PageSize}&pageNum=${t.PageNumber}&sortBy=${t.SortBy}&sortExp=${t.SortExp}`;n["a"].GetPropertyHistoryList(e).then(e=>{t.isLoading=!1,e.data.result.DATA.length>0?(t.ListingData=e.data.result.DATA,t.TotalRecords=e.data.result.DATA[0].TOTAL_RECORDS,t.TotalPages=Math.ceil(t.TotalRecords/t.PageSize),t.PageNumber=t.PageNumber):(t.ListingData=[],t.TotalRecords=0)})},leftCommonSearch:function(t){},renderActions:function(t){},pagerMethod:function(t){this.PageSize=t.PageSize,this.PageNumber=t.PageNumber,this.GetPropertyHistoryList()},actionButtonClick:function(t,e){},commonHeaderButtonClick:async function(t){},sortdata:function(t){var e="sort tb_headerSortDown";this.SortBy=t,t===this.SortBy&&(""==this.SortExp?(this.SortExp="ASC",e="sort tb_headerSortDown"):"ASC"==this.SortExp?(this.SortExp="DESC",e="sort tb_headerSortUp"):(this.SortExp="ASC",e="sort tb_headerSortDown")),this.GetPropertyHistoryList(),$("#"+t+"  span:first-child").attr("class",e)}}},fl=gl,Cl=Object(d["a"])(fl,vl,_l,!1,null,null,null),yl=Cl.exports,bl=function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content",staticStyle:{"max-width":"800px"}},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("Update"))+" "+t._s(t.HeaderTitle))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.CloseConstructionType}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("dynamic-form",{ref:"AddTaxCategoryForm",attrs:{lang:"en",schema:t.FormSchema,mandatorytext:t.MandatoryString,buttons:t.buttons},on:{OnSubmit:t.OnSubmit}})],1)])])])],1)},Sl=[],Al={props:{ClientId:{type:Number,required:!0},ClientData:{type:Object},AddAddProperty:{type:Object,required:!0},Type:{type:String,required:!0}},data(){return{isLoading:!1,PropertyId:0,MandatoryString:"Fields marked with an asterisk (*) are mandatory.",FormSchema:[{layoutType:"single",group_name:"Property Details",Data:[{astype:"SelectField",label:this.$t("Property Type"),name:"Property Type",value:"",disabled:!1,visibility:!1,config:{options:[]},placeholder:this.$t("Property Type"),validationRules:{required:!0,max:100}},{astype:"SelectField",label:this.$t("Construction Status"),name:"ConstructionStatus",value:"",disabled:!1,visibility:!1,config:{options:[]},placeholder:this.$t("Construction Status"),validationRules:{required:!0,max:100}}]}],buttons:[{type:"submit",class:"btn btn-success",text:"<i class='fa fa-save pr-2'></i>Save"},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Cancel",onClick:this.CloseConstructionType}],HeaderTitle:""}},created:function(){var t=this;"T"==t.Type&&(t.FormSchema[0].Data[0].visibility=!0,t.HeaderTitle="Property Type",t.GetPropertyType()),"C"==t.Type&&(t.FormSchema[0].Data[1].visibility=!0,t.HeaderTitle="Construction Status",t.GetPropertConstructioStauts()),t.BindPropertyDetails()},methods:{CloseConstructionType(){this.$emit("CloseConstructionType")},GetPropertyType(){var t=this,e="id=&moduleName=&type=PROPERTY_TYPE&search=&refId=";n["a"].GetDDLData(e).then(e=>{200==e.status&&(void 0==e.data.DATA&&null==e.data.DATA||e.data.DATA.length>0&&e.data.DATA.forEach(e=>{let a={value:e.value,name:e.name};t.FormSchema[0].Data[0].config.options.push(a),t.$refs.AddTaxCategoryForm.UpdateKeyValue()}))})},GetPropertConstructioStauts(){var t=this,e="id=&moduleName=&type=PROPERTY_CONSTRUCTION_STATUS&search=&refId=";n["a"].GetDDLData(e).then(e=>{200==e.status&&(void 0==e.data.DATA&&null==e.data.DATA||e.data.DATA.length>0&&e.data.DATA.forEach(e=>{let a={value:e.value,name:e.name};t.FormSchema[0].Data[1].config.options.push(a),t.$refs.AddTaxCategoryForm.UpdateKeyValue()}))})},BindPropertyDetails(){var t=this;t.PropertyId=t.AddAddProperty.id,t.FormSchema[0].Data[0].value=t.AddAddProperty.property_type_id,t.FormSchema[0].Data[1].value=t.AddAddProperty.construction_status_id},OnSubmit(){var t=this;t.isLoading=!0,t.$refs.AddTaxCategoryForm.validateForm.validate().then(async e=>{if(e){var a={id:t.PropertyId,property_type_id:t.FormSchema[0].Data[0].value,construction_status_id:t.FormSchema[0].Data[1].value},i=JSON.stringify(a);n["a"].SaveClientProperty(i).then((function(e){t.isLoading=!1,e.data.result.DATA.length>0&&("UPDATE"==e.data.result.DATA[0].VALUE?(t.ShowAlert(t.$t("UpdatedSuccess",[t.$t("Property")]),"success",!0,t.$t("Alert")),t.CloseConstructionType()):"EXISTS"==e.data.result.DATA[0].VALUE?t.ShowAlert(t.$t("AlreadyExists",[t.$t("Property")]),"warning",!0,t.$t("Alert")):(t.ShowAlert(t.$t("AddedSuccess",[t.$t("Property")]),"success",!0,t.$t("Alert")),t.CloseConstructionType()))}))}})}}},Dl=Al,Il=Object(d["a"])(Dl,bl,Sl,!1,null,null,null),Tl=Il.exports,Ll=a("2b0e"),El={components:{AddPropertymodal:Hi,PropertyHistory:yl,ConstructionType:Tl},props:{ClientId:{type:Number,required:!0},ClientData:{type:Object},ChecKPrivilege:{type:Boolean,required:!0}},data(){return{isLoading:!1,PageSize:10,PageNumber:1,isPaged:1,TotalPages:0,widgets:[],LegendArray:[],ListingData:[],TotalRecords:0,SortBy:"",moduleCode:"Billing",SortExp:"",Buttons:hl.buttons,listActions:hl.listActions,leftSearchFields:hl.leftsearchSchema,Headers:[{COLUMN_NAME:"property_title",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Title",DISPLAY_ORDER:1},{COLUMN_NAME:"property_type",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Type",DISPLAY_ORDER:2},{COLUMN_NAME:"property_construction_status",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Construction",DISPLAY_ORDER:3},{COLUMN_NAME:"block_name",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"BlockName",DISPLAY_ORDER:2},{COLUMN_NAME:"floor_name",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"FloorName",DISPLAY_ORDER:3},{COLUMN_NAME:"user_address_1",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"AddressLine1",DISPLAY_ORDER:3},{COLUMN_NAME:"user_address_2",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"AddressLine2",DISPLAY_ORDER:3},{COLUMN_NAME:"user_city",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"City",DISPLAY_ORDER:3},{COLUMN_NAME:"user_state",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"STATE",DISPLAY_ORDER:3},{COLUMN_NAME:"user_zipcode",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"ZIPCODE",DISPLAY_ORDER:3,settings:{isInSlot:!0}},{COLUMN_NAME:"country_name",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"COUNTRY",DISPLAY_ORDER:3},{COLUMN_NAME:"user_address_desc",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"DESCRIPTION",DISPLAY_ORDER:3},{COLUMN_NAME:"property_size_unit",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Unit",DISPLAY_ORDER:3},{COLUMN_NAME:"property_size",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Size",DISPLAY_ORDER:3,settings:{isInSlot:!0}},{COLUMN_NAME:"meter_count",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"MeterMappedCount",DISPLAY_ORDER:3,settings:{isInSlot:!0}},{COLUMN_NAME:"status_name",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Status",DISPLAY_ORDER:3,settings:{isInSlot:!0}}],userId:null,companyId:null,IsAddProperty:!1,AddAddProperty:null,PropertyId:null,PropertyName:"",IsPropertyHistory:!1,isMeterMapped:!1,meterList:[],IsType:"",IsConstructionType:!1,IsPrivilege:!0}},created:function(){var t=this;this.userId=this.GetUserInfo.ID,this.companyId=this.GetUserInfo.CompanyId,t.ChecKPrivilege?(t.IsPrivilege=!0,t.GetPropertyList()):t.IsPrivilege=!1},methods:{popupClose:function(){var t=this;t.isMeterMapped=!1},OpenMeterListPopup:async function(t){var e=this;e.isLoading=!0,e.isMeterMapped=!0;var a=`clientId=${e.ClientId}&propertyId=${t}`;e.isBlank(this.searchCondition)||(a+="&search="+this.searchCondition),await n["a"].GetMapMeterById(a).then((function(t){t.data?t.data.length>0?(e.isLoading=!1,e.meterList=t.data):(e.meterList=[],e.isLoading=!1):e.isLoading=!1}))},GetPropertyList(){var t=this;t.isLoading=!0;var e=`ClientId=${t.ClientId}&pageSize=${t.PageSize}&pageNum=${t.PageNumber}&sortBy=${t.SortBy}&sortExp=${t.SortExp}`;n["a"].GetPropertyList(e).then(e=>{t.isLoading=!1,e.data.result.DATA.length>0?(t.ListingData=e.data.result.DATA,t.TotalRecords=e.data.result.DATA[0].TOTAL_RECORDS,t.TotalPages=Math.ceil(t.TotalRecords/t.PageSize),t.PageNumber=t.PageNumber,t.ListingData.forEach(t=>{Ll["default"].set(t,"isSelected",!1),t.meter_count>0?Ll["default"].set(t,"isCheckBoxDisabled",!0):Ll["default"].set(t,"isCheckBoxDisabled",!1)})):(t.ListingData=[],t.TotalRecords=0)})},leftCommonSearch:function(t){if(this.PageNumber=t.PageNumber,this.isPaged=1,"undefined"!=typeof t.searchCondition)if(""!=t.searchConditionJson){const e=t.searchConditionJson.split("=")[1];this.fav=e}else this.searchCondition=t.searchCondition;else this.searchCondition="";this.GetPropertyList()},renderActions:function(t){var e=this;let a=[];return e.listActions.forEach(e=>{let i={...e};switch(i.title){case"Update Construction":i.isVisible=!0;break;case"Update Type":i.isVisible=!0;break;case"Delete":i.isVisible=!(t.meter_count>0);break;case"History":i.isVisible=!0;break;default:i.isVisible=!0}a.push(i)}),a},pagerMethod:function(t){this.PageSize=t.PageSize,this.PageNumber=t.PageNumber,this.GetPropertyList()},actionButtonClick:function(t,e){switch(t){case"EditUpdateConstruction":this.EditConstructionType(e,"C");break;case"EditUpdateType":this.EditConstructionType(e,"T");break;case"DeleteTaxClient":this.commonDeleteData(e.id);break;case"PropertyHistory":this.PropertyHistory(e);break}},commonHeaderButtonClick:async function(t){var e=this;switch(t.callbackfunction){case"AddProperty":e.AddProperty(null);break;case"BacktoList":e.BacktoList();break;case"commonDeleteData":e.commonDeleteData(null);break}},sortdata:function(t){var e="sort tb_headerSortDown";this.SortBy=t,t===this.SortBy&&(""==this.SortExp?(this.SortExp="ASC",e="sort tb_headerSortDown"):"ASC"==this.SortExp?(this.SortExp="DESC",e="sort tb_headerSortUp"):(this.SortExp="ASC",e="sort tb_headerSortDown")),this.FetchTaxList(),$("#"+t+"  span:first-child").attr("class",e)},BacktoList(){this.$router.push({name:"ClientListing"})},AddProperty(t){var e=this;e.AddAddProperty=t,e.IsAddProperty=!0},EditConstructionType(t,e){var a=this;a.IsType=e,a.AddAddProperty=t,a.IsConstructionType=!0},CloseConstructionType(){var t=this;t.IsConstructionType=!1,t.GetPropertyList()},CloseAddProperty(){var t=this;t.IsAddProperty=!1,t.GetPropertyList()},commonDeleteData(t){var e=this,a="";e.isLoading=!0,null==t?$(".chkItems:checkbox:checked").not("[id^='chkAll_0']").each((function(){a.length>0&&(a+=","),a+=$(this).val()})):a=t,null!=a?e.confirmR(e.$t("ConfirmDelete"),!0,e.$t("Delete")+"  "+e.$t("Property"),(function(){var t="ids="+a;n["a"].DeletePropertyList(t).then(t=>{e.isLoading=!1,t.data.result.DATA.length>0?"REMOVE_MAPPING"==t.data.result.DATA[0].VALUE?(e.ShowAlert(e.$t("DeletedSuccess",[e.$t("Property")]),"Success",!0,e.$t("Alert")),e.CloseAddProperty()):(e.ShowAlert(e.$t("DeletedError",[e.$t("Property")]),"failure",!0,e.$t("Alert")),e.CloseAddProperty()):e.ShowAlert(e.$t("UnknownErrorOccur"),"failure",!0,e.$t("Alert"))})})):e.ShowAlert(e.$t("Selectanyrecordtodelete")),e.isLoading=!1},PropertyHistory(t){var e=this;e.PropertyId=t.id,e.PropertyName=t.property_title,e.IsPropertyHistory=!0},ClosePropertyHistory(){var t=this;t.IsPropertyHistory=!1}}},xl=El,Nl=(a("1673"),Object(d["a"])(xl,dl,ul,!1,null,null,null)),Pl=Nl.exports,wl=a("39b8"),Rl=function(){var t=this,e=t._self._c;return e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-12 col-lg-12 gd_mainbase"},[e("div",{staticClass:"header"},[e("div",{staticClass:"customer-header"},[""!=t.blobUrl?e("img",{staticClass:"customer-avatar",attrs:{src:t.blobUrl,alt:"Customer"}}):e("div",{staticClass:"customer-avatarname"},[t._v(t._s(t.getInitialsName)+" ")]),e("div",{staticClass:"customer-info"},[e("h1",[t._v(t._s(t.ClientData.clientdetail.first_name)+" "+t._s(t.ClientData.clientdetail.last_name))]),e("div",{staticClass:"customer-meta"},[e("span",[e("em",{staticClass:"fas fa-envelope"}),t._v(" "+t._s(t.ClientData.clientdetail.email_id))]),e("span",[e("em",{staticClass:"fas fa-phone"}),t._v(t._s(t.MobileNumber))]),e("a",{staticClass:"text-success",attrs:{href:"javascript:;"},on:{click:t.OpenContatNumber}},[e("em",{staticClass:"fas fa-pencil"})])])])]),1001==t.ClientData.clientdetail.clientStatusId?e("div",{staticClass:"float-right"},[e("button",{staticClass:"btn btn-danger",on:{click:function(e){return t.ClientDisable(t.ClientData.clientdetail.user_id,"Disable")}}},[e("em",{staticClass:"fa fa-ban"}),t._v(" "+t._s(t.$t("Disable"))+" ")])]):1002==t.ClientData.clientdetail.clientStatusId?e("div",{staticClass:"float-right"},[e("button",{staticClass:"btn btn-success",on:{click:function(e){return t.ClientDisable(t.ClientData.clientdetail.user_id,"Enable")}}},[e("em",{staticClass:"fa fa-check"}),t._v(" "+t._s(t.$t("Enable"))+" ")])]):t._e()]),e("div",{staticClass:"tab-pane"},[e("div",{staticClass:"tab-content",staticStyle:{display:"block"},attrs:{id:"myTabContent"}},[e("div",{staticClass:"tab-pane fade border-0 p-0 no-border-mb project-tab active show",attrs:{id:"PROJECT_OVERVIEW",role:"tabpanel","aria-labelledby":"dashboard-tab"}},[e("ul",{staticClass:"dashbord-widget"},[e("li",{staticClass:"one_wid",staticStyle:{cursor:"pointer"}},[e("h3",[t._v(t._s(t.$n(t.totalInvoicesIssued))),e("br"),e("span",[t._v(t._s(t.$t("totalInvoicesIssued")))])]),t._v(" "),e("em",{staticClass:"fa fa-file",attrs:{"aria-hidden":"true"}})]),e("li",{staticClass:"two_wid",staticStyle:{cursor:"pointer"}},[e("h3",[t._v(t._s(t.$n(t.totalamountbilled,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))),e("br"),e("span",[t._v(t._s(t.$t("totalamountbilled")))])]),t._v(" "),e("em",{staticClass:"fa fa-money",attrs:{"aria-hidden":"true"}})]),e("li",{staticClass:"three_wid",staticStyle:{cursor:"pointer"}},[e("h3",[t._v(t._s(t.$n(t.totalamountpaid,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))),e("br"),e("span",[t._v(t._s(t.$t("TotalAmountPaid")))])]),t._v(" "),e("em",{staticClass:"fa fa-money",attrs:{"aria-hidden":"true"}})]),e("li",{staticClass:"four_wid",staticStyle:{cursor:"pointer"}},[e("h3",[t._v(t._s(t.$n(t.TotalAmountDue,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))),e("br"),e("span",[t._v(t._s(t.$t("TotalAmountDue")))])]),t._v(" "),e("em",{staticClass:"fa fa-money",attrs:{"aria-hidden":"true"}})]),e("li",{staticClass:"five_wid",staticStyle:{cursor:"pointer"}},[e("h3",[t._v(t._s(t.$n(t.totaloverdueamount,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))),e("br"),e("span",[t._v(t._s(t.$t("totaloverdueamount")))])]),t._v(" "),e("em",{staticClass:"fa fa-money",attrs:{"aria-hidden":"true"}})])])])])]),e("div",{staticClass:"col-12 mt-4 p-0 float-left"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-6"},[e("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 p-0 float-left"},[e("div",{staticClass:"col-lg-12 mb-3 p-0"},[e("div",{staticClass:"heading-border mt-2"},[e("h5",{staticClass:"h5"},[e("span",[t._v(t._s(t.$t("customerdetail")))]),e("small",{staticClass:"float-right"},[e("a",{attrs:{href:"javascript:;",title:"Add"},on:{click:t.EditClient}},[e("em",{staticClass:"fa fa-pencil pr-1"}),t._v(" "+t._s(t.$t("Edit"))+" ")])])])])]),e("div",{staticClass:"col-lg-12 mb-3 p-0"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12"},[t._l(t.FormSchema,(function(a){return["YES"==a.list_field_visibility&&"first_name"!=a.name&&"last_name"!=a.name&&"bool"!=a.dt_code?e("div",{staticClass:"form-group mb-2 row"},[e("div",{staticClass:"col-sm-12 col-md-6 col-lg-6 col-xl-6"},[e("b",[t._v(t._s(t.$t(a.display_name))+" :")])]),e("div",{staticClass:"col-sm-12 col-md-6 col-lg-6 col-xl-6"},[t._v(" "+t._s(a.value?a.value:"--")+" ")])]):t._e(),"bool"==a.dt_code?e("div",{staticClass:"form-group mb-2 row"},[e("div",{staticClass:"col-sm-12 col-md-6 col-lg-6 col-xl-6"},[e("b",[t._v(t._s(t.$t(a.display_name))+" :")])]),e("div",{staticClass:"col-sm-12 col-md-6 col-lg-6 col-xl-6"},[t._v(" "+t._s("1"==a.value?"Yes":"No")+" ")])]):t._e()]}))],2)])])]),e("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 mt-4 p-0 float-left"},[e("div",{staticClass:"col-lg-12 mb-3 p-0"},[e("div",{staticClass:"heading-border mt-2"},[e("h5",{staticClass:"h5"},[e("span",[t._v(t._s(t.$t("Addresses")))]),e("small",{staticClass:"float-right"},[e("a",{attrs:{href:"javascript:;",title:"Add"},on:{click:t.AddClientAddress}},[e("em",{staticClass:"fa fa-plus pr-1"}),t._v(" "+t._s(t.$t("Add"))+"/ "+t._s(t.$t("Edit"))+" ")])])])])]),t._l(t.AddressList,(function(a,i){return e("div",{key:i,staticClass:"col-lg-12 mb-3 p-0"},[e("div",{staticClass:"customer-headersmall"},[e("div",{staticClass:"profileicon"},[e("em",{class:t.getIconClass(a.address_type)})]),e("div",{staticClass:"customer-info"},[null!=a.address_type?e("h1",[t._v(t._s(t.$t(a.address_type)))]):e("h1",[t._v(t._s(t.$t("secondaryaddress")))]),e("div",{staticClass:"customer-meta"},[e("span",[t._v(" "+t._s(t.formatFullAddress(a))+" ")])])])])])})),0==t.AddressList.length?e("div",{staticClass:"text-center text-danger border p-2 norecord"},[t._v(" "+t._s(t.$t("NorecordfoundText"))+" ")]):t._e()],2),e("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 mt-4 p-0 float-left"},[e("div",{staticClass:"col-lg-12 mb-3 p-0"},[e("div",{staticClass:"heading-border mt-2"},[e("h5",{staticClass:"h5"},[e("span",[t._v(t._s(t.$t("Communication")))]),e("small",{staticClass:"float-right"},[e("a",{attrs:{href:"javascript:void(0)",title:"Add"},on:{click:t.AddCommunication}},[e("em",{staticClass:"fa fa-plus pr-1"}),t._v(" "+t._s(t.$t("Add"))+" / "+t._s(t.$t("Edit")))])])])])]),e("div",{staticClass:"col-lg-12 mb-3 p-0"},[t._l(t.EmailData,(function(a,i){return e("div",{key:i,staticClass:"social-links"},["Facebook"==a.CARRIER_TYPE_NAME?e("a",{staticClass:"social-link facebook",attrs:{href:a.CARRIER_VALUE.startsWith("http")?a.CARRIER_VALUE:"https://"+a.CARRIER_VALUE,target:"_blank"}},[e("i",{staticClass:"fab fa-facebook-f"})]):t._e(),"twitter"==a.CARRIER_TYPE_NAME?e("a",{staticClass:"social-link twitter",attrs:{href:a.CARRIER_VALUE.startsWith("http")?a.CARRIER_VALUE:"https://"+a.CARRIER_VALUE,target:"_blank"}},[e("i",{staticClass:"fab fa-twitter"})]):t._e(),"instagram"==a.CARRIER_TYPE_NAME?e("a",{staticClass:"social-link instagram",attrs:{href:a.CARRIER_VALUE.startsWith("http")?a.CARRIER_VALUE:"https://"+a.CARRIER_VALUE,target:"_blank"}},[e("i",{staticClass:"fab fa-instagram"})]):t._e(),"linkedin-in"==a.CARRIER_TYPE_NAME?e("a",{staticClass:"social-link linkedin",attrs:{href:a.CARRIER_VALUE.startsWith("http")?a.CARRIER_VALUE:"https://"+a.CARRIER_VALUE,target:"_blank"}},[e("i",{staticClass:"fab fa-linkedin-in"})]):t._e(),"Phone Number"==a.CARRIER_TYPE_NAME?e("a",{staticClass:"social-link whatsapp",attrs:{href:a.CARRIER_VALUE.startsWith("http")?a.CARRIER_VALUE:"https://"+a.CARRIER_VALUE,target:"_blank"}},[e("i",{staticClass:"fa fa-phone"})]):t._e(),"Yahoo"==a.CARRIER_TYPE_NAME?e("a",{staticClass:"social-link yahoo",attrs:{href:a.CARRIER_VALUE.startsWith("http")?a.CARRIER_VALUE:"https://"+a.CARRIER_VALUE,target:"_blank"}},[e("i",{staticClass:"fab fa-yahoo"})]):t._e(),"Fax"==a.CARRIER_TYPE_NAME?e("a",{staticClass:"social-link fax",attrs:{href:a.CARRIER_VALUE.startsWith("http")?a.CARRIER_VALUE:"https://"+a.CARRIER_VALUE,target:"_blank"}},[e("i",{staticClass:"fa fa-fax"})]):t._e(),"Google"==a.CARRIER_TYPE_NAME?e("a",{staticClass:"social-link email",attrs:{href:a.CARRIER_VALUE.startsWith("http")?a.CARRIER_VALUE:"https://"+a.CARRIER_VALUE,target:"_blank"}},[e("i",{staticClass:"fa fa-envelope"})]):t._e(),"Skype"==a.CARRIER_TYPE_NAME?e("a",{staticClass:"social-link skype",attrs:{href:a.CARRIER_VALUE.startsWith("http")?a.CARRIER_VALUE:"https://"+a.CARRIER_VALUE,target:"_blank"}},[e("i",{staticClass:"fab fa-skype"})]):t._e(),"MSN"==a.CARRIER_TYPE_NAME?e("a",{staticClass:"social-link msn",attrs:{href:a.CARRIER_VALUE.startsWith("http")?a.CARRIER_VALUE:"https://"+a.CARRIER_VALUE,target:"_blank"}},[e("img",{attrs:{src:"https://talygenv.github.io/Vue-UI-Content/images/msn.png"}})]):t._e()])})),0==t.EmailData.length?e("div",{staticClass:"text-center text-danger border p-2 norecord"},[t._v(" "+t._s(t.$t("NorecordfoundText"))+" ")]):t._e()],2)]),e("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 mt-4 p-0 float-left"},[e("div",{staticClass:"col-lg-12 mb-3 p-0"},[e("div",{staticClass:"heading-border mt-2"},[e("h5",{staticClass:"h5"},[e("span",[t._v(t._s(t.$t("Notes")))]),e("small",{staticClass:"float-right"},[e("a",{attrs:{href:"javascript:;",title:"Add"},on:{click:t.AddNotes}},[e("em",{staticClass:"fa fa-plus pr-1"}),t._v(" "+t._s(t.$t("Add"))+" / "+t._s(t.$t("Edit"))+" ")])])])])]),t._l(t.NoteData,(function(a,i){return e("div",{key:i,staticClass:"col-lg-12 mb-3 p-0"},[e("div",{staticClass:"customer-headersmall notespanel"},[t._m(0,!0),e("div",{staticClass:"customer-info w-100"},[e("div",{staticClass:"d-flex justify-content-between"},[e("h1",{staticClass:"mb-0"},[t._v(t._s(a.notes_created_by))]),e("span",{staticClass:"sender-department"},[e("small",{staticClass:"text-secondary font-14 font-weight-medium",attrs:{title:t._f("formatDateTime")(a.note_date)}},[t._v(" "+t._s(t._f("formatDateTime")(a.note_date))+" ")])])]),e("div",{staticClass:"customer-meta w-100"},[e("p",{staticClass:"mb-0",domProps:{innerHTML:t._s(a.crm_notes)}})])])])])})),0==t.NoteData.length?e("div",{staticClass:"text-center text-danger border p-2 norecord"},[t._v(" "+t._s(t.$t("NorecordfoundText"))+" ")]):t._e()],2)]),e("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-6"},[e("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 p-0 float-left"},[e("div",{staticClass:"col-lg-12 mb-3 p-0"},[e("div",{staticClass:"heading-border mt-2"},[e("h5",{staticClass:"h5"},[e("span",[t._v(t._s(t.$t("Contacts")))]),e("small",{staticClass:"float-right"},[e("a",{attrs:{href:"javascript:void(0)",title:"Add"},on:{click:t.AssociateContact}},[e("em",{staticClass:"fa fa-plus pr-1"}),t._v(" "+t._s(t.$t("Add")))])])])])]),t._l(t.ListingData,(function(a,i){return e("div",{staticClass:"col-lg-12 mb-3 p-0",attrs:{Key:i}},[e("div",{staticClass:"customer-headersmall"},[t._m(1,!0),e("div",{staticClass:"customer-info"},[e("div",{staticClass:"d-flex justify-content-between align-items-center"},[e("div",[e("h1",[t._v(t._s(a.CONTACTNAME))]),e("div",{staticClass:"customer-meta"},[e("span",[t._v(t._s(a.EMAIL_ID))])])]),e("a",{staticClass:"text-danger",staticStyle:{"font-size":"18px",padding:"5px"},attrs:{href:"javascript:;",title:t.$t("De-Associate")},on:{click:function(e){return t.DeAssociateContact(a.CONTACT_ID)}}},[e("em",{staticClass:"fa fa-trash"})])])])])])})),0==t.ListingData.length?e("div",{staticClass:"text-center text-danger border p-2 norecord"},[t._v(" "+t._s(t.$t("NorecordfoundText"))+" ")]):t._e()],2),e("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 mt-4 p-0 float-left"},[e("div",{staticClass:"col-lg-12 mb-3 p-0"},[e("div",{staticClass:"heading-border mt-2"},[e("h5",{staticClass:"h5"},[e("span",[t._v(t._s(t.$t("Configuration")))]),e("small",{staticClass:"float-right"},[e("a",{attrs:{href:"javascript:void(0)",title:"Add"},on:{click:t.AddClientConfiguration}},[e("em",{staticClass:"fa fa-pencil pr-1"}),t._v(" "+t._s(t.$t("Edit"))+" ")])])])])]),e("div",{staticClass:"col-lg-12 mb-3 p-0"},[e("div",{staticClass:"row"},t._l(t.StorageKeys,(function(a,i){return e("div",{key:i,staticClass:"col-sm-12 col-md-6 col-lg-6"},["HolidayPreference"==a.CORE_CONFIG_KEY?e("div",{staticClass:"form-group mb-2"},[e("label",[e("b",[t._v(t._s(t.$t(a.CORE_CONFIG_KEY))+":")]),t._v(" "+t._s("clientholidays"==a.CORE_CONFIG_VALUE?t.$t("clientholidays"):t.$t("companyholidays"))+" ")])]):t._e(),"IsTaxable"==a.CORE_CONFIG_KEY?e("div",{staticClass:"form-group mb-2"},[e("label",[e("b",[t._v(t._s(t.$t(a.CORE_CONFIG_KEY))+":")]),t._v(" "+t._s("Taxable"==a.CORE_CONFIG_VALUE?t.$t("Taxable"):t.$t("Exempt"))+" ")])]):t._e(),"TaxOverride"==a.CORE_CONFIG_KEY?e("div",{staticClass:"form-group mb-2"},[e("label",[e("b",[t._v(t._s(t.$t(a.CORE_CONFIG_KEY))+":")]),t._v(" "+t._s(1==a.CORE_CONFIG_VALUE?t.$t("Yes"):t.$t("No"))+" ")])]):t._e()])})),0)])]),e("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 mt-4 p-0 float-left"},[e("div",{staticClass:"col-lg-12 mb-3 p-0"},[e("div",{staticClass:"heading-border mt-2"},[e("h5",{staticClass:"h5"},[e("span",[t._v(t._s(t.$t("RecentInvoices")))])])])]),e("div",{staticClass:"col-lg-12 p-0"},[e("div",{staticClass:"listing"},[e("div",{staticClass:"table-responsive"},[e("table",{staticClass:"table table-bordered"},[e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",[t._v(t._s(t.$t("DetailedInvoice"))+" "+t._s(t.$t("#")))]),e("th",[t._v(t._s(t.$t("WorkDate")))]),e("th",[t._v(t._s(t.$t("expense_amount")))]),e("th",[t._v(t._s(t.$t("Status_MyDashboard_Module")))])])]),e("tbody",[t._l(t.InvoiceData,(function(a,i){return e("tr",{key:i},[e("td",[t._v(t._s(a.bill_number))]),e("td",[t._v(t._s(null!=a.bill_due_date?t.$d(a.bill_due_date):"--"))]),e("td",[t._v(t._s(t.$n(a.bill_net_total)))]),e("td",["CLBGEN"==a.status_code?e("span",{staticClass:"btn btn-warning py-0 d-block font-14",staticStyle:{cursor:"inherit"},attrs:{title:t.$t("Generated")}},[t._v(t._s(a.status_name))]):t._e(),"Sent"==a.status_code||"CLBSND"==a.status_code?e("span",{staticClass:"btn btn-primary py-0 d-block font-14",staticStyle:{cursor:"inherit"},attrs:{title:t.$t("Sent")}},[t._v(t._s(a.status_name))]):t._e(),"CLBDSPT"==a.status_code?e("span",{staticClass:"btn btn-warning py-0 d-block font-14",staticStyle:{cursor:"inherit"},attrs:{title:t.$t("Disputed")}},[t._v(t._s(a.status_name))]):t._e(),"CLBPAD"==a.status_code?e("span",{staticClass:"btn btn-success py-0 d-block font-14",staticStyle:{cursor:"inherit"},attrs:{title:t.$t("FullPaid")}},[t._v(t._s(a.status_name))]):t._e(),"CLBRSTP"==a.status_code?e("span",{staticClass:"btn btn-danger py-0 d-block font-14",staticStyle:{cursor:"inherit"},attrs:{title:t.$t("Recurring")}},[t._v(t._s(a.status_name))]):t._e(),"CLBBDBT"==a.status_code?e("span",{staticClass:"btn btn-danger py-0 d-block font-14",staticStyle:{cursor:"inherit"},attrs:{title:t.$t("BadDebt")}},[t._v(t._s(a.status_name))]):t._e(),"CLBDFT"==a.status_code?e("span",{staticClass:"btn btn-warning py-0 d-block font-14",staticStyle:{cursor:"inherit"},attrs:{title:t.$t("Draft")}},[t._v(t._s(a.status_name))]):t._e(),"CLBCNCL"==a.status_code?e("span",{staticClass:"btn btn-danger py-0 d-block font-14",staticStyle:{cursor:"inherit"},attrs:{title:t.$t("Cancel")}},[t._v(t._s(a.status_name))]):t._e(),"CNCLFAILED"==a.status_code?e("span",{staticClass:"btn btn-danger py-0 d-block font-14",staticStyle:{cursor:"inherit"},attrs:{title:t.$t("Failed")}},[t._v(t._s(a.status_name))]):t._e(),"CLBPPAD"==a.status_code?e("span",{staticClass:"btn btn-info py-0 d-block font-14",staticStyle:{cursor:"inherit"},attrs:{title:t.$t("PartialPaid")}},[t._v(t._s(a.status_name))]):t._e(),"RLSTOWORKDAY"==a.status_code?e("span",{staticClass:"btn btn-success py-0 d-block font-14",staticStyle:{cursor:"inherit"},attrs:{title:t.$t("Released")}},[t._v(t._s(t.$t("Released")))]):t._e(),"CLBERROR"==a.status_code?e("span",{staticClass:"btn btn-info py-0 d-block font-14",staticStyle:{cursor:"inherit"},attrs:{title:t.$t("Failed")}},[t._v(t._s(t.$t("Failed")))]):t._e(),"CANPWORKDAY"==a.status_code?e("span",{staticClass:"btn btn-info py-0 d-block font-14",staticStyle:{cursor:"inherit"},attrs:{title:t.$t("CancelPending")}},[t._v(t._s(t.$t("CancelPending")))]):t._e(),"CLBUPDATED"==a.status_code?e("span",{staticClass:"btn btn-success py-0 d-block font-14",staticStyle:{cursor:"inherit"},attrs:{title:t.$t("Updated")}},[t._v(t._s(t.$t("Updated")))]):t._e(),"SYNC_FAILED"==a.status_code?e("span",{staticClass:"btn btn-danger py-0 d-block font-14",staticStyle:{cursor:"inherit"},attrs:{title:t.$t("UpdateFromWorkdayFailed")}},[t._v(t._s(a.status_name))]):t._e(),"DEL"==a.status_code?e("span",{staticClass:"btn btn-danger py-0 d-block font-14",staticStyle:{cursor:"inherit"},attrs:{title:t.$t("Delete")}},[t._v(t._s(a.status_name))]):t._e(),"SYNCED"==a.status_code?e("span",{staticClass:"btn btn-success py-0 d-block font-14",staticStyle:{cursor:"inherit"},attrs:{title:t.$t("UpdatedFromWorkday")}},[t._v(t._s(a.status_name))]):t._e(),"RLSTOXERO"==a.status_code?e("span",{staticClass:"btn btn-secondary py-0 d-block font-14",staticStyle:{cursor:"inherit"},attrs:{title:t.$t("UpdatedFromWorkday")}},[t._v(t._s(a.status_name))]):t._e()])])})),0==t.InvoiceData.length?e("tr",[e("td",{staticClass:"text-center text-danger border p-2 norecord",attrs:{colspan:"8"}},[t._v(" "+t._s(t.$t("NorecordfoundText")))])]):t._e()],2)])])])])])])])])]),t.IsClientAddress?e("AddClientAddressModal",{attrs:{IsClient:t.IsClient,ClientId:t.ClientId},on:{ClosePopUp:t.ClosePopUp}}):t._e(),t.IsClientConfiguration?e("ClientConfigurationData",{attrs:{ClientId:t.ClientId},on:{CloseConfigurationPopUp:t.CloseConfigurationPopUp}}):t._e(),t.IsNewClient?e("NewClientPopup",{on:{onCancel:t.onCancel}}):t._e(),t.OpenAssociateContact?e("AssociateContact",{attrs:{UserId:t.ClientId},on:{CloseAssociatePopup:t.CloseAssociatePopup}}):t._e(),t.IsAddCommunication?e("AddCommunication",{attrs:{IsClient:t.IsClient,ClientId:t.UserId},on:{CloseAddCommuniction:t.CloseAddCommuniction}}):t._e(),t.IsAddNote?e("AddClientNote",{on:{CloseNotePopup:t.CloseNotePopup}}):t._e(),t.IsContactNumber?e("ContactNumberPopup",{attrs:{UserId:t.ClientId,IsClient:t.IsClient}}):t._e()],1)},Ml=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"profileicon"},[e("em",{staticClass:"fa fa-user"})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"profileicon"},[e("em",{staticClass:"fa fa-user"})])}],$l=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"my-popups"},[e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered ui-draggable"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header ui-draggable-handle py-1"},[e("h5",{staticClass:"pt-2",attrs:{name:"header"}},[t._v(" "+t._s(t.$t("Manage Address"))+" ")]),e("button",{staticClass:"close",on:{click:t.ClosePopUp}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-6"},[e("dynamic-form",{ref:"refAddress",attrs:{lang:"en",buttons:!1,schema:t.FormSchema}})],1),e("div",{staticClass:"col-md-6"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-12"},[e("MapComponent",{ref:"mapComponnet",staticClass:"row",attrs:{mapType:"MapBox",mapContainer:"addAddress",config:t.config,mapHeight:"355px",latLng:t.latLngValues},on:{GetAddress:t.GetAddress}}),e("div",{staticClass:"row flex-row-reverse mt-2"},[e("div",{staticClass:"col-lg-6 text-right"},[1==t.isUpdateForm?e("a",{staticClass:"btn btn-success mr-2",attrs:{href:"javascript:;",title:"",id:"addAddress","data-toggle-tooltip":"tooltip","data-original-title":"Save"},on:{click:t.onSubmit}},[e("i",{staticClass:"fa fa-refresh"}),e("span",{attrs:{id:"btnAddressText"}},[t._v(" "+t._s(t.$t("Update")))])]):e("a",{staticClass:"btn btn-success mr-2",attrs:{href:"javascript:;",title:"",id:"addAddress","data-toggle-tooltip":"tooltip","data-original-title":"Save"},on:{click:t.onSubmit}},[e("i",{staticClass:"fa fa-save mr-2"}),e("span",{attrs:{id:"btnAddressText"}},[t._v(" "+t._s(t.$t("Save")))])]),e("a",{staticClass:"btn btn-danger",attrs:{href:"javascript:;",title:"",id:"CancelAddress","data-toggle-tooltip":"tooltip","data-original-title":"Cancel"},on:{click:function(e){return t.cancelAddress()}}},[e("i",{staticClass:"fa fa-times mr-2"}),t._v(t._s(t.$t("Cancel")))])])])],1)])])]),e("div",{staticClass:"row col-lg-6"},[e("div",{staticClass:"py-2"},[e("span",{staticClass:"mandatory"},[t._v(t._s(t.$t("Mandatory")))])])]),t.AddressList.length>1?e("div",{staticClass:"mt-3 mb-2"},[e("div",{staticClass:"heading-border"},[e("h5",{staticClass:"h5"},[e("span",[t._v(t._s(t.$t("AdditionalAddresses")))]),e("small",{staticClass:"float-right"},[e("a",{class:{"table-head-btn":!0,disabled:!t.isdeleteButtonVisible},attrs:{title:"",id:"DeleteMultipleAddress","data-toggle-tooltip":"tooltip","data-original-title":"Please select one/multiple check box(s) to remove additional addresses(s)"},on:{click:function(e){return t.removeaddress("MultipleDelete")}}},[e("i",{staticClass:"fa fa-trash pr-2"}),t._v(t._s(t.$t("Delete"))+" ")])])])])]):t._e(),e("div",{staticClass:"row p-2"},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"d-inline-block"},[e("span",{staticClass:"legend-pending colorboxsquare"}),t._v(t._s(t.$t("AddressIsVisibleToclient"))+" ")])])]),e("div",{staticClass:"listing"},[e("div",{staticClass:"table-responsive"},[e("table",{staticClass:"table table-bordered dt-responsive nowrap mt-0",attrs:{id:"Addresslist"}},[e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",[e("div",{staticClass:"custom-control custom-checkbox"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.allSelected,expression:"allSelected"}],staticClass:"AddressChkAll custom-control-input",attrs:{type:"checkbox",id:"chkAll_0",name:"checkbox"},domProps:{checked:Array.isArray(t.allSelected)?t._i(t.allSelected,null)>-1:t.allSelected},on:{click:function(e){return t.selectAll(e)},change:function(e){var a=t.allSelected,i=e.target,s=!!i.checked;if(Array.isArray(a)){var n=null,l=t._i(a,n);i.checked?l<0&&(t.allSelected=a.concat([n])):l>-1&&(t.allSelected=a.slice(0,l).concat(a.slice(l+1)))}else t.allSelected=s}}}),e("label",{staticClass:"custom-control-label universal-custom-control-label pt-1",attrs:{for:"chkAll_0"}})])]),e("th",[t._v("#")]),e("th",{attrs:{id:"th-ADDRESS"}},[t._v(" "+t._s(t.$t("Address")))]),e("th",[t._v(t._s(t.$t("NotesDescription")))]),e("th",[t._v(t._s(t.$t("IsinCompanyDirectory")))]),e("th",[t._v(t._s(t.$t("IsPrimary"))+" "+t._s(t.$t("Address")))]),e("th",[t._v(t._s(t.$t("Action")))])])]),e("tbody",[t._l(t.AddressList,(function(a,i){return e("tr",{class:1==a.is_client_address?"high-bar":"",attrs:{Key:i}},[e("td",{staticClass:"textaligncenter"},[e("div",{staticClass:"custom-control custom-checkbox"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.isSelected,expression:"item.isSelected"}],staticClass:"custom-control-input",attrs:{id:a.user_address_id,type:"checkbox",name:"checkbox"},domProps:{value:a.user_address_id,checked:Array.isArray(a.isSelected)?t._i(a.isSelected,a.user_address_id)>-1:a.isSelected},on:{change:[function(e){var i=a.isSelected,s=e.target,n=!!s.checked;if(Array.isArray(i)){var l=a.user_address_id,o=t._i(i,l);s.checked?o<0&&t.$set(a,"isSelected",i.concat([l])):o>-1&&t.$set(a,"isSelected",i.slice(0,o).concat(i.slice(o+1)))}else t.$set(a,"isSelected",n)},function(e){return t.select(e,a)}]}}),e("label",{staticClass:"custom-control-label universal-custom-control-label pt-1",attrs:{for:a.user_address_id}})])]),e("td",[e("strong",[t._v(t._s(i+1))])]),e("td",[t._v(" "+t._s(t.formatFullAddress(a))+" ")]),e("td",[t._v(" "+t._s(t.TruncateStr(a.user_address_desc,20))+" ")]),1==a.add_to_directory?e("td",[t._v(" "+t._s(t.$t("Yes"))+" ")]):e("td",[t._v(" "+t._s(t.$t("No"))+" ")]),e("td",[e("div",{staticClass:"custom-control custom-checkbox"},[e("input",{staticClass:"custom-control-input",staticStyle:{"z-index":"1",width:"19px","margin-top":"6px"},attrs:{type:"checkbox"},domProps:{checked:a.is_primary_address},on:{change:function(e){return t.setPrimaryAddress(e,a)}}}),e("label",{staticClass:"custom-control-label universal-custom-control-label pt-1"})])]),e("td",{staticClass:"text-center single-action"},[e("a",{staticClass:"enable",attrs:{"data-placement":"left",title:"",href:"javascript:;","data-toggle-tooltip":"tooltip","data-original-title":"Edit"},on:{click:function(e){return t.editAddress(a)}}},[e("em",{staticClass:"fa fa-pencil text-success action-icon mr-2"})]),e("a",{staticClass:"enable",attrs:{"data-placement":"left",title:"",href:"javascript:;","data-toggle-tooltip":"tooltip","data-original-title":"Delete"},on:{click:function(e){return t.removeaddress("singleDelete",a)}}},[e("em",{staticClass:"fa fa-trash text-danger action-icon"})])])])})),0==t.AddressList.length?e("tr",[e("td",{staticClass:"text-danger text-center no-record",attrs:{colspan:"8"}},[t._v(t._s(t.$t("NoRecordfound")))])]):t._e()],2)])])])])])])])])])},Fl=[],kl={components:{MapComponent:Ui["a"]},props:{ClientId:{type:Number},IsClient:{type:String}},data(){return{config:{isShowDrawButton:!0,isShowSearchBox:!0},isUpdateForm:!1,userAddressId:null,countryList:[],isdeleteButtonVisible:!1,AddressList:[],Longitude:null,Latitude:null,latLngValues:"",allSelected:!1,addressIds:null,FormSchema:[{layoutType:"double",Data:[{astype:"TextField",label:this.$t("AddressLine1"),name:"Address Line 1:",value:"",placeholder:"",validationRules:{max:200,required:!0}},{astype:"TextField",label:this.$t("AddressLine2"),name:"Address Line 2:",value:"",placeholder:"",validationRules:{max:200,required:!1}},{astype:"SelectField",label:this.$t("COUNTRY"),name:"Country",value:"",placeholder:"",disabled:!1,validationRules:{required:!0,max:250},config:{options:[]}},{astype:"TextField",label:this.$t("StateProvince"),name:"State/Province",value:"",placeholder:"",disabled:!1,validationRules:{required:!1}},{astype:"TextField",label:this.$t("City"),name:"City:",value:"",placeholder:"",disabled:!1,validationRules:{required:!1},config:{options:[]}},{astype:"TextField",label:this.$t("ZIPCODE"),name:"Zip Code:",value:"",placeholder:"",disabled:!1,validationRules:{required:!1}},{astype:"TextField",label:this.$t("NotesDescriptionAbtAddress"),name:"Note/Description About Address",userGuide:"Example: office Address",value:"",placeholder:"",validationRules:{max:200,required:!1}},{astype:"toggleField",label:this.$t("AddToCompanyDirectory"),name:"Show in Company Directory",value:"",placeholder:""},{astype:"toggleField",label:this.$t("isVisibleToClient"),name:"Visible To Client",value:"",placeholder:"",config:{onChange:this.visibleToClient}},{astype:"SelectField",label:this.$t("addresstype"),name:"addresstype",value:"",placeholder:"",disabled:!1,validationRules:{required:!0},config:{options:[]}}]}],AddressTypeList:[]}},created:function(){var t=this;t.GetCountryDDL(),t.GetAddressDDL(),t.getAdditionalAddressList(),"Client"==t.IsClient?t.FormSchema[0].Data[8].visibility=!1:t.FormSchema[0].Data[8].visibility=!0},methods:{GetCountryDDL(){var t="moduleName=CRM&type=COUNTRIES",e=this;n["a"].GetCountryDDL(t).then(t=>{e.countryList=t.data.DATA,e.countryList.forEach(t=>{e.FormSchema[0].Data[2].config.options.push({name:""+t.name,value:""+t.value})}),this.$refs.refAddress.UpdateKeyValue()})},GetAddressDDL(){var t="moduleName=CRM&type=ADDRESS_TYPE",e=this;n["a"].GetCountryDDL(t).then(t=>{e.AddressTypeList=t.data.DATA,e.AddressTypeList.forEach(t=>{e.FormSchema[0].Data[9].config.options.push({name:""+t.name,value:""+t.value})}),this.$refs.refAddress.UpdateKeyValue()})},async getAdditionalAddressList(){var t=this,e=`userId=${t.ClientId}&userAddressId=0`;await n["a"].GetAdditionalAddressList(e).then(e=>{null!=e.data&&(t.AddressList=[],e.data.result.length>0&&(t.AddressList=e.data.result,t.AddressList.forEach(e=>{if(e.isSelected=!1,1==e.is_primary_address){let a={location_nw:e.longitude.replace(",","")+e.latitude.replace(",",",")};t.latLngValues=a}})))})},ClosePopUp(){this.$emit("ClosePopUp")},visibleToClient(t,e){var a=this;1==t?(a.confirmR(a.$t("VisibleToClientValidation"),!0,!1,(function(t){if(void 0==t)return a.FormSchema[0].Data[8].value=!0})),a.FormSchema[0].Data[8].value=!1):a.FormSchema[0].Data[8].value=t},selectAll(){var t=this;let e=[],a="",i={};t.allSelected=!t.allSelected,t.allSelected?(t.AddressList.forEach(t=>{t.isSelected=!0}),t.isdeleteButtonVisible=!0):(t.AddressList.forEach(t=>{t.isSelected=!1}),t.isdeleteButtonVisible=!1),t.AddressList.forEach(t=>{1==t.isSelected&&(i={addressId:t.user_address_id,userId:t.user_id},e.push(i))}),a=e.map(t=>t.addressId).join(","),t.getAddressValue(a)},select(t,e){var a=this;let i=[],s="",n={};1==t.target.checked?(a.AddressList.forEach(t=>{t.user_address_id==e.user_address_id&&(t.isSelected=!0,a.allSelected=!1)}),a.isdeleteButtonVisible=!0):a.AddressList.forEach(t=>{t.user_address_id==e.user_address_id&&(t.isSelected=!1,a.allSelected=!1)}),a.AddressList.forEach(t=>{1==t.isSelected&&(n={addressId:t.user_address_id,userId:t.user_id},i.push(n))}),a.AddressList.length==i.length?a.allSelected=!0:a.allSelected=!1,s=i.map(t=>t.addressId).join(","),""==s&&(a.isdeleteButtonVisible=!1),a.getAddressValue(s)},getAddressValue(t){var e=this;e.addressIds="",e.addressIds=t},clearForm(){var t=this;t.FormSchema[0].Data[0].value="",t.FormSchema[0].Data[1].value="",t.FormSchema[0].Data[2].value="",t.FormSchema[0].Data[3].value="",t.FormSchema[0].Data[4].value="",t.FormSchema[0].Data[5].value="",t.FormSchema[0].Data[6].value="",t.FormSchema[0].Data[7].value="",t.FormSchema[0].Data[8].value="",t.FormSchema[0].Data[9].value="",t.$refs.refAddress.validateForm.reset()},async setPrimaryAddress(t,e){var a=this;try{let s={Num:t.target.checked?1:0,userAddressID:e.user_address_id};var i="postString="+JSON.stringify(s);await n["a"].SetPrimaryAddress(i).then(t=>{"Success"==t.data.status&&(a.ShowAlert(a.$t("LeadOwnerChanged",[a.$t("PrimaryAddress")]),"success",!0,a.$t("Alert")),a.getAdditionalAddressList())})}catch(s){console.log("error message",s)}},editAddress(t){var e=this;e.latLngValues="",e.isUpdateForm=!0,e.FormSchema[0].Data[0].value=t.user_address_1,e.FormSchema[0].Data[1].value="null"==t.user_address_2.toLowerCase()?"":t.user_address_2||"",e.FormSchema[0].Data[2].value=t.country_id,e.FormSchema[0].Data[3].value=t.user_city,e.FormSchema[0].Data[4].value=t.user_state,e.FormSchema[0].Data[5].value=t.user_zipcode,e.FormSchema[0].Data[6].value=t.user_address_desc,e.FormSchema[0].Data[7].value=t.add_to_directory,e.FormSchema[0].Data[8].value=t.is_client_address,e.FormSchema[0].Data[9].value=t.address_type,e.longitude=t.longitude,e.latitude=t.latitude,e.userAddressId=t.user_address_id;let a={location_nw:t.longitude.replace(",","")+t.latitude.replace(",",",")};e.latLngValues=a},removeaddress(t,e){var a=this;e.is_primary_address?a.ShowAlert(a.$t("CheckRemovePrimaryAddress"),"warning",a.$t("Alert")):a.confirmR(a.$t("ConfirmDelete"),!0,!1,(function(i){let s="";try{s="MultipleDelete"==t?`ids=${a.addressIds}&userId=${a.ClientId}`:`ids=${e.user_address_id}&userId=${a.ClientId}`,n["a"].DeleteUserAddress(s).then(t=>{"Deleted"==JSON.parse(t.data).statuscode&&(a.allSelected=!1,a.$refs.mapComponnet.removeMarker(),a.clearForm(),a.isUpdateForm=!1,a.getAdditionalAddressList(),a.ShowAlert(a.$t("DeletedSuccess",[a.$t("Address")]),"Success",!0,a.$t("Alert")))})}catch(l){console.log("error message",l)}}))},GetAddress(t){var e=this;e.Latitude="",e.Longitude="",e.$refs.mapComponnet.fullAddress=[],e.$refs.mapComponnet.lngLatData=[];var a=t.length-1;let i=e.countryList.filter(e=>e.name===t[a].CompleteAddress.Country.LongName),s=t[a].CompleteAddress.FullAddress,n=t[a].CompleteAddress.City.LongName,l=t[a].CompleteAddress.State.LongName,o=t[a].CompleteAddress.PinCode,r=t[a].CompleteAddress.Country.LongName;const c=/^[23456789CFGHJMPQRVWX]{4}\+[23456789CFGHJMPQRVWX]{2}/i.test(s);if(c){const n=new google.maps.Geocoder;n.geocode({address:s},(function(s,n){if("OK"===n){let n=s[0].address_components;if(n.length>0){var l=n.filter(t=>"plus_code"!==t.types[0]);e.FormSchema[0].Data[0].value=l[0].long_name;var r=""==i?"":i[0].value;e.FormSchema[0].Data[2].value=r,e.FormSchema[0].Data[3].value=l[3].long_name,e.FormSchema[0].Data[4].value=l[1].long_name,e.FormSchema[0].Data[5].value=o;n.find(t=>t.types.includes("postal_code")||t.types.includes("postal_code_prefix")||t.types.includes("postal_code_suffix")||t.types.includes("plus_code")||t.types.includes("zip_code")||t.types.includes("zipcode"))}var c="",d="",u="",p="";t[a].LatLng.forEach((t,e)=>{0==e&&(c=t.Lat,d=t.Lng)}),e.Latitude=u+","+d,e.Longitude=c+","+p;let m={location_nw:e.Longitude.replace(",","")+e.Latitude.replace(",",",")};e.latLngValues=m}else console.warn("Geocode failed:",n)}))}else{s=s.replace(r,"").replace(l,"").replace(n,"").replace(o,""),e.FormSchema[0].Data[0].value=s.split(",").map(t=>t.trim()).filter(t=>t.length).join(", ");var d=""==i?"":i[0].value;e.FormSchema[0].Data[2].value=d,e.FormSchema[0].Data[3].value=l,e.FormSchema[0].Data[4].value=n,e.FormSchema[0].Data[5].value=o;var u="",p="",m="",h="";t[a].LatLng.forEach((t,e)=>{0==e&&(u=t.Lat,p=t.Lng)}),e.Latitude=m+","+p,e.Longitude=u+","+h;let c={location_nw:e.Longitude.replace(",","")+e.Latitude.replace(",",",")};e.latLngValues=c}},onSubmit(){var t=this;t.$refs.refAddress.validateForm.validate().then(async e=>{if(e){t.isLoading=!0;let e={user_id:t.ClientId,user_address_id:null===t.userAddressId?0:t.userAddressId,user_address_1:t.FormSchema[0].Data[0].value,user_address_2:t.FormSchema[0].Data[1].value,country_id:parseInt(t.FormSchema[0].Data[2].value),user_city:t.FormSchema[0].Data[3].value,user_state:t.FormSchema[0].Data[4].value,user_zipcode:t.FormSchema[0].Data[5].value,user_address_desc:t.FormSchema[0].Data[6].value,is_client_address:t.FormSchema[0].Data[8].value,add_to_directory:t.FormSchema[0].Data[7].value,latitude:t.Latitude,longitude:t.Longitude,Address_type:t.FormSchema[0].Data[9].value};var a=new FormData;a.append("postString",JSON.stringify(e)),n["a"].AddupdateAdditionalAddress(a).then(e=>{t.isLoading=!1,null!=e.data?1==e.data?(t.ShowAlert(t.$t("AddedSuccess",[t.$t("Address")]),"success",!0,t.$t("Alert")),t.clearForm(),t.$refs.mapComponnet.removeMarker(),t.$refs.mapComponnet.clearSearchField(),t.$refs.mapComponnet.resetMap(),t.getAdditionalAddressList()):2==e.data&&(t.ShowAlert(t.$t("UpdatedSuccess",[t.$t("Address")]),"success",!0,t.$t("Alert")),t.clearForm(),t.isUpdateForm=!1,t.userAddressId=null,t.$refs.mapComponnet.removeMarker(),t.$refs.mapComponnet.clearSearchField(),t.$refs.mapComponnet.resetMap(),t.getAdditionalAddressList()):t.ShowAlert(t.$t("SomethingWentWrong"),"success",t.$t("Alert"))})}}).catch(t=>{console.error("Error validating form:",t)})},cancelAddress(){var t=this;t.clearForm(),t.isUpdateForm=!1,t.userAddressId=null,t.$refs.mapComponnet.removeMarker()},formatFullAddress(t){return[t.user_address_1,t.user_address_2,t.user_state,t.country_name,t.user_zipcode].filter(t=>t&&""!==t.trim()).join(", ")}}},Ol=kl,Bl=Object(d["a"])(Ol,$l,Fl,!1,null,null,null),Ul=Bl.exports,Gl=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"my-popups"},[e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered ui-draggable"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header ui-draggable-handle py-1"},[e("h5",{staticClass:"pt-2",attrs:{name:"header"}},[t._v(" "+t._s(t.$t("Configurations"))+" ")]),e("button",{staticClass:"close",on:{click:t.CloseConfigurationPopUp}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("dynamic-form",{ref:"ConfigurationsForm",attrs:{schema:t.formSchema,buttons:t.buttons},on:{OnSubmit:t.FinalSaveConfigurations}})],1)])])])])])},Yl=[],Vl={props:{ClientId:{type:Number}},data(){return{modueKeys:[],currentSelectedModule:"",formSchema:[],buttons:[{type:"submit",class:"btn btn-success",text:"<i class='fa fa-save pr-2'></i> Save Settings"}],showTicketNumber:!1,ticketCoreConfigId:0,noRecordfound:!1,Message:"",AttachmentFileDetail:[],uploadUrl:"https://stagefilemedia.talygen.com/api/UploadStreamNew",token:null,CheckFileSave:!1,CompanyLogo:null,UserId:null,moduleCode:"Billing",ModuleId:0}},created:async function(){var t=this;t.UserId=this.GetUserInfo.ID,await this.GetModuleConfigurationKeys(),t.formSchema[0].Data[0].value>0&&(await this.GetTemplateListBySetupId(t.formSchema[0].Data[0].value),await this.LoadTemplateBySetupId(t.formSchema[0].Data[0].value))},methods:{Close:function(){var t=this;t.$parent.ConfigurationPopup=!1},GetModuleConfigurationKeys:async function(t){var e=this;await e.GetModuleIdByModuleName();var a="moduleId="+e.ModuleId;await n["a"].GetConfigurationkeysData(a).then((function(t){null!=t&&null!=t.data&&e.ConvertConfigurationDataIntoDynamicFormobj(t.data.StorageKeys)}))},GetTemplateListBySetupId:async function(t){var e=this,a="SetupId="+t;e.formSchema[0].Data[2].config.options=[],await n["a"].GetTemplateListBySetupId(a).then((function(t){t.data.length>0?t.data.forEach(t=>{e.formSchema[0].Data[2].config.options.push({name:t.NAME,value:""+t.INVOICE_TYPE_ID})}):e.formSchema[0].Data[2].config.options=[],e.$refs.ConfigurationsForm.UpdateKeyValue()}))},LoadTemplateBySetupId:async function(t){var e=this,a="SetupId="+t;e.formSchema[0].Data[1].config.options=[],await n["a"].LoadTemplateBySetupId(a).then((function(t){t.data.length>0?t.data.forEach(t=>{e.formSchema[0].Data[1].config.options.push({name:t.Name,value:""+t.Value})}):e.formSchema[0].Data[1].config.options=[],e.$refs.ConfigurationsForm.UpdateKeyValue()}))},async GetModuleIdByModuleName(){var t=this,e="moduleName="+t.moduleCode;await n["a"].GetModuleIdByModuleName(e).then((function(e){null!=e&&null!=e.data&&(t.ModuleId=e.data)}))},Getoption:function(t){t=null==t?"":t;var e=[];return $.each(t.split("^"),(function(t,a){e.push(a)})),e},ConvertConfigurationDataIntoDynamicFormobj:function(t){var e=this;if(e.formSchema=[],t.sort((t,a)=>{const i=e.$t(t.DISPLAY_ORDER),s=e.$t(a.DISPLAY_ORDER),n=Number(i),l=Number(s);return isNaN(n)||isNaN(l)?i>s?1:s>i?-1:0:n-l}),null!=t&&t.length>0){let a={layoutType:"double",groupId:0,group_name:"",Data:[]};t.forEach((function(t,i){var s;let n={required:!0},l=t.ASTYPE,o=[];var r=null!==(s=t.CORE_CONFIG_VALUE)&&void 0!==s?s:"";null!=t.CORE_CONFIG_OPTIONS&&(o=e.MakeArray(e.$t(t.CORE_CONFIG_OPTIONS),"radio","^")),null!=t.SELECT_OPTIONS&&""!=t.SELECT_OPTIONS&&(o=e.MakeNormalArray(t.SELECT_OPTIONS));let c="date",d="Enter "+e.$t(t.CORE_CONFIG_KEY);if("SelectField"==l||"CustomSelectField"==l||"TreeSelectField"==l)d="Select "+e.$t(t.CORE_CONFIG_KEY);else if("MultiSelectField"==l){r=[];let e=t.CORE_CONFIG_VALUE.split("^");e.forEach((function(t){r.push({label:t,value:t})}))}else"CheckBoxField"==l&&(r=t.CORE_CONFIG_VALUE.split("^"));if("DateField"==l)c="date";else if("MultiSelectField"==l)c="tag";else if("FileField"==l)var u=t.CORE_CONFIG_VALUE,p=u.split("/").pop();else"JPJobCode"==t.CORE_CONFIG_KEY?(n["alpha_num"]=!0,n["min"]=4,n["max"]=6):"TaxOverride"==t.CORE_CONFIG_KEY&&(l="toggleField",n["required"]=!1,r="true"==t.CORE_CONFIG_VALUE);let m={customFieldId:t.CORE_CONFIG_ID,astype:l,label:e.$t(t.CORE_CONFIG_KEY),name:t.CORE_CONFIG_KEY,displayOrder:t.DISPLAY_ORDER,value:r,placeholder:d,mode:c,config:{maxSize:5,showSelectedFiles:[{attachmentName:u,attachmentPath:p}],onChange:e.onChangeField,onDeleteSelectedFiles:e.onDeleteSelectedFiles,onClickSelectedFiles:e.showCompanyLogo,accept:[{fileType:"png",iconClass:"fa-file-image-o"},{fileType:"jpg",iconClass:"fa-file-image-o"},{fileType:"jpeg",iconClass:"fa-file-image-o"}],mode:c,options:o,dependentOn:null,showWhen:null,valueMapping:null,fieldCode:null,showCrossOnSelectedFiles:!1},visibility:!0,validationRules:n,dtCode:t.CORE_CONFIG_TYPE};a.Data.push(m)})),e.formSchema.push(a);const i=e.formSchema[0].Data.filter(t=>"IsTaxable"===t.name),s=i[0].value;"Exempt"==s&&e.formSchema.forEach((function(t,e){t.Data.forEach((function(t,e){"TaxOverride"==t.name&&(t.visibility=!1)}))}))}},async showCompanyLogo(t){var e=this;let a=document.createElement("a");a.target="_blank",await e.GetCompanyLogo(t.attachmentPath),a.href=e.CompanyLogo,a.click()},async GetCompanyLogo(t){var e=this,a="imagename="+t;await n["a"].GetCompanyLogo(a).then(t=>{e.CompanyLogo=t.data})},MakeArray:function(t,e,a){var i=[],s=",";"undefined"!=typeof a&&null!=a&&(s=a);var n=String(t).split(s);if("radio"==e||"checkbox"==e){if(n.length>0)for(let o of n)if(o.split("|").length>1){var l={name:o.split("|")[0].trim(),value:o.split("|")[1].trim()};i.push(l)}else{l={name:this.$t(o.trim()),value:o.trim()};i.push(l)}}else if(n.length>0)for(let o of n){l={name:o.trim(),value:o.trim()};i.push(l)}return i},onChangeField:async function(t,e){var a=this;if("FileField"==e.astype)try{a.fileData=[];for(var i=t.target.files,s=0;s<i.length;s++){var n=i[s],l=new FileReader;l.onload=function(t){return function(t){var i=t.target.result,s=window.btoa(i),l=n.name;a.fileName=l;var o=l.lastIndexOf("."),r=l.substring(o+1,l.length);a.fileExt+="."+r;var c='{"ContentType":"'+n.type+'","Size":"'+n.size+'","Extension":"'+r+'"}',d=n.size;a.fileSize=d;var u={attachement_mime:c,fileName:l,userId:a.GetUserInfo.ID,companyId:a.GetUserInfo.CompanyId,id:0,moduleName:a.currentSelectedModule.moduleName.toLowerCase(),subModuleCode:"",containerName:a.GetUserInfo.ContainerName,base64String:s,attachement_path:"",fieldName:e.name};a.AttachmentFileDetail.push(u)}}(),l.readAsBinaryString(n)}}catch(o){}"SelectSetup"==e.name&&(await a.LoadTemplateBySetupId(e.value),await a.GetTemplateListBySetupId(e.value)),"IsTaxable"==e.name&&a.formSchema.forEach((t,a)=>{t.Data.forEach((t,a)=>{"Exempt"==e.value?"TaxOverride"==t.name?(t.visibility=!1,t.value=!1):t.visibility=!0:"TaxOverride"==t.name&&(t.visibility=!0)})})},onDeleteSelectedFiles:function(t,e){var a=this;a.formSchema.forEach((function(t,e){t.Data.forEach((function(t,e){"FileField"==t.astype&&(a.$delete(t.config,"showSelectedFiles"),t.value="")}))}))},SendAttactment:async function(){this.token=this.GetUserInfo?this.GetUserInfo.Token:"";var t=this,e=JSON.stringify(t.AttachmentFileDetail);await n["a"].UploadFile(e).then((function(e){e.data&&e.data.length>0&&(t.CheckFileSave=!1,t.formSchema.forEach((function(t,a){t.Data.forEach((function(t,a){if("FileField"==t.astype)if("companylogo"==t.name.toLowerCase()){var i=e.data[0].Name.split("/")[e.data[0].Name.split("/").length-1];t.value=i}else t.value=e.data[0].Name}))})),t.SaveConfigurations())}))},FinalSaveConfigurations:function(){var t=this;t.formSchema[0].Data.forEach(e=>{e.dtCode&&"image"==e.dtCode.toLowerCase()&&t.AttachmentFileDetail.length>0&&(t.CheckFileSave=!0)}),t.CheckFileSave?t.SendAttactment():t.SaveConfigurations()},CloseConfigurationPopUp(){this.$emit("CloseConfigurationPopUp")},SaveConfigurations:function(){var t=this,e=[];t.formSchema.forEach((function(t,a){t.Data.forEach((function(t,a){var i=t.value;if("CheckBoxField"==t.astype&&(i=t.value.filter(t=>""!=t).join("^")),"MultiSelectField"==t.astype){let e="";if("object"==typeof t.value)try{"undefined"!=typeof t.value.length&&t.value.length>0?t.value.forEach((function(t){e=""==e?t.value:e+"^"+t.value})):e=t.value.value}catch(n){e=t.value.value}else e=t.value;i=e}var s={DataId:t.customFieldId,key:t.name,DataValue:i};e.push(s)}))}));var a={configData:e,conditionData:{refCode:"CompanySetting",moduleName:t.moduleCode}},i=JSON.stringify(a);n["a"].ManageDocUserStorageSettingData(i).then((function(e){null!=e&&null!=e.data&&1==e.data?(t.ShowAlert(t.$t("RecordsSavedSuccessfully"),"success"),t.CloseConfigurationPopUp()):t.ShowAlert(t.$t("UnknownErrorOccur"),"failure",!0,t.$t("Alert"))}))}}},Hl=Vl,jl=(a("b750"),Object(d["a"])(Hl,Gl,Yl,!1,null,null,null)),ql=jl.exports,zl=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"my-popups"},[e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered ui-draggable"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header ui-draggable-handle py-1"},[e("h5",{staticClass:"pt-2",attrs:{name:"header"}},[t._v(" "+t._s(t.$t("CAMANAGECLIENTS"))+" ")]),e("button",{staticClass:"close",on:{click:t.onCancel}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("Form",{ref:"LeadForm"},[e("dynamic-form",{ref:"ManageClientForm",attrs:{buttons:t.buttons,schema:t.FormSchema},on:{OnSubmit:t.saveForm}})],1)],1)])])])])])},Wl=[],Jl={props:{ClientData:{type:Object,required:!0}},data(){return{IsShow:!0,FormSchema:[],fileMulitpleData:[],buttons:[{type:"submit",class:"btn btn-success AddLeadDetail_a",text:"<i class='fa fa-save pr-2'></i>Save"},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Cancel",onClick:this.onCancel,isVisible:!0}]}},created(){var t=this;t.IsShow=!(t.$route.params.id>0),t.getForm()},methods:{onCancel:function(){var t=this;t.$emit("onCancel"),t.$parent.getClientDetailData()},getForm(){var t=this;t.isLoading=!0;var e=`recordId=${t.$route.params.id}&moduleName=Company&subModuleCode=Client&langCode=en`;n["a"].GetDynamicForm(e).then((function(e){null!=e&&null!=e.data&&(t.FormSchema=t.$refs.ManageClientForm.ConvertCustomFieldIntoDynamicFormObj(e.data.data),t.FormSchema.forEach((e,a)=>{e.Data.forEach(async(e,a)=>{if("is_existing_account"==e.name&&""==e.value&&(e.value="1"),"user_type_id"==e.name&&""==e.value&&(e.value=4),"email_id"==e.name&&(e.disabled=!0,e.value=""==e.value?t.$route.params.email:e.value),"status_id"==e.name&&(e.value=1001),"client_type"==e.name&&""==e.value&&(e.value="individual"),"avatar"==e.name){e.showLabel=!1,e.config={maxSize:5,accept:[{fileType:"jpg",iconClass:"fa-file-image-o"},{fileType:"jpeg",iconClass:"fa-file-image-o"},{fileType:"png",iconClass:"fa-file-image-o"}],multiple:!1,showSelectedFiles:[],onDeleteSelectedFiles:t.onDeleteSelectedFiles,onClickSelectedFiles:t.onClickSelectedFiles};var i=[];if(""!=e.value){var s={attachmentId:0,attachmentName:JSON.parse(e.value)[0].AttchmentName,attachmentPath:JSON.parse(e.value)[0].AttachmentPath,attachmentDesc:JSON.parse(e.value)[0].AttachmentDesc};i.push(s),i.length>0&&e.config.showSelectedFiles.push(...i)}}e.config.onChange=t.onChangeEventForFields})}),t.isLoading=!1)}))},onDeleteSelectedFiles:function(){var t=this;t.FormSchema.forEach((e,a)=>{e.Data.forEach(async(e,a)=>{"avatar"==e.name&&(t.$delete(e.config,"showSelectedFiles"),t.fileMulitpleData=[])})})},onChangeEventForFields(t,e,a){"avatar"==e.name&&this.GetBase64String(e.value),"is_existing_account"==e.name&&("0"==e.value?(this.$refs.ManageClientForm.updateProperty("parent_id","visibility",!1),this.$refs.ManageClientForm.updateProperty("account_name","visibility",!0)):(this.$refs.ManageClientForm.updateProperty("parent_id","visibility",!0),this.$refs.ManageClientForm.updateProperty("account_name","visibility",!1)))},GetBase64String(t){try{var e=this,a=t[0],i=new FileReader;let s={};i.onload=function(t){return function(t){var i=t.target.result,n=window.btoa(i),l=a.name;e.fileName=l;var o=l.lastIndexOf("."),r=l.substring(o+1,l.length);e.fileExt+="."+r;var c='{"ContentType":"'+a.type+'","Size":"'+a.size+'","Extension":"'+r+'"}',d=a.size;e.fileSize=d,s.attachement_mime=c,s.fileName=l,s.base64String=n,s.fileSize=a.size,s.contentType=a.type,s.ModuleName="Company",s.SubModuleCode="Client",e.fileMulitpleData.push(s)}}(),i.readAsBinaryString(a)}catch(s){}},saveForm(){var t=this;t.isLoading=!0,t.$refs.ManageClientForm.validateForm.validate().then(e=>{if(e){t.isLoading=!0;var a=t.$refs.ManageClientForm.ConvertDynamicFormObjToCustomFieldObj(t.FormSchema);a.forEach(t=>{"last_name"===t.field_name&&(t.field_value&&""!==t.field_value.trim()||(t.field_value="."))});var i={data:a,moduleCode:"Company",subModuleCode:"Client",attachmentData:t.fileMulitpleData.length>0?t.fileMulitpleData:null};n["a"].SaveDynamicForm(JSON.stringify(i)).then((function(e){if(null!=e&&null!=e.data&&"Success"==e.data[0].Status)if(t.isLoading=!1,t.$route.params.id>0)"DUPLICATE"==e.data[0].Value.MSG?t.ShowAlert(t.$t("AlreadyExists",[t.$t("Email")]),"warning",!0,t.$t("Alert")):(t.ShowAlert(t.$t("UpdatedSuccess",[t.$t("Client")]),"success",!0,t.$t("Alert")),t.onCancel());else if("DUPLICATE"==e.data[0].Value.MSG)t.ShowAlert(t.$t("AlreadyExists",[t.$t("Email")]),"warning",!0,t.$t("Alert"));else{t.ShowAlert(t.$t("AddedSuccess",[t.$t("Client")]),"success",!0,t.$t("Alert"));var a="User_Id="+e.data[0].Value.MAIN_ID;n["a"].SendEmailClient(a).then(t=>{}),t.onCancel()}})),t.isLoading=!1}})}}},Kl=Jl,Ql=Object(d["a"])(Kl,zl,Wl,!1,null,null,null),Zl=Ql.exports,Xl=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"my-popups"},[e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered ui-draggable"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header ui-draggable-handle py-1"},[e("h5",{staticClass:"pt-2",attrs:{name:"header"}},[t._v(" "+t._s(t.$t("ManageCommunicationType"))+" ")]),e("button",{staticClass:"close",on:{click:t.onCancel}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("Form",{ref:"LeadForm"},[e("dynamic-form",{ref:"refCommunication",attrs:{lang:"en",mandatorytext:t.MandatoryString,buttons:t.buttons,schema:t.FormSchema},on:{OnSubmit:t.onSubmit}})],1),e("div",{staticClass:"listing mt-3"},[e("div",{staticClass:"table-responsive"},[e("table",{staticClass:"table table-bordered dt-responsive nowrap mt-0",attrs:{id:"Addresslist"}},[e("thead",{staticClass:"thead-bg"},[e("tr",[t._m(0),e("th",{staticClass:"text-left"},[e("span",[t._v(t._s(t.$t("CommunicationType")))])]),e("th",{staticClass:"text-left"},[e("span",[t._v(t._s(t.$t("AddressOrScreenName")))])]),e("th",{staticClass:"text-left"},[e("span",[t._v(t._s(t.$t("NotesDescription")))])]),e("th",{staticClass:"text-center"},[e("span",[t._v(t._s(t.$t("IsinCompanyDirectory")))])]),e("th",{staticClass:"text-center"},[e("span",[t._v(t._s(t.$t("Edit")))])]),e("th",{staticClass:"text-center"},[e("span",[t._v(t._s(t.$t("Delete")))])])])]),e("tbody",[0===t.EmailData.length?e("tr",[e("td",{staticClass:"text-center text-danger no_records no-record",attrs:{colspan:"5"}},[t._v(" "+t._s(t.$t("NoRecordfound")))])]):t._e(),t._l(t.EmailData,(function(a,i){return e("tr",{key:a.ROWNUMBER},[e("td",{staticClass:"text-center"},[t._v(t._s(i+1))]),e("td",{staticClass:"text-left"},[t._v(t._s(a.CARRIER_TYPE_NAME))]),e("td",{staticClass:"text-left"},[t._v(t._s(a.CARRIER_VALUE))]),e("td",{staticClass:"text-left"},[t._v(t._s(a.USER_EMAIL_DESC))]),e("td",{staticClass:"text-center"},[t._v(t._s(a.ADD_TO_DIRECTORY?"Yes":"No"))]),e("td",{staticClass:"text-center single-action"},[e("a",{staticClass:"enable",attrs:{"data-placement":"left",href:"javascript:;","data-toggle-tooltip":"tooltip","data-original-title":"Edit"},on:{click:function(e){return t.Edit(a)}}},[e("em",{staticClass:"fa fa-pencil text-success action-icon"})])]),e("td",{staticClass:"text-center single-action"},[e("a",{class:{enable:!0,disabled:t.isDiabled},attrs:{"data-placement":"left",href:"javascript:;","data-toggle-tooltip":"tooltip","data-original-title":"Delete","aria-describedby":"tooltip845041"},on:{click:function(e){return t.Delete(a)}}},[e("em",{staticClass:"fa fa-trash action-icon text-danger"})])])])}))],2)])])])],1)])])])])])},to=[function(){var t=this,e=t._self._c;return e("th",{staticClass:"text-center"},[e("span",[t._v("#")])])}],eo={props:{ClientId:{type:Number},IsClient:{type:String}},data(){return{EmailData:[],MandatoryString:this.$t("MandatoryString"),FormSchema:[{layoutType:"triple",Data:[{astype:"SelectField",label:this.$t("CommunicationType"),name:"CommunicationType",value:"",placeholder:"",validationRules:{required:!0,max:250},config:{options:[]}},{astype:"TextField",label:this.$t("AddressOrScreenName"),name:"AddressScreenName",value:"",placeholder:"",validationRules:{required:!0}},{astype:"TextField",label:this.$t("NotesDescription"),name:"NoteDescription",value:"",placeholder:"",disabled:!1,validationRules:{required:!1}}]},{layoutType:"triple",Data:[{astype:"toggleField",label:this.$t("IsinCompanyDirectory"),name:"CompanyDirectory",value:"",placeholder:""},{astype:"toggleField",label:this.$t("VisibleToClient"),name:"VisibleToClient",value:"",placeholder:"",config:{onChange:this.visibleToClient}}]}],buttons:[{type:"submit",class:"btn btn-success",text:"<i class='fa fa-save pr-2'></i>Save"},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Cancel",onClick:this.onCancel}],CommunicationTypes:[],pageNo:1,pageSize:10,EmailId:0,isDiabled:!1}},created(){var t=this;t.getCommunicationTypes(),t.FetchData(),"Client"==t.IsClient?t.FormSchema[1].Data[1].visibility=!1:t.FormSchema[1].Data[1].visibility=!0},methods:{async getCommunicationTypes(){try{var t=this;await n["a"].GetCommunicationTypes().then(e=>{t.CommunicationTypes=e.data,t.CommunicationTypes.length>0&&(t.CommunicationTypes.forEach((e,a)=>{t.FormSchema[0].Data[0].config.options.push({name:e.text,value:e.value})}),t.$refs.refCommunication.UpdateKeyValue())})}catch(e){console.error("Error in getCommunicationTypes:",e)}},FetchData:function(){var t=this;t.isLoading=!0;var e=`pageNum=${t.pageNo}&pageSize=${t.pageSize}&sortBy=&sortExp=&userId=${t.ClientId}`;n["a"].GetUserEmailList(e).then((function(e){var a=JSON.parse(e.data);t.EmailData=a.data}))},Edit:function(t){var e=this;e.EmailId=t.USER_EMAIL_ID,e.FormSchema[0].Data[0].value=t.CARRIER_TYPE_ID,e.FormSchema[0].Data[1].value=t.CARRIER_VALUE,e.FormSchema[0].Data[2].value=t.USER_EMAIL_DESC,e.FormSchema[1].Data[0].value=t.ADD_TO_DIRECTORY,e.FormSchema[1].Data[1].value=t.IS_VISIBLE,e.isDiabled=!0},Delete:function(t){var e=this;e.EmailId=t.USER_EMAIL_ID,e.EmailId>0?e.confirmR(e.$t("ConfirmDelete"),!0,e.$t("Delete")+"  "+e.$t("AddtionalEmail"),(function(){var t=`EmailId=${e.EmailId}&userId=${e.ClientId}`;n["a"].DeleteAddtionalEmail(t).then((function(t){200==t.status?(e.ShowAlert(e.$t("DeletedSuccess",[e.$t("Record")]),"success",!0,e.$t("Alert")),e.FetchData()):e.ShowAlert(e.$t("DeletedError",[e.$t("Record")]),"failure",!0,e.$t("Alert"))}))})):e.ShowAlert(e.$t("Selectanyrecordtodelete")),e.isLoading=!1},visibleToClient(){var t=this;t.confirmR(t.$t("Are you sure you want to make this Visible to Client?"),!0,!1,(function(t){}),(function(){t.cancelAction()}))},cancelAction(){this.FormSchema[1].Data[1].value=1!=this.FormSchema[1].Data[1].value},async onSubmit(t){var e=this;e.isLoading=!0;let a={EmailId:e.EmailId,CommunicationType:t.CommunicationType,AddressScreenName:t.AddressScreenName,NoteDescription:t.NoteDescription,AddToDirectory:t.CompanyDirectory,VisibleTo:""!=t.VisibleToClient&&t.VisibleToClient,configUserId:e.ClientId};var i=JSON.stringify(a);await n["a"].AddUpdateAdditionalEmail(i).then((function(t){null!=t&&null!=t.data&&t.data>0?(e.ShowAlert(e.$t("RecordsSavedSuccessfully"),"success"),e.Clear(),e.FetchData()):(e.ShowAlert(e.$t("UnknownErrorOccur"),"failure",!0,e.$t("Alert")),e.FetchData())})),e.isLoading=!1},onCancel:function(){this.Clear(),this.$emit("CloseAddCommuniction")},Clear:function(){var t=this;t.EmailId=0,t.isDiabled=!1,t.FormSchema[0].Data[0].value="",t.FormSchema[0].Data[1].value="",t.FormSchema[0].Data[2].value="",t.FormSchema[1].Data[0].value="",t.FormSchema[1].Data[1].value="",t.$refs.refCommunication.validateForm.reset()}}},ao=eo,io=Object(d["a"])(ao,Xl,to,!1,null,null,null),so=io.exports,no=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"my-popups gd_mainbase"},[e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered ui-draggable"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header ui-draggable-handle py-1"},[e("h5",{staticClass:"pt-2",attrs:{name:"header"}},[t._v(" "+t._s(t.$t("Notes"))+" ")]),e("span",{staticClass:"float-right pt-2"},[e("a",{staticClass:"text-white",attrs:{href:"javascript:;","data-toggle-tooltip":"tooltip"},on:{click:t.AddNewNote}},[e("em",{staticClass:"fa fa-plus mr-2"}),t._v(t._s(t.$t("AddNote"))+" ")])]),e("button",{staticClass:"close",on:{click:t.onCancel}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[t.IsNote?e("Form",{ref:"LeadForm"},[e("dynamic-form",{ref:"refCommunication",attrs:{lang:"en",mandatorytext:t.MandatoryString,buttons:t.buttons,schema:t.FormSchema},on:{OnSubmit:t.onSubmit},scopedSlots:t._u([{key:"tgslot-Content",fn:function({data:a}){return[e("ckeditor",{ref:"textarea",class:{"is-invalid":""!=a.error},attrs:{editor:t.editor},on:{ready:t.onReady},model:{value:t.editorData,callback:function(e){t.editorData=e},expression:"editorData"}}),e("span",{staticClass:"invalid-feedback"},[t._v(t._s(a.error))])]}}],null,!1,2592373697)})],1):t._e(),t.IsNote?t._e():e("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 mt-4 p-0 float-left"},[t._l(t.NoteData,(function(a,i){return e("div",{key:i,staticClass:"col-lg-12 mb-3 p-0"},[e("div",{staticClass:"customer-headersmall notespanel",staticStyle:{"border-bottom":"1px solid #eee"}},[t._m(0,!0),e("div",{staticClass:"customer-info w-100"},[e("div",{staticClass:"d-flex justify-content-between"},[e("h1",{staticClass:"mb-0"},[t._v(t._s(a.notes_created_by))]),e("span",{staticClass:"sender-department"},[e("small",{staticClass:"text-secondary font-14 mr-4 font-weight-medium",attrs:{title:t._f("formatDateTime")(a.note_date)}},[t._v(" "+t._s(t._f("formatDateTime")(a.note_date))+" ")]),e("span",{staticClass:"ml-4"},[t.LogginUserId==a.created_by?e("a",{staticClass:"float-right",attrs:{href:"javascript:;",id:"DeleteNote"},on:{click:function(e){return t.deleteNote(a.crm_note_id)}}},[e("em",{staticClass:"fa fa-trash-o text-danger font-18",attrs:{"aria-hidden":"true"}})]):t._e(),t.LogginUserId==a.created_by?e("a",{staticClass:"float-right mr-3",attrs:{href:"javascript:;"},on:{click:function(e){return t.editNote(a)}}},[e("em",{staticClass:"fa fa-pencil text-success font-18",attrs:{"aria-hidden":"true"}})]):t._e()])])]),e("div",{staticClass:"customer-meta w-90"},[e("p",{staticClass:"mb-0",domProps:{innerHTML:t._s(a.crm_notes)}})])])])])})),0==t.NoteData.length?e("div",{staticClass:"text-center text-danger border p-2 norecord"},[t._v(" "+t._s(t.$t("NorecordfoundText"))+" ")]):t._e()],2)],1)])])])])])},lo=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"profileicon"},[e("em",{staticClass:"fa fa-user"})])}],oo={data(){return{MandatoryString:this.$t("MandatoryString"),isLoading:!1,editor:this.CLASSIC_EDITOR,LogginUserId:null,editorData:"",crmNoteId:null,FormSchema:[{layoutType:"single",Data:[{astype:"RadioField",label:"Visibility",name:"Visibility ",value:"1",placeholder:"",disabled:!1,config:{options:[{value:"1",name:"Public"},{value:"0",name:"Private"}]},validationRules:"required"},{astype:"SlotField",label:this.$t("NotesDescription"),name:"Content",value:"",placeholder:"",validationRules:{required:!0,max:1e3},config:{options:[]}}]}],buttons:[{type:"submit",class:"btn btn-success",text:"<i class='fa fa-save pr-2'></i>Save"},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Cancel",onClick:this.AddNewNote}],NoteData:[],IsNote:!1}},created:function(){var t=this;t.LogginUserId=t.GetUserInfo.ID,t.NoteListing()},methods:{NoteListing(){var t=this;t.NoteData=[];var e=`id=${this.$route.params.id}&refId=${this.$route.params.id}&moduleName=Company&subModuleCode=Client`;n["a"].NoteListing(e).then(e=>{e.data.data.length>0?e.data.data.forEach(e=>{e.note_date=new Date(e.note_date),t.NoteData.push(e)}):t.NoteData=[]})},onSubmit(){var t=this,e={sourceId:t.$route.params.id,moduleName:"Company",subModuleCode:"Client",note:t.editorData,isPrivate:t.FormSchema[0].Data[0].value,crmNotesId:t.crmNoteId},a=JSON.stringify(e);n["a"].SaveNoteData(a).then((function(e){"Success"==e.data[0].Status&&(null!=t.crmNoteId?t.ShowAlert(t.$t("UpdatedSuccess",[t.$t("Note")]),"success",!0,t.$t("Alert")):t.ShowAlert(t.$t("AddedSuccess",[t.$t("Note")]),"success",!0,t.$t("Alert")),t.NoteListing(),t.editorData="",t.IsNote=!1)}))},onCancel(){var t=this;t.$emit("CloseNotePopup")},editNote(t){var e=this;e.IsNote=!0,e.crmNoteId=t.crm_note_id,e.FormSchema[0].Data[0].value=t.IS_PRIVATE?"1":"0",e.editorData=t.crm_notes},deleteNote:function(t){var e=this;null!=t&&e.confirmR(this.$t("ConfirmDelete"),this.$t("Delete"),this.$t("Note"),(function(){var a={ids:t,moduleName:"Client",subModuleCode:"Company",refCode:"DELETE_VIEW_CRM_NOTE"},i=JSON.stringify(a);n["a"].CommonDelete(i).then((function(t){"Success"==t.data[0].Status?(e.ShowAlert(e.$t("DeletedSuccess",[e.$t("NOTE")]),"success",!0,e.$t("Alert")),e.NoteListing()):e.ShowAlert(e.$t("DeletedError",[e.$t("NOTE")]),"failurfe",!0,e.$t("Alert"))}))}))},AddNewNote(){var t=this;t.IsNote=!t.IsNote}}},ro=oo,co=(a("8e00"),Object(d["a"])(ro,no,lo,!1,null,"21af6479",null)),uo=co.exports,po=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"my-popups"},[e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered ui-draggable"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header ui-draggable-handle py-1"},[e("h5",{staticClass:"pt-2",attrs:{name:"header"}},[t._v(" "+t._s(t.$t("ManageContact"))+" ")]),e("button",{staticClass:"close",on:{click:t.onCancel}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"container-fluid p-0"},[e("div",{staticClass:"border p-3 col-lg-12"},[e("dynamic-form",{ref:"dynamicForm",attrs:{lang:"en",buttons:t.buttons,mandatorytext:t.$t("MandatoryString"),schema:t.FormSchema},on:{OnSubmit:t.onSubmit}})],1),e("div",{staticClass:"listing mt-2"},[e("div",{staticClass:"conversation-date heading-border"},[e("span",[t._v(t._s(t.$t("ContactNumber")))])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"d-inline-block"},[e("span",{staticClass:"legend-pending colorboxsquare"}),t._v(t._s(t.$t("Communication"))+" "+t._s(t.$t("VisibleToClient"))+" ")])])]),e("div",{staticClass:"table-responsive"},[e("table",{staticClass:"table table-bordered dt-responsive nowrap mt-0",attrs:{id:"Addresslist"}},[e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",{staticClass:"text-center"},[e("div",{staticClass:"custom-control custom-checkbox"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.selectAll,expression:"selectAll"}],staticClass:"AddressChkAll custom-control-input",attrs:{type:"checkbox",id:"chkAll_0",name:"checkbox"},domProps:{checked:Array.isArray(t.selectAll)?t._i(t.selectAll,null)>-1:t.selectAll},on:{change:[function(e){var a=t.selectAll,i=e.target,s=!!i.checked;if(Array.isArray(a)){var n=null,l=t._i(a,n);i.checked?l<0&&(t.selectAll=a.concat([n])):l>-1&&(t.selectAll=a.slice(0,l).concat(a.slice(l+1)))}else t.selectAll=s},t.toggleSelectAll]}}),e("label",{staticClass:"custom-control-label universal-custom-control-label pt-1",attrs:{for:"chkAll_0"}})])]),t._m(0),e("th",{staticClass:"text-left"},[e("span",[t._v(t._s(t.$t("ContactNumber")))])]),e("th",{staticClass:"text-left"},[e("span",[t._v(t._s(t.$t("PhoneDescription")))])]),e("th",{staticClass:"text-center"},[e("span",[t._v(t._s(t.$t("CompanyDirectory"))+" ")])]),e("th",{staticClass:"text-center"},[e("span",[t._v(t._s(t.$t("Edit")))])]),e("th",{staticClass:"text-center"},[e("span",[t._v(t._s(t.$t("Delete")))])])])]),e("tbody",[t._l(t.PhoneData.data,(function(a,i){return e("tr",{key:a.user_phone_id,class:1==a.is_visible?"text-center high-bar":"text-center"},[e("td",{staticClass:"text-center"},[e("div",{staticClass:"custom-control custom-checkbox"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.selected,expression:"phone.selected"}],staticClass:"chkItems custom-control-input",attrs:{type:"checkbox",id:"chk_"+a.user_phone_id},domProps:{checked:Array.isArray(a.selected)?t._i(a.selected,null)>-1:a.selected},on:{change:function(e){var i=a.selected,s=e.target,n=!!s.checked;if(Array.isArray(i)){var l=null,o=t._i(i,l);s.checked?o<0&&t.$set(a,"selected",i.concat([l])):o>-1&&t.$set(a,"selected",i.slice(0,o).concat(i.slice(o+1)))}else t.$set(a,"selected",n)}}}),e("label",{staticClass:"custom-control-label universal-custom-control-label pt-1",attrs:{for:"chk_"+a.user_phone_id}})])]),e("td",{staticClass:"text-center"},[t._v(t._s(a.ROWNUMBER))]),e("td",{staticClass:"text-left"},[t._v(t._s(a.user_phone))]),e("td",{staticClass:"text-left"},[t._v(t._s(a.user_phone_desc))]),e("td",{staticClass:"text-center"},[t._v(t._s(a.add_to_directory?"Yes":"No")+" ")]),e("td",{staticClass:"text-center single-action"},[e("a",{staticClass:"enable",attrs:{"data-placement":"left",href:"javascript:;","data-toggle-tooltip":"tooltip","data-original-title":"Edit"},on:{click:function(e){return t.Edit(a)}}},[e("em",{staticClass:"fa fa-pencil text-success action-icon"})])]),e("td",{staticClass:"text-center single-action"},[e("a",{staticClass:"enable",attrs:{"data-placement":"left",href:"javascript:;","data-toggle-tooltip":"tooltip","data-original-title":"Delete","aria-describedby":"tooltip845041"},on:{click:function(e){return t.Delete(a)}}},[e("em",{staticClass:"fa fa-trash action-icon text-danger"})])])])})),0==t.PhoneData.data.length?e("tr",[e("td",{staticClass:"text-danger text-center no-record",attrs:{colspan:"7"}},[t._v(" "+t._s(t.$t("NoRecordfound")))])]):t._e()],2)])])])])])])])])])])},mo=[function(){var t=this,e=t._self._c;return e("th",{staticClass:"text-center"},[e("span",[t._v("#")])])}],ho={name:"Manage Contact",props:{UserId:{type:Number},IsClient:{type:String}},data(){return{FormSchema:[{layoutType:"double",Data:[{astype:"PhoneField",label:this.$t("ContactNumber"),name:"ContactNumber",value:"",placeholder:this.$t("ContactNumber"),validationRules:{required:!0},disabled:!1},{astype:"TextField",label:this.$t("PhoneDescription"),name:"PhoneDescription",value:"",placeholder:this.$t("PhoneDescription"),validationRules:{required:!0},disabled:!1},{astype:"toggleField",label:this.$t("IsinCompanyDirectory"),name:"CompanyDirectory",value:"",placeholder:"",validationRules:{required:!1}},{astype:"toggleField",label:this.$t("VisibleToClient"),name:"VisibleToClient",value:"",placeholder:"",validationRules:{required:!1},config:{onChange:this.VisibleToClient}}]}],buttons:[{type:"submit",class:"btn btn-success",text:"<i class='fa fa-save pr-2'></i>Save",isVisible:!0},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Cancel",onClick:this.Clear}],isLoading:!1,phoneId:0,pageNo:1,pageSize:10,PhoneData:[]}},created:function(){var t=this;t.FetchData(),"Client"==t.IsClient?t.FormSchema[0].Data[3].visibility=!1:t.FormSchema[0].Data[3].visibility=!0},methods:{FetchData:function(){var t=this;t.isLoading=!0;var e=`pageNum=${t.pageNo}&pageSize=${t.pageSize}&sortBy=&sortExp=&userId=${t.UserId}`;n["a"].GetUserPhoneList(e).then((function(e){t.PhoneData=JSON.parse(e.data)}))},Edit:function(t){var e=this;e.phoneId=t.user_phone_id,e.FormSchema[0].Data[0].value=t.user_phone,e.FormSchema[0].Data[1].value=t.user_phone_desc,e.FormSchema[0].Data[2].value=t.add_to_directory,"Client"==e.IsClient?e.FormSchema[0].Data[3].visibility=!1:e.FormSchema[0].Data[3].value=t.is_visible},Delete:function(t){var e=this;e.phoneId=t.user_phone_id,e.phoneId>0?e.confirmR(e.$t("ConfirmDelete"),!0,e.$t("Delete")+"  "+e.$t("AddtionalPhone"),(function(){var t=`phoneId=${e.phoneId}&userId=${e.UserId}`;n["a"].DeleteAddtionalPhone(t).then((function(t){"Deletion successful"==t.data.Message?(e.ShowAlert(e.$t("DeletedSuccess",[e.$t("Record")]),"success",!0,e.$t("Alert")),e.FetchData()):e.ShowAlert(e.$t("DeletedError",[e.$t("Record")]),"failure",!0,e.$t("Alert"))}))})):e.ShowAlert(e.$t("Selectanyrecordtodelete")),e.isLoading=!1},onSubmit:function(t){var e=this,a={userPhoneId:e.phoneId>0?e.phoneId:0,userid:e.UserId,phone:t.ContactNumber,Description:t.PhoneDescription,isVisible:t.VisibleToClient,addToDir:t.CompanyDirectory,isVisibletoCA:!0},i=JSON.stringify(a);n["a"].AddUpdateContact(i).then(t=>{if(null!=t.data){JSON.parse(t.data);null!=t&&null!=t.data&&t.data>0?(e.ShowAlert(e.$t("RecordsSavedSuccessfully"),"success"),e.isLoading=!1,e.Clear(),e.FetchData(),e.onCancel()):(e.ShowAlert(e.$t("UnknownErrorOccur"),"failure",!0,e.$t("Alert")),e.isLoading=!1,e.FetchData())}})},Clear:function(){var t=this;t.phoneId=0,t.FormSchema[0].Data[0].value="",t.FormSchema[0].Data[1].value="",t.FormSchema[0].Data[2].value="",t.FormSchema[0].Data[3].value="",t.$refs.dynamicForm.validateForm.reset()},onCancel(){var t=this;t.$parent.IsContactNumber=!1,t.$parent.ContactNumber()},VisibleToClient(){var t=this;t.confirmR(t.$t("Are you sure you want to make this Visible to Client?"),!0,!1,(function(t){}),(function(){t.cancelAction()}))},cancelAction(){this.FormSchema[0].Data[3].value=1!=this.FormSchema[0].Data[3].value}}},vo=ho,_o=(a("0699"),Object(d["a"])(vo,po,mo,!1,null,null,null)),go=_o.exports,fo={components:{AddClientAddressModal:Ul,ClientConfigurationData:ql,NewClientPopup:Zl,AssociateContact:yt,AddCommunication:so,AddClientNote:uo,ContactNumberPopup:go},props:{ClientData:{type:Object,required:!0},UserId:{type:Number},IsClient:{type:String}},data(){return{containerName:null,blobUrl:"",IsAddNote:!1,IsAddCommunication:!1,IsClientAddress:!1,OpenAssociateContact:!1,IsNewClient:!1,ClientId:0,IsClient:"Client",moduleCode:"Billing",AddressList:[],IsClientConfiguration:!1,ModuleId:0,StorageKeys:[],totalInvoicesIssued:"00.00",totalamountbilled:"00.00",totalamountpaid:"00.00",TotalAmountDue:"00.00",totaloverdueamount:"00.00",InvoiceData:[],searchCondition:"",PageSize:10,statusId:"",PageNumber:1,isPaged:1,TotalPages:0,ListingData:[],EmailData:[],LogginUserId:null,RoleName:"--",TaxJudrisdictionName:"--",NoteData:[],CompanyId:null,NoteObj:null,AccountName:"",ClientOwnerName:"--",clientTypeName:"--",TimeZoneName:"--",MobileNumber:"--",ImagePath:"",CurrencyCode:"PKR",FormSchema:[],getInitialsName:"",IsContactNumber:!1}},created(){var t=this;t.containerName=t.GetUserInfo.ContainerName,t.LogginUserId=t.GetUserInfo.ID,t.CompanyId=t.GetUserInfo.CompanyId,t.CurrencyCode=t.GetUserInfo.Currency.replace(/[()]/g,""),t.getClientDetailData(),t.GetBlobUrl(),t.GetWidgetData(),t.GetAddressList(),t.GetModuleIdByModuleName(),t.GetContactList(),t.GetCommunicationList(),t.NoteListing(),t.ContactNumber()},methods:{getClientDetailData(){var t=this,e=`id=${t.$route.params.id}&moduleName=Company&subModuleCode=Client`;n["a"].GetDynamicViewList(e).then((function(e){if(null!=e&&null!=e.data){t.FormSchema=e.data.LEFTDATA;const a=t.FormSchema.find(t=>"first_name"===t.name),i=t.FormSchema.find(t=>"last_name"===t.name),s=t.FormSchema.find(t=>"account_name"===t.name),n=`${(null===a||void 0===a?void 0:a.value)||""} ${(null===i||void 0===i?void 0:i.value)||""}`.trim();s&&(s.value=n),t.GetBlobUrl()}}))},ContactNumber:function(){var t=this;t.isLoading=!0;var e=`pageNum=${t.PageNumber}&pageSize=${t.PageSize}&sortBy=&sortExp=&userId=${t.UserId}`;n["a"].GetUserPhoneList(e).then((function(e){var a=JSON.parse(e.data).data;t.MobileNumber=a.length>0?a.map(t=>t.user_phone).join(","):"--"}))},GetCommunicationList:function(){var t=this;t.isLoading=!0;var e=`pageNum=${t.PageNumber}&pageSize=${t.PageSize}&sortBy=&sortExp=&userId=${t.UserId}`;n["a"].GetUserEmailList(e).then((function(e){var a=JSON.parse(e.data);t.EmailData=a.data}))},GetWidgetData(){var t=this,e=`ClientId=${t.UserId}&userAddressId=0`;n["a"].GetClientWidgetData(e).then(e=>{null!=e.data&&(null!=e.data.result.DATA&&""!=e.data.result.DATA&&(t.totalInvoicesIssued=0==e.data.result.DATA.Total_invoice_issued||null==e.data.result.DATA.Total_invoice_issued?t.totalInvoicesIssued:e.data.result.DATA.Total_invoice_issued,t.totalamountbilled=0==e.data.result.DATA.Total_amount_bill||null==e.data.result.DATA.Total_amount_bill?t.totalamountbilled:e.data.result.DATA.Total_amount_bill,t.totalamountpaid=0==e.data.result.DATA.Total_amount_paid||null==e.data.result.DATA.Total_amount_paid?t.totalamountpaid:e.data.result.DATA.Total_amount_paid,t.totaloverdueamount=0==e.data.result.DATA.Total_over_due_amount||null==e.data.result.DATA.Total_over_due_amount?t.totaloverdueamount:e.data.result.DATA.Total_over_due_amount,t.TotalAmountDue=0==e.data.result.DATA.Total_amount_due||null==e.data.result.DATA.Total_amount_due?t.TotalAmountDue:e.data.result.DATA.Total_amount_due),null!=e.data.result.INVOICE_DATA&&""!=e.data.result.INVOICE_DATA&&(t.InvoiceData=e.data.result.INVOICE_DATA,t.InvoiceData.forEach(t=>{t.bill_due_date=new Date(t.bill_due_date),t.bill_issue_date=new Date(t.bill_issue_date),t.bill_date_to=new Date(t.bill_date_to)})))})},GetContactList(){var t=this,e=`clientId=${t.UserId}&pageSize=${t.PageSize}&pageNum=${t.PageNumber}&sortBy=${t.SortBy}&sortExp=${t.SortExp}`;t.isBlank(this.searchCondition)||(e+="&search="+this.searchCondition),n["a"].ListAdditionalNewContact(e).then((function(e){e.data?e.data.length>0?(t.ListingData=e.data,t.TotalRecords=e.data[0].TOTALRECORDS,t.noRecord=!1):(t.ListingData=[],t.noRecord=!0,t.TotalRecords=0):(t.noRecord=!0,t.ListingData=[],t.TotalRecords=0)}))},async GetAddressList(){var t=this,e=`userId=${t.UserId}&userAddressId=0`;await n["a"].GetAdditionalAddressList(e).then(e=>{null!=e.data&&(t.AddressList=[],e.data.result.length>0&&(t.AddressList=e.data.result))})},GetModuleConfigurationKeys:async function(t){var e=this,a="moduleId="+e.ModuleId;await n["a"].GetConfigurationkeysData(a).then((function(t){null!=t&&null!=t.data&&(e.StorageKeys=t.data.StorageKeys)}))},async GetModuleIdByModuleName(){var t=this,e="moduleName="+t.moduleCode;await n["a"].GetModuleIdByModuleName(e).then((function(e){null!=e&&null!=e.data&&(t.ModuleId=e.data,t.GetModuleConfigurationKeys())}))},GetBlobUrl:function(){var t=this;t.isLoading=!0,n["a"].GetBlobUrl().then(e=>{var a=e.data[0].CONFIG_DATA_VALUE;if(null==t.ClientData.clientdetail.avatar){t.blobUrl="";const e=t.ClientData.clientdetail.first_name?t.ClientData.clientdetail.first_name.trim():"",a=t.ClientData.clientdetail.last_name?t.ClientData.clientdetail.last_name.trim():"";t.getInitialsName=!e&&a?a.substring(0,2).toUpperCase():!a&&e?e.substring(0,2).toUpperCase():e&&a?(e.charAt(0)+a.charAt(0)).toUpperCase():"--"}else{const e=JSON.parse(this.ClientData.clientdetail.avatar),i=e[0].AttachmentPath;t.blobUrl=a+this.containerName+"/"+i}t.isLoading=!1})},ClosePopUp(){var t=this;t.IsClientAddress=!1,t.GetAddressList()},AddClientAddress(){var t=this;t.ClientId=t.UserId,t.IsClientAddress=!0},AddClientConfiguration(){var t=this;t.ClientId=t.UserId,t.IsClientConfiguration=!0},CloseConfigurationPopUp(){var t=this;t.GetModuleIdByModuleName(),t.IsClientConfiguration=!1},EditClient(){var t=this;t.IsNewClient=!0},onCancel(){var t=this;t.IsNewClient=!1},AssociateContact(){var t=this;t.ClientId=t.UserId,t.OpenAssociateContact=!0},CloseAssociatePopup(){var t=this;t.GetContactList(),t.OpenAssociateContact=!1},AddCommunication(){var t=this;t.IsAddCommunication=!0},CloseAddCommuniction(){var t=this;t.GetCommunicationList(),t.IsAddCommunication=!1},ClientMessage(){},async ClientDisable(t,e){var a=this;a.isLoading=!0,null!=t?"Disable"==e?a.confirmR(a.$t("ConfirmInactiveRecord"),!0,a.$t("Disable")+"  "+a.$t("Client"),(function(){var e=`ids=${t}&tablename=TALYGEN_company_client_New&primaryKey=user_id`;n["a"].Delete(e).then((async function(e){200==e.status?(a.ShowAlert(a.$t("RecordUpdatedSuccessfully"),"success",a.$t("Alert")),await a.$parent.GetClientDetailByClientId(t),a.getClientDetailData()):a.ShowAlert(a.$t("DeletedError",[a.$t("TrainingFeedback")]),"Success",!0,a.$t("Alert"))}))})):a.confirmR(a.$t("ConfirmActiveRecord"),!0,a.$t("Disable")+"  "+a.$t("Client"),(function(){var e=`ids=${t}&tablename=TALYGEN_company_client_Status&primaryKey=user_id`;n["a"].Delete(e).then((async function(e){200==e.status?(a.ShowAlert(a.$t("RecordUpdatedSuccessfully"),"success",a.$t("Alert")),await a.$parent.GetClientDetailByClientId(t),a.getClientDetailData()):a.ShowAlert(a.$t("DeletedError",[a.$t("TrainingFeedback")]),"Success",!0,a.$t("Alert"))}))})):a.ShowAlert(a.$t("Selectanyrecordtodelete")),a.isLoading=!1},AddNotes(){var t=this;t.NoteObj=null,t.IsAddNote=!0},CloseNotePopup(){var t=this;t.NoteListing(),t.IsAddNote=!1},NoteListing(){var t=this;t.NoteData=[];var e=`id=${this.$route.params.id}&refId=${this.$route.params.id}&moduleName=Company&subModuleCode=Client`;n["a"].NoteListing(e).then(e=>{e.data.data.length>0?e.data.data.forEach(e=>{e.note_date=new Date(e.note_date),t.NoteData.push(e)}):t.NoteData=[]})},getIconClass(t){switch(t){case"HomeAddress":return"fa fa-home";case"OfficeAddress":return"fa fa-building";case"SecondaryAddress":return"fa fa-address-card";default:return"fa fa-address-card"}},formatFullAddress(t){return[t.user_address_1,t.user_address_2,t.user_state,t.country_name,t.user_zipcode].filter(t=>t&&""!==t.trim()).join(", ")},OpenContatNumber(){var t=this;t.ClientId=t.UserId,t.IsContactNumber=!0},DeAssociateContact:async function(t){var e=this,a=[],i=t,s={id:i,userId:e.UserId,isfor:"DeAssociate"};a.push(s),a.length>0?await e.confirmR(e.$t("ContactConfirmDelete"),!0,e.$t("Delete"),(async function(){var t=JSON.stringify(a);n["a"].SubmitAdditionalNewContacts(t).then(t=>{"Success"==t.data.Status?(e.ShowAlert(e.$t("ContactsDeletedSuccessfully"),"success",!0,e.$t("Alert")),e.GetContactList()):e.ShowAlert(e.$t("AddedError",[e.$t("Contacts")]),"failure",!0,e.$t("Alert"))})})):e.ShowAlert(e.$t("PleaseSelectAnyRecordsForFurther"),"warning",!0,e.$t("Alert"))}}},Co=fo,yo=(a("fded"),Object(d["a"])(Co,Rl,Ml,!1,null,"07467c1e",null)),bo=yo.exports,So=a("e361"),Ao={components:{GeneralSettingmodel:p,Address:m["a"],ConfigurationModal:C,ContactNumberVue:y["a"],Communication:b["a"],Quotation:w,Contract:Y,CreditHistory:W,AddCreditHistory:tt,AdditionalContact:Dt,SubscriptionListing:We,BillListing:_a,InvoiceGrouping:si,ContractHoliday:Ua,AddContract:Na,AddBnakHoliday:di,MapMeter:as,MeterReading:dn,AdditionalOwner:rs,RateSchedule:ws,TaxListing:Rn,UtilityTab:cl,Property:Pl,NewClient:wl["default"],GeneralNewTab:bo,WalletRecharge:So["default"]},data(){return{isLoading:!1,isGeneral:!1,isAddress:!1,isConfiguration:!1,isBill:!1,isMeter:!1,isTax:!1,isPro:!1,isMeterReading:!1,isContact:!1,isQuote:!1,isContract:!1,isPlan:!1,isPlanSelection:!1,isPlanDetails:!1,isCreditHistory:!1,isInvoiceGrouping:!1,isAdditionalContact:!1,activeTab:"general",MandatoryString:this.$t("MandatoryString"),companyId:null,userId:null,TabsList:[],ClientData:[],HeaderText:this.$t("GeneralDetails"),HeaderTitle:"",GeneralSettingModal:!1,AdditionalContact:!1,ShowAddress:!1,ShowConfiguration:!1,ShowCommunication:!1,ShowContactNumbers:!1,ShowContract:!1,ShowCreditHistory:!1,ShowQuotation:!1,ShowMeter:!1,ShowMeterReading:!1,ClientId:0,isEditUser:"",Headerstext:"",isCommunication:"",GetConfiguration:{},planDetails:[],AddHistory:!1,refreshKey:0,InvoiceData:[],IsAddContract:!1,isContractHoliday:!1,ContractHolidayData:null,IsAddBnakHoliday:!1,IsInvoiceGroupingDataShow:!1,IsAdditionalInfoDataShow:!1,crefreshKey:0,isAdditionalOwner:!1,ShowAdditionalOwner:!1,isRateSchedule:!1,ShowRateSchedule:!1,IsSubscriptionBilling:!1,IsUtilityBilling:!1,isAdditionalInfoClient:!1,showMobileTabs:!1,AdditionalInfoData:[],currentTab:"GeneralDetails",aWallet:!1}},created:async function(){var t=this;t.userId=t.GetUserInfo.ID,t.user_type=t.GetUserInfo.UserType,t.companyId=t.GetUserInfo.CompanyId,await this.CheckExtraFeatures(),await this.GetTabsContent(),await this.GetClientDetailByClientId(t.$route.params.id),this.$route.query&&"Contract"==this.$route.query.redirectFrom?await this.setActiveTab("aContracts"):this.$route.query&&"Wallet"==this.$route.query.redirectFrom?await this.setActiveTab("aWallet"):await this.setActiveTab("general"),t.isEditUser="EditUser",t.GetUserDetailByUserId()},computed:{GetSelectedModuleItem(){var t=this,e=t.TabsList.filter(e=>e.display_name==t.currentTab);return e.length>0?e[0]:{icon:"",display_name:""}}},methods:{async CheckExtraFeatures(t){var e=this;const a="featureCode=GET_EXTRA_FEATURE_BILLING&outputType=list";try{const t=await n["a"].CheckExtraFeatures(a);if(t.data){const a=JSON.parse(t.data);a.forEach(t=>{"SUBSCRIPTION_BILLING"===t.FEATURE_CODE&&(e.IsSubscriptionBilling=!0),"UTILITY_BILLING"===t.FEATURE_CODE&&(e.IsUtilityBilling=!0)})}}catch(i){console.log("Error checking extra features:",i)}},GetClientDetailByClientId:async function(t){var e=this,a="ClientId="+t;await n["a"].GetClientDetailByClientId(a).then((function(t){e.ClientData=t.data,e.ClientId=e.ClientData.clientdetail.user_id,e.HeaderTitle=t.data.clientdetail.first_name+" "+t.data.clientdetail.last_name}))},receiveUserTypeId(t,e){var a=this;a.userType="",a.userType=parseInt(t),a.Headerstext=e},async GetUserDetailByUserId(){var t=this;try{let e="userId="+t.$route.params.id;await n["a"].GetUserDetailById(e).then(e=>{if(e.data){t.userType=e.data.UserType,t.UserTypeName=e.data.USER_TYPE_NAME,t.userDetail=e.data;let a=e.data.User_Name.replace(" ","")+" ",i=e.data.designation+"  , "||!1,s=e.data.department+" "||!1;t.IS_DEFAULT=e.data.IS_DEFAULT,t.Headerstext=`${a}-${i}${s}`}})}catch(e){console.log("error message",e)}},AddMore(t){var e=this;"creditInfo"==t&&(e.AddHistory=!e.AddHistory)},SetCurrentTab:function(t,e){this.currentTab=t,this.setActiveTab(e)},setActiveTab(t){var e=this;if("general"==t)e.isGeneral=!0,e.openGeneralSettingDetail();else if("aContracts"==t)e.isGeneral=!1,e.isAddress=!1,e.isConfiguration=!1,e.isContact=!1,e.isCommunication=!1,e.isQuote=!1,e.isPlan=!1,e.isPlanSelection=!1,e.isPlanDetails=!1,e.isInvoiceGrouping=!1,e.isAdditionalContact=!1,e.isCreditHistory=!1,e.isContractHoliday=!1,e.isBill=!1,e.isMeter=!1,e.isMeterReading=!1,e.isContract=!0,e.isAdditionalInfoClient=!1,e.isAdditionalOwner=!1,e.isRateSchedule=!1,e.activeTab="aContracts",e.isMeterReading=!1,e.isTax=!1,e.isPro=!1,e.aWallet=!1,e.openContract();else if("aWallet"==t)e.isGeneral=!1,e.isAddress=!1,e.isConfiguration=!1,e.isContact=!1,e.isCommunication=!1,e.isQuote=!1,e.isPlan=!1,e.isPlanSelection=!1,e.isPlanDetails=!1,e.isInvoiceGrouping=!1,e.isAdditionalContact=!1,e.isCreditHistory=!1,e.isContractHoliday=!1,e.isBill=!1,e.isMeter=!1,e.isMeterReading=!1,e.isContract=!1,e.isAdditionalInfoClient=!1,e.isAdditionalOwner=!1,e.isRateSchedule=!1,e.activeTab="aWallet",e.isMeterReading=!1,e.isTax=!1,e.isPro=!1,e.aWallet=!0;else{if(this.activeTab=t.unique_id,this.HeaderText=e.$t(t.display_name),"general"==this.activeTab&&(e.isAddress=!1,e.isConfiguration=!1,e.isContact=!1,e.isCommunication=!1,e.isQuote=!1,e.isContract=!1,e.isPlan=!1,e.isPlanSelection=!1,e.isPlanDetails=!1,e.isCreditHistory=!1,e.isAdditionalContact=!1,e.isInvoiceGrouping=!1,e.isBill=!1,e.isContractHoliday=!1,e.isMeter=!1,e.isGeneral=!0,e.isAdditionalOwner=!1,e.isRateSchedule=!1,e.isMeterReading=!1,e.isTax=!1,e.isPro=!1,e.aWallet=!1,e.isAdditionalInfoClient=!1,e.openGeneralSettingDetail()),"aAddresses"==this.activeTab&&(e.isGeneral=!1,e.isConfiguration=!1,e.isContact=!1,e.isCommunication=!1,e.isQuote=!1,e.isContract=!1,e.isPlan=!1,e.isPlanSelection=!1,e.isPlanDetails=!1,e.isCreditHistory=!1,e.isAdditionalContact=!1,e.isInvoiceGrouping=!1,e.isBill=!1,e.isContractHoliday=!1,e.isMeter=!1,e.isAddress=!0,e.isAdditionalOwner=!1,e.isRateSchedule=!1,e.isMeterReading=!1,e.isTax=!1,e.isPro=!1,e.aWallet=!1,e.isAdditionalInfoClient=!1,e.openAddress()),"clientConfig"==this.activeTab&&(e.isGeneral=!1,e.isAddress=!1,e.isContact=!1,e.isCommunication=!1,e.isQuote=!1,e.isContract=!1,e.isPlan=!1,e.isPlanSelection=!1,e.isPlanDetails=!1,e.isCreditHistory=!1,e.isAdditionalContact=!1,e.isInvoiceGrouping=!1,e.isBill=!1,e.isContractHoliday=!1,e.isMeter=!1,e.isConfiguration=!0,e.isAdditionalOwner=!1,e.isRateSchedule=!1,e.isMeterReading=!1,e.isTax=!1,e.isPro=!1,e.aWallet=!1,e.isAdditionalInfoClient=!1,e.openConfiguration()),"aContactNumbers"==this.activeTab&&(e.isGeneral=!1,e.isAddress=!1,e.isConfiguration=!1,e.isCommunication=!1,e.isQuote=!1,e.isContract=!1,e.isPlan=!1,e.isPlanSelection=!1,e.isPlanDetails=!1,e.isCreditHistory=!1,e.isAdditionalContact=!1,e.isInvoiceGrouping=!1,e.isContractHoliday=!1,e.isMeter=!1,e.isContact=!0,e.isAdditionalOwner=!1,e.isRateSchedule=!1,e.isMeterReading=!1,e.isTax=!1,e.isPro=!1,e.aWallet=!1,e.isAdditionalInfoClient=!1,e.openContactNumbers()),"aAdditionalEmails"==this.activeTab&&(e.isGeneral=!1,e.isAddress=!1,e.isConfiguration=!1,e.isContact=!1,e.isQuote=!1,e.isContract=!1,e.isPlan=!1,e.isPlanSelection=!1,e.isPlanDetails=!1,e.isCreditHistory=!1,e.isAdditionalContact=!1,e.isInvoiceGrouping=!1,e.isBill=!1,e.isContractHoliday=!1,e.isMeter=!1,e.isCommunication=!0,e.isAdditionalOwner=!1,e.isRateSchedule=!1,e.isTax=!1,e.isPro=!1,e.aWallet=!1,e.isAdditionalInfoClient=!1,e.GetConfiguration={user_id:e.userId,user_name:e.Headerstext},e.isMeterReading=!1,e.openCommunication()),"aQuotation"==this.activeTab&&(e.isGeneral=!1,e.isAddress=!1,e.isConfiguration=!1,e.isContact=!1,e.isCommunication=!1,e.isContract=!1,e.isPlan=!1,e.isPlanSelection=!1,e.isPlanDetails=!1,e.isCreditHistory=!1,e.isAdditionalContact=!1,e.isInvoiceGrouping=!1,e.isBill=!1,e.isContractHoliday=!1,e.isMeter=!1,e.isQuote=!0,e.isAdditionalOwner=!1,e.isRateSchedule=!1,e.isMeterReading=!1,e.isTax=!1,e.isPro=!1,e.aWallet=!1,e.isAdditionalInfoClient=!1,e.openQuotation()),"aContracts"==this.activeTab&&(e.isGeneral=!1,e.isAddress=!1,e.isConfiguration=!1,e.isContact=!1,e.isCommunication=!1,e.isQuote=!1,e.isPlan=!1,e.isPlanSelection=!1,e.isPlanDetails=!1,e.isInvoiceGrouping=!1,e.isAdditionalContact=!1,e.isCreditHistory=!1,e.isContractHoliday=!1,e.isBill=!1,e.isMeter=!1,e.isContract=!0,e.isAdditionalOwner=!1,e.isRateSchedule=!1,e.isMeterReading=!1,e.isTax=!1,e.isPro=!1,e.aWallet=!1,e.isAdditionalInfoClient=!1,e.openContract()),"ancPlanMapping"==this.activeTab&&(e.isAddress=!1,e.isConfiguration=!1,e.isContact=!1,e.isCommunication=!1,e.isQuote=!1,e.isContract=!1,e.isPlanSelection=!1,e.isCreditHistory=!1,e.isAdditionalContact=!1,e.isInvoiceGrouping=!1,e.isGeneral=!1,e.isBill=!1,e.isContractHoliday=!1,e.isMeter=!1,e.isPlan=!0,e.isAdditionalOwner=!1,e.isRateSchedule=!1,e.isTax=!1,e.isPro=!1,e.aWallet=!1,e.isAdditionalInfoClient=!1,e.isMeterReading=!1),"ancInvoices"==this.activeTab&&(e.isGeneral=!1,e.isAddress=!1,e.isConfiguration=!1,e.isContact=!1,e.isCommunication=!1,e.isQuote=!1,e.isContract=!1,e.isCreditHistory=!1,e.isContractHoliday=!1,e.isAdditionalContact=!1,e.isPlan=!1,e.isPlanSelection=!1,e.isPlanDetails=!1,e.isMeter=!1,e.isBill=!0,e.isTax=!1,e.isPro=!1,e.aWallet=!1,e.isAdditionalOwner=!1,e.isRateSchedule=!1,e.isAdditionalInfoClient=!1,e.isMeterReading=!1,e.isInvoiceGrouping=!1),"creditInfo"==this.activeTab&&(e.isGeneral=!1,e.isAddress=!1,e.isConfiguration=!1,e.isContact=!1,e.isCommunication=!1,e.isQuote=!1,e.isContract=!1,e.isPlan=!1,e.isPlanSelection=!1,e.isPlanDetails=!1,e.isAdditionalContact=!1,e.isInvoiceGrouping=!1,e.isContractHoliday=!1,e.isBill=!1,e.isMeter=!1,e.isTax=!1,e.aWallet=!1,e.isPro=!1,e.isCreditHistory=!0,e.isAdditionalOwner=!1,e.isAdditionalInfoClient=!1,e.isRateSchedule=!1,e.isMeterReading=!1,e.openCreditHistory()),"aAdditionalNewContacts"==this.activeTab&&(e.isGeneral=!1,e.isAddress=!1,e.isConfiguration=!1,e.isContact=!1,e.isCommunication=!1,e.isQuote=!1,e.isContract=!1,e.isPlan=!1,e.isPlanSelection=!1,e.isPlanDetails=!1,e.isCreditHistory=!1,e.isInvoiceGrouping=!1,e.isContractHoliday=!1,e.isBill=!1,e.isMeter=!1,e.isMeterReading=!1,e.isAdditionalContact=!0,e.isAdditionalOwner=!1,e.isAdditionalInfoClient=!1,e.isRateSchedule=!1,e.isTax=!1,e.isPro=!1,e.aWallet=!1,e.openAdditionalContact()),"AdditionalInfo"==this.activeTab){e.isGeneral=!1,e.isAddress=!1,e.isConfiguration=!1,e.isContact=!1,e.isCommunication=!1,e.isQuote=!1,e.isContract=!1,e.isPlan=!1,e.isPlanSelection=!1,e.isPlanDetails=!1,e.isCreditHistory=!1,e.isInvoiceGrouping=!1,e.isContractHoliday=!1,e.isBill=!1,e.isMeter=!1,e.isMeterReading=!1,e.isAdditionalContact=!1,e.isAdditionalOwner=!1,e.isRateSchedule=!1,e.isPro=!1,e.aWallet=!1,1==e.IsUtilityBilling&&(this.HeaderText=e.$t("TalygenUtility"));var a="controller=Client&action=AdditionalInfoClient";n["a"].CheckPrivilege(a).then((function(t){t.data?(e.isAdditionalInfoClient=!0,e.LoadAdditionalInfo()):e.ShowAlert(e.$t("NotAuthorizedSection"),"warning",!0,e.$t("Alert"))}))}if("ancDivisionMapping"==this.activeTab){e.isGeneral=!1,e.isAddress=!1,e.isConfiguration=!1,e.isContact=!1,e.isCommunication=!1,e.isContractHoliday=!1,e.isQuote=!1,e.isContract=!1,e.isPlan=!1,e.isPlanSelection=!1,e.isPlanDetails=!1,e.isCreditHistory=!1,e.isAdditionalContact=!1,e.isMeter=!1,e.isBill=!1,e.isAdditionalOwner=!1,e.isAdditionalInfoClient=!1,e.isRateSchedule=!1,e.isMeterReading=!1,e.InvoiceAdd=null,e.isTax=!1,e.isPro=!1,e.aWallet=!1,e.GetInvoicedata();a="controller=Client&action=DivisionList";n["a"].CheckPrivilege(a).then((function(t){t.data?(e.isInvoiceGrouping=!0,e.GetInvoicedata()):e.ShowAlert(e.$t("NotAuthorizedSection"),"warning",!0,e.$t("Alert"))}))}if("aCompanyHoliday"==this.activeTab&&(e.isGeneral=!1,e.isAddress=!1,e.isConfiguration=!1,e.isContact=!1,e.isCommunication=!1,e.isQuote=!1,e.isContract=!1,e.isPlan=!1,e.isPlanSelection=!1,e.isPlanDetails=!1,e.isCreditHistory=!1,e.isInvoiceGrouping=!1,e.isAdditionalContact=!1,e.isAdditionalInfoClient=!1,e.isMeter=!1,e.isBill=!1,e.isTax=!1,e.isContractHoliday=!0,e.isAdditionalOwner=!1,e.isMeterReading=!1,e.isRateSchedule=!1,e.aWallet=!1,e.isPro=!1),"aMeter"==this.activeTab&&(e.isGeneral=!1,e.isAddress=!1,e.isConfiguration=!1,e.isContact=!1,e.isCommunication=!1,e.isQuote=!1,e.isContract=!1,e.isPlan=!1,e.isPlanSelection=!1,e.isAdditionalInfoClient=!1,e.isPlanDetails=!1,e.isCreditHistory=!1,e.isInvoiceGrouping=!1,e.isContractHoliday=!1,e.isAdditionalContact=!1,e.isBill=!1,e.isMeter=!0,e.isTax=!1,e.aWallet=!1,e.isPro=!1,e.isAdditionalOwner=!1,e.isMeterReading=!1,e.isRateSchedule=!1,e.openMeter()),"MeterReading"==this.activeTab&&(e.isGeneral=!1,e.isAddress=!1,e.isConfiguration=!1,e.isContact=!1,e.isCommunication=!1,e.isQuote=!1,e.isContract=!1,e.isPlan=!1,e.isPlanSelection=!1,e.isAdditionalInfoClient=!1,e.isPlanDetails=!1,e.isCreditHistory=!1,e.isInvoiceGrouping=!1,e.isContractHoliday=!1,e.isAdditionalContact=!1,e.isBill=!1,e.isMeter=!1,e.aWallet=!1,e.isMeterReading=!0,e.isAdditionalOwner=!1,e.isRateSchedule=!1,e.isTax=!1,e.isPro=!1,e.openMeterReading()),"AdditionalOwner"==this.activeTab&&(e.isGeneral=!1,e.isConfiguration=!1,e.isContact=!1,e.isCommunication=!1,e.isAdditionalInfoClient=!1,e.isQuote=!1,e.isContract=!1,e.isPlan=!1,e.isPlanSelection=!1,e.isPlanDetails=!1,e.isCreditHistory=!1,e.isAdditionalContact=!1,e.isInvoiceGrouping=!1,e.isBill=!1,e.isContractHoliday=!1,e.isMeter=!1,e.isAddress=!1,e.isTax=!1,e.aWallet=!1,e.isAdditionalOwner=!0,e.isRateSchedule=!1,e.isMeterReading=!1,e.isPro=!1,e.openAdditionalOwner()),"RateSchedule"==this.activeTab&&(e.isGeneral=!1,e.isConfiguration=!1,e.isContact=!1,e.isCommunication=!1,e.isQuote=!1,e.isContract=!1,e.isPlan=!1,e.isPlanSelection=!1,e.isPlanDetails=!1,e.isCreditHistory=!1,e.isAdditionalContact=!1,e.isInvoiceGrouping=!1,e.isBill=!1,e.isContractHoliday=!1,e.isMeter=!1,e.isTax=!1,e.isAddress=!1,e.isPro=!1,e.aWallet=!1,e.isAdditionalOwner=!1,e.isRateSchedule=!0,e.isAdditionalInfoClient=!1,e.isMeterReading=!1,e.openAdditionalOwner()),"aTax"==this.activeTab){e.isGeneral=!1,e.isConfiguration=!1,e.isContact=!1,e.isCommunication=!1,e.isQuote=!1,e.isContract=!1,e.isPlan=!1,e.isPlanSelection=!1,e.isPlanDetails=!1,e.isCreditHistory=!1,e.isAdditionalContact=!1,e.isInvoiceGrouping=!1,e.isBill=!1,e.isContractHoliday=!1,e.isMeter=!1,e.isPro=!1,e.isAddress=!1,e.isAdditionalOwner=!1,e.isRateSchedule=!1,e.isMeterReading=!1,e.aWallet=!1;a="controller=Client&action=ManageTax";n["a"].CheckPrivilege(a).then((function(t){t.data?e.isTax=!0:e.ShowAlert(e.$t("NotAuthorizedSection"),"warning",!0,e.$t("Alert"))}))}if("APro"==this.activeTab){e.isGeneral=!1,e.isConfiguration=!1,e.isContact=!1,e.isCommunication=!1,e.isQuote=!1,e.isContract=!1,e.isPlan=!1,e.isPlanSelection=!1,e.isPlanDetails=!1,e.isCreditHistory=!1,e.isAdditionalContact=!1,e.isInvoiceGrouping=!1,e.isBill=!1,e.isContractHoliday=!1,e.isMeter=!1,e.isTax=!1,e.isAddress=!1,e.isAdditionalOwner=!1,e.isRateSchedule=!1,e.isMeterReading=!1,e.isAdditionalInfoClient=!1,e.aWallet=!1;a="controller=Client&action=ManageProperty";n["a"].CheckPrivilege(a).then((function(t){t.data?e.isPro=!0:e.ShowAlert(e.$t("NotAuthorizedSection"),"warning",!0,e.$t("Alert"))}))}"aWallet"==this.activeTab&&(e.isGeneral=!1,e.isConfiguration=!1,e.isContact=!1,e.isCommunication=!1,e.isQuote=!1,e.isContract=!1,e.isPlan=!1,e.isPlanSelection=!1,e.isPlanDetails=!1,e.isCreditHistory=!1,e.isAdditionalContact=!1,e.isInvoiceGrouping=!1,e.isBill=!1,e.isContractHoliday=!1,e.isMeter=!1,e.isTax=!1,e.isAddress=!1,e.isAdditionalOwner=!1,e.isRateSchedule=!1,e.isMeterReading=!1,e.isAdditionalInfoClient=!1,e.isPro=!1,e.aWallet=!0,e.parentId=e.$route.params.parentId)}},LoadAdditionalInfo:async function(){var t=this;t.AdditionalInfoData=[];var e="ClientId="+t.ClientId;await n["a"].GetAdditionalInformation(e).then(e=>{e.data.length>0?(t.AdditionalInfoData=e.data,t.IsAdditionalInfoDataShow=!1):t.IsAdditionalInfoDataShow=!0})},GetInvoicedata:function(){var t=this;t.InvoiceData=[];var e=`Serach=&ClientId=${t.ClientId}&SortBy=&SortExp=&PageSize=10&PageNumber=1`;n["a"].GetInvoiceData(e).then(e=>{e&&e.data.result.Data.length>0?(t.InvoiceData=e.data.result.Data,t.IsInvoiceGroupingDataShow=!1):t.IsInvoiceGroupingDataShow=!0})},openGeneralSettingDetail:function(){var t=this;t.GeneralSettingModal=!t.GeneralSettingModal},openAdditionalContact:function(){var t=this;t.AdditionalContact=!t.AdditionalContact},openAddress:function(){var t=this;t.ShowAddress=!t.ShowAddress},openConfiguration:function(){var t=this;t.ShowConfiguration=!t.ShowConfiguration},openCommunication:function(){var t=this;t.ShowCommunication=!t.ShowCommunication},openContactNumbers:function(){var t=this;t.ShowContactNumbers=!t.ShowContactNumbers},openContract:function(){var t=this;t.ShowContract=!t.ShowContract},openCreditHistory:function(){var t=this;t.ShowCreditHistory=!t.ShowCreditHistory},openQuotation:function(){var t=this;t.ShowQuotation=!t.ShowQuotation},openMeter:function(){var t=this;t.ShowMeter=!t.ShowMeter},openMeterReading(){var t=this;t.ShowMeterReading=!t.ShowMeterReading},openAdditionalOwner:function(){var t=this;t.ShowAdditionalOwner=!t.ShowAdditionalOwner},openRateSchedule:function(){var t=this;t.ShowRateSchedule=!t.ShowRateSchedule},isActiveTab(t){return this.activeTab===t.unique_id},GetTabsContent:async function(){var t=this;let e="ModuleCode=&SubModuleCode=&UseFor=CLIENT_TAB";await n["a"].GetTabsContent(e).then((function(e){t.TabsList=e.data,console.log("vm.TabsList",t.TabsList)}))},Close:function(){var t=this;t.$router.push({name:"ClientListing"})},showPlanDetails(t){this.isPlanSelection=!1,this.isPlanDetails=!0,this.planDetails=t,console.log("gdfgplanDetails",this.planDetails)},AddUtility(){var t=this;t.AdditionalInfoData.push({_validation:!1,clientUserId:0,clientAdditionalId:0,companyName:"",description:"",contactTitle:"",contractStartDate:0,contractEndDate:0,contractRenewalDate:0,frequency:"",jde:"",notes:"",billing:"",poNumber:"",jobDescription:"",premierJobNo:"",statusId:1001,isAfterHour:!1,billingDivision:"",checkCountInAllContracts:!1,startTime:0,endTime:0,isAnyTime:!1,dbName:"",utilityCount:0,processType:"",processDayDate:0,processDay:"",processingTime:"",noOfNotes:0,latestNote:"",totalRecords:0,utilityTypeId:0,meterDescription:""}),t.IsAdditionalInfoDataShow=!1},AddInvoice(){var t=this;t.InvoiceData.push({DIVISIONS_ID:0,NAME:"",DESCRIPTION:"",STATUS_ID:1001,CLIENT_ID:0,DISTRICT_NAME:"",CREATED_DATE:"",PO_NUMBER:"",INVOICE_MEMO:"",INVOICE_DETAIL_TEMPLATE:0,INVOICE_FREQUENCY:"",INVOICE_TYPE_ID:null,FREQUENCY_CUSTOM_DATE:0,DETAIL_FORMAT_TYPE:"",AUTO_INVOICE:!1,PROJECT_ID:0,INVOICE_TYPE_ID:0,AUTOMATE_INVOICE_WORKDAY:!1,SUMMARIZED_LINE_ITEMS:!1,NO_OF_NOTES:0,LATEST_NOTE:null,TOTAL_RECORDS:0}),t.IsInvoiceGroupingDataShow=!1},AddContractHoliady(){var t=this;t.ContractHolidayData=null,t.IsFor="Company",t.IsAddContract=!0},CloseAddContract(){var t=this;t.IsAddContract=!1,t.crefreshKey+=1},AddBankHoliady(){var t=this;t.IsAddBnakHoliday=!0},CloseHolidayBank(){var t=this;t.IsAddBnakHoliday=!1},AddContract(){var t=this,e=t.$route.params.id,a=t.$route.params.parentId;t.$router.push({path:`/CRM/ManageContract/0/CRM/CRM_CONTRACTS?clientId=${e}&parentId=${a}`})}}},Do=Ao,Io=(a("0265"),Object(d["a"])(Do,i,s,!1,null,"2688292d",null));e["default"]=Io.exports},d00a:function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h5",{staticClass:"modal-title"},[t._v(t._s(t.$t("Attachment")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("dynamic-form",{ref:"fileForm",attrs:{mandatorytext:t.MandatoryString,buttons:t.buttons,schema:t.FormSchema},on:{OnSubmit:t.uploadFile}}),e("AttachmentList",{ref:"AttachmentList",attrs:{BillId:t.BillId}})],1)])])])],1)])},s=[],n=(a("14d9"),a("b7ef"),a("9769")),l=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"listing mt-2",attrs:{id:"divAttachmentsList"}},[e("div",{staticClass:"heading-border mb-2"},[e("h5",{staticClass:"h5"},[e("span",[t._v(t._s(t.$t("AttachmentList")))])])]),e("div",{staticClass:"table-responsive"},[e("table",{staticClass:"table table-bordered dt-responsive nowrap mt-0 w-100",attrs:{id:"tbllistingdata"}},[e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",{staticClass:"ui-resizable",attrs:{id:"th-FILENAME"}},[e("span",[t._v(t._s(t.$t("FileName")))])]),e("th",{staticClass:"ui-resizable",attrs:{id:"th-CREATEDAT"}},[e("span",[t._v(t._s(t.$t("CreatedAt")))])]),e("th",{staticClass:"ui-resizable",attrs:{id:"th-CREATEDBY"}},[e("span",[t._v(t._s(t.$t("CreatedBy")))])]),e("th",{staticClass:"ui-resizable",attrs:{id:"th-FILETYPE"}},[e("span",[t._v(t._s(t.$t("FileType")))])]),e("th",{staticClass:"ui-resizable",attrs:{id:"th-DESCRIPTION"}},[e("span",[t._v(t._s(t.$t("Description")))])]),e("th",{staticClass:"text-center nonresize"},[e("span",[t._v(t._s(t.$t("Download")))])]),e("th",{staticClass:"text-center nonresize"},[e("span",[t._v(t._s(t.$t("Delete")))])])])]),e("tbody",[0===t.filteredAttachmentList.length?e("tr",[e("td",{staticClass:"text-center text-danger no-record",attrs:{colspan:"7"}},[t._v(" "+t._s(t.$t("NoRecordfound"))+" ")])]):t._e(),t._l(t.filteredAttachmentList,(function(a,i){return e("tr",{key:i},[e("td",[t._v(t._s(a.file_name))]),e("td",[t._v(t._s(t.$options.filters.formatDate(a.created_at)))]),e("td",[t._v(t._s(a.created_by))]),e("td",[e("i",{class:["file-icon",t.getIconClass(a.Extension),t.getColorClass(a.Extension)]}),t._v(" "+t._s(a.Extension)+" ")]),e("td",[t._v(t._s(t.truncate(a.file_description||"No Description",30)))]),e("td",{staticClass:"text-center"},[e("a",{staticClass:"download",attrs:{title:"Download File"},on:{click:function(e){return t.downloadAttachment(a)}}},[e("i",{staticClass:"fa fa-download text-success"})])]),e("td",{staticClass:"text-center"},[e("a",{staticClass:"delete",attrs:{title:"Delete"},on:{click:function(e){return t.deleteAttachment(a.attachment_id)}}},[e("i",{staticClass:"fa fa-trash text-danger"})])])])}))],2)])])])])},o=[],r=(a("d9e2"),{props:{BillId:{type:Number}},data(){return{attachmentList:[]}},computed:{filteredAttachmentList(){return this.attachmentList}},async created(){console.log("billId",this.BillId),await this.getBillAttachMentList()},methods:{truncate(t,e){return t.length>e?t.substring(0,e)+"...":t},getIconClass(t){switch(t.toLowerCase()){case"doc":case"docx":return"fa fa-file-word";case"pdf":return"fa fa-file-pdf";case"txt":return"fa fa-file-text";case"xls":case"xlsx":return"fa fa-file-excel";default:return"fa fa-file"}},getColorClass(t){switch(t.toLowerCase()){case"doc":case"docx":return"word-color";case"pdf":return"pdf-color";case"txt":return"text-color";case"xls":case"xlsx":return"excel-color";default:return"default-color"}},async getBillAttachMentList(){this.$parent.isLoading=!0,this.attachmentList=[];try{let t="billId="+this.BillId;const e=await n["a"].GetBillAttachMentList(t);200===e.status?(this.$parent.isLoading=!1,""==e.data.result&&null==e.data.result||(this.attachmentList=JSON.parse(e.data.result).data)):this.$parent.isLoading=!1}catch(t){console.error("Error fetching attachment list:",t)}},downloadAttachment(t){try{if(!t||!t.file_path||!t.file_name)throw new Error("Invalid attachment details.");var e=document.createElement("a");e.href=t.file_path,e.setAttribute("download",t.file_name),document.body.appendChild(e),e.click(),document.body.removeChild(e)}catch(a){console.error("Error downloading attachment:",a)}},async deleteAttachment(t){try{const e=await new Promise((t,e)=>{this.confirmR(this.$t("Are you sure you want to delete this attachment?"),!0,!1,(function(e){t(e)}))});if(this.$parent.isLoading=!0,void 0==e){const e="documentId="+t,a=await n["a"].DeleteAttachment(e);200===a.status?(this.$parent.isLoading=!1,"1"==a.data.result.Result&&(this.ShowAlert(this.$t("deleteBillAttachment"),"success"),this.getBillAttachMentList())):this.ShowAlert(this.$t("UnknownError"),"failure",this.$t("Alert"))}}catch(e){console.error("Error deleting attachment:",e)}}}}),c=r,d=(a("9908"),a("2877")),u=Object(d["a"])(c,l,o,!1,null,"2273132f",null),p=u.exports,m={components:{AttachmentList:p},props:{BillId:{type:Number}},data(){return{MandatoryString:this.$t("MandatoryString"),FormSchema:[{layoutType:"double",Data:[{astype:"TextField",label:this.$t("FileName"),name:"FileName",value:"",placeholder:"",config:{},validationRules:{required:!0,max:2e3}},{astype:"FileField",showLabel:!1,label:this.$t("AttachItemImage"),name:"AttachItemImage",value:"",placeholder:"",FieldIndex:0,validationRules:{required:!0},config:{maxSize:5,accept:[{fileType:"doc",iconClass:"fa-file-word-o"},{fileType:"pdf",iconClass:"fa-file-pdf-o"},{fileType:"docx",iconClass:"fa-file-word-o"},{fileType:"txt",iconClass:"fa-file-text-o"},{fileType:"xls",iconClass:"fa-file-excel-o"},{fileType:"xlsx",iconClass:"fa-file-excel-o"}],onDeleteSelectedFiles:this.onDeleteSelectedFiles,onChange:this.GetBase64String,showSelectedFiles:[],showAddIcon:!1,onAddButtonClick:this.AddFileMore,multiple:!1}}]},{layoutType:"single",Data:[{astype:"TextAreaField",label:this.$t("Description"),name:"Description",value:"",placeholder:"",config:{rows:3},validationRules:{required:!1,max:2e3}}]}],buttons:[{type:"submit",class:"btn btn-success save",value:"Y",text:"<i class='fa fa-upload pr-2 pr-2'></i>Upload"},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Cancel",onClick:this.Close}],isLoading:!1}},created(){console.log("FormSchema",this.FormSchema)},methods:{Close(){var t=this;t.$parent.isAttachment=!1},onDeleteSelectedFiles(t){this.$delete(this.FormSchema[0].Data[1].config,"showSelectedFiles")},GetBase64String(t){try{var e=this;e.fileData=[];var a=t.target.files[0],i=new FileReader;i.onload=function(t){return function(t){var i=t.target.result,s=window.btoa(i),n=a.name;e.fileName=n;var l=n.lastIndexOf("."),o=n.substring(l+1,n.length);e.fileExt+="."+o;var r='{"ContentType":"'+a.type+'","Size":"'+a.size+'","Extension":"'+o+'"}',c=a.size;e.fileSize=c;var d={attachement_mime:r,fileName:n,base64String:s,fileSize:a.size,contentType:a.type};e.fileData.push(d)}}(),i.readAsBinaryString(a)}catch(s){}},async uploadFile(t,e){try{if(void 0==this.fileData)return;this.isLoading=!0;let e={file_Name:t.FileName,file_Description:t.Description,invoice_id:this.BillId,attachment:JSON.stringify(this.fileData)},a=new FormData;a.append("postString",JSON.stringify(e));const i=await n["a"].SaveBillAttachment(a);200===i.status?(this.isLoading=!1,"Success"==i.data.Status?(this.FormSchema[0].Data[0].value="",this.FormSchema[0].Data[1].value=[],this.FormSchema[1].Data[0].value="",this.$refs.fileForm.validateForm.reset(),this.onDeleteSelectedFiles(),this.$refs.AttachmentList.getBillAttachMentList(),this.ShowAlert(this.$t("SaveBillAttachment"),"success")):"Exceeds"==i.data.status?this.ShowAlert(this.$t("ExceedBillAttachmentLimit"),"Warning",this.$t("Alert")):this.ShowAlert(this.$t("UnknownError"),"failure",this.$t("Alert"))):(this.isLoading=!1,console.error("Upload failed:",i))}catch(a){console.error("Error uploading file:",a)}}}},h=m,v=Object(d["a"])(h,i,s,!1,null,null,null);e["a"]=v.exports},d42b:function(t,e,a){"use strict";a("0fb6")},d85a:function(t,e,a){"use strict";a("1ecc")},d982:function(t,e,a){"use strict";a("f104")},da52:function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,".gd_mainbase .profileicon[data-v-21af6479]{margin-top:-12px}",""]),t.exports=e},dd99:function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,".ticketsmallfix.theme-primary .p-name{float:left}",""]),t.exports=e},de36:function(t,e,a){"use strict";a("ed02")},e042:function(t,e,a){var i=a("ba15");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("8658956a",i,!0,{sourceMap:!1,shadowMode:!1})},e109:function(t,e,a){"use strict";a("3bc9")},e1f3:function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,"input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}input[type=number]{-moz-appearance:textfield}",""]),t.exports=e},e361:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"container-fluid tab-style p-0 mt-3 clientwallet"},[e("loader",{attrs:{"is-visible":t.isLoading}}),t.ClientId?t._e():e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-12 col-md-4 col-lg-4"},[e("div",{staticClass:"form-group mb-0"},[e("label",[t._v(t._s(t.$t("ChooseCompany"))+":")]),e("div",{staticClass:"input-group form-control p-0 border-0"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedCompany,expression:"selectedCompany"}],staticClass:"form-control",attrs:{id:"ddlcompanylist",tabindex:"1"},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selectedCompany=e.target.multiple?a:a[0]},t.onCompanyChange]}},[e("option",{attrs:{disabled:"",value:""}},[t._v(" "+t._s(t.$t("SelectCompany"))+" ")]),t._l(t.companyListData,(function(a){return e("option",{key:a.value,domProps:{value:a.value}},[t._v(" "+t._s(a.name)+" ")])}))],2)])])])]),e("div",{staticClass:"row mt-3"},[e("div",{staticClass:"col-sm-6"},[e("div",{staticClass:"card profile-card border p-3 ai_base"},[e("div",{staticClass:"d-flex align-items-center"},[t._m(0),e("div",{staticClass:"profile-infoo"},[e("h2",{staticClass:"mb-1"},[t._v("Wallet Balance")]),e("div",{staticClass:"font-18"},[t._v(t._s(t.BaseCurrencyCode)+" "+t._s(t.CurrentAmount?parseFloat(t.CurrentAmount).toFixed(2):"0.00")+" ")]),e("div",{staticClass:"mt-0"},[e("p",{staticClass:"mt-2 text-muted"},[t._v(" Low balance threshold: "+t._s(t.BaseCurrencyCode)+" "+t._s(t.thresholdCurrency?parseFloat(t.thresholdCurrency).toFixed(2):"0.00")+" ")])])]),e("div",{staticClass:"float-right ml-auto"},[e("a",{staticClass:"btn btn-primary mr-2",on:{click:function(e){return t.clkTransactionHistory()}}},[e("em",{staticClass:"fa fa-eye mr-2"}),t._v("Transaction History")]),t.ClientId?t._e():e("a",{staticClass:"btn btn-warning",on:{click:function(e){return t.clkRechargeNow()}}},[e("em",{staticClass:"fa fa-money mr-2"}),t._v("Recharge Now")])])])])]),t.ClientId?t._e():e("div",{staticClass:"col-sm-6"},[e("div",{staticClass:"card profile-card border ai_base p-3"},[e("div",{staticClass:"d-flex align-items-center"},[t._m(1),e("div",{staticClass:"profile-infoo"},[e("h2",{staticClass:"mb-1"},[t._v(t._s(t.GetUserInfo.Name))]),e("div",{staticClass:"font-14"},[t._v(t._s(t.GetUserInfo.Email))]),e("div",{staticClass:"mt-3"},[t._v(" Customer ID: "),e("strong",[t._v(t._s(t.AccountNumber))])])])])])])]),e("div",{staticClass:"col-12 p-0 float-left",class:{"d-none":t.isHidden}},[e("div",{staticClass:"col-12 p-0 float-left"},[t._m(2),e("div",{staticClass:"utilities-grid"},[e("div",{staticClass:"utility-card electricity scrollable-container"},[t._m(3),0===t.ElectricData.length?e("div",{staticClass:"infogrid_base"},[e("div",[t._v("Meter: --")]),t._m(4),e("div",{staticClass:"info-grid"},[t._m(5),e("div",{staticClass:"inner-box"},[e("div",{staticClass:"inner-title red-t"},[t._v("Est. Charge")]),e("div",{staticClass:"inner-value red-t"},[t._v(" "+t._s(t.BaseCurrencyCode)+" 0 ")])])]),t._m(6),t._m(7)]):t.ElectricData.length>0?t._l(t.ElectricData,(function(a){return e("div",{key:a.related_info_id,staticClass:"infogrid_base"},[e("div",[t._v("Meter: "+t._s(a.unique_name))]),e("div",{staticClass:"info-grid"},[e("div",{staticClass:"inner-box"},[e("div",{staticClass:"inner-title"},[t._v("Current Reading")]),e("div",{staticClass:"inner-value"},[t._v(" "+t._s(a.electric_current_reading)+" "),e("small",[t._v("kWh")])])]),e("div",{staticClass:"inner-box"},[e("div",{staticClass:"inner-title"},[t._v("Previous Reading")]),e("div",{staticClass:"inner-value"},[t._v(" "+t._s(a.electric_prev_reading)+" "),e("small",[t._v("kWh")])])])]),e("div",{staticClass:"info-grid"},[e("div",{staticClass:"inner-box"},[e("div",{staticClass:"inner-title"},[t._v("Consumption")]),e("div",{staticClass:"inner-value green"},[t._v(" "+t._s(a.electric_consumption)+" "),e("small",[t._v("kWh")])])]),e("div",{staticClass:"inner-box"},[e("div",{staticClass:"inner-title red-t"},[t._v("Est. Charge")]),e("div",{staticClass:"inner-value red-t"},[t._v(" "+t._s(t.BaseCurrencyCode)+" 0 ")])])]),e("div",{staticClass:"info-grid"},[e("label",[e("span",{staticClass:"font-weight-medium"},[t._v("Last Reading Date:")]),t._v(" "+t._s(t.$d(t.formatDate(a.current_last_reading_date)))+" ")])]),e("div",{staticClass:"text-center mt-3"},[e("a",{staticClass:"btn btn-info",attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.ViewHistory("Electric",a.related_info_id)}}},[e("em",{staticClass:"fa fa-eye mr-2"}),t._v("View Usage History ")])])])})):t._e()],2),e("div",{staticClass:"utility-card water h2o scrollable-container"},[e("div",{staticClass:"utility-title"},[e("svg",{staticClass:"bi bi-droplet text-info",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",viewBox:"0 0 16 16"}},[e("path",{attrs:{"fill-rule":"evenodd",d:"M7.21.8C7.69.295 8 0 8 0q.164.544.371 1.038c.812 1.946 2.073 3.35 3.197 4.6C12.878 7.096 14 8.345 14 10a6 6 0 0 1-12 0C2 6.668 5.58 2.517 7.21.8m.413 1.021A31 31 0 0 0 5.794 3.99c-.726.95-1.436 2.008-1.96 3.07C3.304 8.133 3 9.138 3 10a5 5 0 0 0 10 0c0-1.201-.796-2.157-2.181-3.7l-.03-.032C9.75 5.11 8.5 3.72 7.623 1.82z"}}),e("path",{attrs:{"fill-rule":"evenodd",d:"M4.553 7.776c.82-1.641 1.717-2.753 2.093-3.13l.708.708c-.29.29-1.128 1.311-1.907 2.87z"}})]),t._v(" Water ")]),0===t.WaterData.length?e("div",{staticClass:"infogrid_base"},[e("div",[t._v("Meter: --")]),t._m(8),e("div",{staticClass:"info-grid"},[t._m(9),e("div",{staticClass:"inner-box"},[e("div",{staticClass:"inner-title red-t"},[t._v("Est. Charge")]),e("div",{staticClass:"inner-value red-t"},[t._v(" "+t._s(t.BaseCurrencyCode)+" 0 ")])])]),t._m(10),t._m(11)]):t.WaterData.length>0?t._l(t.WaterData,(function(a){return e("div",{key:a.related_info_id,staticClass:"infogrid_base"},[e("div",[t._v("Meter: "+t._s(a.unique_name))]),e("div",{staticClass:"info-grid"},[e("div",{staticClass:"inner-box"},[e("div",{staticClass:"inner-title"},[t._v("Current Reading")]),e("div",{staticClass:"inner-value"},[t._v(" "+t._s(a.water_current_reading)+" "),e("small",[t._v("m³")])])]),e("div",{staticClass:"inner-box"},[e("div",{staticClass:"inner-title"},[t._v("Previous Reading")]),e("div",{staticClass:"inner-value"},[t._v(" "+t._s(a.water_prev_reading)+" "),e("small",[t._v("m³")])])])]),e("div",{staticClass:"info-grid"},[e("div",{staticClass:"inner-box"},[e("div",{staticClass:"inner-title"},[t._v("Consumption")]),e("div",{staticClass:"inner-value green"},[t._v(" "+t._s(a.water_consumption)+" "),e("small",[t._v("m³")])])]),e("div",{staticClass:"inner-box"},[e("div",{staticClass:"inner-title red-t"},[t._v("Est. Charge")]),e("div",{staticClass:"inner-value red-t"},[t._v(" "+t._s(t.BaseCurrencyCode)+" 0 ")])])]),e("div",{staticClass:"info-grid"},[e("label",[e("span",{staticClass:"font-weight-medium"},[t._v("Last Reading Date:")]),t._v(" "+t._s(t.$d(t.formatDate(a.current_last_reading_date)))+" ")])]),e("div",{staticClass:"text-center mt-3"},[e("a",{staticClass:"btn btn-info",attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.ViewHistory("Water",a.related_info_id)}}},[e("em",{staticClass:"fa fa-eye mr-2"}),t._v("View Usage History ")])])])})):t._e()],2),e("div",{staticClass:"utility-card gas scrollable-container"},[t._m(12),0===t.GasData.length?e("div",[e("div",[t._v("Meter: --")]),t._m(13),e("div",{staticClass:"info-grid"},[t._m(14),e("div",{staticClass:"inner-box"},[e("div",{staticClass:"inner-title red-t"},[t._v("Est. Charge")]),e("div",{staticClass:"inner-value red-t"},[t._v(" "+t._s(t.BaseCurrencyCode)+" 0 ")])])]),t._m(15),t._m(16)]):t.GasData.length>0?t._l(t.GasData,(function(a){return e("div",{key:a.related_info_id,staticClass:"infogrid_base"},[e("div",[t._v("Meter: "+t._s(a.unique_name))]),e("div",{staticClass:"info-grid"},[e("div",{staticClass:"inner-box"},[e("div",{staticClass:"inner-title"},[t._v("Current Reading")]),e("div",{staticClass:"inner-value"},[t._v(" "+t._s(a.gas_current_reading)+" "),e("small",[t._v("CCF")])])]),e("div",{staticClass:"inner-box"},[e("div",{staticClass:"inner-title"},[t._v("Previous Reading")]),e("div",{staticClass:"inner-value"},[t._v(" "+t._s(a.gas_prev_reading)+" "),e("small",[t._v("CCF")])])])]),e("div",{staticClass:"info-grid"},[e("div",{staticClass:"inner-box"},[e("div",{staticClass:"inner-title"},[t._v("Consumption")]),e("div",{staticClass:"inner-value green"},[t._v(" "+t._s(a.gas_consumption)+" "),e("small",[t._v("CCF")])])]),e("div",{staticClass:"inner-box"},[e("div",{staticClass:"inner-title red-t"},[t._v("Est. Charge")]),e("div",{staticClass:"inner-value red-t"},[t._v(" "+t._s(t.BaseCurrencyCode)+" 0 ")])])]),e("div",{staticClass:"info-grid"},[e("label",[e("span",{staticClass:"font-weight-medium"},[t._v("Last Reading Date:")]),t._v(" "+t._s(t.$d(t.formatDate(a.current_last_reading_date)))+" ")])]),e("div",{staticClass:"text-center mt-3"},[e("a",{staticClass:"btn btn-info",attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.ViewHistory("Gas",a.related_info_id)}}},[e("em",{staticClass:"fa fa-eye mr-2"}),t._v("View Usage History ")])])])})):t._e()],2)])])])],1),e("transition",{attrs:{name:"modal"}},[e("div",{staticClass:"my-popups clientwallet"},[t.isRechargeNow?e("div",{staticClass:"modal d-block dialog"},[e("div",{staticClass:"modal-dialog modal-lg",staticStyle:{width:"600px !important"}},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("Recharge Wallet")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.closeModal}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body recharge_popup"},[e("div",{staticClass:"card recharge mt-0"},[e("label",[t._v("Enter Amount ("+t._s(t.BaseCurrencyCode)+"):")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.RechargeAmount,expression:"RechargeAmount"}],attrs:{type:"number",step:"0.01",min:"0",placeholder:"0.00"},domProps:{value:t.RechargeAmount},on:{input:[function(e){e.target.composing||(t.RechargeAmount=e.target.value)},function(e){return t.onAmountInput(e)}]}}),t.RechargeAmount&&!t.isRechargeAmountValid?e("div",{staticClass:"text-danger small mt-1"},[t._v("Please enter a valid amount (up to 10 digits, optional 2 decimals) greater than 0.")]):t._e(),e("div",{staticClass:"quick-select"},t._l([10,25,50,100],(function(a){return e("button",{key:a,class:{active:t.RechargeAmount==a},on:{click:function(e){return t.setAmount(a)}}},[t._v(" "+t._s(t.BaseCurrencyCode)+" "+t._s(a)+" ")])})),0),e("button",{staticClass:"btn btn-success",on:{click:t.WalletRecharge}},[e("em",{staticClass:"fa fa-credit-card"}),t._v(" Recharge Now")]),e("div",{staticClass:"note float-left"},[e("strong",[t._v("Note:")]),t._v(" Funds will be available immediately after successful payment processing. ")])])])])])]):t._e()])]),t.IsClientWalletRechargePayNow?e("ClientWalletRechargePayNow",{attrs:{RechargeAmount:t.RechargeAmount,BaseCurrencyCode:t.BaseCurrencyCode}}):t._e()],1)},s=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"avatar mr-3"},[e("em",{staticClass:"fa fa-wallet"})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"avatar mr-3"},[e("img",{attrs:{src:"https://talygenv.github.io/Vue-UI-Content/images/avatar-icon.jpg"}})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"col-lg-12 my-4 p-0"},[e("div",{staticClass:"heading-border mt-2"},[e("h5",{staticClass:"h5"},[e("span",[t._v("Your Utilities")])])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"utility-title"},[e("em",{staticClass:"fa fa-lightbulb-o text-danger"}),t._v(" Electricity ")])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"info-grid"},[e("div",{staticClass:"inner-box"},[e("div",{staticClass:"inner-title"},[t._v("Current Reading")]),e("div",{staticClass:"inner-value"},[t._v(" 0 "),e("small",[t._v("kWh")])])]),e("div",{staticClass:"inner-box"},[e("div",{staticClass:"inner-title"},[t._v("Previous Reading")]),e("div",{staticClass:"inner-value"},[t._v(" 0 "),e("small",[t._v("kWh")])])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"inner-box"},[e("div",{staticClass:"inner-title"},[t._v("Consumption")]),e("div",{staticClass:"inner-value green"},[t._v(" 0 "),e("small",[t._v("kWh")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"info-grid"},[e("label",[e("span",{staticClass:"font-weight-medium"},[t._v("Last Reading Date:")]),t._v(" -- ")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-center mt-3"},[e("a",{staticClass:"btn btn-info",attrs:{href:"javascript:void(0)"}},[e("em",{staticClass:"fa fa-eye mr-2"}),t._v("View Usage History ")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"info-grid"},[e("div",{staticClass:"inner-box"},[e("div",{staticClass:"inner-title"},[t._v("Current Reading")]),e("div",{staticClass:"inner-value"},[t._v(" 0 "),e("small",[t._v("m³")])])]),e("div",{staticClass:"inner-box"},[e("div",{staticClass:"inner-title"},[t._v("Previous Reading")]),e("div",{staticClass:"inner-value"},[t._v(" 0 "),e("small",[t._v("m³")])])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"inner-box"},[e("div",{staticClass:"inner-title"},[t._v("Consumption")]),e("div",{staticClass:"inner-value green"},[t._v(" 0 "),e("small",[t._v("m³")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"info-grid"},[e("label",[e("span",{staticClass:"font-weight-medium"},[t._v("Last Reading Date: --")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-center mt-3"},[e("a",{staticClass:"btn btn-info",attrs:{href:"javascript:void(0)"}},[e("em",{staticClass:"fa fa-eye mr-2"}),t._v("View Usage History ")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"utility-title"},[e("em",{staticClass:"fa fa-fire text-warning"}),t._v(" Gas ")])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"info-grid"},[e("div",{staticClass:"inner-box"},[e("div",{staticClass:"inner-title"},[t._v("Current Reading")]),e("div",{staticClass:"inner-value"},[t._v("0 "),e("small",[t._v("CCF")])])]),e("div",{staticClass:"inner-box"},[e("div",{staticClass:"inner-title"},[t._v("Previous Reading")]),e("div",{staticClass:"inner-value"},[t._v("0 "),e("small",[t._v("CCF")])])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"inner-box"},[e("div",{staticClass:"inner-title"},[t._v("Consumption")]),e("div",{staticClass:"inner-value green"},[t._v("0 "),e("small",[t._v("CCF")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"info-grid"},[e("label",[e("span",{staticClass:"font-weight-medium"},[t._v("Last Reading Date: --")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-center mt-3"},[e("a",{staticClass:"btn btn-info",attrs:{href:"javascript:void(0)"}},[e("em",{staticClass:"fa fa-eye mr-2"}),t._v("View Usage History ")])])}],n=(a("14d9"),a("9769")),l=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex justify-content-between align-items-center"},[e("h5",{staticClass:"modal-title"},[t._v("Recharge Pay")]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:function(e){return t.CloseClientWalletRecharge()}}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"container-fluid invoice-payment p-0"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"col-sm-12 col-md-12 float-left col-lg-12 col-xl-12 p-0"},[e("div",{staticClass:"card probx mt-0 recharge_payment"},[e("div",{staticClass:"card-header"},[e("h2",{staticClass:"mb-0"},[t._v(t._s(t.$t("PaymentGateway")))])]),e("div",{staticClass:"card-body"},[e("div",{attrs:{id:"ProcessPayment"}},[e("div",{staticClass:"clientwalletsprite"},[t._l(t.paymentGateways,(function(a,i){return"Wallet"!==a.PaymantGatewayType?e("div",{key:i,staticClass:"col-sm-12 col-lg-12 col-md-12 mb-0 p-0"},[e("button",{staticClass:"btn w-100 py-3",class:[a.PaymantGatewayType,"",{active:t.selectedGateway===a.PaymentGatewayCode}],attrs:{type:"button"},on:{click:function(e){return t.selectGateway(a.PaymentGatewayCode)}}},[e("em",{class:t.selectedGateway===a.PaymentGatewayCode?"fa fa-check-circle float-left font-20 text-success":"fa fa-circle-thin float-left font-20"})])]):t._e()})),t.PaymentLink?e("div",{staticClass:"col-md-4 mb-3"},[e("a",{staticClass:"btn btn-outline-info w-100 py-3",attrs:{href:t.PaymentLink,target:"_blank"}},[t._v(" "+t._s(t.$t("ExternalLink")||"External Link")+" ")])]):t._e()],2),e("input",{attrs:{type:"hidden",name:"PaymentGatewayCode"},domProps:{value:t.selectedGateway}}),e("div",{staticClass:"right-forms"},["Stripe"==t.selectedGateway?e("div",[e("form",{ref:"paymentForm",on:{submit:function(e){return e.preventDefault(),t.submitPayment.apply(null,arguments)}}},[e("div",{staticClass:"row py-3"},[e("div",{staticClass:"col-sm-12 col-md-6 col-lg-4 col-xl-4"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"cardholder-name"}},[t._v("Name On Card:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.billingDetails.name,expression:"billingDetails.name"}],staticClass:"stripe-input w-100 form-control",attrs:{type:"text",placeholder:"Name On Card"},domProps:{value:t.billingDetails.name},on:{input:function(e){e.target.composing||t.$set(t.billingDetails,"name",e.target.value)}}})])]),t._m(0),t._m(1),t._m(2),e("div",{staticClass:"col-sm-12 col-md-6 col-lg-4 col-xl-4"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Recharge Amount ("+t._s(t.BaseCurrencyCode)+"):")]),e("input",{staticClass:"form-control font-weight-bold",attrs:{type:"text",disabled:""},domProps:{value:t.RechargeAmount?parseFloat(t.RechargeAmount).toFixed(2):"0.00"}})])]),e("div",{staticClass:"stripe-error",attrs:{id:"card-errors"}},[t._v(" "+t._s(t.errorMessage))])]),e("div",{staticClass:"col-12 mt-3 p-0"},[e("div",{staticClass:"row flex-row-reverse"},[e("div",{staticClass:"col-lg-6 text-right"},[e("input",{ref:"stripeToken",attrs:{type:"hidden"}}),e("input",{ref:"hdnCardType",attrs:{type:"hidden"}}),e("input",{ref:"hdnNameonCard",attrs:{type:"hidden"}}),e("input",{ref:"hdnCardNumber",attrs:{type:"hidden"}}),e("input",{ref:"hdnCardMonth",attrs:{type:"hidden"}}),e("input",{ref:"hdnCardYear",attrs:{type:"hidden"}}),e("input",{ref:"hdnCvv",attrs:{type:"hidden"}}),e("a",{staticClass:"btn btn-info mr-1",attrs:{href:"javascript:;"},on:{click:function(e){return t.submitPayment()}}},[e("em",{staticClass:"fa fa-credit-card-alt pr-2"}),t._v(t._s(t.$t("PayNow"))+" ")]),e("a",{staticClass:"btn btn-danger",attrs:{href:"javascript:;"},on:{click:function(e){return t.RechargeCancel()}}},[e("em",{staticClass:"fa fa-times pr-2"}),t._v(t._s(t.$t("Cancel"))+" ")])]),t._m(3)])])])]):"PayU"==t.selectedGateway||"Razorpay"==t.selectedGateway?e("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 p-0"},[e("div",{staticClass:"row py-3"},[e("div",{staticClass:"col-sm-12 col-md-4 col-lg-4 col-xl-4"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Recharge Amount ("+t._s(t.BaseCurrencyCode)+"):")]),e("input",{staticClass:"form-control font-weight-bold",attrs:{type:"text",disabled:""},domProps:{value:t.RechargeAmount?parseFloat(t.RechargeAmount).toFixed(2):"0.00"}})])]),e("div",{staticClass:"col-12"},[e("div",{staticClass:"row flex-row-reverse"},[e("div",{staticClass:"col-lg-6 text-right"},[e("a",{staticClass:"btn btn-info mr-1",attrs:{href:"javascript:;"},on:{click:t.RechargePayNow}},[e("em",{staticClass:"fa fa-credit-card-alt pr-2"}),t._v(t._s(t.$t("PayNow")))]),e("a",{staticClass:"btn btn-secondary",attrs:{href:"javascript:;"},on:{click:function(e){return t.RechargeCancel()}}},[e("em",{staticClass:"fa fa-times pr-2"}),t._v(t._s(t.$t("Cancel"))+" ")])]),e("div",{staticClass:"col-lg-6"},[e("div",{staticClass:"py-2 mandatory"},[t._v(t._s(t.$t("MandatoryString")))])])])])])]):e("div",[e("div",{staticClass:"row mb-3 py-3"},[e("div",{staticClass:"col-sm-12 col-md-6 col-lg-4 col-xl-4"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("CardType"))+":"),e("span",{staticClass:"text-danger"},[t._v("*")])]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.card.cardType,expression:"card.cardType"}],staticClass:"form-control",class:{"is-invalid":t.cardErrors.cardType},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.card,"cardType",e.target.multiple?a:a[0])},function(e){t.cardErrors.cardType=""}]}},[e("option",{attrs:{value:"Visa"}},[t._v("Visa")]),e("option",{attrs:{value:"Master"}},[t._v("Master Card")]),e("option",{attrs:{value:"Discover"}},[t._v("Discover")]),e("option",{attrs:{value:"Amex"}},[t._v("American Express")])]),t.cardErrors.cardType?e("small",{staticClass:"text-danger"},[t._v(t._s(t.cardErrors.cardType))]):t._e()])]),e("div",{staticClass:"col-sm-12 col-md-6 col-lg-4 col-xl-4"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("CardNumber"))+":"),e("span",{staticClass:"text-danger"},[t._v("*")])]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.card.number,expression:"card.number"}],staticClass:"form-control",class:{"is-invalid":t.cardErrors.number},attrs:{type:"text",placeholder:"1234 1234 1234 1234"},domProps:{value:t.card.number},on:{input:[function(e){e.target.composing||t.$set(t.card,"number",e.target.value)},function(e){t.cardErrors.number=""}]}}),t.cardErrors.number?e("small",{staticClass:"text-danger"},[t._v(t._s(t.cardErrors.number))]):t._e()])]),e("div",{staticClass:"col-sm-12 col-md-6 col-lg-4 col-xl-4"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("NameOnCard"))+":"),e("span",{staticClass:"text-danger"},[t._v("*")])]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.card.name,expression:"card.name"}],staticClass:"form-control",class:{"is-invalid":t.cardErrors.name},attrs:{type:"text"},domProps:{value:t.card.name},on:{input:[function(e){e.target.composing||t.$set(t.card,"name",e.target.value)},function(e){t.cardErrors.name=""}]}}),t.cardErrors.name?e("small",{staticClass:"text-danger"},[t._v(t._s(t.cardErrors.name))]):t._e()])]),e("div",{staticClass:"col-sm-12 col-md-6 col-lg-4 col-xl-4"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("ExpirationDate"))+":"),e("span",{staticClass:"text-danger"},[t._v("*")])]),e("div",{staticClass:"row no-gutters"},[e("div",{staticClass:"col-6 pr-1"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.card.expMonth,expression:"card.expMonth"}],staticClass:"form-control",class:{"is-invalid":t.cardErrors.expMonth},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.card,"expMonth",e.target.multiple?a:a[0])},function(e){t.cardErrors.expMonth=""}]}},[e("option",{attrs:{disabled:"",value:""}},[t._v("Month")]),t._l(t.months,(function(a,i){return e("option",{key:i,domProps:{value:(i+1).toString().padStart(2,"0")}},[t._v(" "+t._s(a)+" ")])}))],2),t.cardErrors.expMonth?e("small",{staticClass:"text-danger"},[t._v(t._s(t.cardErrors.expMonth))]):t._e()]),e("div",{staticClass:"col-6 pl-1"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.card.expYear,expression:"card.expYear"}],staticClass:"form-control",class:{"is-invalid":t.cardErrors.expYear},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.card,"expYear",e.target.multiple?a:a[0])},function(e){t.cardErrors.expYear=""}]}},[e("option",{attrs:{disabled:"",value:""}},[t._v("Year")]),t._l(t.years,(function(a){return e("option",{key:a},[t._v(t._s(a)+" ")])}))],2),t.cardErrors.expYear?e("small",{staticClass:"text-danger"},[t._v(t._s(t.cardErrors.expYear))]):t._e()])])])]),e("div",{staticClass:"col-sm-12 col-md-6 col-lg-4 col-xl-4"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Recharge Amount ("+t._s(t.BaseCurrencyCode)+"):")]),e("input",{staticClass:"form-control font-weight-bold",attrs:{type:"text",disabled:""},domProps:{value:t.RechargeAmount?parseFloat(t.RechargeAmount).toFixed(2):"0.00"}})])]),e("div",{staticClass:"col-sm-12 col-md-6 col-lg-4 col-xl-3 d-none"},[e("div",{staticClass:"form-group"},[e("label",{staticClass:"d-block mb-2"},[t._v(t._s(t.$t("PaymentType"))+":")]),e("div",{staticClass:"d-flex align-items-center"},[e("div",{staticClass:"form-check mr-3"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.paymentType,expression:"paymentType"}],staticClass:"form-check-input",attrs:{type:"radio",id:"full",value:"f"},domProps:{checked:t._q(t.paymentType,"f")},on:{change:function(e){t.paymentType="f"}}}),e("label",{staticClass:"form-check-label",attrs:{for:"full"}},[t._v(" "+t._s(t.$t("FullBalance"))+" ")])]),e("div",{staticClass:"form-check"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.paymentType,expression:"paymentType"}],staticClass:"form-check-input",attrs:{type:"radio",id:"partial",value:"p"},domProps:{checked:t._q(t.paymentType,"p")},on:{change:function(e){t.paymentType="p"}}}),e("label",{staticClass:"form-check-label",attrs:{for:"partial"}},[t._v(" "+t._s(t.$t("PartialPaid"))+" ")])])])])]),e("div",{staticClass:"col-sm-12 col-md-6 col-lg-4 col-xl-4 d-none"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Enter Amount :")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.paymentAmount,expression:"paymentAmount"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.paymentAmount},on:{input:function(e){e.target.composing||(t.paymentAmount=e.target.value)}}})])])]),e("div",{staticClass:"col-12 mt-3 p-0"},[e("div",{staticClass:"row flex-row-reverse"},[e("div",{staticClass:"col-lg-6 text-right"},[e("a",{staticClass:"btn btn-info mr-1",attrs:{href:"javascript:;"},on:{click:t.RechargePayNow}},[e("em",{staticClass:"fa fa-credit-card-alt pr-2"}),t._v(t._s(t.$t("PayNow"))+" ")]),e("a",{staticClass:"btn btn-danger",attrs:{href:"javascript:;"},on:{click:function(e){return t.RechargeCancel()}}},[e("em",{staticClass:"fa fa-times pr-2"}),t._v(t._s(t.$t("Cancel"))+" ")])]),e("div",{staticClass:"col-lg-6"},[e("div",{staticClass:"py-2 mandatory"},[t._v(t._s(t.$t("MandatoryString"))+" ")])])])])])])])])])])],1)])])])])],1),t.IsRechargeReceiptShow?e("ClientWalletRechargeReceipt",{attrs:{TransactionId:t.TransactionId}}):t._e()],1)},o=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"col-sm-12 col-md-6 col-lg-4 col-xl-4"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Card Number: "),e("span",{staticClass:"mandatory"},[t._v("*")])]),e("div",{staticClass:"stripe-input form-control",attrs:{id:"card-number-element"}})])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"col-sm-12 col-md-6 col-lg-4 col-xl-4"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Expiry Date: "),e("span",{staticClass:"mandatory"},[t._v("*")])]),e("div",{staticClass:"stripe-input form-control",attrs:{id:"card-expiry-element"}})])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"col-sm-12 col-md-6 col-lg-4 col-xl-4"},[e("div",{staticClass:"form-group"},[e("label",[t._v("CVC: "),e("span",{staticClass:"mandatory"},[t._v("*")])]),e("div",{staticClass:"stripe-input form-control",attrs:{id:"card-cvc-element"}})])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"col-lg-6"},[e("div",{staticClass:"py-2 mandatory"},[t._v("Fields marked with * are mandatory.")])])}],r=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex justify-content-between align-items-center"},[e("h5",{staticClass:"modal-title"},[t._v("Payment Receipt")]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:function(e){return t.CloseClientWalletRechargeReceipt()}}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("div",{ref:"printArea",staticClass:"invoice-container mt-3 border p-2"},[t._m(0),e("div",{staticStyle:{width:"100%",display:"flex","justify-content":"space-between","align-items":"center","padding-bottom":"5px","border-bottom":"1px dashed rgb(217, 216, 216)","margin-bottom":"10px"}},[t.ReceiptData.company_logo?e("img",{staticStyle:{width:"200px"},attrs:{src:t.ReceiptData.company_logo,alt:"Company Logo"}}):t._e(),e("div",{staticStyle:{color:"rgb(0, 0, 0)","font-family":"Arial, Helvetica, sans-serif","font-size":"1em"}},[e("p",{staticStyle:{"font-weight":"600","font-size":"16px"}},[t._v(t._s(t.ReceiptData.company_name||"Company Name"))]),e("p",[t._v(t._s(t.ReceiptData.company_address||"No Address Provided"))]),e("p",[t._v(t._s((t.ReceiptData.company_zipcode||"No Zip Code Provided")+", "+(t.ReceiptData.company_country||"No Country Provided")))])])]),e("div",{staticClass:"header float-left w-100 p-2 mb-0"},[e("div",{staticClass:"float-left col-md-6 p-0",staticStyle:{color:"rgb(0, 0, 0)","font-family":"Arial, Helvetica, sans-serif","font-size":"1em"}},[e("p",[e("strong",[t._v("Client Name:")]),t._v(" "+t._s(t.ReceiptData.FirstName||"---"))]),e("p",[e("strong",[t._v("Address:")]),t._v(" "+t._s(t.address||"---"))])]),e("div",{staticClass:"float-left col-md-6 p-0",staticStyle:{color:"rgb(0, 0, 0)","font-family":"Arial, Helvetica, sans-serif","font-size":"1em",display:"flex","justify-content":"flex-end"}},[t.ReceiptData.bill_id?e("p",[e("b",[t._v("Invoice Number:")]),t._v(" "+t._s(t.ReceiptData.bill_id||"---")+" ")]):t._e()])]),e("div",{staticStyle:{clear:"both"}}),e("table",{staticClass:"table table-bordered mt-0 border mb-2 secondtable"},[e("tbody",[t._m(1),e("tr",[e("td",[t._v(t._s(t.ReceiptData.payment_gateway_name||"---"))]),e("td",[t._v(t._s(t.ReceiptData.TransactionID||"---"))]),e("td",[t._v(t._s(t.ReceiptData.created_at?t.$options.filters.formatDateTime(t.ReceiptData.created_at):"---"))]),e("td",{style:{color:t.isPaymentSuccess?"green":"red"}},[t._v(t._s(t.ReceiptData.Message||"---"))])])])]),e("table",{staticClass:"table table-bordered mt-2 text-right border float-right secondtable",staticStyle:{width:"400px"}},[e("tbody",[e("tr",[e("td",{staticStyle:{"font-weight":"600",color:"#737373","font-family":"Arial, Helvetica, sans-serif","font-size":"1em",background:"rgb(249 249 249)"}},[t._v(" Recharge Amount ")]),e("td",{staticStyle:{"text-align":"right",color:"#000","font-family":"Arial, Helvetica, sans-serif","font-size":"1.20em","font-weight":"600"}},[t._v(" Rs "+t._s(parseFloat(t.ReceiptData.Amount||0).toFixed(2))+" ")])])])]),e("div",{staticStyle:{clear:"both"}}),e("p",{class:["mt-1","fw-bold",t.isPaymentSuccess?"alert alert-success text-center":"alert alert-danger text-center"]},[t.isPaymentSuccess?e("span",[t._v(" Thank you! Your transaction has been processed successfully. ")]):e("span",[t._v(" Your transaction has failed. Please try again. ")])]),e("div",{staticClass:"text-right mt-3 no-print"},[e("button",{staticClass:"btn btn-success mr-2",on:{click:t.downloadReceipt}},[e("em",{staticClass:"fa fa-print"}),t._v(" Download Receipt ")]),e("button",{staticClass:"btn btn-danger",on:{click:t.goBack}},[e("em",{staticClass:"fa fa-close"}),t._v(" Back to Wallet ")])])])])])])])],1)])},c=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-center"},[e("h4",{staticStyle:{"margin-top":"0",color:"#000","font-family":"Arial, Helvetica, sans-serif","font-size":"18px",background:"#f2f2f2",padding:"10px"}},[t._v(" Wallet Recharge Receipt ")])])},function(){var t=this,e=t._self._c;return e("tr",[e("td",{staticStyle:{"font-weight":"600",color:"#737373",background:"#f9f9f9"}},[t._v("Payment Method")]),e("td",{staticStyle:{"font-weight":"600",color:"#737373",background:"#f9f9f9"}},[t._v("Transaction ID")]),e("td",{staticStyle:{"font-weight":"600",color:"#737373",background:"#f9f9f9"}},[t._v("Payment Date")]),e("td",{staticStyle:{"font-weight":"600",color:"#737373",background:"#f9f9f9"}},[t._v("Status")])])}],d={props:{TransactionId:{type:Number,required:!0}},data(){return{isLoading:!1,RechargeReceipt:null,ReceiptData:{},ResponceMsg:null,CurrencyCode:"",isPrinting:!1,address:""}},computed:{isPaymentSuccess(){if(!this.ReceiptData.Message)return!1;const t=this.normalizeMessage(this.ReceiptData.Message);return"success"===t||t.includes("approved")}},created:async function(){var t=this;t.CurrencyCode=t.GetUserInfo.Currency.replace(/[()]/g,"");try{if("string"===typeof t.TransactionId){const e=JSON.parse(t.TransactionId);t.RechargeReceipt=e.TransactionId}else t.RechargeReceipt=t.TransactionId}catch(e){console.error("Error parsing TransactionId:",e),t.RechargeReceipt=t.TransactionId}t.GetClientReceiptData()},methods:{normalizeMessage(t){return(t||"").toLowerCase().trim().replace(/[.\s]+$/g,"")},CloseClientWalletRechargeReceipt(){this.$parent.IsRechargeReceiptShow=!1},downloadReceipt(){this.isPrinting=!0,setTimeout(()=>{window.print(),this.isPrinting=!1},100)},goBack(){const t=this.normalizeMessage(this.ResponceMsg);("success"===t||t.includes("approved"))&&this.$parent.$parent.onCompanyChange(),this.$parent.$parent.RechargeAmount=null,this.$parent.$parent.isRechargeNow=!1,this.$parent.$parent.IsClientWalletRechargePayNow=!1},GetClientReceiptData(){let t=this;t.isLoading=!0;const e="TransactionId="+t.RechargeReceipt,a=t=>null!==t&&void 0!==t?t:"";n["a"].GetClientReceiptData(e).then(e=>{var i;if(!e.data)return void(t.ReceiptData={});let s=e.data,n={};try{s.response_Json&&(n=JSON.parse(s.response_Json))}catch(l){console.error("JSON parse error:",l)}t.ReceiptData={...s,...n,company_logo:a(s.company_Logo),company_name:a(s.company_Name),company_address:a(s.company_Address),company_city:a(s.company_City),company_state:a(s.company_State),company_country:a(s.company_Country),company_zipcode:a(s.company_ZipCode),user_address_1:a(n.user_address_1),user_address_2:a(n.user_address_2),user_city:a(n.user_city),user_state:a(n.user_state),user_zipcode:a(n.user_zipcode),user_country:a(n.user_country),payment_gateway_name:a(n.payment_gateway_name||s.payment_gateway_name||"N/A")},t.ReceiptData.created_at=n.created_at||s.created_At||null,t.ReceiptData.TransactionID=t.ReceiptData.TransactionID||t.RechargeReceipt,t.ReceiptData.FirstName=t.ReceiptData.FirstName||(null===(i=t.GetUserInfo)||void 0===i?void 0:i.Name)||"",t.ReceiptData.Amount=t.ReceiptData.Amount||t.ReceiptData.field3||0,t.ReceiptData.Message=a(t.ReceiptData.Message||t.ReceiptData.status||"N/A"),t.address=t.formatFullAddress(t.ReceiptData)||"N/A",t.ResponceMsg=t.ReceiptData.Message}).catch(e=>{console.error("Error fetching receipt data:",e),t.ReceiptData={}}).finally(()=>{t.isLoading=!1})},formatFullAddress(t){return[t.user_address_1,t.user_address_2,t.user_city,t.user_state,t.user_zipcode,t.user_country].filter(t=>t&&""!==t.trim()).join(", ")}}},u=d,p=(a("5a3f"),a("2877")),m=Object(p["a"])(u,r,c,!1,null,"51987ad9",null),h=m.exports,v={components:{ClientWalletRechargeReceipt:h},props:{RechargeAmount:{type:Number,required:!0},BaseCurrencyCode:{type:String,required:!1}},watch:{async selectedGateway(t){"Stripe"===t&&(await this.loadStripeScript(),this.initializeStripe())}},async mounted(){await this.createdDone,"Stripe"===this.selectedGateway&&(await this.loadStripeScript(),this.initializeStripe())},data(){return{isLoading:!1,IsUtilityBilling:!1,paymentHistoryData:[],paymentList:[],MainInvocieNetAmount:0,totalPayments:0,templatedata:[],companies:[],selectedCompanyId:"",paymentGateways:[],selectedGateway:"",PaymentLink:"",paymentAmount:"",paymentType:"f",card:{cardType:"Visa",number:"",name:"",expMonth:"",expYear:""},years:[],months:["January","February","March","April","May","June","July","August","September","October","November","December"],UserId:"",BillIdEnc:"",BillId:"",cardErrors:{cardType:"",number:"",name:"",expMonth:"",expYear:""},CompanyName:null,JsonResponse:null,TransactionId:null,IsRechargeReceiptShow:!1,UniqueId:null,ClientEmail:null,ClientName:null,stripe:null,elements:null,cardNumber:null,cardExpiry:null,cardCvc:null,errorMessage:"",billingDetails:{name:""},isStripePaymentGateway:!0,stripePublishableKey:"pk_test_51RjfwB4C6gUvp1ei45F8RMBEUh9vCrFMZgb6Qgrs78Rs9ED9gX2H0HpVm0Pv7NlHiGOc7wdJ1OtH7phwoxpJMgMY00tzECaTbs",createdDone:null}},created:async function(){this.createdDone=(async()=>{var t=this;await t.AddPaymentTranaction(),t.UserId=t.GetUserInfo.ID,t.CompanyName=t.GetUserInfo.CompanyName,t.ClientEmail=t.GetUserInfo.Email,t.ClientName=t.GetUserInfo.Name,t.generateYears(),await t.GetActiveGatewayDetail()})()},methods:{CloseClientWalletRecharge(){this.$parent.IsClientWalletRechargePayNow=!1},async AddPaymentTranaction(){var t=this;const e=`Amount=${t.RechargeAmount}&Description=WALLET_RECHARGE`;await n["a"].AddPaymentTranaction(e).then(e=>{e.data?(t.UniqueId=e.data[0].UniqueId,t.TransactionId=e.data[0].TransactionId):(t.UniqueId=null,t.TransactionId=null)})},generateYears(){const t=(new Date).getFullYear();for(let e=0;e<15;e++)this.years.push(t+e)},async GetActiveGatewayDetail(){try{var t,e=this;e.isLoading=!0;const a=await n["a"].GetActiveGatewayDetail();if(null!==(t=a.data)&&void 0!==t&&t.result){const t=JSON.parse(a.data.result);t.forEach(t=>{if(t.parameters)try{t.parameters=JSON.parse(t.parameters)}catch(e){console.warn("Invalid parameters JSON:",t.parameters),t.parameters={}}}),e.paymentGateways=t,e.paymentGateways.length>0&&(e.selectedGateway=e.paymentGateways[0].PaymentGatewayCode,e.isLoading=!1)}else e.paymentGateways=[],e.isLoading=!1}catch(a){console.error("Error loading gateways:",a),e.paymentGateways=[],e.isLoading=!1}},selectGateway(t){this.selectedGateway=t},RechargePayNow(){var t=this;if(t.isLoading=!0,"Authorize"==t.selectedGateway){let i=!0;if(t.card.cardType||(t.cardErrors.cardType="Card type is required.",i=!1),t.card.number?/^\d{13,19}$/.test(t.card.number)||(t.cardErrors.number="Invalid card number.",i=!1):(t.cardErrors.number="Card number is required.",i=!1),t.card.name||(t.cardErrors.name="Name on card is required.",i=!1),t.card.expMonth||(t.cardErrors.expMonth="Expiration month is required.",i=!1),t.card.expYear||(t.cardErrors.expYear="Expiration year is required.",i=!1),!i)return void(t.isLoading=!1);var e={CardMonth:t.card.expMonth,CardNum:t.card.number,CardType:t.card.cardType,CardYear:t.card.expYear,CompanyName:t.CompanyName,CustomerId:"",InvoiceId:0,NameOnCard:t.card.name,NetAmount:t.RechargeAmount,PaidAmount:t.RechargeAmount,PaymentGatewayCode:t.selectedGateway,RefId:"",BillIdEnc:0,Description:"WALLET_RECHARGE",StripeToken:null,UniqueId:t.UniqueId,TransactionId:t.TransactionId,ClientEmail:t.ClientEmail},a=JSON.stringify(e);n["a"].MakeRealPartialpayment(a).then((function(e){t.TransactionId=e.data.data,1==e.data.status?t.ShowAlert(t.$t("AddedSuccess",[t.$t("Payment")]),"success",!0,t.$t("Alert")):2==e.data.status?t.ShowAlert("Payment not completed","failure",!0,t.$t("Alert")):t.ShowAlert(t.$t("UnknownErrorOccur"),"failure",!0,t.$t("Alert")),t.IsRechargeReceiptShow=!0})).catch(e=>{console.error(e),t.ShowAlert(t.$t("UnknownErrorOccur"),"failure",!0,t.$t("Alert"))}).finally(()=>{t.isLoading=!1})}else if("Razorpay"===t.selectedGateway){var i,s,l,o={amount:(null===(i=t.RechargeAmount)||void 0===i?void 0:i.toString())||"0",currency:"USD",name:t.ClientName||"",email:t.ClientEmail||"",transactionId:(null===(s=t.TransactionId)||void 0===s?void 0:s.toString())||"0",notes:"WALLET_RECHARGE",invoice_id:0,user_id:t.GetUserInfo.ID,company_id:t.GetUserInfo.CompanyId,reference_no:(null===(l=t.UniqueId)||void 0===l?void 0:l.toString())||"0"};t.isLoading=!1,t.$router.push({name:"RazorpayCheckout",params:{razorpayData:o}})}else{var r,c,d={txnid:(null===(r=t.TransactionId)||void 0===r?void 0:r.toString())||"0",udf1:t.UniqueId||"",amount:(null===(c=t.RechargeAmount)||void 0===c?void 0:c.toString())||"0",productinfo:"WALLET_RECHARGE",firstname:t.ClientName||"",email:t.ClientEmail||"",phonenumber:"",udf2:"",udf3:t.selectedGateway};n["a"].MakeRealPartialpaymentPAYU(d).then((function(e){e.data&&"string"===typeof e.data?window.location.href=e.data:t.ShowAlert(t.$t("UnknownErrorOccur"),"failure",!0,t.$t("Alert"))})).catch(e=>{console.error(e),t.ShowAlert(t.$t("UnknownErrorOccur"),"failure",!0,t.$t("Alert"))}).finally(()=>{t.isLoading=!1})}},async submitPayment(){var t=this;const{token:e,error:a}=await t.stripe.createToken(t.cardNumber,{name:t.billingDetails.name});if(a)t.errorMessage=t.mapStripeError(a);else{t.$refs.stripeToken.value=e.id,t.$refs.hdnCardType.value=e.card.brand,t.$refs.hdnNameonCard.value=e.card.name,t.$refs.hdnCardNumber.value=e.card.last4,t.$refs.hdnCardMonth.value=e.card.exp_month,t.$refs.hdnCardYear.value=e.card.exp_year,t.$refs.hdnCvv.value=123;var i={CardMonth:t.$refs.hdnCardMonth.value,CardNum:t.$refs.hdnCardNumber.value,CardType:t.$refs.hdnCardType.value,CardYear:t.$refs.hdnCardYear.value,CompanyName:"UtilityBilling",CustomerId:"",InvoiceId:0,NameOnCard:t.$refs.hdnNameonCard.value,NetAmount:t.RechargeAmount,PaidAmount:t.RechargeAmount,PaymentGatewayCode:"Stripe",RefId:"",BillIdEnc:0,Description:"WALLET_RECHARGE",StripeToken:t.$refs.stripeToken.value,UniqueId:t.UniqueId,TransactionId:t.TransactionId,ClientEmail:t.ClientEmail},s=JSON.stringify(i);n["a"].MakeRealPartialpayment(s).then((function(e){t.isLoading=!1,1==e.data.status?(t.ShowAlert(t.$t("AddedSuccess",[t.$t("Payment")]),"success",!0,t.$t("Alert")),t.IsRechargeReceiptShow=!0):(e.data.status,t.IsRechargeReceiptShow=!0)}))}},RechargeCancel(){this.CloseClientWalletRecharge()},loadStripeScript(){return new Promise((t,e)=>{if(document.querySelector('script[src="https://js.stripe.com/v3/"]'))return void t();const a=document.createElement("script");a.src="https://js.stripe.com/v3/",a.onload=()=>t(),a.onerror=()=>e("Stripe failed to load"),document.head.appendChild(a)})},initializeStripe(){this.stripe=Stripe(this.stripePublishableKey),this.elements=this.stripe.elements();const t={base:{fontSize:"14px",color:"#212529","::placeholder":{color:"#888"}},invalid:{color:"#dc3545"}};this.cardNumber=this.elements.create("cardNumber",{style:t}),this.cardExpiry=this.elements.create("cardExpiry",{style:t}),this.cardCvc=this.elements.create("cardCvc",{style:t}),this.cardNumber.mount("#card-number-element"),this.cardExpiry.mount("#card-expiry-element"),this.cardCvc.mount("#card-cvc-element"),[this.cardNumber,this.cardExpiry,this.cardCvc].forEach(t=>{t.on("change",t=>{this.errorMessage=t.error?t.error.message:""})})},mapStripeError(t){const e={incomplete_number:"Please enter a complete card number.",invalid_number:"The card number you entered is invalid.",incomplete_cvc:"Please enter your card's CVC.",invalid_cvc:"The CVC code you entered is incorrect.",incomplete_expiry:"Please enter the full expiration date.",invalid_expiry_year_past:"Your card's expiration year is in the past.",card_declined:"Your card was declined. Please try another payment method.",expired_card:"Your card has expired."};return e[t.code]||t.message||"Something went wrong."}}},_=v,g=(a("d85a"),Object(p["a"])(_,l,o,!1,null,null,null)),f=g.exports,C={props:{ClientId:{type:Number,required:!0},parentId:{type:Number,required:!0}},components:{ClientWalletRechargePayNow:f},data(){return{isLoading:!1,Currency:"",TotalRecords:0,RechargeAmount:null,HistoryData:[],isRechargeNow:!1,isHidden:!1,UtilityUsageData:[],TotalCousumption:null,TotalAmount:null,AverageCousumption:null,CurrentAmount:null,companyListData:[],selectedCompany:"",IsClientWalletRechargePayNow:!1,thresholdCurrency:0,ElectricData:[],WaterData:[],GasData:[],selectedCurrency:null,BaseCurrencyCode:null,UserId:"",AccountNumber:""}},async created(){this.Currency=this.GetUserInfo.Currency.replace(/[()]/g,""),await this.GetBaseCurrency(),await this.GetBaseCurrencyCode(),this.GetConfigurationValueByKey("Client","MinimumWalletBalance"),this.GetCompanyDDlData(),this.ClientId>0?this.selectedCompany=this.GetUserInfo.CompanyId:this.UserId=this.GetUserInfo.ID,this.GetClientCurrentBalence(this.selectedCompany),this.GetClientDashboardData(this.selectedCompany)},computed:{isRechargeAmountValid(){if(null===this.RechargeAmount||void 0===this.RechargeAmount||""===this.RechargeAmount)return!1;const t=String(this.RechargeAmount),e=/^\d{1,10}(?:\.\d{1,2})?$/;return e.test(t)&&Number(t)>0}},watch:{companyListData(t){t&&t.length>0&&!this.selectedCompany&&(this.selectedCompany=t[0].value,this.onCompanyChange())}},methods:{async GetBaseCurrency(){var t=this,e="configkey=Currency";await n["a"].GetBaseCurrency(e).then(e=>{t.selectedCurrency=e.data.CONFIG_DATA_VALUE}).catch(t=>{console.log(t)})},async GetBaseCurrencyCode(){var t=this;const e="CurrencyId="+t.selectedCurrency;await n["a"].GetBaseCurrencyCode(e).then(e=>{e.data?t.BaseCurrencyCode=e.data[0].iso_code:t.BaseCurrencyCode=null})},GetConfigurationValueByKey(t,e){var a=`moduleName=${t}&configkey=${e}`;n["a"].GetBaseCurrency(a).then(t=>{this.thresholdCurrency=t.data.CONFIG_DATA_VALUE})},GetClientCurrentBalence(t){var e=this.ClientId>0?this.ClientId:this.UserId;const a=`Client_Company_Id=${t}&ClientId=${e}`;n["a"].GetClientCurrentBalence(a).then(t=>{t.data?(this.CurrentAmount=t.data.current_Balance,this.AccountNumber=t.data.crm_Account_No):(this.CurrentAmount="",this.AccountNumber="")})},setAmount(t){this.RechargeAmount=String(t)},onAmountInput(t){let e=t.target.value||"";e=e.replace(/[^0-9.]/g,"");const a=e.split(".");let i=a[0]||"";i.length>10&&(i=i.slice(0,10));let s=a[1]||"";s.length>2&&(s=s.slice(0,2));let n=i;""!==s&&(n=i+"."+s),/^0{2,}$/.test(n)&&-1===n.indexOf(".")&&(n="0"),this.RechargeAmount=n},WalletRecharge(){this.isRechargeAmountValid?this.IsClientWalletRechargePayNow=!0:this.ShowAlert("Please enter a valid amount greater than zero.","failure",!0,this.$t("Alert"))},clkRechargeNow(){var t=this.ClientId>0?this.ClientId:this.UserId;const e="ClientId="+t;n["a"].GetClientWalletRechargeStatus(e).then(t=>{t.data&&("ACTIVE"==t.data?this.isRechargeNow=!0:"INACTIVE"==t.data?this.ShowAlert("Wallet has been inactive. Please contact the administrator.","warning",!0,this.$t("Alert")):"NOT EXIST"==t.data&&this.ShowAlert("Wallet access has been disabled. Please contact the administrator.","warning",!0,this.$t("Alert")))})},async GetClientDashboardData(t){var e=this;e.isLoading=!0;var a=this.ClientId>0?this.ClientId:this.UserId;const i=`Client_Company_Id=${t}&ClientId=${a}`;await n["a"].GetClientDashboardDetail(i).then(t=>{""!=t.data?(e.ElectricData=t.data.filter(t=>"electric"===t.meter_type),e.WaterData=t.data.filter(t=>"water"===t.meter_type),e.GasData=t.data.filter(t=>"gas"===t.meter_type)):(e.ElectricData=[],e.WaterData=[],e.GasData=[]),this.isLoading=!1})},BackDashboard(){var t=this;t.isHidden=!1,t.UtilityUsageData=[],t.TotalAmount="",t.TotalCousumption="",t.AverageCousumption=""},closeModal(){this.isLoading=!0,this.isRechargeNow=!1,this.onCompanyChange(),this.isLoading=!1},GetCompanyDDlData(){const t=this,e="id=&moduleName=&type=GET_COMPANY_LIST&search=&refId=";n["a"].GetDDLData(e).then(e=>{e.data&&e.data.DATA&&e.data.DATA.length>0?t.companyListData=e.data.DATA:(t.companyListData=[],t.selectedCompany="")})},async onCompanyChange(){this.isLoading=!0;var t=""===this.selectedCompany?this.GetUserInfo.CompanyId:this.selectedCompany;this.GetClientCurrentBalence(t),this.GetClientDashboardData(t),this.isLoading=!1},clkTransactionHistory(){var t=this;this.ClientId>0?t.$router.push({name:"TransactionWalletHistory",params:{id:""===this.selectedCompany?this.GetUserInfo.CompanyId:this.selectedCompany,client_id:this.ClientId?this.ClientId:"",parentId:this.parentId?this.parentId:""}}):t.$router.push({name:"TransactionHistory",params:{id:""===this.selectedCompany?this.GetUserInfo.CompanyId:this.selectedCompany}})},ViewHistory(t,e){var a=this;this.ClientId>0?a.$router.push({name:"UsageWalletHistory",params:{id:e,clientId:this.ClientId?this.ClientId:"",parentId:this.parentId?this.parentId:""}}):a.$router.push({name:"UsageHistory",params:{id:e}})}}},y=C,b=(a("b2e5"),Object(p["a"])(y,i,s,!1,null,null,null));e["default"]=b.exports},e870:function(t,e,a){var i=a("9dfd");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("22394d08",i,!0,{sourceMap:!1,shadowMode:!1})},e94c:function(t,e,a){var i=a("967b");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("78d1fae2",i,!0,{sourceMap:!1,shadowMode:!1})},ea0c:function(t,e,a){var i=a("00c5");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("ff9f7090",i,!0,{sourceMap:!1,shadowMode:!1})},ed02:function(t,e,a){var i=a("32e2");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("c98ac07c",i,!0,{sourceMap:!1,shadowMode:!1})},edf8:function(t,e,a){var i=a("dd99");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("54ddf052",i,!0,{sourceMap:!1,shadowMode:!1})},ef94:function(t,e,a){var i=a("ca21");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("7aeb7f3c",i,!0,{sourceMap:!1,shadowMode:!1})},f104:function(t,e,a){var i=a("3621");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("e8e8c97a",i,!0,{sourceMap:!1,shadowMode:!1})},f16f:function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,".recharge_payment .stripe-input.form-control.StripeElement{padding:14.8px 12px}",""]),t.exports=e},f2d7:function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,"body{background-color:#f8f9fa;color:#333}.header-container{background:linear-gradient(135deg,#6a11cb,#2575fc);color:#fff;padding:2rem 0;margin-bottom:2rem;border-radius:0 0 10px 10px}.service-card{border-radius:10px;box-shadow:0 4px 12px rgba(0,0,0,.1);transition:transform .3s;height:100%;border:none}.service-card:hover{transform:translateY(-5px);box-shadow:0 8px 16px rgba(0,0,0,.2)}.service-header{border-radius:0;padding:15px 20px;color:#000;font-weight:600}.service-type-badge{position:absolute;top:20px;right:10px}.badge{line-height:normal!important}.rate-item{border-left:3px solid #0d6efd;padding-left:10px;margin-bottom:15px;background-color:#f8f9fa;padding:10px;border-radius:5px}.current-rate{border-left:3px solid #198754}.rate-form{background-color:#f8f9fa;padding:15px;border-radius:8px}.slab-rate{background-color:#e9ecef;padding:10px;border-radius:5px;margin-top:10px}.action-buttons{margin-top:15px}.service-one-time{background-color:#818ccf}.service-recurring{background-color:#d6e5d6}.service-usage{background-color:#b3cce6}.service-activation{background-color:#f6e2b3}.service-support{background-color:#ffe8b3}.service-fixed-rate{background-color:#e6d4f6}@media (min-width:1200px) and (max-width:1599px){.ratesbasecontrol{flex:0 0 50%!important;max-width:50%!important}}@media (max-width:1199px){.ratesbasecontrol{flex:0 0 100%!important;max-width:100%!important}}",""]),t.exports=e},f7f8:function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,".left-tab-container[data-v-2688292d]{max-height:70vh;overflow-y:auto}.left-tab .nav-link.left-menu a[data-v-2688292d]{width:100%;display:flex}.left-tab .nav-link.left-menu.active .listing[data-v-2688292d],.left-tab .nav-link.left-menu[data-v-2688292d]:hover,.listing[data-v-2688292d]:hover{color:#fff}",""]),t.exports=e},f8c5:function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h5",{staticClass:"modal-title"},[t._v(t._s(t.$t("PaySlipListing")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"d-flex justify-content-between align-items-center flex-wrap"}),e("div",{staticClass:"listing"},[e("div",{staticClass:"table-responsive"},[e("table",{staticClass:"table table-bordered dt-responsive nowrap mt-0"},[e("thead",{staticClass:"thead-bg"},[e("tr",[e("th",[t._v(t._s(t.$t("Serial#")))]),e("th",[t._v(t._s(t.$t("Bill#")))]),e("th",[t._v(t._s(t.$t("Payment Date")))]),e("th",{staticStyle:{"text-align":"center"}},[t._v(t._s(t.$t("Amount")))]),e("th",[t._v(t._s(t.$t("Status")))]),e("th",[t._v(t._s(t.$t("Reference number")))]),e("th",[t._v(t._s(t.$t("Payment mode")))]),e("th",[t._v(t._s(t.$t("Action")))])])]),e("tbody",t._l(t.transaction_history,(function(a,i){return e("tr",{key:i},[e("td",[t._v(t._s(i+1))]),e("td",[t._v(t._s(a.bill_number))]),e("td",[t._v(" "+t._s(t.$options.filters.formatDateTime(a.payment_date)))]),e("td",{staticStyle:{"text-align":"right"}},[t._v(" "+t._s(t.$n(a.bill_record_amount,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")]),e("td",[t._v(t._s(a.PaymentStatus))]),e("td",[t._v(t._s(a.transaction_ref_id))]),e("td",[t._v(t._s(a.Payment_Mode))]),e("td",[e("a",{staticClass:"btn btn-info mr-2",attrs:{href:"javascript:;",title:t.$t("ViewSlip")},on:{click:function(e){return t.PrintPaySlip(a.bill_record_id)}}},[e("em",{staticClass:"fa fa-eye pr-2"}),t._v(t._s(t.$t("ViewSlip"))+" ")])])])})),0)])])])])])])])],1),t.IsPrint?e("PrintPaySlip",{attrs:{BillRecordData:t.BillRecordData}}):t._e()],1)},s=[],n=a("9769"),l=function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered",staticStyle:{width:"1140px"}},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h5",{staticClass:"modal-title"},[t._v(t._s(t.$t("Pay Slip")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"invoice-container",staticStyle:{padding:"5px"},attrs:{id:"printArea"}},[e("h2",{staticStyle:{"margin-top":"0",color:"#000","font-family":"Arial, Helvetica, sans-serif","text-align":"center","font-size":"18px",background:"#f2f2f2",padding:"7px"}},[t._v(" "+t._s(t.$t("PaymentReceipt"))+" ")]),e("div",{staticStyle:{width:"100%",display:"flex","justify-content":"space-between","align-items":"center","padding-bottom":"5px","border-bottom":"1px dashed #d9d8d8","margin-bottom":"10px"}},[e("img",{staticStyle:{"margin-right":"10px",width:"300px"},attrs:{src:t.CompanyLogo,alt:"Company Logo"}}),e("div",{staticClass:"div1",staticStyle:{color:"#000","font-family":"Arial, Helvetica, sans-serif","font-size":"1em"}},[e("p",{staticStyle:{"font-size":"20px","font-weight":"bold",color:"black",padding:"1px 0px"}},[t._v(" "+t._s(t.CompanyName)+" ")]),e("p",[t._v(t._s(t.CompanyAddress))]),e("p",[t._v(t._s(t.CompanyZipCode)+", "+t._s(t.CompanyCountry))])])]),e("div",{staticStyle:{clear:"both"}}),e("div",{staticClass:"header float-left w-100 p-2 mb-0"},[e("div",{staticClass:"div1",staticStyle:{color:"#000","font-family":"Arial, Helvetica, sans-serif","font-size":"1em"}},[e("p",[e("b",[t._v(t._s(t.$t("ClientName"))+":")]),t._v(" "),e("strong",[t._v(t._s(t.BillTo))])]),e("p",[e("b",[t._v(t._s(t.$t("Address"))+":")]),t._v(" "),e("strong",[t._v(t._s(t.address))])])]),e("div",{staticClass:"div3",staticStyle:{color:"#000","font-family":"Arial, Helvetica, sans-serif","font-size":"1em",display:"flex","flex-direction":"column",gap:"0px"}},[e("p",{staticClass:"ps",staticStyle:{display:"flex","justify-content":"end","align-items":"center","white-space":"nowrap"}},[e("b",[t._v(t._s(t.$t("InvoiceNumber"))+":")]),t._v(" "+t._s(t.Billno)+" ")]),e("p",{staticClass:"ps",staticStyle:{display:"flex","justify-content":"end","align-items":"center","white-space":"nowrap"}},[e("b",[t._v(t._s(t.$t("ReceiptNumber"))+" :")]),t._v(" "),e("span",[t._v(t._s(t.Billrecordid))])]),e("p",{staticClass:"ps",staticStyle:{display:"flex","justify-content":"end","align-items":"center","white-space":"nowrap"}},[e("b",[t._v(t._s(t.$t("PaymentDate"))+" :")]),t._v(" "),e("span",[t._v(t._s(t.paymentdate))])])])]),e("div",{staticClass:"payment-advice"},[e("table",{staticClass:"secondtable"},[e("tbody",[e("tr",[e("td",{staticStyle:{"font-weight":"600",color:"#737373","font-family":"Arial, Helvetica, sans-serif","font-size":"1em",background:"rgb(249 249 249)"}},[t._v(t._s(t.$t("ReceivedFrom")))]),e("td",{staticStyle:{"font-weight":"600",color:"#737373","font-family":"Arial, Helvetica, sans-serif","font-size":"1em",background:"rgb(249 249 249)"}},[t._v(t._s(t.$t("Status")))]),e("td",{staticStyle:{"font-weight":"600",color:"#737373","font-family":"Arial, Helvetica, sans-serif","font-size":"1em",background:"rgb(249 249 249)",width:"500px"}},[t._v(t._s(t.$t("PaymentMethod")))])]),e("tr",[e("td",{staticStyle:{color:"#000","font-family":"Arial, Helvetica, sans-serif","font-size":"1em"}},[t._v(t._s(t.BillTo))]),e("td",{staticStyle:{color:"#000","font-family":"Arial, Helvetica, sans-serif","font-size":"1em"}},[t._v(t._s(t.PaymentStatus))]),e("td",{staticStyle:{color:"#000","font-family":"Arial, Helvetica, sans-serif","font-size":"1em"}},[t._v(t._s(t.PaymentMode))])])])]),e("table",{staticClass:"secondtable float-right",staticStyle:{width:"500px"}},[e("tbody",[e("tr",[e("td",{staticStyle:{"font-weight":"600",color:"#737373","font-family":"Arial, Helvetica, sans-serif","font-size":"1em",background:"rgb(249 249 249)"}},[t._v(t._s(t.$t("PreviousPayment")))]),e("td",{staticStyle:{"text-align":"right",color:"#000","font-family":"Arial, Helvetica, sans-serif","font-size":"1em"}},[t._v(t._s(t.$n(t.PreviousPayment,"currency",t.$getLocaleByCurrency(t.CurrencyCode)))+" ")])]),e("tr",[e("td",{staticStyle:{"font-weight":"600",color:"#737373","font-family":"Arial, Helvetica, sans-serif","font-size":"1em",background:"rgb(249 249 249)"}},[t._v(t._s(t.$t("AmountReceived")))]),e("td",{staticStyle:{"text-align":"right",color:"#000","font-family":"Arial, Helvetica, sans-serif","font-size":"1em"}},[t._v(t._s(t.$n(t.BillAmount,"currency",t.$getLocaleByCurrency(t.CurrencyCode))))])]),e("tr",[e("td",{staticStyle:{"font-weight":"600",color:"#737373","font-family":"Arial, Helvetica, sans-serif","font-size":"1em",background:"rgb(249 249 249)"}},[t._v(t._s(t.$t("TransactionRefrenceNumber")))]),e("td",{staticStyle:{"text-align":"right",color:"#000","font-family":"Arial, Helvetica, sans-serif","font-size":"1em"}},[t._v(t._s(t.TransactionRefNumber))])]),e("tr",[e("td",{staticStyle:{"font-weight":"600",color:"#737373","font-family":"Arial, Helvetica, sans-serif","font-size":"1em",background:"rgb(249 249 249)"}},[t._v(t._s(t.$t("TotalAmount")))]),e("td",{staticStyle:{"text-align":"right",color:"#000","font-family":"Arial, Helvetica, sans-serif","font-size":"1.20em","font-weight":"600"}},[t._v(t._s(t.$n(t.TotalAmount,"currency",t.$getLocaleByCurrency(t.CurrencyCode))))])])])])])])]),e("div",{staticClass:"modal-footer text-right pr-0 pb-0",staticStyle:{"margin-bottom":"10px"}},[e("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 p-0"},[e("a",{class:{"btn btn-success mr-2":!0},attrs:{href:"javascript:;",title:t.$t("Print")},on:{click:function(e){return t.PrintPaySlip("printArea")}}},[e("em",{staticClass:"fa fa-print pr-2",attrs:{"aria-hidden":"true"}}),t._v(" "+t._s(t.$t("Print"))+" ")]),e("a",{staticClass:"btn btn-primary delete-btn mr-2",attrs:{title:"Close"},on:{click:function(e){return t.Close()}}},[e("i",{staticClass:"fa fa-times pr-2",attrs:{"aria-hidden":"true"}}),t._v(t._s(t.$t("Close"))+" ")])])])])])])],1)},o=[],r={components:{PrintPaySlip:p},props:{BillRecordData:{type:Object,required:!0}},data(){return{isLoading:!1,CompanyLogo:null,InvoiceDate:"",PaymentMode:"Cash",BillAmount:0,TransactionRefNumber:null,BillTo:null,Billrecordid:null,Billno:"",paymentdate:null,paymentdate:"",Notes:"",PaymentStatus:"",CurrencyCode:"PKR"}},created(){var t=this;this.FetchData(),t.CurrencyCode=t.GetUserInfo.Currency.replace(/[()]/g,"")},methods:{formatFullAddress(t){return[t.user_address_1,t.user_address_2,t.user_state,t.country_name,t.user_zipcode].filter(t=>t&&""!==t.trim()).join(", ")},FetchData:async function(){var t=this,e=t.BillRecordData;t.CompanyLogo=e.company_logo,t.InvoiceDate=t.$options.filters.formatDateTime(e.payment_date),t.PaymentMode=e.Payment_Mode,t.CompanyName=e.company_name,t.CompanyAddress=e.company_address||"No Address Provided",t.CompanyZipCode=e.company_zipcode||"No Zip Code Provided",t.CompanyCountry=e.company_country||"No Country Provided",t.BillAmount=e.TotalAmountRecived,t.TransactionRefNumber=e.Transaction_Reference_Number,t.Billrecordid=e.bill_record_id,t.BillTo=e.ClientName,t.Billno=e.Bill_number,t.address=e.user_address_1&&""!==e.user_address_1.trim()?this.formatFullAddress(e):"N/A",t.paymentdate=t.$options.filters.formatDateTime(e.payment_date),t.Notes=e.Notes,t.TotalAmount=e.TotalAmount,t.PreviousPayment=e.PreviousPayment,t.PaymentStatus=e.PaymentStatus},PrintPaySlip(t){const e=document.getElementById(t).innerHTML,a=document.createElement("iframe");a.style.position="absolute",a.style.width="0px",a.style.height="0px",a.style.border="none",document.body.appendChild(a);const i=a.contentWindow.document;i.open(),i.write("<html><head><title>Print</title>"),i.write("<style>");const s=document.querySelectorAll('style, link[rel="stylesheet"]');s.forEach(t=>{i.write(t.outerHTML)}),i.write("</style></head><body>"),i.write(e),i.write("</body></html>"),i.close(),a.contentWindow.focus(),a.contentWindow.print(),a.remove()},Close(){var t=this;t.$parent.IsPrint=!1}}},c=r,d=(a("5fb0"),a("2877")),u=Object(d["a"])(c,l,o,!1,null,"53b0216e",null),p=u.exports,m={components:{PrintPaySlip:p},props:{BillId:{type:Number,required:!0}},data(){return{isLoading:!1,InvoiceHistory:[],textCountertlength:2e3,comment:"",company_logo:"",invoicedate:"",transaction_history:[],BillNumber:"",mode:"cash",IsPrint:!1,BillRecordData:[],CurrencyCode:"PKR"}},created(){var t=this;this.FetchData(),t.CurrencyCode=t.GetUserInfo.Currency.replace(/[()]/g,"")},methods:{FetchData:async function(){var t=this,e="invoiceId="+t.BillId;await n["a"].GetInvoicePaymentDetails(e).then((function(e){""!=e.data&&null!=e.data&&e.data.length>0&&(t.transaction_history=e.data)}))},Close(){var t=this;t.$parent.isPaySlip=!1},PrintPaySlip:async function(t){var e=this,a=`invoiceId=${e.BillId}&invoiceRecordId=${t}`;await n["a"].GetInvoicePaymentRecord(a).then((function(t){""!=t.data&&null!=t.data&&t.data.length>0&&(e.BillRecordData=t.data[0],e.IsPrint=!0)}))}}},h=m,v=Object(d["a"])(h,i,s,!1,null,null,null);e["a"]=v.exports},fded:function(t,e,a){"use strict";a("6eea")},fea2:function(t,e,a){var i=a("4bad");e=i(!1),e.push([t.i,".receipt-section[data-v-51987ad9]{background:#f7f9fc}table.secondtable[data-v-51987ad9]{width:100%;border-collapse:collapse;margin-top:10px}table.secondtable td[data-v-51987ad9],table.secondtable th[data-v-51987ad9]{border:1px solid #ddd!important;padding:10px;text-align:left}table.secondtable th[data-v-51987ad9]{background-color:#f4f4f4}",""]),t.exports=e}}]);
//# sourceMappingURL=chunk-9a858e5e.js.map