{"version":3,"sources":["webpack:///./src/views/ClientBill/RazorpayCheckout.vue","webpack:///src/views/ClientBill/RazorpayCheckout.vue","webpack:///./src/views/ClientBill/RazorpayCheckout.vue?6b55","webpack:///./src/views/ClientBill/RazorpayCheckout.vue?4db2"],"names":["render","_vm","this","_c","_self","ref","staticStyle","on","createOrder","_v","staticRenderFns","name","mounted","$nextTick","$refs","autoButton","click","created","data","$route","params","razorpayData","JSON","parse","localStorage","getItem","methods","src","Promise","resolve","script","document","createElement","onload","onerror","body","appendChild","_this$razorpayData$or","loaded","loadScript","alert","razorpayObj","amount","currency","email","order_id","toString","notes","transactionId","invoice_id","user_id","GetUserInfo","ID","company_id","CompanyId","reference_no","billId","BillIdEnc","response","DataService","CreatepaymentRAZORPAY","console","log","openRazorpayCheckout","razorpayOrderId","contact","keyId","oid","error","ShowAlert","orderId","transId","vm","invoiceId","options","key","description","prefill","modal","ondismiss","$router","push","InvoiceId","handler","verifyObj","razorpayPaymentId","razorpay_payment_id","razorpay_order_id","razorpaySignature","razorpay_signature","VerifyPaymentRazorpay","then","isLoading","window","location","href","redirectUrl","$t","paymentStatus","theme","color","rzp","Razorpay","paymentId","metadata","payment_id","open","component"],"mappings":"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","file":"js/chunk-2d224d4f.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('button',{ref:\"autoButton\",staticStyle:{\"display\":\"none\"},on:{\"click\":_vm.createOrder}},[_vm._v(\" Open PayU \")])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <button \r\n      ref=\"autoButton\" \r\n      style=\"display:none\"\r\n      @click=\"createOrder\"\r\n    >\r\n      Open PayU\r\n    </button>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport DataService from \"../../services/DataService\";\r\n\r\nexport default {\r\n  name: \"PaymentResult\",\r\n\r\n  mounted() {\r\n    this.$nextTick(() => {\r\n      this.$refs.autoButton.click();\r\n    });\r\n  },\r\n  created() {\r\n    let data = this.$route.params.razorpayData;\r\n\r\n    if (!data) {\r\n        data = JSON.parse(localStorage.getItem(\"razorpayData\"));\r\n    }\r\n\r\n    this.razorpayData = data;\r\n    //this.createOrder()\r\n},\r\n\r\n  methods: {\r\n    async loadScript(src) {\r\n        debugger\r\n      return new Promise((resolve) => {\r\n        const script = document.createElement(\"script\");\r\n        script.src = src;\r\n        script.onload = () => resolve(true);\r\n        script.onerror = () => resolve(false);\r\n        document.body.appendChild(script);\r\n      });\r\n    },\r\n\r\n  async createOrder() {\r\n    debugger\r\n  try {\r\n    // Load Razorpay SDK\r\n    const loaded = await this.loadScript(\"https://checkout.razorpay.com/v1/checkout.js\");\r\n\r\n    if (!loaded) {\r\n      alert(\"Razorpay SDK failed to load.\");\r\n      return;\r\n    }\r\n\r\n    // Prepare request object\r\n    var data=this.razorpayData;\r\n    const razorpayObj = {\r\n      amount: this.razorpayData.amount,                        \r\n      currency: this.razorpayData.currency,\r\n      name: this.razorpayData.name,\r\n      email: this.razorpayData.email,\r\n      order_id: this.razorpayData.order_id?.toString() || \"0\",\r\n      notes: this.razorpayData.notes,\r\n      transactionId: this.razorpayData.transactionId,\r\n      invoice_id: this.razorpayData.invoice_id,\r\n      user_id: this.GetUserInfo.ID,\r\n      company_id: this.GetUserInfo.CompanyId,\r\n      reference_no:  this.razorpayData.reference_no ,\r\n      billId:this.razorpayData.BillIdEnc\r\n    };\r\n\r\n    // Create Razorpay Order (API call)\r\n    const response = await DataService.CreatepaymentRAZORPAY(razorpayObj);\r\n\r\n    console.log(\"Razorpay Order Response:\", response.data);\r\n    debugger\r\n    // Calling checkout popup\r\n    this.openRazorpayCheckout(\r\n      response.data.razorpayOrderId,\r\n      response.data.amount,\r\n      response.data.name ,\r\n      response.data.email ,\r\n      response.data.contact ,\r\n      response.data.notes.keyId,\r\n      response.data.currency,\r\n      response.data.oid \r\n    );\r\n  } \r\n  catch (error) {\r\n    console.error(\"Razorpay API Error:\", error);\r\n    this.ShowAlert(\"Server Error\", \"failure\", true, \"Alert\");\r\n  }\r\n},\r\n\r\n\r\n async openRazorpayCheckout(orderId, amount, name, email, contact, keyId, currency,transId) {\r\n  debugger\r\n  var vm =this\r\n  debugger\r\n  const invoiceId = this.razorpayData.invoice_id;\r\n   const billId = this.razorpayData.BillIdEnc;\r\n    \r\n  const options = {\r\n    key: keyId,\r\n    amount: amount,\r\n    currency: currency,\r\n    name: name,\r\n    description: `BILL_PAYMENT`,\r\n    order_id: orderId,\r\n     \r\n    prefill: { name, email, contact },\r\n  modal: {\r\n      ondismiss: function () {\r\n         vm.$router.push({name: \"PayNow\",params: { InvoiceId: invoiceId,billId: billId }});\r\n        // vm.$router.push({ path: `/ClientBill/PayNow/${invoiceId}/${billId}` });\r\n      }\r\n    },\r\n    handler: async (response) => {\r\n      const verifyObj = {\r\n        razorpayPaymentId: response.razorpay_payment_id,\r\n        razorpayOrderId: response.razorpay_order_id,\r\n        razorpaySignature: response.razorpay_signature,\r\n        transactionId: transId\r\n      };\r\n\r\n      try {\r\n           DataService.VerifyPaymentRazorpay(verifyObj).then(function (response) {\r\n              debugger\r\n                    vm.isLoading = false;\r\n                    if (response.data) {\r\n                        window.location.href = response.data.redirectUrl;\r\n                        return;\r\n                    }\r\n                    vm.ShowAlert(vm.$t(\"UnknownErrorOccur\"), \"failure\", true, vm.$t('Alert'));\r\n                });\r\n                return;\r\n      } catch (error) {\r\n        console.error(\"Verification API Error:\", error);\r\n        this.paymentStatus = \"Failed\";\r\n      }\r\n    },\r\n\r\n    theme: { color: \"#3399cc\" },\r\n  };\r\n\r\n  const rzp = new Razorpay(options);\r\n\r\n  rzp.on(\"payment.failed\", (response) => {\r\n    this.paymentStatus = \"Failed\";\r\n    this.paymentId = response.error.metadata.payment_id;\r\n  });\r\n\r\n  rzp.open();\r\n}\r\n  },\r\n};\r\n</script>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RazorpayCheckout.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RazorpayCheckout.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./RazorpayCheckout.vue?vue&type=template&id=0ffec372\"\nimport script from \"./RazorpayCheckout.vue?vue&type=script&lang=js\"\nexport * from \"./RazorpayCheckout.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}