(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-72a4e8fe"],{"04e7":function(t,e,a){"use strict";var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.$t("Comment")))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:t.Close}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("dynamic-form",{ref:"defaultStatus",attrs:{lang:"en",buttons:t.buttons,schema:t.FormSchema},on:{OnSubmit:t.onSubmit}})],1)])])])],1)},i=[],n=(a("14d9"),a("9769")),o={props:{MappingId:{type:Object,required:!0},type:{type:String,required:!0},planNamesStr:{type:String,required:!0}},data(){return{isLoading:!1,FormSchema:[{layoutType:"single",Data:[{astype:"SelectField",label:this.$t("Status"),name:"Status",value:"",placeholder:"Status",config:{options:[]},validationRules:{required:!0}},{astype:"TextAreaField",label:this.$t("Comment"),name:"Comment",value:"",placeholder:this.$t("Enter Comment"),validationRules:{required:!0},disabled:!1}]}],buttons:[{type:"submit",class:"btn btn-success",text:"<i class='fa fa-save pr-2'></i>Save",isVisible:!0},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Cancel",onClick:this.Close}],companyId:null,userId:null}},created:function(){var t=this;t.userId=t.GetUserInfo.ID,t.companyId=t.GetUserInfo.CompanyId,t.GetStatusList()},methods:{GetStatusList(){var t=this;let e="id=&moduleName=Billing&type=Subscription_Status&search=&refId=";n["a"].GetDDLData(e).then(e=>{""!=e.data&&null!=e.data&&(t.getprojectlist=e.data.DATA,t.getprojectlist.forEach(e=>{t.FormSchema[0].Data[0].config.options.push({value:e.value,name:e.name})}),t.$refs.defaultStatus.UpdateKeyValue())})},onSubmit(t,e){var a=this,s="";a.getprojectlist.forEach((function(e){e.value==t.Status&&(s=e.name)}));const i={ID:a.MappingId,StatusId:t.Status,IsFor:"TALYGEN_CLIENT_PLAN_Mapping",Module:"Billing",Submodule:"Subscription",Comment:t.Comment,StatusName:s,PlanName:a.planNamesStr};n["a"].CommonUpdateStatus(JSON.stringify(i)).then(t=>{var e;"Success"===(null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.status)?(a.ShowAlert(a.$t("RecordUpdatedSuccessfully"),"success",a.$t("Alert")),this.Close(),"Subscription"==a.type?this.$parent.fetchSubscriptions():this.$parent.FetchData()):this.ShowAlert(this.$t("UnknownErrorOccur"),"failure",!0,this.$t("Alert"))})},Close:function(){this.$parent.IsComment=!1}}},c=o,r=a("2877"),l=Object(r["a"])(c,s,i,!1,null,null,null);e["a"]=l.exports},"459f":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("section",[e("tg-list",{attrs:{IsShowAction:!1,showCheckBox:!0,ModuleName:"Billing",listType:["List"],RenderRowActionMethod:t.renderActions,SubModuleCode:"Billing",IdentityColumn:"Mapping_id",HeaderText:"Subscriptions",ListData:t.subscriptionListing,HeaderData:t.subscriptionListHeaders,callbackfunction:t.fetchSubscriptions,HeaderButtons:t.headerButtons,TotalRecords:t.TotalRecords,SearchFields:t.leftSearchFields,ListDataCallBackFunction:t.fetchSubscriptions,LegendArray:[],SortExp:t.sortExp,SortBy:t.sortBy,NorecordfoundText:t.$t("NoRecordfound")},on:{HeaderButtonClick:t.commonHeaderButtonClick,PagerButtonClick:t.pagerMethod,LeftsearchButtonClick:t.leftCommonSearch},scopedSlots:t._u([{key:"slotdata",fn:function({data:a}){return["PLAN_NAME"==a.column.COLUMN_NAME?[e("span",[e("a",{attrs:{href:"/Plan/ManageSubscriptionPlanDetail/"+a.row.PLAN_ID}},[t._v(" "+t._s(a.row.PLAN_NAME)+" ")])])]:t._e(),"STATUS_NAME"==a.column.COLUMN_NAME?[e("span",{class:t.getStatusClassList(a.row.STATUS_NAME,"STATUS_NAME")},[t._v(" "+t._s(a.row.STATUS_NAME)+" ")])]:t._e(),"PRICE"==a.column.COLUMN_NAME?[e("span",[t._v(t._s(t.$n(a.row.PRICE,"currency",t.$getLocaleByCurrency(t.CurrencyCode))))])]:t._e()]}}])}),t.IsComment?e("AddComment",{attrs:{MappingId:t.MappingId,type:t.type,planNamesStr:t.planNamesStr},on:{ChangeStatus:t.ChangeStatus}}):t._e()],1)},i=[],n=(a("14d9"),a("9769"));const o=[{COLUMN_NAME:"USER_NAME",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Client Name",DISPLAY_ORDER:1,settings:{clickEvent:!0}},{COLUMN_NAME:"PLAN_NAME",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Plan Name",DISPLAY_ORDER:2,settings:{isInSlot:!0}},{COLUMN_NAME:"ServiceNames",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Service Name",DISPLAY_ORDER:3},{COLUMN_NAME:"STATUS_NAME",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Status",DISPLAY_ORDER:4,settings:{isInSlot:!0}},{COLUMN_NAME:"FREQUANCY",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Frequancy",DISPLAY_ORDER:5},{COLUMN_NAME:"PRICE",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Price",DISPLAY_ORDER:6,settings:{isInSlot:!0}},{COLUMN_NAME:"UNITS",DATA_TYPE:"text",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Units",DISPLAY_ORDER:7}];let c=[{fieldName:"Clients",fieldType:"text",fieldIcon:"fa-file-text-o",fieldSearchConditionName:["clientName"],paramName:"clientName",placeholder:"Search by client name",isSearch:!1,value:"",listOptions:[]},{fieldName:"Plans",fieldType:"ddl-check",fieldIcon:"fa-file-text-o",fieldSearchConditionName:["plans"],paramName:"plans",isSearch:!1,value:"",listOptions:[]}],r=[{id:"ChangeStatus",title:"Change Status",iconClass:"fa fa-check",callbackfunction:"ChangeStatus",isdisabled:!0,isvisible:!0,isEnabledOnSelectedRow:!0}],l=[{title:"View",callbackfunction:"ViewPlamDetails",icon:"fa fa-eye action-icon",additionalSpan:""}];var d={subscriptionHeaders:o,leftsearchSchema:c,listActions:l,headerButtons:r},u=a("04e7"),p={components:{AddComment:u["a"]},data(){return{subscriptionListing:[],subscriptionListHeaders:d.subscriptionHeaders,TotalRecords:0,leftSearchFields:d.leftsearchSchema,listActions:d.listActions,headerButtons:d.headerButtons,sortExp:"",sortBy:"",pageSize:10,pageNumber:1,IsComment:!1,MappingId:"",type:"Subscription",planNamesStr:"",CurrencyCode:"PKR"}},created:function(){var t=this;this.fetchSubscriptions(),this.getDropdownData("PLANS"),t.CurrencyCode=t.GetUserInfo.Currency.replace(/[()]/g,"")},methods:{getStatusNameById(t){const e=this.StatusListForListing.find(e=>e.STATUS_ID===t);return e?e.STATUS:""},getDropdownData:function(t){var e=this;let a=`id=&moduleName=CLIENT&type=${t}&search=`;n["a"].GetDDLData(a).then(a=>{""!=a.data&&null!=a.data&&e.leftSearchFields.forEach((function(e){"Plans"==e.fieldName&&"PLANS"==t&&(e.listOptions=a.data.DATA)}))})},commonHeaderButtonClick:function(t){switch(t.callbackfunction){case"ChangeStatus":this.ChangeStatusModal();break;case"commonDeleteData":this.commonDeleteData();break}},ChangeStatusModal:function(t){var e=this,a="";if(e.isLoading=!0,null==t?$(".chkItems:checkbox:checked").not("[id^='chkAll_0']").each((function(){a.length>0&&(a+=","),a+=$(this).val()})):a=t,null!=a){e.MappingId=a;var s=e.MappingId.split(",").map(t=>parseInt(t.trim()));e.planNamesStr=e.subscriptionListing.filter(t=>s.includes(t.Mapping_id)).map(t=>t.PLAN_NAME).join(", "),e.IsComment=!0}else e.ShowAlert(e.$t("Selectanyrecordtodelete"));e.isLoading=!1},getStatusClassList:function(t){let e="";switch(t){case"Active":e="px-2 text-center text-white d-block bg-success";break;case"Pending Activation":e="px-2 text-center text-dark d-block bg-warning";break;case"Past Due":e="px-2 text-center bg-warning text-white d-block";break;case"Paused":e="px-2 text-center text-white d-block bg-danger";break;case"Grace Period":e="px-2 text-center text-white d-block bg-teal";break;case"Suspended":e="px-2 bg-primary text-center text-white d-block";break;case"Cancelled":e="px-2 text-center text-white d-block bg-danger";break;case"Inactive":e="px-2 text-center text-white d-block bg-danger";break;case"Churned":e="px-2 bg-secondary text-center text-white d-block";break;default:e="px-2 text-center text-white d-block bg-secondary"}return e},fetchSubscriptions:async function(t){let e=this,a="sortBy="+this.sortBy+"&sortExp="+this.sortExp+"&pageNumber="+this.pageNumber+"&pageSize="+this.pageSize;"undefined"!=typeof t&&""!=t&&(a=a+"&"+t),await n["a"].getSubscriptionListing(a).then((function(t){if(null!=t&&null!=t.data&&"Success"==t.data.status){for(var a in e.subscriptionListing=JSON.parse(t.data.result),e.subscriptionListing)e.subscriptionListing[a].isCheckBoxDisabled=!1,"Inactive"==e.subscriptionListing[a].STATUS_NAME||"Cancelled"==e.subscriptionListing[a].STATUS_NAME?e.subscriptionListing[a].isCheckBoxDisabled=!0:e.subscriptionListing[a].isCheckBoxDisabled=!1;e.subscriptionListing.length>0?(e.TotalRecords=e.subscriptionListing[0].totalRecords,e.headerButtons[0].isdisabled=!0):e.TotalRecords=0}}))},pagerMethod:function(t,e){this.pageNumber=t.PageNumber,this.pageSize=t.PageSize,this.fetchSubscriptions()},renderActions:function(t){var e=this;let a=[];return e.listActions.forEach(t=>{let e={...t};switch(e.title){case"View":e.isVisible=!0;break;case"Delete":e.isVisible=!0;break;case"Share":e.isVisible=!1;break;default:e.isVisible=!0}a.push(e)}),a},leftCommonSearch:function(t,e){this.fetchSubscriptions(t.searchConditionJson)}}},S=p,h=a("2877"),m=Object(h["a"])(S,s,i,!1,null,null,null);e["default"]=m.exports}}]);
//# sourceMappingURL=chunk-72a4e8fe.js.map